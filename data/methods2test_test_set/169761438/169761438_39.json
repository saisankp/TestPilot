{"test_class": {"identifier": "OadrSecurityRoleServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Resource\n\tprivate DigestAuthenticationProvider digestAuthenticationProvider;", "modifier": "@Resource\n\tprivate", "type": "DigestAuthenticationProvider", "declarator": "digestAuthenticationProvider", "var_name": "digestAuthenticationProvider"}, {"original_string": "@Resource\n\tprivate OadrSecurityRoleService oadrSecurityRoleService;", "modifier": "@Resource\n\tprivate", "type": "OadrSecurityRoleService", "declarator": "oadrSecurityRoleService", "var_name": "oadrSecurityRoleService"}, {"original_string": "@Resource\n\tprivate OadrUserService oadrUserService;", "modifier": "@Resource\n\tprivate", "type": "OadrUserService", "declarator": "oadrUserService", "var_name": "oadrUserService"}, {"original_string": "@Resource\n\tprivate OadrAppService oadrAppService;", "modifier": "@Resource\n\tprivate", "type": "OadrAppService", "declarator": "oadrAppService", "var_name": "oadrAppService"}, {"original_string": "@Resource\n\tprivate VenService venService;", "modifier": "@Resource\n\tprivate", "type": "VenService", "declarator": "venService", "var_name": "venService"}, {"original_string": "@Resource\n\tprivate VtnConfig vtnConfig;", "modifier": "@Resource\n\tprivate", "type": "VtnConfig", "declarator": "vtnConfig", "var_name": "vtnConfig"}, {"original_string": "private OadrUser adminUser = null;", "modifier": "private", "type": "OadrUser", "declarator": "adminUser = null", "var_name": "adminUser"}, {"original_string": "private OadrUser passwordUser = null;", "modifier": "private", "type": "OadrUser", "declarator": "passwordUser = null", "var_name": "passwordUser"}, {"original_string": "private OadrApp appUser = null;", "modifier": "private", "type": "OadrApp", "declarator": "appUser = null", "var_name": "appUser"}, {"original_string": "private Ven venUser = null;", "modifier": "private", "type": "Ven", "declarator": "venUser = null", "var_name": "venUser"}, {"original_string": "private Ven venX509 = null;", "modifier": "private", "type": "Ven", "declarator": "venX509 = null", "var_name": "venX509"}], "file": "OpenADRServerVTNCommon/src/test/java/com/avob/openadr/server/common/vtn/security/OadrSecurityRoleServiceTest.java"}, "test_case": {"identifier": "grantDigestRoleTest", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void grantDigestRoleTest() {\n\n\t\tString encodeDigest = oadrUserService.encodeDigest(\"passUser\", \"passUser\",\n\t\t\t\tdigestAuthenticationProvider.getRealm());\n\n\t\tUser digestUserDetail = oadrSecurityRoleService.digestUserDetail(\"passUser\");\n\n\t\tassertEquals(digestUserDetail.getPassword(), encodeDigest);\n\n\t\tUser grantDigestRole = oadrSecurityRoleService.grantDigestRole(\"passUser\", encodeDigest);\n\n\t\tassertEquals(grantDigestRole.getPassword(), encodeDigest);\n\n\t\tboolean exception = false;\n\t\ttry {\n\t\t\toadrSecurityRoleService.grantDigestRole(\"passUser\", \"passUser\");\n\t\t} catch (Exception e) {\n\t\t\texception = true;\n\t\t}\n\t\tassertTrue(exception);\n\t}", "signature": "void grantDigestRoleTest()", "full_signature": "@Test public void grantDigestRoleTest()", "class_method_signature": "OadrSecurityRoleServiceTest.grantDigestRoleTest()", "testcase": true, "constructor": false, "invocations": ["encodeDigest", "getRealm", "digestUserDetail", "assertEquals", "getPassword", "grantDigestRole", "assertEquals", "getPassword", "grantDigestRole", "assertTrue"]}, "focal_class": {"identifier": "OadrSecurityRoleService", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Resource\n\tprivate VtnConfig vtnConfig;", "modifier": "@Resource\n\tprivate", "type": "VtnConfig", "declarator": "vtnConfig", "var_name": "vtnConfig"}, {"original_string": "@Resource\n\tprivate AbstractUserDao abstractUserDao;", "modifier": "@Resource\n\tprivate", "type": "AbstractUserDao", "declarator": "abstractUserDao", "var_name": "abstractUserDao"}, {"original_string": "private BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();", "modifier": "private", "type": "BCryptPasswordEncoder", "declarator": "encoder = new BCryptPasswordEncoder()", "var_name": "encoder"}], "methods": [{"identifier": "digestUserDetail", "parameters": "(String username)", "modifiers": "public", "return": "User", "signature": "User digestUserDetail(String username)", "full_signature": "public User digestUserDetail(String username)", "class_method_signature": "OadrSecurityRoleService.digestUserDetail(String username)", "testcase": false, "constructor": false}, {"identifier": "grantDigestRole", "parameters": "(String username, String password)", "modifiers": "public", "return": "User", "signature": "User grantDigestRole(String username, String password)", "full_signature": "public User grantDigestRole(String username, String password)", "class_method_signature": "OadrSecurityRoleService.grantDigestRole(String username, String password)", "testcase": false, "constructor": false}, {"identifier": "grantBasicRole", "parameters": "(String username, CharSequence rawPassword)", "modifiers": "public", "return": "User", "signature": "User grantBasicRole(String username, CharSequence rawPassword)", "full_signature": "public User grantBasicRole(String username, CharSequence rawPassword)", "class_method_signature": "OadrSecurityRoleService.grantBasicRole(String username, CharSequence rawPassword)", "testcase": false, "constructor": false}, {"identifier": "grantX509Role", "parameters": "(String username)", "modifiers": "public", "return": "User", "signature": "User grantX509Role(String username)", "full_signature": "public User grantX509Role(String username)", "class_method_signature": "OadrSecurityRoleService.grantX509Role(String username)", "testcase": false, "constructor": false}, {"identifier": "saveFindUser", "parameters": "(String username)", "modifiers": "private", "return": "AbstractUser", "signature": "AbstractUser saveFindUser(String username)", "full_signature": "private AbstractUser saveFindUser(String username)", "class_method_signature": "OadrSecurityRoleService.saveFindUser(String username)", "testcase": false, "constructor": false}, {"identifier": "grantRole", "parameters": "(AbstractUser abstractUser, String password)", "modifiers": "private", "return": "User", "signature": "User grantRole(AbstractUser abstractUser, String password)", "full_signature": "private User grantRole(AbstractUser abstractUser, String password)", "class_method_signature": "OadrSecurityRoleService.grantRole(AbstractUser abstractUser, String password)", "testcase": false, "constructor": false}], "file": "OpenADRServerVTNCommon/src/main/java/com/avob/openadr/server/common/vtn/security/OadrSecurityRoleService.java"}, "focal_method": {"identifier": "grantDigestRole", "parameters": "(String username, String password)", "modifiers": "public", "return": "User", "body": "public User grantDigestRole(String username, String password) {\n\t\tAbstractUser abstractUser = saveFindUser(username);\n\t\tif (!abstractUser.getDigestPassword().equals(password)) {\n\t\t\tthrow new BadCredentialsException(\"Bad credentials given for user: '\" + username + \"'\");\n\t\t}\n\t\treturn this.grantRole(abstractUser, abstractUser.getDigestPassword());\n\t}", "signature": "User grantDigestRole(String username, String password)", "full_signature": "public User grantDigestRole(String username, String password)", "class_method_signature": "OadrSecurityRoleService.grantDigestRole(String username, String password)", "testcase": false, "constructor": false, "invocations": ["saveFindUser", "equals", "getDigestPassword", "grantRole", "getDigestPassword"]}, "repository": {"repo_id": 169761438, "url": "https://github.com/avob/OpenADR", "language": "Java", "is_fork": false, "fork_count": 6, "stargazer_count": 8, "size": 55915, "license": "licensed"}}