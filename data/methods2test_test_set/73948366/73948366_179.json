{"test_class": {"identifier": "MetricNotificationServiceTest", "superclass": "", "interfaces": "", "fields": [], "file": "libs/java/server_common/src/test/java/com/yahoo/athenz/common/server/notification/impl/MetricNotificationServiceTest.java"}, "test_case": {"identifier": "testNotify", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testNotify() {\n        Metric metric = Mockito.mock(Metric.class);\n        MetricNotificationService metricNotificationService = new MetricNotificationService(metric);\n\n        Map<String, String> details = new HashMap<>();\n        details.put(\"key1\", \"attribute1\");\n        details.put(\"key2\", \"attribute2\");\n        details.put(\"key3\", \"attribute3\");\n\n        Notification notification = new Notification();\n        notification.setDetails(details);\n        notification.setType(\"testType\");\n\n        boolean notify = metricNotificationService.notify(notification);\n        assertTrue(notify);\n\n        String[] expectedAttributes = new String[] {\n                \"key1\", \"attribute1\",\n                \"key2\", \"attribute2\",\n                \"key3\", \"attribute3\",\n                \"notif_type\", \"testType\"\n        };\n\n        Mockito.verify(metric, Mockito.times(1))\n                .increment(\"athenz_notification\", expectedAttributes);\n    }", "signature": "void testNotify()", "full_signature": "@Test public void testNotify()", "class_method_signature": "MetricNotificationServiceTest.testNotify()", "testcase": true, "constructor": false, "invocations": ["mock", "put", "put", "put", "setDetails", "setType", "notify", "assertTrue", "increment", "verify", "times"]}, "focal_class": {"identifier": "MetricNotificationService", "superclass": "", "interfaces": "implements NotificationService", "fields": [{"original_string": "private final Metric metric;", "modifier": "private final", "type": "Metric", "declarator": "metric", "var_name": "metric"}], "methods": [{"identifier": "MetricNotificationService", "parameters": "(Metric metric)", "modifiers": "public", "return": "", "signature": " MetricNotificationService(Metric metric)", "full_signature": "public  MetricNotificationService(Metric metric)", "class_method_signature": "MetricNotificationService.MetricNotificationService(Metric metric)", "testcase": false, "constructor": true}, {"identifier": "notify", "parameters": "(Notification notification)", "modifiers": "@Override public", "return": "boolean", "signature": "boolean notify(Notification notification)", "full_signature": "@Override public boolean notify(Notification notification)", "class_method_signature": "MetricNotificationService.notify(Notification notification)", "testcase": false, "constructor": false}], "file": "libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/notification/impl/MetricNotificationService.java"}, "focal_method": {"identifier": "notify", "parameters": "(Notification notification)", "modifiers": "@Override public", "return": "boolean", "body": "@Override\n    public boolean notify(Notification notification) {\n        // Convert details to flat array\n        List<String> attributesList = new ArrayList<>();\n        notification.getDetails().forEach((k, v) -> {\n            attributesList.add(k);\n            attributesList.add(v);\n        });\n\n        // add notification type\n        attributesList.add(\"notif_type\");\n        attributesList.add(notification.getType());\n\n        // Increment metric\n        metric.increment(\"athenz_notification\", attributesList.toArray(new String[0]));\n        return true;\n    }", "signature": "boolean notify(Notification notification)", "full_signature": "@Override public boolean notify(Notification notification)", "class_method_signature": "MetricNotificationService.notify(Notification notification)", "testcase": false, "constructor": false, "invocations": ["forEach", "getDetails", "add", "add", "add", "add", "getType", "increment", "toArray"]}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}