{"test_class": {"identifier": "X509RoleCertRequestTest", "superclass": "", "interfaces": "", "fields": [], "file": "servers/zts/src/test/java/com/yahoo/athenz/zts/cert/X509RoleCertRequestTest.java"}, "test_case": {"identifier": "testValidateRoleIPAddressNoCert", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testValidateRoleIPAddressNoCert() throws IOException {\n\n        Path path = Paths.get(\"src/test/resources/role_single_ip.csr\");\n        String csr = new String(Files.readAllBytes(path));\n\n        X509RoleCertRequest certReq = new X509RoleCertRequest(csr);\n        assertTrue(certReq.validateIPAddress(null, \"10.11.12.13\"));\n        assertFalse(certReq.validateIPAddress(null, \"10.10.11.12\"));\n    }", "signature": "void testValidateRoleIPAddressNoCert()", "full_signature": "@Test public void testValidateRoleIPAddressNoCert()", "class_method_signature": "X509RoleCertRequestTest.testValidateRoleIPAddressNoCert()", "testcase": true, "constructor": false, "invocations": ["get", "readAllBytes", "assertTrue", "validateIPAddress", "assertFalse", "validateIPAddress"]}, "focal_class": {"identifier": "X509RoleCertRequest", "superclass": "extends X509CertRequest", "interfaces": "", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(X509RoleCertRequest.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(X509RoleCertRequest.class)", "var_name": "LOGGER"}], "methods": [{"identifier": "X509RoleCertRequest", "parameters": "(String csr)", "modifiers": "public", "return": "", "signature": " X509RoleCertRequest(String csr)", "full_signature": "public  X509RoleCertRequest(String csr)", "class_method_signature": "X509RoleCertRequest.X509RoleCertRequest(String csr)", "testcase": false, "constructor": true}, {"identifier": "getRequestedRoleList", "parameters": "()", "modifiers": "public", "return": "Map<String, String[]>", "signature": "Map<String, String[]> getRequestedRoleList()", "full_signature": "public Map<String, String[]> getRequestedRoleList()", "class_method_signature": "X509RoleCertRequest.getRequestedRoleList()", "testcase": false, "constructor": false}, {"identifier": "validateAndExtractRoleName", "parameters": "(Set<String> roles, final String domainName)", "modifiers": "", "return": "String", "signature": "String validateAndExtractRoleName(Set<String> roles, final String domainName)", "full_signature": " String validateAndExtractRoleName(Set<String> roles, final String domainName)", "class_method_signature": "X509RoleCertRequest.validateAndExtractRoleName(Set<String> roles, final String domainName)", "testcase": false, "constructor": false}, {"identifier": "validateProxyUserUri", "parameters": "(final String proxyUser)", "modifiers": "", "return": "boolean", "signature": "boolean validateProxyUserUri(final String proxyUser)", "full_signature": " boolean validateProxyUserUri(final String proxyUser)", "class_method_signature": "X509RoleCertRequest.validateProxyUserUri(final String proxyUser)", "testcase": false, "constructor": false}, {"identifier": "validateEmail", "parameters": "(final String principal)", "modifiers": "", "return": "boolean", "signature": "boolean validateEmail(final String principal)", "full_signature": " boolean validateEmail(final String principal)", "class_method_signature": "X509RoleCertRequest.validateEmail(final String principal)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "(Set<String> roles, final String domainName, final String principal,\n            final String proxyUser, Set<String> validCertSubjectOrgValues)", "modifiers": "public", "return": "boolean", "signature": "boolean validate(Set<String> roles, final String domainName, final String principal,\n            final String proxyUser, Set<String> validCertSubjectOrgValues)", "full_signature": "public boolean validate(Set<String> roles, final String domainName, final String principal,\n            final String proxyUser, Set<String> validCertSubjectOrgValues)", "class_method_signature": "X509RoleCertRequest.validate(Set<String> roles, final String domainName, final String principal,\n            final String proxyUser, Set<String> validCertSubjectOrgValues)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "(final String principal, final String proxyUser,\n            Set<String> validCertSubjectOrgValues)", "modifiers": "public", "return": "boolean", "signature": "boolean validate(final String principal, final String proxyUser,\n            Set<String> validCertSubjectOrgValues)", "full_signature": "public boolean validate(final String principal, final String proxyUser,\n            Set<String> validCertSubjectOrgValues)", "class_method_signature": "X509RoleCertRequest.validate(final String principal, final String proxyUser,\n            Set<String> validCertSubjectOrgValues)", "testcase": false, "constructor": false}, {"identifier": "validateIPAddress", "parameters": "(X509Certificate cert, final String ip)", "modifiers": "public", "return": "boolean", "signature": "boolean validateIPAddress(X509Certificate cert, final String ip)", "full_signature": "public boolean validateIPAddress(X509Certificate cert, final String ip)", "class_method_signature": "X509RoleCertRequest.validateIPAddress(X509Certificate cert, final String ip)", "testcase": false, "constructor": false}], "file": "servers/zts/src/main/java/com/yahoo/athenz/zts/cert/X509RoleCertRequest.java"}, "focal_method": {"identifier": "validateIPAddress", "parameters": "(X509Certificate cert, final String ip)", "modifiers": "public", "return": "boolean", "body": "public boolean validateIPAddress(X509Certificate cert, final String ip) {\n\n        // if we have no IP addresses in the request, then we're good\n\n        if (ipAddresses.isEmpty()) {\n            return true;\n        }\n\n        // if we have a certificate then we need to make sure\n        // that all the ip addresses in the request match\n        // the ip addresses in the certificate\n\n        if (cert != null) {\n\n            List<String> certIPs = Crypto.extractX509CertIPAddresses(cert);\n\n            // if the certificate has no ip then we'll do\n            // validation based on the connection ip\n\n            if (!certIPs.isEmpty()) {\n                return certIPs.containsAll(ipAddresses);\n            }\n        }\n\n        return validateIPAddress(ip);\n    }", "signature": "boolean validateIPAddress(X509Certificate cert, final String ip)", "full_signature": "public boolean validateIPAddress(X509Certificate cert, final String ip)", "class_method_signature": "X509RoleCertRequest.validateIPAddress(X509Certificate cert, final String ip)", "testcase": false, "constructor": false, "invocations": ["isEmpty", "extractX509CertIPAddresses", "isEmpty", "containsAll", "validateIPAddress"]}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}