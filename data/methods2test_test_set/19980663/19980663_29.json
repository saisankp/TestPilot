{"test_class": {"identifier": "EmailBuilderTest", "superclass": "", "interfaces": "", "fields": [], "file": "foxtrot-core/src/test/java/com/flipkart/foxtrot/core/alerts/EmailBuilderTest.java"}, "test_case": {"identifier": "testCardinalityEmailBuild", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testCardinalityEmailBuild() throws JsonProcessingException {\n        EmailBuilder emailBuilder = new EmailBuilder(new RichEmailBuilder(new StrSubstitutorEmailSubjectBuilder(),\n                                                                          new StrSubstitutorEmailBodyBuilder()));\n        GroupRequest groupRequest = new GroupRequest();\n        groupRequest.setTable(TestUtils.TEST_TABLE_NAME);\n        groupRequest.setNesting(Lists.newArrayList(\"os\", \"deviceId\"));\n\n        QueryProcessingError error = new QueryProcessingError(\n                groupRequest,\n                new CardinalityOverflowException(groupRequest,\n                                                 Jackson.newObjectMapper()\n                                                         .writeValueAsString(\n                                                                 groupRequest),\n                                                 \"deviceId\",\n                                                 0.75));\n        final Email email = emailBuilder.visit(error);\n        Assert.assertEquals(\"Blocked query as it might have screwed up the cluster\", email.getSubject());\n        Assert.assertEquals(\n                \"Blocked Query: {\\\"opcode\\\":\\\"group\\\",\\\"filters\\\":[],\\\"bypassCache\\\":false,\\\"table\\\":\\\"test-table\\\",\" +\n                        \"\\\"uniqueCountOn\\\":null,\\\"nesting\\\":[\\\"os\\\",\\\"deviceId\\\"],\\\"precision\\\":null}\\n\" +\n                        \"Suspect field: deviceId\\n\" +\n                        \"Probability of screwing up the cluster: 0.75\",\n                email.getContent());\n    }", "signature": "void testCardinalityEmailBuild()", "full_signature": "@Test public void testCardinalityEmailBuild()", "class_method_signature": "EmailBuilderTest.testCardinalityEmailBuild()", "testcase": true, "constructor": false, "invocations": ["setTable", "setNesting", "newArrayList", "writeValueAsString", "newObjectMapper", "visit", "assertEquals", "getSubject", "assertEquals", "getContent"]}, "focal_class": {"identifier": "EmailBuilder", "superclass": "", "interfaces": "implements InternalSystemEventVisitor<Email>", "fields": [{"original_string": "private final RichEmailBuilder richEmailBuilder;", "modifier": "private final", "type": "RichEmailBuilder", "declarator": "richEmailBuilder", "var_name": "richEmailBuilder"}], "methods": [{"identifier": "EmailBuilder", "parameters": "(RichEmailBuilder richEmailBuilder)", "modifiers": "", "return": "", "signature": " EmailBuilder(RichEmailBuilder richEmailBuilder)", "full_signature": "  EmailBuilder(RichEmailBuilder richEmailBuilder)", "class_method_signature": "EmailBuilder.EmailBuilder(RichEmailBuilder richEmailBuilder)", "testcase": false, "constructor": true}, {"identifier": "visit", "parameters": "(QueryProcessed queryProcessed)", "modifiers": "@Override public", "return": "Email", "signature": "Email visit(QueryProcessed queryProcessed)", "full_signature": "@Override public Email visit(QueryProcessed queryProcessed)", "class_method_signature": "EmailBuilder.visit(QueryProcessed queryProcessed)", "testcase": false, "constructor": false}, {"identifier": "visit", "parameters": "(QueryProcessingError queryProcessingError)", "modifiers": "@Override public", "return": "Email", "signature": "Email visit(QueryProcessingError queryProcessingError)", "full_signature": "@Override public Email visit(QueryProcessingError queryProcessingError)", "class_method_signature": "EmailBuilder.visit(QueryProcessingError queryProcessingError)", "testcase": false, "constructor": false}, {"identifier": "templateIdFromEvent", "parameters": "(InternalSystemEvent event)", "modifiers": "private", "return": "String", "signature": "String templateIdFromEvent(InternalSystemEvent event)", "full_signature": "private String templateIdFromEvent(InternalSystemEvent event)", "class_method_signature": "EmailBuilder.templateIdFromEvent(InternalSystemEvent event)", "testcase": false, "constructor": false}], "file": "foxtrot-core/src/main/java/com/flipkart/foxtrot/core/alerts/EmailBuilder.java"}, "focal_method": {"identifier": "visit", "parameters": "(QueryProcessed queryProcessed)", "modifiers": "@Override public", "return": "Email", "body": "@Override\n    public Email visit(QueryProcessed queryProcessed) {\n        return null;\n    }", "signature": "Email visit(QueryProcessed queryProcessed)", "full_signature": "@Override public Email visit(QueryProcessed queryProcessed)", "class_method_signature": "EmailBuilder.visit(QueryProcessed queryProcessed)", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 19980663, "url": "https://github.com/Flipkart/foxtrot", "stars": 22, "created": "5/20/2014 12:52:55 PM +00:00", "updates": "2020-01-07T07:05:03+00:00", "fork": "False", "license": "licensed"}}