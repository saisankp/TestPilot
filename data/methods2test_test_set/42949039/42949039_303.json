{"test_class": {"identifier": "BusinessObjectDataInvalidateUnregisteredHelperTest", "superclass": "extends AbstractServiceTest", "interfaces": "", "fields": [{"original_string": "@Autowired\n    private S3Operations s3Operations;", "modifier": "@Autowired\n    private", "type": "S3Operations", "declarator": "s3Operations", "var_name": "s3Operations"}], "file": "herd-code/herd-service/src/test/java/org/finra/herd/service/helper/BusinessObjectDataInvalidateUnregisteredHelperTest.java"}, "test_case": {"identifier": "testInvalidateUnregisteredBusinessObjectDataValidationStorageMustExist", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testInvalidateUnregisteredBusinessObjectDataValidationStorageMustExist()\n    {\n        BusinessObjectDataInvalidateUnregisteredRequest request =\n            new BusinessObjectDataInvalidateUnregisteredRequest(NAMESPACE, BDEF_NAME, FORMAT_USAGE_CODE, FORMAT_FILE_TYPE_CODE, FORMAT_VERSION, PARTITION_VALUE,\n                NO_SUBPARTITION_VALUES, \"DOES_NOT_EXIST\");\n\n        // Given a business object format\n        try\n        {\n            businessObjectFormatServiceTestHelper.createBusinessObjectFormat(request);\n        }\n        catch (Exception e)\n        {\n            throw new IllegalArgumentException(\"Test failed during setup. Most likely setup or developer error.\", e);\n        }\n\n        // Call the API\n        try\n        {\n            businessObjectDataInvalidateUnregisteredHelper.invalidateUnregisteredBusinessObjectData(request);\n            Assert.fail(\"expected a ObjectNotFoundException, but no exception was thrown\");\n        }\n        catch (Exception e)\n        {\n            Assert.assertEquals(\"thrown exception type\", ObjectNotFoundException.class, e.getClass());\n            Assert.assertEquals(\"thrown exception message\", \"Storage with name \\\"\" + request.getStorageName() + \"\\\" doesn't exist.\", e.getMessage());\n        }\n    }", "signature": "void testInvalidateUnregisteredBusinessObjectDataValidationStorageMustExist()", "full_signature": "@Test public void testInvalidateUnregisteredBusinessObjectDataValidationStorageMustExist()", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelperTest.testInvalidateUnregisteredBusinessObjectDataValidationStorageMustExist()", "testcase": true, "constructor": false, "invocations": ["createBusinessObjectFormat", "invalidateUnregisteredBusinessObjectData", "fail", "assertEquals", "getClass", "assertEquals", "getStorageName", "getMessage"]}, "focal_class": {"identifier": "BusinessObjectDataInvalidateUnregisteredHelper", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final String UNREGISTERED_STATUS = BusinessObjectDataStatusEntity.INVALID;", "modifier": "public static final", "type": "String", "declarator": "UNREGISTERED_STATUS = BusinessObjectDataStatusEntity.INVALID", "var_name": "UNREGISTERED_STATUS"}, {"original_string": "@Autowired\n    private BusinessObjectDataDao businessObjectDataDao;", "modifier": "@Autowired\n    private", "type": "BusinessObjectDataDao", "declarator": "businessObjectDataDao", "var_name": "businessObjectDataDao"}, {"original_string": "@Autowired\n    private BusinessObjectDataHelper businessObjectDataHelper;", "modifier": "@Autowired\n    private", "type": "BusinessObjectDataHelper", "declarator": "businessObjectDataHelper", "var_name": "businessObjectDataHelper"}, {"original_string": "@Autowired\n    private BusinessObjectDataStatusDao businessObjectDataStatusDao;", "modifier": "@Autowired\n    private", "type": "BusinessObjectDataStatusDao", "declarator": "businessObjectDataStatusDao", "var_name": "businessObjectDataStatusDao"}, {"original_string": "@Autowired\n    private BusinessObjectFormatDaoHelper businessObjectFormatDaoHelper;", "modifier": "@Autowired\n    private", "type": "BusinessObjectFormatDaoHelper", "declarator": "businessObjectFormatDaoHelper", "var_name": "businessObjectFormatDaoHelper"}, {"original_string": "@Autowired\n    private HerdCollectionHelper herdCollectionHelper;", "modifier": "@Autowired\n    private", "type": "HerdCollectionHelper", "declarator": "herdCollectionHelper", "var_name": "herdCollectionHelper"}, {"original_string": "@Autowired\n    private S3Dao s3Dao;", "modifier": "@Autowired\n    private", "type": "S3Dao", "declarator": "s3Dao", "var_name": "s3Dao"}, {"original_string": "@Autowired\n    private S3KeyPrefixHelper s3KeyPrefixHelper;", "modifier": "@Autowired\n    private", "type": "S3KeyPrefixHelper", "declarator": "s3KeyPrefixHelper", "var_name": "s3KeyPrefixHelper"}, {"original_string": "@Autowired\n    private MessageNotificationEventService sqsNotificationEventService;", "modifier": "@Autowired\n    private", "type": "MessageNotificationEventService", "declarator": "sqsNotificationEventService", "var_name": "sqsNotificationEventService"}, {"original_string": "@Autowired\n    private StorageDaoHelper storageDaoHelper;", "modifier": "@Autowired\n    private", "type": "StorageDaoHelper", "declarator": "storageDaoHelper", "var_name": "storageDaoHelper"}, {"original_string": "@Autowired\n    private StorageFileHelper storageFileHelper;", "modifier": "@Autowired\n    private", "type": "StorageFileHelper", "declarator": "storageFileHelper", "var_name": "storageFileHelper"}, {"original_string": "@Autowired\n    private StorageHelper storageHelper;", "modifier": "@Autowired\n    private", "type": "StorageHelper", "declarator": "storageHelper", "var_name": "storageHelper"}, {"original_string": "@Autowired\n    private StorageUnitStatusDao storageUnitStatusDao;", "modifier": "@Autowired\n    private", "type": "StorageUnitStatusDao", "declarator": "storageUnitStatusDao", "var_name": "storageUnitStatusDao"}], "methods": [{"identifier": "invalidateUnregisteredBusinessObjectData", "parameters": "(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "modifiers": "public", "return": "BusinessObjectDataInvalidateUnregisteredResponse", "signature": "BusinessObjectDataInvalidateUnregisteredResponse invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "full_signature": "public BusinessObjectDataInvalidateUnregisteredResponse invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "testcase": false, "constructor": false}, {"identifier": "getBusinessObjectDataInvalidateUnregisteredResponse", "parameters": "(\n        BusinessObjectDataInvalidateUnregisteredRequest request, List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "modifiers": "private", "return": "BusinessObjectDataInvalidateUnregisteredResponse", "signature": "BusinessObjectDataInvalidateUnregisteredResponse getBusinessObjectDataInvalidateUnregisteredResponse(\n        BusinessObjectDataInvalidateUnregisteredRequest request, List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "full_signature": "private BusinessObjectDataInvalidateUnregisteredResponse getBusinessObjectDataInvalidateUnregisteredResponse(\n        BusinessObjectDataInvalidateUnregisteredRequest request, List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getBusinessObjectDataInvalidateUnregisteredResponse(\n        BusinessObjectDataInvalidateUnregisteredRequest request, List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "testcase": false, "constructor": false}, {"identifier": "getBusinessObjectDataKey", "parameters": "(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "modifiers": "private", "return": "BusinessObjectDataKey", "signature": "BusinessObjectDataKey getBusinessObjectDataKey(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "full_signature": "private BusinessObjectDataKey getBusinessObjectDataKey(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getBusinessObjectDataKey(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "testcase": false, "constructor": false}, {"identifier": "getBusinessObjectDataVersion", "parameters": "(BusinessObjectDataEntity businessObjectDataEntity)", "modifiers": "private", "return": "Integer", "signature": "Integer getBusinessObjectDataVersion(BusinessObjectDataEntity businessObjectDataEntity)", "full_signature": "private Integer getBusinessObjectDataVersion(BusinessObjectDataEntity businessObjectDataEntity)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getBusinessObjectDataVersion(BusinessObjectDataEntity businessObjectDataEntity)", "testcase": false, "constructor": false}, {"identifier": "getBusinessObjectFormatEntity", "parameters": "(BusinessObjectDataInvalidateUnregisteredRequest request)", "modifiers": "private", "return": "BusinessObjectFormatEntity", "signature": "BusinessObjectFormatEntity getBusinessObjectFormatEntity(BusinessObjectDataInvalidateUnregisteredRequest request)", "full_signature": "private BusinessObjectFormatEntity getBusinessObjectFormatEntity(BusinessObjectDataInvalidateUnregisteredRequest request)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getBusinessObjectFormatEntity(BusinessObjectDataInvalidateUnregisteredRequest request)", "testcase": false, "constructor": false}, {"identifier": "getLatestBusinessObjectDataEntity", "parameters": "(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "modifiers": "private", "return": "BusinessObjectDataEntity", "signature": "BusinessObjectDataEntity getLatestBusinessObjectDataEntity(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "full_signature": "private BusinessObjectDataEntity getLatestBusinessObjectDataEntity(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getLatestBusinessObjectDataEntity(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "testcase": false, "constructor": false}, {"identifier": "getResponseBusinessObjectDatas", "parameters": "(List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "modifiers": "private", "return": "List<BusinessObjectData>", "signature": "List<BusinessObjectData> getResponseBusinessObjectDatas(List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "full_signature": "private List<BusinessObjectData> getResponseBusinessObjectDatas(List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getResponseBusinessObjectDatas(List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities)", "testcase": false, "constructor": false}, {"identifier": "getS3ObjectKeys", "parameters": "(BusinessObjectFormatEntity businessObjectFormatEntity, BusinessObjectDataKey businessObjectDataKey,\n        StorageEntity storageEntity)", "modifiers": "private", "return": "List<String>", "signature": "List<String> getS3ObjectKeys(BusinessObjectFormatEntity businessObjectFormatEntity, BusinessObjectDataKey businessObjectDataKey,\n        StorageEntity storageEntity)", "full_signature": "private List<String> getS3ObjectKeys(BusinessObjectFormatEntity businessObjectFormatEntity, BusinessObjectDataKey businessObjectDataKey,\n        StorageEntity storageEntity)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getS3ObjectKeys(BusinessObjectFormatEntity businessObjectFormatEntity, BusinessObjectDataKey businessObjectDataKey,\n        StorageEntity storageEntity)", "testcase": false, "constructor": false}, {"identifier": "getUnregisteredBusinessObjectDataKeys", "parameters": "(BusinessObjectDataInvalidateUnregisteredRequest request,\n        StorageEntity storageEntity, BusinessObjectFormatEntity businessObjectFormatEntity, Integer latestRegisteredBusinessObjectDataVersion)", "modifiers": "private", "return": "List<BusinessObjectDataKey>", "signature": "List<BusinessObjectDataKey> getUnregisteredBusinessObjectDataKeys(BusinessObjectDataInvalidateUnregisteredRequest request,\n        StorageEntity storageEntity, BusinessObjectFormatEntity businessObjectFormatEntity, Integer latestRegisteredBusinessObjectDataVersion)", "full_signature": "private List<BusinessObjectDataKey> getUnregisteredBusinessObjectDataKeys(BusinessObjectDataInvalidateUnregisteredRequest request,\n        StorageEntity storageEntity, BusinessObjectFormatEntity businessObjectFormatEntity, Integer latestRegisteredBusinessObjectDataVersion)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.getUnregisteredBusinessObjectDataKeys(BusinessObjectDataInvalidateUnregisteredRequest request,\n        StorageEntity storageEntity, BusinessObjectFormatEntity businessObjectFormatEntity, Integer latestRegisteredBusinessObjectDataVersion)", "testcase": false, "constructor": false}, {"identifier": "processBusinessObjectDataStatusChangeNotificationEvents", "parameters": "(List<BusinessObjectDataEntity> businessObjectDataEntities)", "modifiers": "private", "return": "void", "signature": "void processBusinessObjectDataStatusChangeNotificationEvents(List<BusinessObjectDataEntity> businessObjectDataEntities)", "full_signature": "private void processBusinessObjectDataStatusChangeNotificationEvents(List<BusinessObjectDataEntity> businessObjectDataEntities)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.processBusinessObjectDataStatusChangeNotificationEvents(List<BusinessObjectDataEntity> businessObjectDataEntities)", "testcase": false, "constructor": false}, {"identifier": "registerInvalidBusinessObjectDatas", "parameters": "(BusinessObjectDataEntity latestBusinessObjectDataEntity,\n        BusinessObjectFormatEntity businessObjectFormatEntity, List<BusinessObjectDataKey> businessObjectDataKeys, StorageEntity storageEntity)", "modifiers": "private", "return": "List<BusinessObjectDataEntity>", "signature": "List<BusinessObjectDataEntity> registerInvalidBusinessObjectDatas(BusinessObjectDataEntity latestBusinessObjectDataEntity,\n        BusinessObjectFormatEntity businessObjectFormatEntity, List<BusinessObjectDataKey> businessObjectDataKeys, StorageEntity storageEntity)", "full_signature": "private List<BusinessObjectDataEntity> registerInvalidBusinessObjectDatas(BusinessObjectDataEntity latestBusinessObjectDataEntity,\n        BusinessObjectFormatEntity businessObjectFormatEntity, List<BusinessObjectDataKey> businessObjectDataKeys, StorageEntity storageEntity)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.registerInvalidBusinessObjectDatas(BusinessObjectDataEntity latestBusinessObjectDataEntity,\n        BusinessObjectFormatEntity businessObjectFormatEntity, List<BusinessObjectDataKey> businessObjectDataKeys, StorageEntity storageEntity)", "testcase": false, "constructor": false}, {"identifier": "trimRequest", "parameters": "(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "modifiers": "private", "return": "void", "signature": "void trimRequest(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "full_signature": "private void trimRequest(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.trimRequest(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "testcase": false, "constructor": false}, {"identifier": "validateRequest", "parameters": "(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "modifiers": "private", "return": "void", "signature": "void validateRequest(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "full_signature": "private void validateRequest(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.validateRequest(BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "testcase": false, "constructor": false}], "file": "herd-code/herd-service/src/main/java/org/finra/herd/service/helper/BusinessObjectDataInvalidateUnregisteredHelper.java"}, "focal_method": {"identifier": "invalidateUnregisteredBusinessObjectData", "parameters": "(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "modifiers": "public", "return": "BusinessObjectDataInvalidateUnregisteredResponse", "body": "public BusinessObjectDataInvalidateUnregisteredResponse invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)\n    {\n        // Validate request\n        validateRequest(businessObjectDataInvalidateUnregisteredRequest);\n\n        // Trim\n        trimRequest(businessObjectDataInvalidateUnregisteredRequest);\n\n        // Validate format exists\n        // Get format\n        BusinessObjectFormatEntity businessObjectFormatEntity = getBusinessObjectFormatEntity(businessObjectDataInvalidateUnregisteredRequest);\n\n        // Validate storage exists\n        // Get storage by name\n        String storageName = businessObjectDataInvalidateUnregisteredRequest.getStorageName();\n        StorageEntity storageEntity = storageDaoHelper.getStorageEntity(storageName);\n\n        // Validate that storage platform is S3\n        if (!StoragePlatformEntity.S3.equals(storageEntity.getStoragePlatform().getName()))\n        {\n            throw new IllegalArgumentException(\"The specified storage '\" + storageName + \"' is not an S3 storage platform.\");\n        }\n\n        // Get data with latest version\n        BusinessObjectDataEntity latestBusinessObjectDataEntity = getLatestBusinessObjectDataEntity(businessObjectDataInvalidateUnregisteredRequest);\n        Integer latestBusinessObjectDataVersion = getBusinessObjectDataVersion(latestBusinessObjectDataEntity);\n\n        // List data which are not registered, but exists in S3\n        List<BusinessObjectDataKey> unregisteredBusinessObjectDataKeys =\n            getUnregisteredBusinessObjectDataKeys(businessObjectDataInvalidateUnregisteredRequest, storageEntity, businessObjectFormatEntity,\n                latestBusinessObjectDataVersion);\n\n        // Register the unregistered data as INVALID\n        List<BusinessObjectDataEntity> registeredBusinessObjectDataEntities =\n            registerInvalidBusinessObjectDatas(latestBusinessObjectDataEntity, businessObjectFormatEntity, unregisteredBusinessObjectDataKeys, storageEntity);\n\n        // Fire notifications\n        processBusinessObjectDataStatusChangeNotificationEvents(registeredBusinessObjectDataEntities);\n\n        // Create and return response\n        return getBusinessObjectDataInvalidateUnregisteredResponse(businessObjectDataInvalidateUnregisteredRequest, registeredBusinessObjectDataEntities);\n    }", "signature": "BusinessObjectDataInvalidateUnregisteredResponse invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "full_signature": "public BusinessObjectDataInvalidateUnregisteredResponse invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "class_method_signature": "BusinessObjectDataInvalidateUnregisteredHelper.invalidateUnregisteredBusinessObjectData(\n        BusinessObjectDataInvalidateUnregisteredRequest businessObjectDataInvalidateUnregisteredRequest)", "testcase": false, "constructor": false, "invocations": ["validateRequest", "trimRequest", "getBusinessObjectFormatEntity", "getStorageName", "getStorageEntity", "equals", "getName", "getStoragePlatform", "getLatestBusinessObjectDataEntity", "getBusinessObjectDataVersion", "getUnregisteredBusinessObjectDataKeys", "registerInvalidBusinessObjectDatas", "processBusinessObjectDataStatusChangeNotificationEvents", "getBusinessObjectDataInvalidateUnregisteredResponse"]}, "repository": {"repo_id": 42949039, "url": "https://github.com/FINRAOS/herd", "language": "Java", "is_fork": false, "fork_count": 36, "stargazer_count": 120, "size": 205797, "license": "licensed"}}