{"test_class": {"identifier": "UpdaterTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final int HTTP_LOCAL_TEST_PORT = 18475;", "modifier": "private static final", "type": "int", "declarator": "HTTP_LOCAL_TEST_PORT = 18475", "var_name": "HTTP_LOCAL_TEST_PORT"}, {"original_string": "public static final String SERVER_PATH = \"/_updatefx/appname\";", "modifier": "public static final", "type": "String", "declarator": "SERVER_PATH = \"/_updatefx/appname\"", "var_name": "SERVER_PATH"}, {"original_string": "private HttpServer localServer;", "modifier": "private", "type": "HttpServer", "declarator": "localServer", "var_name": "localServer"}, {"original_string": "private Map<String, byte[]> paths;", "modifier": "private", "type": "Map<String, byte[]>", "declarator": "paths", "var_name": "paths"}, {"original_string": "private Updater updater;", "modifier": "private", "type": "Updater", "declarator": "updater", "var_name": "updater"}, {"original_string": "private Path dir;", "modifier": "private", "type": "Path", "declarator": "dir", "var_name": "dir"}, {"original_string": "private URI indexURL;", "modifier": "private", "type": "URI", "declarator": "indexURL", "var_name": "indexURL"}, {"original_string": "private long workDone, workMax;", "modifier": "private", "type": "long", "declarator": "workDone", "var_name": "workDone"}, {"original_string": "private List<BigInteger> privKeys;", "modifier": "private", "type": "List<BigInteger>", "declarator": "privKeys", "var_name": "privKeys"}, {"original_string": "private List<ECPoint> pubKeys;", "modifier": "private", "type": "List<ECPoint>", "declarator": "pubKeys", "var_name": "pubKeys"}], "file": "api/src/test/java/com/vinumeris/updatefx/UpdaterTest.java"}, "test_case": {"identifier": "updateRun2", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void updateRun2() throws Exception {\n        // Update from v2 to v3.\n        Path working = dir.resolve(\"working\");\n        createDirectory(working);\n        byte[] baseFile = new byte[2048];\n        Arrays.fill(baseFile, (byte) 1);\n        Path jar1 = working.resolve(\"1.jar\");\n        write(jar1, baseFile, CREATE_NEW);\n        baseFile[0] = 2;\n        Path baseJar = working.resolve(\"2.jar\");\n        write(baseJar, baseFile, CREATE_NEW);\n        baseFile[0] = 3;\n        Path jar3 = working.resolve(\"3.jar\");\n        write(jar3, baseFile, CREATE_NEW);\n        DeltaCalculator.process(working.toAbsolutePath(), working.toAbsolutePath(), -1);\n        Path bpatch2 = working.resolve(\"2.jar.bpatch\");\n        assertTrue(exists(bpatch2));\n        Path bpatch3 = working.resolve(\"3.jar.bpatch\");\n        assertTrue(exists(bpatch3));\n        byte[] bpatch1bits = readAllBytes(bpatch2);\n        byte[] bpatch2bits = readAllBytes(bpatch3);\n        paths.put(\"/2.jar.bpatch\", bpatch1bits);\n        paths.put(\"/3.jar.bpatch\", bpatch2bits);\n        configureIndex(sha256(readAllBytes(jar1)), sha256(bpatch1bits), sha256(readAllBytes(baseJar)),\n                       sha256(readAllBytes(baseJar)), sha256(bpatch2bits), sha256(readAllBytes(jar3)));\n        updater = new TestUpdater(indexURL, \"UnitTest\", dir, baseJar);\n        UpdateSummary summary = updater.call();\n        byte[] bits3 = Files.readAllBytes(dir.resolve(\"3.jar\"));\n        assertArrayEquals(baseFile, bits3);\n        assertEquals(3, summary.highestVersion);\n    }", "signature": "void updateRun2()", "full_signature": "@Test public void updateRun2()", "class_method_signature": "UpdaterTest.updateRun2()", "testcase": true, "constructor": false, "invocations": ["resolve", "createDirectory", "fill", "resolve", "write", "resolve", "write", "resolve", "write", "process", "toAbsolutePath", "toAbsolutePath", "resolve", "assertTrue", "exists", "resolve", "assertTrue", "exists", "readAllBytes", "readAllBytes", "put", "put", "configureIndex", "sha256", "readAllBytes", "sha256", "sha256", "readAllBytes", "sha256", "readAllBytes", "sha256", "sha256", "readAllBytes", "call", "readAllBytes", "resolve", "assertArrayEquals", "assertEquals"]}, "focal_class": {"identifier": "Updater", "superclass": "extends Task<UpdateSummary>", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(Updater.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(Updater.class)", "var_name": "log"}, {"original_string": "private final URI indexURL;", "modifier": "private final", "type": "URI", "declarator": "indexURL", "var_name": "indexURL"}, {"original_string": "private final String userAgent;", "modifier": "private final", "type": "String", "declarator": "userAgent", "var_name": "userAgent"}, {"original_string": "private int highestLocalVersion;", "modifier": "private", "type": "int", "declarator": "highestLocalVersion", "var_name": "highestLocalVersion"}, {"original_string": "private final Path localUpdatesDir;", "modifier": "private final", "type": "Path", "declarator": "localUpdatesDir", "var_name": "localUpdatesDir"}, {"original_string": "private final Path pathToOrigJar;", "modifier": "private final", "type": "Path", "declarator": "pathToOrigJar", "var_name": "pathToOrigJar"}, {"original_string": "private final List<ECPoint> pubkeys;", "modifier": "private final", "type": "List<ECPoint>", "declarator": "pubkeys", "var_name": "pubkeys"}, {"original_string": "private final int requiredSigningThreshold;", "modifier": "private final", "type": "int", "declarator": "requiredSigningThreshold", "var_name": "requiredSigningThreshold"}, {"original_string": "private long totalBytesDownloaded;", "modifier": "private", "type": "long", "declarator": "totalBytesDownloaded", "var_name": "totalBytesDownloaded"}, {"original_string": "private int newHighestVersion;", "modifier": "private", "type": "int", "declarator": "newHighestVersion", "var_name": "newHighestVersion"}, {"original_string": "private boolean overrideURLs = false;", "modifier": "private", "type": "boolean", "declarator": "overrideURLs = false", "var_name": "overrideURLs"}], "methods": [{"identifier": "Updater", "parameters": "(URI indexURL, String userAgent, Path localUpdatesDir,\n                   Path pathToOrigJar, List<ECPoint> pubkeys, int requiredSigningThreshold)", "modifiers": "public", "return": "", "signature": " Updater(URI indexURL, String userAgent, Path localUpdatesDir,\n                   Path pathToOrigJar, List<ECPoint> pubkeys, int requiredSigningThreshold)", "full_signature": "public  Updater(URI indexURL, String userAgent, Path localUpdatesDir,\n                   Path pathToOrigJar, List<ECPoint> pubkeys, int requiredSigningThreshold)", "class_method_signature": "Updater.Updater(URI indexURL, String userAgent, Path localUpdatesDir,\n                   Path pathToOrigJar, List<ECPoint> pubkeys, int requiredSigningThreshold)", "testcase": false, "constructor": true}, {"identifier": "setOverrideURLs", "parameters": "(boolean overrideURLs)", "modifiers": "public", "return": "void", "signature": "void setOverrideURLs(boolean overrideURLs)", "full_signature": "public void setOverrideURLs(boolean overrideURLs)", "class_method_signature": "Updater.setOverrideURLs(boolean overrideURLs)", "testcase": false, "constructor": false}, {"identifier": "call", "parameters": "()", "modifiers": "@Override protected", "return": "UpdateSummary", "signature": "UpdateSummary call()", "full_signature": "@Override protected UpdateSummary call()", "class_method_signature": "Updater.call()", "testcase": false, "constructor": false}, {"identifier": "downloadSignedIndex", "parameters": "()", "modifiers": "private", "return": "UFXProtocol.SignedUpdates", "signature": "UFXProtocol.SignedUpdates downloadSignedIndex()", "full_signature": "private UFXProtocol.SignedUpdates downloadSignedIndex()", "class_method_signature": "Updater.downloadSignedIndex()", "testcase": false, "constructor": false}, {"identifier": "openURL", "parameters": "(URI url)", "modifiers": "private", "return": "URLConnection", "signature": "URLConnection openURL(URI url)", "full_signature": "private URLConnection openURL(URI url)", "class_method_signature": "Updater.openURL(URI url)", "testcase": false, "constructor": false}, {"identifier": "processSignedIndex", "parameters": "(UFXProtocol.SignedUpdates signedUpdates)", "modifiers": "private", "return": "UFXProtocol.Updates", "signature": "UFXProtocol.Updates processSignedIndex(UFXProtocol.SignedUpdates signedUpdates)", "full_signature": "private UFXProtocol.Updates processSignedIndex(UFXProtocol.SignedUpdates signedUpdates)", "class_method_signature": "Updater.processSignedIndex(UFXProtocol.SignedUpdates signedUpdates)", "testcase": false, "constructor": false}, {"identifier": "downloadUpdates", "parameters": "(LinkedList<UFXProtocol.Update> updates, long bytesToFetch)", "modifiers": "private", "return": "List<Path>", "signature": "List<Path> downloadUpdates(LinkedList<UFXProtocol.Update> updates, long bytesToFetch)", "full_signature": "private List<Path> downloadUpdates(LinkedList<UFXProtocol.Update> updates, long bytesToFetch)", "class_method_signature": "Updater.downloadUpdates(LinkedList<UFXProtocol.Update> updates, long bytesToFetch)", "testcase": false, "constructor": false}, {"identifier": "processDownloadedUpdates", "parameters": "(List<UFXProtocol.Update> updates, List<Path> files)", "modifiers": "private", "return": "void", "signature": "void processDownloadedUpdates(List<UFXProtocol.Update> updates, List<Path> files)", "full_signature": "private void processDownloadedUpdates(List<UFXProtocol.Update> updates, List<Path> files)", "class_method_signature": "Updater.processDownloadedUpdates(List<UFXProtocol.Update> updates, List<Path> files)", "testcase": false, "constructor": false}, {"identifier": "maybeOverrideBaseURL", "parameters": "(URI url)", "modifiers": "private", "return": "URI", "signature": "URI maybeOverrideBaseURL(URI url)", "full_signature": "private URI maybeOverrideBaseURL(URI url)", "class_method_signature": "Updater.maybeOverrideBaseURL(URI url)", "testcase": false, "constructor": false}, {"identifier": "hashingFileStream", "parameters": "(Path outfile)", "modifiers": "private", "return": "HashingOutputStream", "signature": "HashingOutputStream hashingFileStream(Path outfile)", "full_signature": "private HashingOutputStream hashingFileStream(Path outfile)", "class_method_signature": "Updater.hashingFileStream(Path outfile)", "testcase": false, "constructor": false}, {"identifier": "validateSignatures", "parameters": "(UFXProtocol.SignedUpdates updates)", "modifiers": "private", "return": "UFXProtocol.Updates", "signature": "UFXProtocol.Updates validateSignatures(UFXProtocol.SignedUpdates updates)", "full_signature": "private UFXProtocol.Updates validateSignatures(UFXProtocol.SignedUpdates updates)", "class_method_signature": "Updater.validateSignatures(UFXProtocol.SignedUpdates updates)", "testcase": false, "constructor": false}], "file": "api/src/main/java/com/vinumeris/updatefx/Updater.java"}, "focal_method": {"identifier": "call", "parameters": "()", "modifiers": "@Override protected", "return": "UpdateSummary", "body": "@Override\n    protected UpdateSummary call() throws Exception {\n        highestLocalVersion = UpdateFX.extractVerFromFilename(UpdateFX.findBestJar(pathToOrigJar, localUpdatesDir));\n        newHighestVersion = highestLocalVersion;\n        UFXProtocol.Updates updates = processSignedIndex(downloadSignedIndex());\n        return new UpdateSummary(newHighestVersion, updates);\n    }", "signature": "UpdateSummary call()", "full_signature": "@Override protected UpdateSummary call()", "class_method_signature": "Updater.call()", "testcase": false, "constructor": false, "invocations": ["extractVerFromFilename", "findBestJar", "processSignedIndex", "downloadSignedIndex"]}, "repository": {"repo_id": 23961325, "url": "https://github.com/vinumeris/updatefx", "language": "Java", "is_fork": false, "fork_count": 27, "stargazer_count": 95, "size": 222, "license": "licensed"}}