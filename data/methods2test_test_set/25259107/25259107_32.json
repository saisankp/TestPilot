{"test_class": {"identifier": "U2fPrimitivesTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "final HashSet<String> allowedOrigins = new HashSet<String>();", "modifier": "final", "type": "HashSet<String>", "declarator": "allowedOrigins = new HashSet<String>()", "var_name": "allowedOrigins"}, {"original_string": "U2fPrimitives u2f = new U2fPrimitives();", "modifier": "", "type": "U2fPrimitives", "declarator": "u2f = new U2fPrimitives()", "var_name": "u2f"}, {"original_string": "@Rule\n    public ExpectedException expectedException = ExpectedException.none();", "modifier": "@Rule\n    public", "type": "ExpectedException", "declarator": "expectedException = ExpectedException.none()", "var_name": "expectedException"}], "file": "u2flib-server-core/src/test/java/com/yubico/u2f/U2fPrimitivesTest.java"}, "test_case": {"identifier": "finishRegistrationShouldDetectIncorrectClientDataType", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void finishRegistrationShouldDetectIncorrectClientDataType() throws Exception {\n        expectedException.expectCause(isA(U2fBadInputException.class));\n\n        RegisterRequest registerRequest = new RegisterRequest(SERVER_CHALLENGE_REGISTER_BASE64, APP_ID_ENROLL);\n\n        String clientDataBase64 = U2fB64Encoding.encode(\"{\\\"typ\\\":\\\"navigator.id.launchNukes\\\",\\\"challenge\\\":\\\"vqrS6WXDe1JUs5_c3i4-LkKIHRr-3XVb3azuA5TifHo\\\",\\\"origin\\\":\\\"http://example.com\\\"}\".getBytes(\"UTF-8\"));\n\n        u2f.finishRegistration(\n            registerRequest,\n            new RegisterResponse(\n                TestVectors.REGISTRATION_DATA_WITH_DIFFERENT_CLIENT_DATA_TYPE_BASE64,\n                clientDataBase64\n            )\n        );\n\n        fail(\"finishRegistration did not detect incorrect type in client data\");\n    }", "signature": "void finishRegistrationShouldDetectIncorrectClientDataType()", "full_signature": "@Test public void finishRegistrationShouldDetectIncorrectClientDataType()", "class_method_signature": "U2fPrimitivesTest.finishRegistrationShouldDetectIncorrectClientDataType()", "testcase": true, "constructor": false, "invocations": ["expectCause", "isA", "encode", "getBytes", "finishRegistration", "fail"]}, "focal_class": {"identifier": "U2fPrimitives", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String SIGN_TYPE = \"navigator.id.getAssertion\";", "modifier": "private static final", "type": "String", "declarator": "SIGN_TYPE = \"navigator.id.getAssertion\"", "var_name": "SIGN_TYPE"}, {"original_string": "private static final String REGISTER_TYPE = \"navigator.id.finishEnrollment\";", "modifier": "private static final", "type": "String", "declarator": "REGISTER_TYPE = \"navigator.id.finishEnrollment\"", "var_name": "REGISTER_TYPE"}, {"original_string": "public static final String U2F_VERSION = \"U2F_V2\";", "modifier": "public static final", "type": "String", "declarator": "U2F_VERSION = \"U2F_V2\"", "var_name": "U2F_VERSION"}, {"original_string": "private final Crypto crypto;", "modifier": "private final", "type": "Crypto", "declarator": "crypto", "var_name": "crypto"}, {"original_string": "private final ChallengeGenerator challengeGenerator;", "modifier": "private final", "type": "ChallengeGenerator", "declarator": "challengeGenerator", "var_name": "challengeGenerator"}], "methods": [{"identifier": "U2fPrimitives", "parameters": "(Crypto crypto, ChallengeGenerator challengeGenerator)", "modifiers": "public", "return": "", "signature": " U2fPrimitives(Crypto crypto, ChallengeGenerator challengeGenerator)", "full_signature": "public  U2fPrimitives(Crypto crypto, ChallengeGenerator challengeGenerator)", "class_method_signature": "U2fPrimitives.U2fPrimitives(Crypto crypto, ChallengeGenerator challengeGenerator)", "testcase": false, "constructor": true}, {"identifier": "U2fPrimitives", "parameters": "()", "modifiers": "public", "return": "", "signature": " U2fPrimitives()", "full_signature": "public  U2fPrimitives()", "class_method_signature": "U2fPrimitives.U2fPrimitives()", "testcase": false, "constructor": true}, {"identifier": "startRegistration", "parameters": "(String appId)", "modifiers": "public", "return": "RegisterRequest", "signature": "RegisterRequest startRegistration(String appId)", "full_signature": "public RegisterRequest startRegistration(String appId)", "class_method_signature": "U2fPrimitives.startRegistration(String appId)", "testcase": false, "constructor": false}, {"identifier": "startRegistration", "parameters": "(String appId, byte[] challenge)", "modifiers": "public", "return": "RegisterRequest", "signature": "RegisterRequest startRegistration(String appId, byte[] challenge)", "full_signature": "public RegisterRequest startRegistration(String appId, byte[] challenge)", "class_method_signature": "U2fPrimitives.startRegistration(String appId, byte[] challenge)", "testcase": false, "constructor": false}, {"identifier": "finishRegistration", "parameters": "(RegisterRequest registerRequest, RegisterResponse response)", "modifiers": "public", "return": "DeviceRegistration", "signature": "DeviceRegistration finishRegistration(RegisterRequest registerRequest, RegisterResponse response)", "full_signature": "public DeviceRegistration finishRegistration(RegisterRequest registerRequest, RegisterResponse response)", "class_method_signature": "U2fPrimitives.finishRegistration(RegisterRequest registerRequest, RegisterResponse response)", "testcase": false, "constructor": false}, {"identifier": "finishRegistration", "parameters": "(RegisterRequest registerRequest,\n                                                 RegisterResponse response,\n                                                 Set<String> facets)", "modifiers": "public", "return": "DeviceRegistration", "signature": "DeviceRegistration finishRegistration(RegisterRequest registerRequest,\n                                                 RegisterResponse response,\n                                                 Set<String> facets)", "full_signature": "public DeviceRegistration finishRegistration(RegisterRequest registerRequest,\n                                                 RegisterResponse response,\n                                                 Set<String> facets)", "class_method_signature": "U2fPrimitives.finishRegistration(RegisterRequest registerRequest,\n                                                 RegisterResponse response,\n                                                 Set<String> facets)", "testcase": false, "constructor": false}, {"identifier": "startSignature", "parameters": "(String appId, DeviceRegistration deviceRegistration)", "modifiers": "public", "return": "SignRequest", "signature": "SignRequest startSignature(String appId, DeviceRegistration deviceRegistration)", "full_signature": "public SignRequest startSignature(String appId, DeviceRegistration deviceRegistration)", "class_method_signature": "U2fPrimitives.startSignature(String appId, DeviceRegistration deviceRegistration)", "testcase": false, "constructor": false}, {"identifier": "startSignature", "parameters": "(String appId, DeviceRegistration deviceRegistration, byte[] challenge)", "modifiers": "public", "return": "SignRequest", "signature": "SignRequest startSignature(String appId, DeviceRegistration deviceRegistration, byte[] challenge)", "full_signature": "public SignRequest startSignature(String appId, DeviceRegistration deviceRegistration, byte[] challenge)", "class_method_signature": "U2fPrimitives.startSignature(String appId, DeviceRegistration deviceRegistration, byte[] challenge)", "testcase": false, "constructor": false}, {"identifier": "finishSignature", "parameters": "(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration)", "modifiers": "public", "return": "void", "signature": "void finishSignature(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration)", "full_signature": "public void finishSignature(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration)", "class_method_signature": "U2fPrimitives.finishSignature(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration)", "testcase": false, "constructor": false}, {"identifier": "finishSignature", "parameters": "(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration,\n                                Set<String> facets)", "modifiers": "public", "return": "void", "signature": "void finishSignature(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration,\n                                Set<String> facets)", "full_signature": "public void finishSignature(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration,\n                                Set<String> facets)", "class_method_signature": "U2fPrimitives.finishSignature(SignRequest signRequest,\n                                SignResponse response,\n                                DeviceRegistration deviceRegistration,\n                                Set<String> facets)", "testcase": false, "constructor": false}], "file": "u2flib-server-core/src/main/java/com/yubico/u2f/U2fPrimitives.java"}, "focal_method": {"identifier": "finishRegistration", "parameters": "(RegisterRequest registerRequest, RegisterResponse response)", "modifiers": "public", "return": "DeviceRegistration", "body": "public DeviceRegistration finishRegistration(RegisterRequest registerRequest, RegisterResponse response) throws U2fRegistrationException {\n        return finishRegistration(registerRequest, response, null);\n    }", "signature": "DeviceRegistration finishRegistration(RegisterRequest registerRequest, RegisterResponse response)", "full_signature": "public DeviceRegistration finishRegistration(RegisterRequest registerRequest, RegisterResponse response)", "class_method_signature": "U2fPrimitives.finishRegistration(RegisterRequest registerRequest, RegisterResponse response)", "testcase": false, "constructor": false, "invocations": ["finishRegistration"]}, "repository": {"repo_id": 25259107, "url": "https://github.com/Yubico/java-u2flib-server", "language": "Java", "is_fork": false, "fork_count": 55, "stargazer_count": 127, "size": 896, "license": "licensed"}}