{"test_class": {"identifier": "TestHiveWriter", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final String dbName = \"testing\";", "modifier": "static final", "type": "String", "declarator": "dbName = \"testing\"", "var_name": "dbName"}, {"original_string": "static final String tblName = \"alerts\";", "modifier": "static final", "type": "String", "declarator": "tblName = \"alerts\"", "var_name": "tblName"}, {"original_string": "public static final String PART1_NAME = \"continent\";", "modifier": "public static final", "type": "String", "declarator": "PART1_NAME = \"continent\"", "var_name": "PART1_NAME"}, {"original_string": "public static final String PART2_NAME = \"country\";", "modifier": "public static final", "type": "String", "declarator": "PART2_NAME = \"country\"", "var_name": "PART2_NAME"}, {"original_string": "public static final String[] partNames = { PART1_NAME, PART2_NAME };", "modifier": "public static final", "type": "String[]", "declarator": "partNames = { PART1_NAME, PART2_NAME }", "var_name": "partNames"}, {"original_string": "private static final String COL1 = \"id\";", "modifier": "private static final", "type": "String", "declarator": "COL1 = \"id\"", "var_name": "COL1"}, {"original_string": "private static final String COL2 = \"msg\";", "modifier": "private static final", "type": "String", "declarator": "COL2 = \"msg\"", "var_name": "COL2"}, {"original_string": "final String[] colNames = {COL1,COL2};", "modifier": "final", "type": "String[]", "declarator": "colNames = {COL1,COL2}", "var_name": "colNames"}, {"original_string": "private String[] colTypes = { \"int\", \"string\" };", "modifier": "private", "type": "String[]", "declarator": "colTypes = { \"int\", \"string\" }", "var_name": "colTypes"}, {"original_string": "private static final String PART1_VALUE = \"Asia\";", "modifier": "private static final", "type": "String", "declarator": "PART1_VALUE = \"Asia\"", "var_name": "PART1_VALUE"}, {"original_string": "private static final String PART2_VALUE = \"India\";", "modifier": "private static final", "type": "String", "declarator": "PART2_VALUE = \"India\"", "var_name": "PART2_VALUE"}, {"original_string": "private final ArrayList<String> partVals;", "modifier": "private final", "type": "ArrayList<String>", "declarator": "partVals", "var_name": "partVals"}, {"original_string": "private final String metaStoreURI;", "modifier": "private final", "type": "String", "declarator": "metaStoreURI", "var_name": "metaStoreURI"}, {"original_string": "private HiveDelimitedTextSerializer serializer;", "modifier": "private", "type": "HiveDelimitedTextSerializer", "declarator": "serializer", "var_name": "serializer"}, {"original_string": "private final HiveConf conf;", "modifier": "private final", "type": "HiveConf", "declarator": "conf", "var_name": "conf"}, {"original_string": "private ExecutorService callTimeoutPool;", "modifier": "private", "type": "ExecutorService", "declarator": "callTimeoutPool", "var_name": "callTimeoutPool"}, {"original_string": "int timeout = 10000;", "modifier": "", "type": "int", "declarator": "timeout = 10000", "var_name": "timeout"}, {"original_string": "@Rule\n  public TemporaryFolder dbFolder = new TemporaryFolder();", "modifier": "@Rule\n  public", "type": "TemporaryFolder", "declarator": "dbFolder = new TemporaryFolder()", "var_name": "dbFolder"}, {"original_string": "private final Driver driver;", "modifier": "private final", "type": "Driver", "declarator": "driver", "var_name": "driver"}], "file": "flume-ng-sinks/flume-hive-sink/src/test/java/org/apache/flume/sink/hive/TestHiveWriter.java"}, "test_case": {"identifier": "testInstantiate", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testInstantiate() throws Exception {\n    HiveEndPoint endPoint = new HiveEndPoint(metaStoreURI, dbName, tblName, partVals);\n    SinkCounter sinkCounter = new SinkCounter(this.getClass().getName());\n    HiveWriter writer = new HiveWriter(endPoint, 10, true, timeout, callTimeoutPool, \"flumetest\",\n                                       serializer, sinkCounter);\n\n    writer.close();\n  }", "signature": "void testInstantiate()", "full_signature": "@Test public void testInstantiate()", "class_method_signature": "TestHiveWriter.testInstantiate()", "testcase": true, "constructor": false, "invocations": ["getName", "getClass", "close"]}, "focal_class": {"identifier": "HiveWriter", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(HiveWriter.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(HiveWriter.class)", "var_name": "LOG"}, {"original_string": "private final HiveEndPoint endPoint;", "modifier": "private final", "type": "HiveEndPoint", "declarator": "endPoint", "var_name": "endPoint"}, {"original_string": "private HiveEventSerializer serializer;", "modifier": "private", "type": "HiveEventSerializer", "declarator": "serializer", "var_name": "serializer"}, {"original_string": "private final StreamingConnection connection;", "modifier": "private final", "type": "StreamingConnection", "declarator": "connection", "var_name": "connection"}, {"original_string": "private final int txnsPerBatch;", "modifier": "private final", "type": "int", "declarator": "txnsPerBatch", "var_name": "txnsPerBatch"}, {"original_string": "private final RecordWriter recordWriter;", "modifier": "private final", "type": "RecordWriter", "declarator": "recordWriter", "var_name": "recordWriter"}, {"original_string": "private TransactionBatch txnBatch;", "modifier": "private", "type": "TransactionBatch", "declarator": "txnBatch", "var_name": "txnBatch"}, {"original_string": "private final ExecutorService callTimeoutPool;", "modifier": "private final", "type": "ExecutorService", "declarator": "callTimeoutPool", "var_name": "callTimeoutPool"}, {"original_string": "private final long callTimeout;", "modifier": "private final", "type": "long", "declarator": "callTimeout", "var_name": "callTimeout"}, {"original_string": "private long lastUsed;", "modifier": "private", "type": "long", "declarator": "lastUsed", "var_name": "lastUsed"}, {"original_string": "private SinkCounter sinkCounter;", "modifier": "private", "type": "SinkCounter", "declarator": "sinkCounter", "var_name": "sinkCounter"}, {"original_string": "private int batchCounter;", "modifier": "private", "type": "int", "declarator": "batchCounter", "var_name": "batchCounter"}, {"original_string": "private long eventCounter;", "modifier": "private", "type": "long", "declarator": "eventCounter", "var_name": "eventCounter"}, {"original_string": "private long processSize;", "modifier": "private", "type": "long", "declarator": "processSize", "var_name": "processSize"}, {"original_string": "protected boolean closed;", "modifier": "protected", "type": "boolean", "declarator": "closed", "var_name": "closed"}, {"original_string": "private boolean autoCreatePartitions;", "modifier": "private", "type": "boolean", "declarator": "autoCreatePartitions", "var_name": "autoCreatePartitions"}, {"original_string": "private boolean hearbeatNeeded = false;", "modifier": "private", "type": "boolean", "declarator": "hearbeatNeeded = false", "var_name": "hearbeatNeeded"}, {"original_string": "private final int writeBatchSz = 1000;", "modifier": "private final", "type": "int", "declarator": "writeBatchSz = 1000", "var_name": "writeBatchSz"}, {"original_string": "private ArrayList<Event> batch = new ArrayList<Event>(writeBatchSz);", "modifier": "private", "type": "ArrayList<Event>", "declarator": "batch = new ArrayList<Event>(writeBatchSz)", "var_name": "batch"}], "methods": [{"identifier": "HiveWriter", "parameters": "(HiveEndPoint endPoint, int txnsPerBatch,\n             boolean autoCreatePartitions, long callTimeout,\n             ExecutorService callTimeoutPool, String hiveUser,\n             HiveEventSerializer serializer, SinkCounter sinkCounter)", "modifiers": "", "return": "", "signature": " HiveWriter(HiveEndPoint endPoint, int txnsPerBatch,\n             boolean autoCreatePartitions, long callTimeout,\n             ExecutorService callTimeoutPool, String hiveUser,\n             HiveEventSerializer serializer, SinkCounter sinkCounter)", "full_signature": "  HiveWriter(HiveEndPoint endPoint, int txnsPerBatch,\n             boolean autoCreatePartitions, long callTimeout,\n             ExecutorService callTimeoutPool, String hiveUser,\n             HiveEventSerializer serializer, SinkCounter sinkCounter)", "class_method_signature": "HiveWriter.HiveWriter(HiveEndPoint endPoint, int txnsPerBatch,\n             boolean autoCreatePartitions, long callTimeout,\n             ExecutorService callTimeoutPool, String hiveUser,\n             HiveEventSerializer serializer, SinkCounter sinkCounter)", "testcase": false, "constructor": true}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "HiveWriter.toString()", "testcase": false, "constructor": false}, {"identifier": "resetCounters", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void resetCounters()", "full_signature": "private void resetCounters()", "class_method_signature": "HiveWriter.resetCounters()", "testcase": false, "constructor": false}, {"identifier": "setHearbeatNeeded", "parameters": "()", "modifiers": "", "return": "void", "signature": "void setHearbeatNeeded()", "full_signature": " void setHearbeatNeeded()", "class_method_signature": "HiveWriter.setHearbeatNeeded()", "testcase": false, "constructor": false}, {"identifier": "getRemainingTxns", "parameters": "()", "modifiers": "public", "return": "int", "signature": "int getRemainingTxns()", "full_signature": "public int getRemainingTxns()", "class_method_signature": "HiveWriter.getRemainingTxns()", "testcase": false, "constructor": false}, {"identifier": "write", "parameters": "(final Event event)", "modifiers": "public synchronized", "return": "void", "signature": "void write(final Event event)", "full_signature": "public synchronized void write(final Event event)", "class_method_signature": "HiveWriter.write(final Event event)", "testcase": false, "constructor": false}, {"identifier": "writeEventBatchToSerializer", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void writeEventBatchToSerializer()", "full_signature": "private void writeEventBatchToSerializer()", "class_method_signature": "HiveWriter.writeEventBatchToSerializer()", "testcase": false, "constructor": false}, {"identifier": "flush", "parameters": "(boolean rollToNext)", "modifiers": "public", "return": "void", "signature": "void flush(boolean rollToNext)", "full_signature": "public void flush(boolean rollToNext)", "class_method_signature": "HiveWriter.flush(boolean rollToNext)", "testcase": false, "constructor": false}, {"identifier": "abort", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void abort()", "full_signature": "public void abort()", "class_method_signature": "HiveWriter.abort()", "testcase": false, "constructor": false}, {"identifier": "heartBeat", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void heartBeat()", "full_signature": "public void heartBeat()", "class_method_signature": "HiveWriter.heartBeat()", "testcase": false, "constructor": false}, {"identifier": "close", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void close()", "full_signature": "public void close()", "class_method_signature": "HiveWriter.close()", "testcase": false, "constructor": false}, {"identifier": "abortRemainingTxns", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void abortRemainingTxns()", "full_signature": "private void abortRemainingTxns()", "class_method_signature": "HiveWriter.abortRemainingTxns()", "testcase": false, "constructor": false}, {"identifier": "abortCurrTxnHelper", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void abortCurrTxnHelper()", "full_signature": "private void abortCurrTxnHelper()", "class_method_signature": "HiveWriter.abortCurrTxnHelper()", "testcase": false, "constructor": false}, {"identifier": "isClosed", "parameters": "(TransactionBatch.TxnState txnState)", "modifiers": "private", "return": "boolean", "signature": "boolean isClosed(TransactionBatch.TxnState txnState)", "full_signature": "private boolean isClosed(TransactionBatch.TxnState txnState)", "class_method_signature": "HiveWriter.isClosed(TransactionBatch.TxnState txnState)", "testcase": false, "constructor": false}, {"identifier": "closeConnection", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void closeConnection()", "full_signature": "public void closeConnection()", "class_method_signature": "HiveWriter.closeConnection()", "testcase": false, "constructor": false}, {"identifier": "commitTxn", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void commitTxn()", "full_signature": "private void commitTxn()", "class_method_signature": "HiveWriter.commitTxn()", "testcase": false, "constructor": false}, {"identifier": "abortTxn", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void abortTxn()", "full_signature": "private void abortTxn()", "class_method_signature": "HiveWriter.abortTxn()", "testcase": false, "constructor": false}, {"identifier": "newConnection", "parameters": "(final String proxyUser)", "modifiers": "private", "return": "StreamingConnection", "signature": "StreamingConnection newConnection(final String proxyUser)", "full_signature": "private StreamingConnection newConnection(final String proxyUser)", "class_method_signature": "HiveWriter.newConnection(final String proxyUser)", "testcase": false, "constructor": false}, {"identifier": "nextTxnBatch", "parameters": "(final RecordWriter recordWriter)", "modifiers": "private", "return": "TransactionBatch", "signature": "TransactionBatch nextTxnBatch(final RecordWriter recordWriter)", "full_signature": "private TransactionBatch nextTxnBatch(final RecordWriter recordWriter)", "class_method_signature": "HiveWriter.nextTxnBatch(final RecordWriter recordWriter)", "testcase": false, "constructor": false}, {"identifier": "closeTxnBatch", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void closeTxnBatch()", "full_signature": "private void closeTxnBatch()", "class_method_signature": "HiveWriter.closeTxnBatch()", "testcase": false, "constructor": false}, {"identifier": "timedCall", "parameters": "(final CallRunner1<T> callRunner)", "modifiers": "private", "return": "T", "signature": "T timedCall(final CallRunner1<T> callRunner)", "full_signature": "private T timedCall(final CallRunner1<T> callRunner)", "class_method_signature": "HiveWriter.timedCall(final CallRunner1<T> callRunner)", "testcase": false, "constructor": false}, {"identifier": "getLastUsed", "parameters": "()", "modifiers": "", "return": "long", "signature": "long getLastUsed()", "full_signature": " long getLastUsed()", "class_method_signature": "HiveWriter.getLastUsed()", "testcase": false, "constructor": false}], "file": "flume-ng-sinks/flume-hive-sink/src/main/java/org/apache/flume/sink/hive/HiveWriter.java"}, "focal_method": {"identifier": "close", "parameters": "()", "modifiers": "public", "return": "void", "body": "public void close() throws InterruptedException {\n    batch.clear();\n    abortRemainingTxns();\n    closeTxnBatch();\n    closeConnection();\n    closed = true;\n  }", "signature": "void close()", "full_signature": "public void close()", "class_method_signature": "HiveWriter.close()", "testcase": false, "constructor": false, "invocations": ["clear", "abortRemainingTxns", "closeTxnBatch", "closeConnection"]}, "repository": {"repo_id": 2198510, "url": "https://github.com/apache/flume", "language": "Java", "is_fork": false, "fork_count": 1372, "stargazer_count": 1971, "size": 44377, "license": "licensed"}}