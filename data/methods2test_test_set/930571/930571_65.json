{"test_class": {"identifier": "ProcessInstanceMigrationServiceImplTest", "superclass": "extends AbstractKieServicesBaseTest", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(KModuleDeploymentServiceTest.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(KModuleDeploymentServiceTest.class)", "var_name": "logger"}, {"original_string": "protected static final String MIGRATION_ARTIFACT_ID = \"test-migration\";", "modifier": "protected static final", "type": "String", "declarator": "MIGRATION_ARTIFACT_ID = \"test-migration\"", "var_name": "MIGRATION_ARTIFACT_ID"}, {"original_string": "protected static final String MIGRATION_GROUP_ID = \"org.jbpm.test\";", "modifier": "protected static final", "type": "String", "declarator": "MIGRATION_GROUP_ID = \"org.jbpm.test\"", "var_name": "MIGRATION_GROUP_ID"}, {"original_string": "protected static final String MIGRATION_VERSION_V1 = \"1.0.0\";", "modifier": "protected static final", "type": "String", "declarator": "MIGRATION_VERSION_V1 = \"1.0.0\"", "var_name": "MIGRATION_VERSION_V1"}, {"original_string": "protected static final String MIGRATION_VERSION_V2 = \"2.0.0\";", "modifier": "protected static final", "type": "String", "declarator": "MIGRATION_VERSION_V2 = \"2.0.0\"", "var_name": "MIGRATION_VERSION_V2"}, {"original_string": "private List<DeploymentUnit> units = new ArrayList<DeploymentUnit>();", "modifier": "private", "type": "List<DeploymentUnit>", "declarator": "units = new ArrayList<DeploymentUnit>()", "var_name": "units"}, {"original_string": "private KModuleDeploymentUnit deploymentUnitV1;", "modifier": "private", "type": "KModuleDeploymentUnit", "declarator": "deploymentUnitV1", "var_name": "deploymentUnitV1"}, {"original_string": "private KModuleDeploymentUnit deploymentUnitV2;", "modifier": "private", "type": "KModuleDeploymentUnit", "declarator": "deploymentUnitV2", "var_name": "deploymentUnitV2"}, {"original_string": "protected ProcessInstanceMigrationService migrationService;", "modifier": "protected", "type": "ProcessInstanceMigrationService", "declarator": "migrationService", "var_name": "migrationService"}, {"original_string": "private static final String ADDTASKAFTERACTIVE_ID_V1 = \"process-migration-testv1.AddTaskAfterActive\";", "modifier": "private static final", "type": "String", "declarator": "ADDTASKAFTERACTIVE_ID_V1 = \"process-migration-testv1.AddTaskAfterActive\"", "var_name": "ADDTASKAFTERACTIVE_ID_V1"}, {"original_string": "private static final String ADDTASKAFTERACTIVE_ID_V2 = \"process-migration-testv2.AddTaskAfterActive\";", "modifier": "private static final", "type": "String", "declarator": "ADDTASKAFTERACTIVE_ID_V2 = \"process-migration-testv2.AddTaskAfterActive\"", "var_name": "ADDTASKAFTERACTIVE_ID_V2"}, {"original_string": "private static final String REMOVEACTIVETASK_ID_V1 = \"process-migration-testv1.RemoveActiveTask\";", "modifier": "private static final", "type": "String", "declarator": "REMOVEACTIVETASK_ID_V1 = \"process-migration-testv1.RemoveActiveTask\"", "var_name": "REMOVEACTIVETASK_ID_V1"}, {"original_string": "private static final String REMOVEACTIVETASK_ID_V2 = \"process-migration-testv2.RemoveActiveTask\";", "modifier": "private static final", "type": "String", "declarator": "REMOVEACTIVETASK_ID_V2 = \"process-migration-testv2.RemoveActiveTask\"", "var_name": "REMOVEACTIVETASK_ID_V2"}, {"original_string": "private static final String RECREATEACTIVETASK_ID_V1 = \"process-migration-testv1.RecreateActiveTask\";", "modifier": "private static final", "type": "String", "declarator": "RECREATEACTIVETASK_ID_V1 = \"process-migration-testv1.RecreateActiveTask\"", "var_name": "RECREATEACTIVETASK_ID_V1"}, {"original_string": "private static final String RECREATEACTIVETASK_ID_V2 = \"process-migration-testv2.RecreateActiveTask\";", "modifier": "private static final", "type": "String", "declarator": "RECREATEACTIVETASK_ID_V2 = \"process-migration-testv2.RecreateActiveTask\"", "var_name": "RECREATEACTIVETASK_ID_V2"}], "file": "jbpm-services/jbpm-kie-services/src/test/java/org/jbpm/kie/services/impl/admin/ProcessInstanceMigrationServiceImplTest.java"}, "test_case": {"identifier": "testMigrateSingleProcessInstanceWithoutNodeMappingWithNodeOrderChange", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testMigrateSingleProcessInstanceWithoutNodeMappingWithNodeOrderChange() {\n        \n        // JBPM-7598\n        // RECREATEACTIVETASK_ID_V2 was modified from RECREATEACTIVETASK_ID_V1\n        // Remove the UserTask and recreate the same UserTask so they look same but\n        //  - NodeId is different\n        //  - The order of userTask in bpmn2 file is different\n        \n        long processInstanceId = processService.startProcess(deploymentUnitV1.getIdentifier(), RECREATEACTIVETASK_ID_V1);\n        assertNotNull(processInstanceId);\n        \n        MigrationReport report = migrationService.migrate(deploymentUnitV1.getIdentifier(), processInstanceId, deploymentUnitV2.getIdentifier(), RECREATEACTIVETASK_ID_V2);\n        assertNotNull(report);\n        assertFalse(report.isSuccessful());\n        MigrationEntry error = report.getEntries().stream().filter(e -> e.getType().equals(\"ERROR\")).findFirst().get();\n        assertNotNull(error);\n        assertEquals(\"Node with id _54C7BD3A-0BE4-4C87-9689-C492B8469D2D was not found in new process definition\", error.getMessage());\n    }", "signature": "void testMigrateSingleProcessInstanceWithoutNodeMappingWithNodeOrderChange()", "full_signature": "@Test public void testMigrateSingleProcessInstanceWithoutNodeMappingWithNodeOrderChange()", "class_method_signature": "ProcessInstanceMigrationServiceImplTest.testMigrateSingleProcessInstanceWithoutNodeMappingWithNodeOrderChange()", "testcase": true, "constructor": false, "invocations": ["startProcess", "getIdentifier", "assertNotNull", "migrate", "getIdentifier", "getIdentifier", "assertNotNull", "assertFalse", "isSuccessful", "get", "findFirst", "filter", "stream", "getEntries", "equals", "getType", "assertNotNull", "assertEquals", "getMessage"]}, "focal_class": {"identifier": "ProcessInstanceMigrationServiceImpl", "superclass": "", "interfaces": "implements ProcessInstanceMigrationService", "fields": [], "methods": [{"identifier": "ProcessInstanceMigrationServiceImpl", "parameters": "()", "modifiers": "public", "return": "", "signature": " ProcessInstanceMigrationServiceImpl()", "full_signature": "public  ProcessInstanceMigrationServiceImpl()", "class_method_signature": "ProcessInstanceMigrationServiceImpl.ProcessInstanceMigrationServiceImpl()", "testcase": false, "constructor": true}, {"identifier": "migrate", "parameters": "(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "modifiers": "@Override public", "return": "MigrationReport", "signature": "MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "full_signature": "@Override public MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "class_method_signature": "ProcessInstanceMigrationServiceImpl.migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "testcase": false, "constructor": false}, {"identifier": "migrate", "parameters": "(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "modifiers": "@Override public", "return": "MigrationReport", "signature": "MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "full_signature": "@Override public MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "class_method_signature": "ProcessInstanceMigrationServiceImpl.migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "testcase": false, "constructor": false}, {"identifier": "migrate", "parameters": "(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId)", "modifiers": "@Override public", "return": "List<MigrationReport>", "signature": "List<MigrationReport> migrate(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId)", "full_signature": "@Override public List<MigrationReport> migrate(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId)", "class_method_signature": "ProcessInstanceMigrationServiceImpl.migrate(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId)", "testcase": false, "constructor": false}, {"identifier": "migrate", "parameters": "(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "modifiers": "@Override public", "return": "List<MigrationReport>", "signature": "List<MigrationReport> migrate(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "full_signature": "@Override public List<MigrationReport> migrate(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "class_method_signature": "ProcessInstanceMigrationServiceImpl.migrate(String sourceDeploymentId, List<Long> processInstanceIds, String targetDeploymentId, String targetProcessId, Map<String, String> nodeMapping)", "testcase": false, "constructor": false}, {"identifier": "convert", "parameters": "(org.jbpm.runtime.manager.impl.migration.MigrationReport report)", "modifiers": "protected", "return": "MigrationReport", "signature": "MigrationReport convert(org.jbpm.runtime.manager.impl.migration.MigrationReport report)", "full_signature": "protected MigrationReport convert(org.jbpm.runtime.manager.impl.migration.MigrationReport report)", "class_method_signature": "ProcessInstanceMigrationServiceImpl.convert(org.jbpm.runtime.manager.impl.migration.MigrationReport report)", "testcase": false, "constructor": false}], "file": "jbpm-services/jbpm-kie-services/src/main/java/org/jbpm/kie/services/impl/admin/ProcessInstanceMigrationServiceImpl.java"}, "focal_method": {"identifier": "migrate", "parameters": "(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "modifiers": "@Override public", "return": "MigrationReport", "body": "@Override\n    public MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId) {\n        MigrationSpec migrationSpec = new MigrationSpec(sourceDeploymentId, processInstanceId, targetDeploymentId, targetProcessId);        \n        MigrationManager migrationManager = new MigrationManager(migrationSpec);\n        \n        org.jbpm.runtime.manager.impl.migration.MigrationReport report = null;\n        try {\n            report = migrationManager.migrate();\n        \n        } catch (MigrationException e) {\n            report = e.getReport();\n        }\n        return convert(report);\n    }", "signature": "MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "full_signature": "@Override public MigrationReport migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "class_method_signature": "ProcessInstanceMigrationServiceImpl.migrate(String sourceDeploymentId, Long processInstanceId, String targetDeploymentId, String targetProcessId)", "testcase": false, "constructor": false, "invocations": ["migrate", "getReport", "convert"]}, "repository": {"repo_id": 930571, "url": "https://github.com/kiegroup/jbpm", "stars": 1035, "created": "9/22/2010 1:19:52 PM +00:00", "updates": "2020-01-22T03:39:57+00:00", "fork": "False", "license": "licensed"}}