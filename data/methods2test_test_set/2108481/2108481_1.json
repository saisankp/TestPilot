{"test_class": {"identifier": "IssuerClaimVerifierTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String DEFAULT_ISSUER = \"https://uaa.run.pivotal.io\";", "modifier": "private static final", "type": "String", "declarator": "DEFAULT_ISSUER = \"https://uaa.run.pivotal.io\"", "var_name": "DEFAULT_ISSUER"}, {"original_string": "private IssuerClaimVerifier issuerClaimVerifier;", "modifier": "private", "type": "IssuerClaimVerifier", "declarator": "issuerClaimVerifier", "var_name": "issuerClaimVerifier"}], "file": "spring-security-oauth2/src/test/java/org/springframework/security/oauth2/provider/token/store/IssuerClaimVerifierTest.java"}, "test_case": {"identifier": "verifyWhenJwtClaimsSetContainsValidIssuerThenVerificationSucceeds", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void verifyWhenJwtClaimsSetContainsValidIssuerThenVerificationSucceeds() throws Exception {\n\t\tMap<String, Object> claims = new HashMap<String, Object>();\n\t\tclaims.put(\"iss\", DEFAULT_ISSUER);\n\t\tthis.issuerClaimVerifier.verify(claims);\n\t}", "signature": "void verifyWhenJwtClaimsSetContainsValidIssuerThenVerificationSucceeds()", "full_signature": "@Test public void verifyWhenJwtClaimsSetContainsValidIssuerThenVerificationSucceeds()", "class_method_signature": "IssuerClaimVerifierTest.verifyWhenJwtClaimsSetContainsValidIssuerThenVerificationSucceeds()", "testcase": true, "constructor": false, "invocations": ["put", "verify"]}, "focal_class": {"identifier": "IssuerClaimVerifier", "superclass": "", "interfaces": "implements JwtClaimsSetVerifier", "fields": [{"original_string": "private static final String ISS_CLAIM = \"iss\";", "modifier": "private static final", "type": "String", "declarator": "ISS_CLAIM = \"iss\"", "var_name": "ISS_CLAIM"}, {"original_string": "private final URL issuer;", "modifier": "private final", "type": "URL", "declarator": "issuer", "var_name": "issuer"}], "methods": [{"identifier": "IssuerClaimVerifier", "parameters": "(URL issuer)", "modifiers": "public", "return": "", "signature": " IssuerClaimVerifier(URL issuer)", "full_signature": "public  IssuerClaimVerifier(URL issuer)", "class_method_signature": "IssuerClaimVerifier.IssuerClaimVerifier(URL issuer)", "testcase": false, "constructor": true}, {"identifier": "verify", "parameters": "(Map<String, Object> claims)", "modifiers": "@Override public", "return": "void", "signature": "void verify(Map<String, Object> claims)", "full_signature": "@Override public void verify(Map<String, Object> claims)", "class_method_signature": "IssuerClaimVerifier.verify(Map<String, Object> claims)", "testcase": false, "constructor": false}], "file": "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/IssuerClaimVerifier.java"}, "focal_method": {"identifier": "verify", "parameters": "(Map<String, Object> claims)", "modifiers": "@Override public", "return": "void", "body": "@Override\n\tpublic void verify(Map<String, Object> claims) throws InvalidTokenException {\n\t\tif (!CollectionUtils.isEmpty(claims) && claims.containsKey(ISS_CLAIM)) {\n\t\t\tString jwtIssuer = (String)claims.get(ISS_CLAIM);\n\t\t\tif (!jwtIssuer.equals(this.issuer.toString())) {\n\t\t\t\tthrow new InvalidTokenException(\"Invalid Issuer (iss) claim: \" + jwtIssuer);\n\t\t\t}\n\t\t}\n\t}", "signature": "void verify(Map<String, Object> claims)", "full_signature": "@Override public void verify(Map<String, Object> claims)", "class_method_signature": "IssuerClaimVerifier.verify(Map<String, Object> claims)", "testcase": false, "constructor": false, "invocations": ["isEmpty", "containsKey", "get", "equals", "toString"]}, "repository": {"repo_id": 2108481, "url": "https://github.com/spring-projects/spring-security-oauth", "language": "Java", "is_fork": false, "fork_count": 3777, "stargazer_count": 4150, "size": 7166, "license": "licensed"}}