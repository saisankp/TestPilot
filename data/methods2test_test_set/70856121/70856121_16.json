{"test_class": {"identifier": "LoginResourceTest", "superclass": "", "interfaces": "", "fields": [], "file": "src/server/src/test/java/io/cassandrareaper/resources/auth/LoginResourceTest.java"}, "test_case": {"identifier": "testLogin", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testLogin() throws IOException {\n    try (InputStream is = ResourceUtils.getInputStreamForPath(\"classpath:shiro.ini\")) {\n      Ini ini = new Ini();\n      ini.load(is);\n      new WebIniSecurityManagerFactory(ini).getInstance().authenticate(new UsernamePasswordToken(\"admin\", \"admin\"));\n    }\n  }", "signature": "void testLogin()", "full_signature": "@Test public void testLogin()", "class_method_signature": "LoginResourceTest.testLogin()", "testcase": true, "constructor": false, "invocations": ["getInputStreamForPath", "load", "authenticate", "getInstance"]}, "focal_class": {"identifier": "LoginResource", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "login", "parameters": "(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "modifiers": "@Path(\"/login\") @POST public", "return": "void", "signature": "void login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "full_signature": "@Path(\"/login\") @POST public void login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "class_method_signature": "LoginResource.login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "testcase": false, "constructor": false}, {"identifier": "logout", "parameters": "(@Auth Subject subject)", "modifiers": "@Path(\"/logout\") @POST public", "return": "void", "signature": "void logout(@Auth Subject subject)", "full_signature": "@Path(\"/logout\") @POST public void logout(@Auth Subject subject)", "class_method_signature": "LoginResource.logout(@Auth Subject subject)", "testcase": false, "constructor": false}, {"identifier": "ensurePresent", "parameters": "(String value, String message)", "modifiers": "private", "return": "void", "signature": "void ensurePresent(String value, String message)", "full_signature": "private void ensurePresent(String value, String message)", "class_method_signature": "LoginResource.ensurePresent(String value, String message)", "testcase": false, "constructor": false}], "file": "src/server/src/main/java/io/cassandrareaper/resources/auth/LoginResource.java"}, "focal_method": {"identifier": "login", "parameters": "(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "modifiers": "@Path(\"/login\") @POST public", "return": "void", "body": "@Path(\"/login\")\n  @POST\n  public void login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject) throws IOException {\n\n    ensurePresent(username, \"Invalid credentials: missing username.\");\n    ensurePresent(password, \"Invalid credentials: missing password.\");\n\n    try {\n      subject.login(new UsernamePasswordToken(username, password, rememberMe));\n    } catch (AuthenticationException e) {\n      throw new IncorrectCredentialsException(\"Invalid credentials combination for user: \" + username);\n    }\n  }", "signature": "void login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "full_signature": "@Path(\"/login\") @POST public void login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "class_method_signature": "LoginResource.login(\n      @FormParam(\"username\") String username,\n      @FormParam(\"password\") String password,\n      @FormParam(\"rememberMe\") boolean rememberMe,\n      @Auth Subject subject)", "testcase": false, "constructor": false, "invocations": ["ensurePresent", "ensurePresent", "login"]}, "repository": {"repo_id": 70856121, "url": "https://github.com/thelastpickle/cassandra-reaper", "language": "Java", "is_fork": false, "fork_count": 156, "stargazer_count": 353, "size": 43662, "license": "licensed"}}