{"test_class": {"identifier": "DeserializerProcessorTest", "superclass": "", "interfaces": "", "fields": [], "file": "core/src/test/java/com/nextdoor/bender/deserializer/DeserializerProcessorTest.java"}, "test_case": {"identifier": "testStatsLoggingOnError", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testStatsLoggingOnError() {\n    DummyDeserializer mockDeser = mock(DummyDeserializer.class);\n    when(mockDeser.deserialize(\"foo\"))\n        .thenThrow(new DeserializationException(new RuntimeException(\"expected\")));\n    DeserializerProcessor deser = new DeserializerProcessor(mockDeser);\n\n    /*\n     * Mock the Stat object\n     */\n    Stat runtimeStat = mock(Stat.class);\n    Stat successStat = mock(Stat.class);\n    Stat errorStat = mock(Stat.class);\n\n    deser.setRuntimeStat(runtimeStat);\n    deser.setSuccessCountStat(successStat);\n    deser.setErrorCountStat(errorStat);\n\n    try {\n      deser.deserialize(\"foo\");\n    } catch (DeserializationException e) {\n      // expected\n    }\n\n    /*\n     * Verify start, stop are called, increment error count and never increment success count.\n     */\n    verify(runtimeStat, times(1)).start();\n    verify(runtimeStat, times(1)).stop();\n    verify(successStat, never()).increment();\n    verify(errorStat, times(1)).increment();\n  }", "signature": "void testStatsLoggingOnError()", "full_signature": "@Test public void testStatsLoggingOnError()", "class_method_signature": "DeserializerProcessorTest.testStatsLoggingOnError()", "testcase": true, "constructor": false, "invocations": ["mock", "thenThrow", "when", "deserialize", "mock", "mock", "mock", "setRuntimeStat", "setSuccessCountStat", "setErrorCountStat", "deserialize", "start", "verify", "times", "stop", "verify", "times", "increment", "verify", "never", "increment", "verify", "times"]}, "focal_class": {"identifier": "DeserializerProcessor", "superclass": "extends MonitoredProcess", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = Logger.getLogger(DeserializerProcessor.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = Logger.getLogger(DeserializerProcessor.class)", "var_name": "logger"}, {"original_string": "private Deserializer deser;", "modifier": "private", "type": "Deserializer", "declarator": "deser", "var_name": "deser"}], "methods": [{"identifier": "DeserializerProcessor", "parameters": "(Deserializer deserializer)", "modifiers": "public", "return": "", "signature": " DeserializerProcessor(Deserializer deserializer)", "full_signature": "public  DeserializerProcessor(Deserializer deserializer)", "class_method_signature": "DeserializerProcessor.DeserializerProcessor(Deserializer deserializer)", "testcase": false, "constructor": true}, {"identifier": "deserialize", "parameters": "(String eventString)", "modifiers": "public", "return": "DeserializedEvent", "signature": "DeserializedEvent deserialize(String eventString)", "full_signature": "public DeserializedEvent deserialize(String eventString)", "class_method_signature": "DeserializerProcessor.deserialize(String eventString)", "testcase": false, "constructor": false}, {"identifier": "getDeserializer", "parameters": "()", "modifiers": "public", "return": "Deserializer", "signature": "Deserializer getDeserializer()", "full_signature": "public Deserializer getDeserializer()", "class_method_signature": "DeserializerProcessor.getDeserializer()", "testcase": false, "constructor": false}, {"identifier": "setDeserializer", "parameters": "(Deserializer deserializer)", "modifiers": "public", "return": "void", "signature": "void setDeserializer(Deserializer deserializer)", "full_signature": "public void setDeserializer(Deserializer deserializer)", "class_method_signature": "DeserializerProcessor.setDeserializer(Deserializer deserializer)", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String toString()", "full_signature": "public String toString()", "class_method_signature": "DeserializerProcessor.toString()", "testcase": false, "constructor": false}], "file": "core/src/main/java/com/nextdoor/bender/deserializer/DeserializerProcessor.java"}, "focal_method": {"identifier": "deserialize", "parameters": "(String eventString)", "modifiers": "public", "return": "DeserializedEvent", "body": "public DeserializedEvent deserialize(String eventString) {\n    DeserializedEvent dEvent = null;\n    this.getRuntimeStat().start();\n\n    try {\n      dEvent = this.deser.deserialize(eventString);\n      this.getSuccessCountStat().increment();\n    } catch (DeserializationException e) {\n      logger.warn(\"failed to deserialize\", e);\n      this.getErrorCountStat().increment();\n    } finally {\n      this.getRuntimeStat().stop();\n    }\n\n    return dEvent;\n  }", "signature": "DeserializedEvent deserialize(String eventString)", "full_signature": "public DeserializedEvent deserialize(String eventString)", "class_method_signature": "DeserializerProcessor.deserialize(String eventString)", "testcase": false, "constructor": false, "invocations": ["start", "getRuntimeStat", "deserialize", "increment", "getSuccessCountStat", "warn", "increment", "getErrorCountStat", "stop", "getRuntimeStat"]}, "repository": {"repo_id": 75955378, "url": "https://github.com/Nextdoor/bender", "language": "Java", "is_fork": false, "fork_count": 15, "stargazer_count": 163, "size": 1503, "license": "licensed"}}