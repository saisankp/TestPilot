{"test_class": {"identifier": "AcroFormUtilsTest", "superclass": "", "interfaces": "", "fields": [], "file": "sejda-sambox/src/test/java/org/sejda/impl/sambox/util/AcroFormUtilsTest.java"}, "test_case": {"identifier": "megeDetaults", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void megeDetaults() throws IOException {\n        try (PDDocument anotherDoc = PDFParser.parse(SeekableSources.inMemorySeekableSourceFrom(\n                getClass().getClassLoader().getResourceAsStream(\"pdf/forms/simple_form_with_full_dic.pdf\")))) {\n            PDAcroForm destination = new PDAcroForm(new PDDocument());\n            AcroFormUtils.mergeDefaults(anotherDoc.getDocumentCatalog().getAcroForm(), destination);\n            assertEquals(2, destination.getQuadding());\n            assertEquals(\"/ArialMT 0 Tf 0 g \", destination.getDefaultAppearance());\n            assertTrue(destination.isNeedAppearances());\n            assertTrue(destination.getDefaultResources().getCOSObject().size() > 0);\n        }\n    }", "signature": "void megeDetaults()", "full_signature": "@Test public void megeDetaults()", "class_method_signature": "AcroFormUtilsTest.megeDetaults()", "testcase": true, "constructor": false, "invocations": ["parse", "inMemorySeekableSourceFrom", "getResourceAsStream", "getClassLoader", "getClass", "mergeDefaults", "getAcroForm", "getDocumentCatalog", "assertEquals", "getQuadding", "assertEquals", "getDefaultAppearance", "assertTrue", "isNeedAppearances", "assertTrue", "size", "getCOSObject", "getDefaultResources"]}, "focal_class": {"identifier": "AcroFormUtils", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(AcroFormUtils.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(AcroFormUtils.class)", "var_name": "LOG"}], "methods": [{"identifier": "AcroFormUtils", "parameters": "()", "modifiers": "private", "return": "", "signature": " AcroFormUtils()", "full_signature": "private  AcroFormUtils()", "class_method_signature": "AcroFormUtils.AcroFormUtils()", "testcase": false, "constructor": true}, {"identifier": "mergeDefaults", "parameters": "(PDAcroForm mergeThis, PDAcroForm intoThis)", "modifiers": "public static", "return": "void", "signature": "void mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis)", "full_signature": "public static void mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis)", "class_method_signature": "AcroFormUtils.mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis)", "testcase": false, "constructor": false}, {"identifier": "mergeResourceArrayValue", "parameters": "(COSDictionary formResources, COSArray value, COSName currentKey)", "modifiers": "private static", "return": "void", "signature": "void mergeResourceArrayValue(COSDictionary formResources, COSArray value, COSName currentKey)", "full_signature": "private static void mergeResourceArrayValue(COSDictionary formResources, COSArray value, COSName currentKey)", "class_method_signature": "AcroFormUtils.mergeResourceArrayValue(COSDictionary formResources, COSArray value, COSName currentKey)", "testcase": false, "constructor": false}, {"identifier": "mergeResourceDictionaryValue", "parameters": "(final COSDictionary formResources, COSDictionary value,\n            COSName currentKey)", "modifiers": "private static", "return": "void", "signature": "void mergeResourceDictionaryValue(final COSDictionary formResources, COSDictionary value,\n            COSName currentKey)", "full_signature": "private static void mergeResourceDictionaryValue(final COSDictionary formResources, COSDictionary value,\n            COSName currentKey)", "class_method_signature": "AcroFormUtils.mergeResourceDictionaryValue(final COSDictionary formResources, COSDictionary value,\n            COSName currentKey)", "testcase": false, "constructor": false}], "file": "sejda-sambox/src/main/java/org/sejda/impl/sambox/util/AcroFormUtils.java"}, "focal_method": {"identifier": "mergeDefaults", "parameters": "(PDAcroForm mergeThis, PDAcroForm intoThis)", "modifiers": "public static", "return": "void", "body": "public static void mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis) {\n        if (!intoThis.isNeedAppearances() && mergeThis.isNeedAppearances()) {\n            intoThis.setNeedAppearances(true);\n        }\n        String da = mergeThis.getDefaultAppearance();\n        if (isBlank(intoThis.getDefaultAppearance()) && !isBlank(da)) {\n            intoThis.setDefaultAppearance(da);\n        }\n        int quadding = mergeThis.getCOSObject().getInt(COSName.Q);\n        if ((quadding >= 0 && quadding <= 2) && !intoThis.getCOSObject().containsKey(COSName.Q)) {\n            intoThis.setQuadding(quadding);\n        }\n        final COSDictionary formResources = ofNullable(\n                intoThis.getCOSObject().getDictionaryObject(COSName.DR, COSDictionary.class))\n                        .orElseGet(COSDictionary::new);\n        ofNullable(mergeThis.getCOSObject().getDictionaryObject(COSName.DR, COSDictionary.class)).ifPresent(dr -> {\n            for (COSName currentKey : dr.keySet()) {\n                ofNullable(dr.getDictionaryObject(currentKey)).ifPresent(value -> {\n                    if (value instanceof COSDictionary) {\n                        mergeResourceDictionaryValue(formResources, (COSDictionary) value, currentKey);\n                    } else if (value instanceof COSArray) {\n                        mergeResourceArrayValue(formResources, (COSArray) value, currentKey);\n                    } else {\n                        LOG.warn(\"Unsupported resource dictionary type {}\", value);\n                    }\n                });\n            }\n        });\n        intoThis.getCOSObject().setItem(COSName.DR, formResources);\n        LOG.debug(\"Merged AcroForm dictionary\");\n    }", "signature": "void mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis)", "full_signature": "public static void mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis)", "class_method_signature": "AcroFormUtils.mergeDefaults(PDAcroForm mergeThis, PDAcroForm intoThis)", "testcase": false, "constructor": false, "invocations": ["isNeedAppearances", "isNeedAppearances", "setNeedAppearances", "getDefaultAppearance", "isBlank", "getDefaultAppearance", "isBlank", "setDefaultAppearance", "getInt", "getCOSObject", "containsKey", "getCOSObject", "setQuadding", "orElseGet", "ofNullable", "getDictionaryObject", "getCOSObject", "ifPresent", "ofNullable", "getDictionaryObject", "getCOSObject", "keySet", "ifPresent", "ofNullable", "getDictionaryObject", "mergeResourceDictionaryValue", "mergeResourceArrayValue", "warn", "setItem", "getCOSObject", "debug"]}, "repository": {"repo_id": 13146848, "url": "https://github.com/torakiki/sejda", "language": "Java", "is_fork": false, "fork_count": 47, "stargazer_count": 316, "size": 59670, "license": "licensed"}}