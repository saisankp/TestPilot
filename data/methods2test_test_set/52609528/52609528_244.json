{"test_class": {"identifier": "CopyResourceHandlerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private HttpServerRequest httpServerRequestMock;", "modifier": "private", "type": "HttpServerRequest", "declarator": "httpServerRequestMock", "var_name": "httpServerRequestMock"}, {"original_string": "private CopyResourceHandler copyResourceHandler;", "modifier": "private", "type": "CopyResourceHandler", "declarator": "copyResourceHandler", "var_name": "copyResourceHandler"}], "file": "gateleen-core/src/test/java/org/swisspush/gateleen/core/resource/CopyResourceHandlerTest.java"}, "test_case": {"identifier": "testBackwardCompatibility", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testBackwardCompatibility() {\n        String json = \" { 'staticHeaders': {\" +\n                \" 'x-expire-after': 900,\" +\n                \" 'Content-Type': 'application/json'\" +\n                \"} }\";\n        json = json.replace('\\'', '\"');\n\n        Buffer jsonBuffer = Buffer.buffer(json);\n        CopyTask copyTask = copyResourceHandler.createCopyTask(httpServerRequestMock, jsonBuffer);\n\n        Assert.assertEquals(\"900\", copyTask.getHeaders().get(\"x-expire-after\"));\n        Assert.assertEquals(\"application/json\", copyTask.getHeaders().get(\"Content-Type\"));\n    }", "signature": "void testBackwardCompatibility()", "full_signature": "@Test public void testBackwardCompatibility()", "class_method_signature": "CopyResourceHandlerTest.testBackwardCompatibility()", "testcase": true, "constructor": false, "invocations": ["replace", "buffer", "createCopyTask", "assertEquals", "get", "getHeaders", "assertEquals", "get", "getHeaders"]}, "focal_class": {"identifier": "CopyResourceHandler", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(CopyResourceHandler.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(CopyResourceHandler.class)", "var_name": "log"}, {"original_string": "private static final String SLASH = \"/\";", "modifier": "private static final", "type": "String", "declarator": "SLASH = \"/\"", "var_name": "SLASH"}, {"original_string": "private static final int DEFAULT_TIMEOUT = 120000;", "modifier": "private static final", "type": "int", "declarator": "DEFAULT_TIMEOUT = 120000", "var_name": "DEFAULT_TIMEOUT"}, {"original_string": "private final String copyPath;", "modifier": "private final", "type": "String", "declarator": "copyPath", "var_name": "copyPath"}, {"original_string": "private final HttpClient selfClient;", "modifier": "private final", "type": "HttpClient", "declarator": "selfClient", "var_name": "selfClient"}], "methods": [{"identifier": "CopyResourceHandler", "parameters": "(HttpClient selfClient, String copyPath)", "modifiers": "public", "return": "", "signature": " CopyResourceHandler(HttpClient selfClient, String copyPath)", "full_signature": "public  CopyResourceHandler(HttpClient selfClient, String copyPath)", "class_method_signature": "CopyResourceHandler.CopyResourceHandler(HttpClient selfClient, String copyPath)", "testcase": false, "constructor": true}, {"identifier": "handle", "parameters": "(final HttpServerRequest request)", "modifiers": "public", "return": "boolean", "signature": "boolean handle(final HttpServerRequest request)", "full_signature": "public boolean handle(final HttpServerRequest request)", "class_method_signature": "CopyResourceHandler.handle(final HttpServerRequest request)", "testcase": false, "constructor": false}, {"identifier": "validTask", "parameters": "(HttpServerRequest request, CopyTask task)", "modifiers": "protected", "return": "boolean", "signature": "boolean validTask(HttpServerRequest request, CopyTask task)", "full_signature": "protected boolean validTask(HttpServerRequest request, CopyTask task)", "class_method_signature": "CopyResourceHandler.validTask(HttpServerRequest request, CopyTask task)", "testcase": false, "constructor": false}, {"identifier": "performGETRequest", "parameters": "(final HttpServerRequest request, final CopyTask task)", "modifiers": "protected", "return": "void", "signature": "void performGETRequest(final HttpServerRequest request, final CopyTask task)", "full_signature": "protected void performGETRequest(final HttpServerRequest request, final CopyTask task)", "class_method_signature": "CopyResourceHandler.performGETRequest(final HttpServerRequest request, final CopyTask task)", "testcase": false, "constructor": false}, {"identifier": "performPUTRequest", "parameters": "(final HttpServerRequest request, final HttpClientResponse getResponse, final CopyTask task)", "modifiers": "protected", "return": "void", "signature": "void performPUTRequest(final HttpServerRequest request, final HttpClientResponse getResponse, final CopyTask task)", "full_signature": "protected void performPUTRequest(final HttpServerRequest request, final HttpClientResponse getResponse, final CopyTask task)", "class_method_signature": "CopyResourceHandler.performPUTRequest(final HttpServerRequest request, final HttpClientResponse getResponse, final CopyTask task)", "testcase": false, "constructor": false}, {"identifier": "createResponse", "parameters": "(final HttpServerRequest request, final HttpClientResponse response, final CopyTask task)", "modifiers": "private", "return": "void", "signature": "void createResponse(final HttpServerRequest request, final HttpClientResponse response, final CopyTask task)", "full_signature": "private void createResponse(final HttpServerRequest request, final HttpClientResponse response, final CopyTask task)", "class_method_signature": "CopyResourceHandler.createResponse(final HttpServerRequest request, final HttpClientResponse response, final CopyTask task)", "testcase": false, "constructor": false}, {"identifier": "createCopyTask", "parameters": "(final HttpServerRequest request, final Buffer buffer)", "modifiers": "", "return": "CopyTask", "signature": "CopyTask createCopyTask(final HttpServerRequest request, final Buffer buffer)", "full_signature": " CopyTask createCopyTask(final HttpServerRequest request, final Buffer buffer)", "class_method_signature": "CopyResourceHandler.createCopyTask(final HttpServerRequest request, final Buffer buffer)", "testcase": false, "constructor": false}], "file": "gateleen-core/src/main/java/org/swisspush/gateleen/core/resource/CopyResourceHandler.java"}, "focal_method": {"identifier": "createCopyTask", "parameters": "(final HttpServerRequest request, final Buffer buffer)", "modifiers": "", "return": "CopyTask", "body": "CopyTask createCopyTask(final HttpServerRequest request, final Buffer buffer) {\n        JsonObject task = new JsonObject(buffer.toString());\n        HeaderFunction headerFunction = HeaderFunctions.DO_NOTHING;\n\n        JsonObject staticHeaders = task.getJsonObject(\"staticHeaders\");\n        if (staticHeaders != null) {\n            headerFunction = HeaderFunctions.parseStaticHeadersFromJson(staticHeaders);\n        } else {\n            final JsonArray dynamicHeaders = task.getJsonArray(\"headers\");\n            if (dynamicHeaders != null) {\n                headerFunction = HeaderFunctions.parseFromJson(dynamicHeaders);\n            }\n        }\n\n        MultiMap headers = StatusCodeTranslator.getTranslateFreeHeaders(request.headers());\n\n        final HeaderFunctions.EvalScope evalScope = headerFunction.apply(headers);\n        if (evalScope.getErrorMessage() != null) {\n            log.warn(\"Problem invoking Header functions: {}\", evalScope.getErrorMessage());\n            return null;\n        }\n\n        HttpHeaderUtil.removeNonForwardHeaders(headers);\n        headers.remove(\"content-length\");\n\n        // create copy task\n        return new CopyTask(task.getString(\"source\"), task.getString(\"destination\"), headers);\n    }", "signature": "CopyTask createCopyTask(final HttpServerRequest request, final Buffer buffer)", "full_signature": " CopyTask createCopyTask(final HttpServerRequest request, final Buffer buffer)", "class_method_signature": "CopyResourceHandler.createCopyTask(final HttpServerRequest request, final Buffer buffer)", "testcase": false, "constructor": false, "invocations": ["toString", "getJsonObject", "parseStaticHeadersFromJson", "getJsonArray", "parseFromJson", "getTranslateFreeHeaders", "headers", "apply", "getErrorMessage", "warn", "getErrorMessage", "removeNonForwardHeaders", "remove", "getString", "getString"]}, "repository": {"repo_id": 52609528, "url": "https://github.com/swisspush/gateleen", "language": "Java", "is_fork": false, "fork_count": 28, "stargazer_count": 63, "size": 2919, "license": "licensed"}}