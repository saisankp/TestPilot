{"test_class": {"identifier": "ClassGeneratorTest", "superclass": "", "interfaces": "", "fields": [], "file": "CoreFeatures/UtilityTools/ClassGeneratorJavaCompileAPI/src/test/java/info/smart_tools/smartactors/utility_tool/class_generator_with_java_compile_api/ClassGeneratorTest.java"}, "test_case": {"identifier": "checkClassGenerationWithUsingJarFile", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void checkClassGenerationWithUsingJarFile()\n            throws Exception {\n\n        String pathToJar = this.getClass().getClassLoader().getResource(\"ifield_name.jar\").getFile();\n        JarFile jarFile = new JarFile(pathToJar);\n        Enumeration<JarEntry> e = jarFile.entries();\n\n        URL[] urls = { new URL(\"jar:file:\" + pathToJar+\"!/\") };\n        URLClassLoader cl = URLClassLoader.newInstance(urls);\n\n        while (e.hasMoreElements()) {\n            JarEntry je = e.nextElement();\n            if(je.isDirectory() || !je.getName().endsWith(\".class\")){\n                continue;\n            }\n            // -6 because of .class\n            String className = je.getName().substring(0,je.getName().length()-6);\n            className = className.replace('/', '.');\n            Class c = cl.loadClass(className);\n\n        }\n\n        ClassGenerator classGenerator = new ClassGenerator(cl);\n        String testSample = \"package info.smart_tools.smartactors.utility_tool.test_class;\\n\" +\n                \"import info.smart_tools.smartactors.utility_tool.class_generator_with_java_compile_api.TestInterface;\\n\" +\n                \"import info.smart_tools.smartactors.core.ifield_name.IFieldName;\\n\" +\n                \"public class TestClass implements TestInterface, IFieldName {\\n\" +\n                \"    private int a;\\n\" +\n                \"    public Integer getA() {\\n\" +\n                \"        return a;\\n\" +\n                \"    }\\n\" +\n                \"}\\n\";\n        Class newClass = classGenerator.generate(testSample);\n        assertNotNull(newClass);\n    }", "signature": "void checkClassGenerationWithUsingJarFile()", "full_signature": "@Test public void checkClassGenerationWithUsingJarFile()", "class_method_signature": "ClassGeneratorTest.checkClassGenerationWithUsingJarFile()", "testcase": true, "constructor": false, "invocations": ["getFile", "getResource", "getClassLoader", "getClass", "entries", "newInstance", "hasMoreElements", "nextElement", "isDirectory", "endsWith", "getName", "substring", "getName", "length", "getName", "replace", "loadClass", "generate", "assertNotNull"]}, "focal_class": {"identifier": "ClassGenerator", "superclass": "", "interfaces": "implements IClassGenerator<String>", "fields": [{"original_string": "private InMemoryCodeCompiler compiler;", "modifier": "private", "type": "InMemoryCodeCompiler", "declarator": "compiler", "var_name": "compiler"}], "methods": [{"identifier": "ClassGenerator", "parameters": "(final ClassLoader classLoader)", "modifiers": "public", "return": "", "signature": " ClassGenerator(final ClassLoader classLoader)", "full_signature": "public  ClassGenerator(final ClassLoader classLoader)", "class_method_signature": "ClassGenerator.ClassGenerator(final ClassLoader classLoader)", "testcase": false, "constructor": true}, {"identifier": "generate", "parameters": "(final String source)", "modifiers": "@Override public", "return": "Class<?>", "signature": "Class<?> generate(final String source)", "full_signature": "@Override public Class<?> generate(final String source)", "class_method_signature": "ClassGenerator.generate(final String source)", "testcase": false, "constructor": false}, {"identifier": "getFirstSubstringByPattern", "parameters": "(final String source, final Pattern pattern)", "modifiers": "private", "return": "String", "signature": "String getFirstSubstringByPattern(final String source, final Pattern pattern)", "full_signature": "private String getFirstSubstringByPattern(final String source, final Pattern pattern)", "class_method_signature": "ClassGenerator.getFirstSubstringByPattern(final String source, final Pattern pattern)", "testcase": false, "constructor": false}], "file": "CoreFeatures/UtilityTools/ClassGeneratorJavaCompileAPI/src/main/java/info/smart_tools/smartactors/utility_tool/class_generator_with_java_compile_api/ClassGenerator.java"}, "focal_method": {"identifier": "generate", "parameters": "(final String source)", "modifiers": "@Override public", "return": "Class<?>", "body": "@Override\n    public Class<?> generate(final String source)\n            throws ClassGenerationException, InvalidArgumentException {\n\n        if (null == source || source.isEmpty()) {\n            throw new InvalidArgumentException(\"Source code should not be null or empty.\");\n        }\n        String packageName = getFirstSubstringByPattern(source, Pattern.compile(\"package\\\\s+([\\\\w\\\\.]+)\"));\n        String className = getFirstSubstringByPattern(source, Pattern.compile(\"(?:class|interface)\\\\s+(\\\\w+)\"));\n        if (null == packageName || packageName.isEmpty()) {\n            throw new InvalidArgumentException(\"Source code doesn't contain package name.\");\n        }\n        if (null == className || className.isEmpty()) {\n            throw new InvalidArgumentException(\"Source code doesn't contain class.\");\n        }\n        try {\n            String fullClassName = packageName + \".\" + className;\n            Class<?> compiledClass = this.compiler.compile(fullClassName, source);\n            return compiledClass;\n        } catch (Throwable e) {\n            throw new ClassGenerationException(\"Could not generate class.\", e);\n        }\n    }", "signature": "Class<?> generate(final String source)", "full_signature": "@Override public Class<?> generate(final String source)", "class_method_signature": "ClassGenerator.generate(final String source)", "testcase": false, "constructor": false, "invocations": ["isEmpty", "getFirstSubstringByPattern", "compile", "getFirstSubstringByPattern", "compile", "isEmpty", "isEmpty", "compile"]}, "repository": {"repo_id": 52972024, "url": "https://github.com/SmartTools/smartactors-core", "language": "Java", "is_fork": false, "fork_count": 7, "stargazer_count": 17, "size": 58816, "license": "licensed"}}