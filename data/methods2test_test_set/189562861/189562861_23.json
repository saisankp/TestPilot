{"test_class": {"identifier": "AbstractClusterInvokerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "List<Invoker<IHelloService>> invokers = new ArrayList<Invoker<IHelloService>>();", "modifier": "", "type": "List<Invoker<IHelloService>>", "declarator": "invokers = new ArrayList<Invoker<IHelloService>>()", "var_name": "invokers"}, {"original_string": "List<Invoker<IHelloService>> selectedInvokers = new ArrayList<Invoker<IHelloService>>();", "modifier": "", "type": "List<Invoker<IHelloService>>", "declarator": "selectedInvokers = new ArrayList<Invoker<IHelloService>>()", "var_name": "selectedInvokers"}, {"original_string": "AbstractClusterInvoker<IHelloService> cluster;", "modifier": "", "type": "AbstractClusterInvoker<IHelloService>", "declarator": "cluster", "var_name": "cluster"}, {"original_string": "AbstractClusterInvoker<IHelloService> cluster_nocheck;", "modifier": "", "type": "AbstractClusterInvoker<IHelloService>", "declarator": "cluster_nocheck", "var_name": "cluster_nocheck"}, {"original_string": "Directory<IHelloService> dic;", "modifier": "", "type": "Directory<IHelloService>", "declarator": "dic", "var_name": "dic"}, {"original_string": "RpcInvocation invocation = new RpcInvocation();", "modifier": "", "type": "RpcInvocation", "declarator": "invocation = new RpcInvocation()", "var_name": "invocation"}, {"original_string": "URL url = URL.valueOf(\"registry://localhost:9090\");", "modifier": "", "type": "URL", "declarator": "url = URL.valueOf(\"registry://localhost:9090\")", "var_name": "url"}, {"original_string": "Invoker<IHelloService> invoker1;", "modifier": "", "type": "Invoker<IHelloService>", "declarator": "invoker1", "var_name": "invoker1"}, {"original_string": "Invoker<IHelloService> invoker2;", "modifier": "", "type": "Invoker<IHelloService>", "declarator": "invoker2", "var_name": "invoker2"}, {"original_string": "Invoker<IHelloService> invoker3;", "modifier": "", "type": "Invoker<IHelloService>", "declarator": "invoker3", "var_name": "invoker3"}, {"original_string": "Invoker<IHelloService> invoker4;", "modifier": "", "type": "Invoker<IHelloService>", "declarator": "invoker4", "var_name": "invoker4"}, {"original_string": "Invoker<IHelloService> invoker5;", "modifier": "", "type": "Invoker<IHelloService>", "declarator": "invoker5", "var_name": "invoker5"}, {"original_string": "Invoker<IHelloService> mockedInvoker1;", "modifier": "", "type": "Invoker<IHelloService>", "declarator": "mockedInvoker1", "var_name": "mockedInvoker1"}], "file": "dubbo-cluster/src/test/java/com/alibaba/dubbo/rpc/cluster/support/AbstractClusterInvokerTest.java"}, "test_case": {"identifier": "testDonotSelectAgainAndNoCheckAvailable", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testDonotSelectAgainAndNoCheckAvailable() {\n\n        LoadBalance lb = ExtensionLoader.getExtensionLoader(LoadBalance.class).getExtension(RoundRobinLoadBalance.NAME);\n        initlistsize5();\n        {\n            //Boundary condition test .\n            selectedInvokers.clear();\n            selectedInvokers.add(invoker2);\n            selectedInvokers.add(invoker3);\n            selectedInvokers.add(invoker4);\n            selectedInvokers.add(invoker5);\n            Invoker sinvoker = cluster_nocheck.select(lb, invocation, invokers, selectedInvokers);\n            Assert.assertSame(invoker1, sinvoker);\n        }\n        {\n            //Boundary condition test .\n            selectedInvokers.clear();\n            selectedInvokers.add(invoker1);\n            selectedInvokers.add(invoker3);\n            selectedInvokers.add(invoker4);\n            selectedInvokers.add(invoker5);\n            Invoker sinvoker = cluster_nocheck.select(lb, invocation, invokers, selectedInvokers);\n            Assert.assertSame(invoker2, sinvoker);\n        }\n        {\n            //Boundary condition test .\n            selectedInvokers.clear();\n            selectedInvokers.add(invoker1);\n            selectedInvokers.add(invoker2);\n            selectedInvokers.add(invoker4);\n            selectedInvokers.add(invoker5);\n            Invoker sinvoker = cluster_nocheck.select(lb, invocation, invokers, selectedInvokers);\n            Assert.assertSame(invoker3, sinvoker);\n        }\n        {\n            //Boundary condition test .\n            selectedInvokers.clear();\n            selectedInvokers.add(invoker1);\n            selectedInvokers.add(invoker2);\n            selectedInvokers.add(invoker3);\n            selectedInvokers.add(invoker4);\n            Invoker sinvoker = cluster_nocheck.select(lb, invocation, invokers, selectedInvokers);\n            Assert.assertSame(invoker5, sinvoker);\n        }\n        {\n            //Boundary condition test .\n            selectedInvokers.clear();\n            selectedInvokers.add(invoker1);\n            selectedInvokers.add(invoker2);\n            selectedInvokers.add(invoker3);\n            selectedInvokers.add(invoker4);\n            selectedInvokers.add(invoker5);\n            Invoker sinvoker = cluster_nocheck.select(lb, invocation, invokers, selectedInvokers);\n            Assert.assertTrue(invokers.contains(sinvoker));\n        }\n\n    }", "signature": "void testDonotSelectAgainAndNoCheckAvailable()", "full_signature": "@Test public void testDonotSelectAgainAndNoCheckAvailable()", "class_method_signature": "AbstractClusterInvokerTest.testDonotSelectAgainAndNoCheckAvailable()", "testcase": true, "constructor": false, "invocations": ["getExtension", "getExtensionLoader", "initlistsize5", "clear", "add", "add", "add", "add", "select", "assertSame", "clear", "add", "add", "add", "add", "select", "assertSame", "clear", "add", "add", "add", "add", "select", "assertSame", "clear", "add", "add", "add", "add", "select", "assertSame", "clear", "add", "add", "add", "add", "add", "select", "assertTrue", "contains"]}, "focal_class": {"identifier": "AbstractClusterInvoker", "superclass": "", "interfaces": "implements Invoker<T>", "fields": [{"original_string": "private static final Logger logger = LoggerFactory\n            .getLogger(AbstractClusterInvoker.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory\n            .getLogger(AbstractClusterInvoker.class)", "var_name": "logger"}, {"original_string": "protected final Directory<T> directory;", "modifier": "protected final", "type": "Directory<T>", "declarator": "directory", "var_name": "directory"}, {"original_string": "protected final boolean availablecheck;", "modifier": "protected final", "type": "boolean", "declarator": "availablecheck", "var_name": "availablecheck"}, {"original_string": "private AtomicBoolean destroyed = new AtomicBoolean(false);", "modifier": "private", "type": "AtomicBoolean", "declarator": "destroyed = new AtomicBoolean(false)", "var_name": "destroyed"}, {"original_string": "private volatile Invoker<T> stickyInvoker = null;", "modifier": "private volatile", "type": "Invoker<T>", "declarator": "stickyInvoker = null", "var_name": "stickyInvoker"}], "methods": [{"identifier": "AbstractClusterInvoker", "parameters": "(Directory<T> directory)", "modifiers": "public", "return": "", "signature": " AbstractClusterInvoker(Directory<T> directory)", "full_signature": "public  AbstractClusterInvoker(Directory<T> directory)", "class_method_signature": "AbstractClusterInvoker.AbstractClusterInvoker(Directory<T> directory)", "testcase": false, "constructor": true}, {"identifier": "AbstractClusterInvoker", "parameters": "(Directory<T> directory, URL url)", "modifiers": "public", "return": "", "signature": " AbstractClusterInvoker(Directory<T> directory, URL url)", "full_signature": "public  AbstractClusterInvoker(Directory<T> directory, URL url)", "class_method_signature": "AbstractClusterInvoker.AbstractClusterInvoker(Directory<T> directory, URL url)", "testcase": false, "constructor": true}, {"identifier": "getInterface", "parameters": "()", "modifiers": "@Override public", "return": "Class<T>", "signature": "Class<T> getInterface()", "full_signature": "@Override public Class<T> getInterface()", "class_method_signature": "AbstractClusterInvoker.getInterface()", "testcase": false, "constructor": false}, {"identifier": "getUrl", "parameters": "()", "modifiers": "@Override public", "return": "URL", "signature": "URL getUrl()", "full_signature": "@Override public URL getUrl()", "class_method_signature": "AbstractClusterInvoker.getUrl()", "testcase": false, "constructor": false}, {"identifier": "isAvailable", "parameters": "()", "modifiers": "@Override public", "return": "boolean", "signature": "boolean isAvailable()", "full_signature": "@Override public boolean isAvailable()", "class_method_signature": "AbstractClusterInvoker.isAvailable()", "testcase": false, "constructor": false}, {"identifier": "destroy", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void destroy()", "full_signature": "@Override public void destroy()", "class_method_signature": "AbstractClusterInvoker.destroy()", "testcase": false, "constructor": false}, {"identifier": "select", "parameters": "(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "modifiers": "protected", "return": "Invoker<T>", "signature": "Invoker<T> select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "full_signature": "protected Invoker<T> select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "class_method_signature": "AbstractClusterInvoker.select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "testcase": false, "constructor": false}, {"identifier": "doSelect", "parameters": "(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "modifiers": "private", "return": "Invoker<T>", "signature": "Invoker<T> doSelect(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "full_signature": "private Invoker<T> doSelect(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "class_method_signature": "AbstractClusterInvoker.doSelect(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "testcase": false, "constructor": false}, {"identifier": "reselect", "parameters": "(LoadBalance loadbalance, Invocation invocation,\n                                List<Invoker<T>> invokers, List<Invoker<T>> selected, boolean availablecheck)", "modifiers": "private", "return": "Invoker<T>", "signature": "Invoker<T> reselect(LoadBalance loadbalance, Invocation invocation,\n                                List<Invoker<T>> invokers, List<Invoker<T>> selected, boolean availablecheck)", "full_signature": "private Invoker<T> reselect(LoadBalance loadbalance, Invocation invocation,\n                                List<Invoker<T>> invokers, List<Invoker<T>> selected, boolean availablecheck)", "class_method_signature": "AbstractClusterInvoker.reselect(LoadBalance loadbalance, Invocation invocation,\n                                List<Invoker<T>> invokers, List<Invoker<T>> selected, boolean availablecheck)", "testcase": false, "constructor": false}, {"identifier": "invoke", "parameters": "(final Invocation invocation)", "modifiers": "@Override public", "return": "Result", "signature": "Result invoke(final Invocation invocation)", "full_signature": "@Override public Result invoke(final Invocation invocation)", "class_method_signature": "AbstractClusterInvoker.invoke(final Invocation invocation)", "testcase": false, "constructor": false}, {"identifier": "checkWhetherDestroyed", "parameters": "()", "modifiers": "protected", "return": "void", "signature": "void checkWhetherDestroyed()", "full_signature": "protected void checkWhetherDestroyed()", "class_method_signature": "AbstractClusterInvoker.checkWhetherDestroyed()", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "AbstractClusterInvoker.toString()", "testcase": false, "constructor": false}, {"identifier": "checkInvokers", "parameters": "(List<Invoker<T>> invokers, Invocation invocation)", "modifiers": "protected", "return": "void", "signature": "void checkInvokers(List<Invoker<T>> invokers, Invocation invocation)", "full_signature": "protected void checkInvokers(List<Invoker<T>> invokers, Invocation invocation)", "class_method_signature": "AbstractClusterInvoker.checkInvokers(List<Invoker<T>> invokers, Invocation invocation)", "testcase": false, "constructor": false}, {"identifier": "doInvoke", "parameters": "(Invocation invocation, List<Invoker<T>> invokers,\n                                       LoadBalance loadbalance)", "modifiers": "protected abstract", "return": "Result", "signature": "Result doInvoke(Invocation invocation, List<Invoker<T>> invokers,\n                                       LoadBalance loadbalance)", "full_signature": "protected abstract Result doInvoke(Invocation invocation, List<Invoker<T>> invokers,\n                                       LoadBalance loadbalance)", "class_method_signature": "AbstractClusterInvoker.doInvoke(Invocation invocation, List<Invoker<T>> invokers,\n                                       LoadBalance loadbalance)", "testcase": false, "constructor": false}, {"identifier": "list", "parameters": "(Invocation invocation)", "modifiers": "protected", "return": "List<Invoker<T>>", "signature": "List<Invoker<T>> list(Invocation invocation)", "full_signature": "protected List<Invoker<T>> list(Invocation invocation)", "class_method_signature": "AbstractClusterInvoker.list(Invocation invocation)", "testcase": false, "constructor": false}], "file": "dubbo-cluster/src/main/java/com/alibaba/dubbo/rpc/cluster/support/AbstractClusterInvoker.java"}, "focal_method": {"identifier": "select", "parameters": "(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "modifiers": "protected", "return": "Invoker<T>", "body": "protected Invoker<T> select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected) throws RpcException {\n        if (invokers == null || invokers.isEmpty())\n            return null;\n        // \u83b7\u53d6\u8c03\u7528\u65b9\u6cd5\u540d\n        String methodName = invocation == null ? \"\" : invocation.getMethodName();\n\n        boolean sticky = invokers.get(0).getUrl().getMethodParameter(methodName, Constants.CLUSTER_STICKY_KEY, Constants.DEFAULT_CLUSTER_STICKY);\n        {\n            //ignore overloaded method\n            if (stickyInvoker != null && !invokers.contains(stickyInvoker)) {\n                stickyInvoker = null;\n            }\n            //ignore concurrency problem\n            if (sticky && stickyInvoker != null && (selected == null || !selected.contains(stickyInvoker))) {\n                if (availablecheck && stickyInvoker.isAvailable()) {\n                    return stickyInvoker;\n                }\n            }\n        }\n        Invoker<T> invoker = doSelect(loadbalance, invocation, invokers, selected);\n\n        if (sticky) {\n            stickyInvoker = invoker;\n        }\n        return invoker;\n    }", "signature": "Invoker<T> select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "full_signature": "protected Invoker<T> select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "class_method_signature": "AbstractClusterInvoker.select(LoadBalance loadbalance, Invocation invocation, List<Invoker<T>> invokers, List<Invoker<T>> selected)", "testcase": false, "constructor": false, "invocations": ["isEmpty", "getMethodName", "getMethodParameter", "getUrl", "get", "contains", "contains", "isAvailable", "doSelect"]}, "repository": {"repo_id": 189562861, "url": "https://github.com/smallFive55/dubbo-dubbo-2.6.6", "language": "Java", "is_fork": false, "fork_count": 11, "stargazer_count": 8, "size": 1428, "license": "licensed"}}