{"test_class": {"identifier": "DistributedDataTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "static ExampleData exampleData = null;", "modifier": "static", "type": "ExampleData", "declarator": "exampleData = null", "var_name": "exampleData"}], "file": "adfs-hdfs-project/adfs-hdfs/src/test/java/com/taobao/adfs/distributed/DistributedDataTest.java"}, "test_case": {"identifier": "format", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void format() throws Exception {\n    exampleData.write(\"jiwan@taobao.com\");\n    assertThat(exampleData.getDataVersion() == 1, is(true));\n    assertThat(exampleData.read().equals(\"jiwan@taobao.com\"), is(true));\n    exampleData.format();\n    assertThat(exampleData.getDataVersion() == 0, is(true));\n    assertThat(exampleData.read().isEmpty(), is(true));\n  }", "signature": "void format()", "full_signature": "@Test public void format()", "class_method_signature": "DistributedDataTest.format()", "testcase": true, "constructor": false, "invocations": ["write", "assertThat", "getDataVersion", "is", "assertThat", "equals", "read", "is", "format", "assertThat", "getDataVersion", "is", "assertThat", "isEmpty", "read", "is"]}, "focal_class": {"identifier": "DistributedData", "superclass": "", "interfaces": "implements Writable", "fields": [{"original_string": "public static final Logger logger = LoggerFactory.getLogger(DistributedData.class);", "modifier": "public static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(DistributedData.class)", "var_name": "logger"}, {"original_string": "public Configuration conf = null;", "modifier": "public", "type": "Configuration", "declarator": "conf = null", "var_name": "conf"}, {"original_string": "protected DistributedDataVersion version = new DistributedDataVersion();", "modifier": "protected", "type": "DistributedDataVersion", "declarator": "version = new DistributedDataVersion()", "var_name": "version"}, {"original_string": "protected ReentrantReadWriteLockExtension getDataLocker = null;", "modifier": "protected", "type": "ReentrantReadWriteLockExtension", "declarator": "getDataLocker = null", "var_name": "getDataLocker"}, {"original_string": "protected DistributedOperationQueue operationQueue = new DistributedOperationQueue();", "modifier": "protected", "type": "DistributedOperationQueue", "declarator": "operationQueue = new DistributedOperationQueue()", "var_name": "operationQueue"}, {"original_string": "private Map<String, Object> elementsToTransfer = new HashMap<String, Object>();", "modifier": "private", "type": "Map<String, Object>", "declarator": "elementsToTransfer = new HashMap<String, Object>()", "var_name": "elementsToTransfer"}, {"original_string": "static Map<Method, Class<?>> distributedOperationTypeCache = new HashMap<Method, Class<?>>();", "modifier": "static", "type": "Map<Method, Class<?>>", "declarator": "distributedOperationTypeCache = new HashMap<Method, Class<?>>()", "var_name": "distributedOperationTypeCache"}], "methods": [{"identifier": "DistributedData", "parameters": "()", "modifiers": "public", "return": "", "signature": " DistributedData()", "full_signature": "public  DistributedData()", "class_method_signature": "DistributedData.DistributedData()", "testcase": false, "constructor": true}, {"identifier": "setDataLocker", "parameters": "(ReentrantReadWriteLockExtension getDataLocker)", "modifiers": "public", "return": "ReentrantReadWriteLockExtension", "signature": "ReentrantReadWriteLockExtension setDataLocker(ReentrantReadWriteLockExtension getDataLocker)", "full_signature": "public ReentrantReadWriteLockExtension setDataLocker(ReentrantReadWriteLockExtension getDataLocker)", "class_method_signature": "DistributedData.setDataLocker(ReentrantReadWriteLockExtension getDataLocker)", "testcase": false, "constructor": false}, {"identifier": "initialize", "parameters": "()", "modifiers": "protected", "return": "void", "signature": "void initialize()", "full_signature": "protected void initialize()", "class_method_signature": "DistributedData.initialize()", "testcase": false, "constructor": false}, {"identifier": "createDataPath", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void createDataPath()", "full_signature": "private void createDataPath()", "class_method_signature": "DistributedData.createDataPath()", "testcase": false, "constructor": false}, {"identifier": "getDataPath", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getDataPath()", "full_signature": "public String getDataPath()", "class_method_signature": "DistributedData.getDataPath()", "testcase": false, "constructor": false}, {"identifier": "open", "parameters": "()", "modifiers": "synchronized public", "return": "void", "signature": "void open()", "full_signature": "synchronized public void open()", "class_method_signature": "DistributedData.open()", "testcase": false, "constructor": false}, {"identifier": "becomeMasterPre", "parameters": "(ServerType oldServerType)", "modifiers": "synchronized public final", "return": "boolean", "signature": "boolean becomeMasterPre(ServerType oldServerType)", "full_signature": "synchronized public final boolean becomeMasterPre(ServerType oldServerType)", "class_method_signature": "DistributedData.becomeMasterPre(ServerType oldServerType)", "testcase": false, "constructor": false}, {"identifier": "becomeMasterPost", "parameters": "(ServerType oldServerType)", "modifiers": "synchronized public final", "return": "boolean", "signature": "boolean becomeMasterPost(ServerType oldServerType)", "full_signature": "synchronized public final boolean becomeMasterPost(ServerType oldServerType)", "class_method_signature": "DistributedData.becomeMasterPost(ServerType oldServerType)", "testcase": false, "constructor": false}, {"identifier": "leaveMasterPre", "parameters": "(ServerType newServerType)", "modifiers": "synchronized public final", "return": "boolean", "signature": "boolean leaveMasterPre(ServerType newServerType)", "full_signature": "synchronized public final boolean leaveMasterPre(ServerType newServerType)", "class_method_signature": "DistributedData.leaveMasterPre(ServerType newServerType)", "testcase": false, "constructor": false}, {"identifier": "leaveMasterPost", "parameters": "(ServerType newServerType)", "modifiers": "synchronized public final", "return": "boolean", "signature": "boolean leaveMasterPost(ServerType newServerType)", "full_signature": "synchronized public final boolean leaveMasterPost(ServerType newServerType)", "class_method_signature": "DistributedData.leaveMasterPost(ServerType newServerType)", "testcase": false, "constructor": false}, {"identifier": "becomeMasterPreInteranl", "parameters": "(ServerType oldServerType)", "modifiers": "public", "return": "boolean", "signature": "boolean becomeMasterPreInteranl(ServerType oldServerType)", "full_signature": "public boolean becomeMasterPreInteranl(ServerType oldServerType)", "class_method_signature": "DistributedData.becomeMasterPreInteranl(ServerType oldServerType)", "testcase": false, "constructor": false}, {"identifier": "becomeMasterPostInteranl", "parameters": "(ServerType oldServerType)", "modifiers": "public", "return": "boolean", "signature": "boolean becomeMasterPostInteranl(ServerType oldServerType)", "full_signature": "public boolean becomeMasterPostInteranl(ServerType oldServerType)", "class_method_signature": "DistributedData.becomeMasterPostInteranl(ServerType oldServerType)", "testcase": false, "constructor": false}, {"identifier": "leaveMasterPreInteranl", "parameters": "(ServerType newServerType)", "modifiers": "public", "return": "boolean", "signature": "boolean leaveMasterPreInteranl(ServerType newServerType)", "full_signature": "public boolean leaveMasterPreInteranl(ServerType newServerType)", "class_method_signature": "DistributedData.leaveMasterPreInteranl(ServerType newServerType)", "testcase": false, "constructor": false}, {"identifier": "leaveMasterPostInteranl", "parameters": "(ServerType newServerType)", "modifiers": "public", "return": "boolean", "signature": "boolean leaveMasterPostInteranl(ServerType newServerType)", "full_signature": "public boolean leaveMasterPostInteranl(ServerType newServerType)", "class_method_signature": "DistributedData.leaveMasterPostInteranl(ServerType newServerType)", "testcase": false, "constructor": false}, {"identifier": "isValid", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isValid()", "full_signature": "public boolean isValid()", "class_method_signature": "DistributedData.isValid()", "testcase": false, "constructor": false}, {"identifier": "getOperationQueue", "parameters": "()", "modifiers": "public", "return": "DistributedOperationQueue", "signature": "DistributedOperationQueue getOperationQueue()", "full_signature": "public DistributedOperationQueue getOperationQueue()", "class_method_signature": "DistributedData.getOperationQueue()", "testcase": false, "constructor": false}, {"identifier": "openElementToTransfer", "parameters": "(String key, Object defaultValue)", "modifiers": "", "return": "void", "signature": "void openElementToTransfer(String key, Object defaultValue)", "full_signature": " void openElementToTransfer(String key, Object defaultValue)", "class_method_signature": "DistributedData.openElementToTransfer(String key, Object defaultValue)", "testcase": false, "constructor": false}, {"identifier": "close", "parameters": "()", "modifiers": "synchronized public", "return": "void", "signature": "void close()", "full_signature": "synchronized public void close()", "class_method_signature": "DistributedData.close()", "testcase": false, "constructor": false}, {"identifier": "backup", "parameters": "()", "modifiers": "synchronized public", "return": "void", "signature": "void backup()", "full_signature": "synchronized public void backup()", "class_method_signature": "DistributedData.backup()", "testcase": false, "constructor": false}, {"identifier": "format", "parameters": "()", "modifiers": "synchronized public", "return": "void", "signature": "void format()", "full_signature": "synchronized public void format()", "class_method_signature": "DistributedData.format()", "testcase": false, "constructor": false}, {"identifier": "getDataVersion", "parameters": "()", "modifiers": "public", "return": "long", "signature": "long getDataVersion()", "full_signature": "public long getDataVersion()", "class_method_signature": "DistributedData.getDataVersion()", "testcase": false, "constructor": false}, {"identifier": "setDataVersion", "parameters": "(long newVersion)", "modifiers": "public", "return": "long", "signature": "long setDataVersion(long newVersion)", "full_signature": "public long setDataVersion(long newVersion)", "class_method_signature": "DistributedData.setDataVersion(long newVersion)", "testcase": false, "constructor": false}, {"identifier": "readFields", "parameters": "(DataInput in)", "modifiers": "public", "return": "void", "signature": "void readFields(DataInput in)", "full_signature": "public void readFields(DataInput in)", "class_method_signature": "DistributedData.readFields(DataInput in)", "testcase": false, "constructor": false}, {"identifier": "write", "parameters": "(DataOutput out)", "modifiers": "public", "return": "void", "signature": "void write(DataOutput out)", "full_signature": "public void write(DataOutput out)", "class_method_signature": "DistributedData.write(DataOutput out)", "testcase": false, "constructor": false}, {"identifier": "getElementToTransfer", "parameters": "(String key)", "modifiers": "public", "return": "Object", "signature": "Object getElementToTransfer(String key)", "full_signature": "public Object getElementToTransfer(String key)", "class_method_signature": "DistributedData.getElementToTransfer(String key)", "testcase": false, "constructor": false}, {"identifier": "putElementToTransfer", "parameters": "(String key, Object value)", "modifiers": "public", "return": "Object", "signature": "Object putElementToTransfer(String key, Object value)", "full_signature": "public Object putElementToTransfer(String key, Object value)", "class_method_signature": "DistributedData.putElementToTransfer(String key, Object value)", "testcase": false, "constructor": false}, {"identifier": "removeElementToTransfer", "parameters": "(String key)", "modifiers": "public", "return": "Object", "signature": "Object removeElementToTransfer(String key)", "full_signature": "public Object removeElementToTransfer(String key)", "class_method_signature": "DistributedData.removeElementToTransfer(String key)", "testcase": false, "constructor": false}, {"identifier": "getDataProtocols", "parameters": "()", "modifiers": "public", "return": "Class<?>[]", "signature": "Class<?>[] getDataProtocols()", "full_signature": "public Class<?>[] getDataProtocols()", "class_method_signature": "DistributedData.getDataProtocols()", "testcase": false, "constructor": false}, {"identifier": "getData", "parameters": "(DistributedData oldData,\n      ReentrantReadWriteLockExtension.WriteLock writeLock)", "modifiers": "synchronized public", "return": "DistributedData", "signature": "DistributedData getData(DistributedData oldData,\n      ReentrantReadWriteLockExtension.WriteLock writeLock)", "full_signature": "synchronized public DistributedData getData(DistributedData oldData,\n      ReentrantReadWriteLockExtension.WriteLock writeLock)", "class_method_signature": "DistributedData.getData(DistributedData oldData,\n      ReentrantReadWriteLockExtension.WriteLock writeLock)", "testcase": false, "constructor": false}, {"identifier": "getDataAll", "parameters": "(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "modifiers": "public", "return": "DistributedData", "signature": "DistributedData getDataAll(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "full_signature": "public DistributedData getDataAll(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "class_method_signature": "DistributedData.getDataAll(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "testcase": false, "constructor": false}, {"identifier": "getDataIncrement", "parameters": "(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "modifiers": "public", "return": "DistributedData", "signature": "DistributedData getDataIncrement(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "full_signature": "public DistributedData getDataIncrement(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "class_method_signature": "DistributedData.getDataIncrement(DistributedData oldData, ReentrantReadWriteLockExtension.WriteLock writeLock)", "testcase": false, "constructor": false}, {"identifier": "setData", "parameters": "(DistributedData newData)", "modifiers": "public", "return": "void", "signature": "void setData(DistributedData newData)", "full_signature": "public void setData(DistributedData newData)", "class_method_signature": "DistributedData.setData(DistributedData newData)", "testcase": false, "constructor": false}, {"identifier": "setDataAll", "parameters": "(DistributedData newData)", "modifiers": "public", "return": "void", "signature": "void setDataAll(DistributedData newData)", "full_signature": "public void setDataAll(DistributedData newData)", "class_method_signature": "DistributedData.setDataAll(DistributedData newData)", "testcase": false, "constructor": false}, {"identifier": "setDataIncrement", "parameters": "(DistributedData newData)", "modifiers": "public", "return": "void", "signature": "void setDataIncrement(DistributedData newData)", "full_signature": "public void setDataIncrement(DistributedData newData)", "class_method_signature": "DistributedData.setDataIncrement(DistributedData newData)", "testcase": false, "constructor": false}, {"identifier": "invoke", "parameters": "(Invocation invocation)", "modifiers": "public", "return": "Object", "signature": "Object invoke(Invocation invocation)", "full_signature": "public Object invoke(Invocation invocation)", "class_method_signature": "DistributedData.invoke(Invocation invocation)", "testcase": false, "constructor": false}, {"identifier": "invokeDirectly", "parameters": "(Invocation invocation)", "modifiers": "public", "return": "Object", "signature": "Object invokeDirectly(Invocation invocation)", "full_signature": "public Object invokeDirectly(Invocation invocation)", "class_method_signature": "DistributedData.invokeDirectly(Invocation invocation)", "testcase": false, "constructor": false}, {"identifier": "getIsInIncrementRestoreStage", "parameters": "(boolean onlyReadFromMemory)", "modifiers": "public", "return": "boolean", "signature": "boolean getIsInIncrementRestoreStage(boolean onlyReadFromMemory)", "full_signature": "public boolean getIsInIncrementRestoreStage(boolean onlyReadFromMemory)", "class_method_signature": "DistributedData.getIsInIncrementRestoreStage(boolean onlyReadFromMemory)", "testcase": false, "constructor": false}, {"identifier": "setIsInIncrementRestoreStage", "parameters": "(boolean isInIncrementRestoreStage, boolean onlyWriteToMemory)", "modifiers": "public", "return": "void", "signature": "void setIsInIncrementRestoreStage(boolean isInIncrementRestoreStage, boolean onlyWriteToMemory)", "full_signature": "public void setIsInIncrementRestoreStage(boolean isInIncrementRestoreStage, boolean onlyWriteToMemory)", "class_method_signature": "DistributedData.setIsInIncrementRestoreStage(boolean isInIncrementRestoreStage, boolean onlyWriteToMemory)", "testcase": false, "constructor": false}, {"identifier": "getIsIncrementRestoreEnabled", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean getIsIncrementRestoreEnabled()", "full_signature": "public boolean getIsIncrementRestoreEnabled()", "class_method_signature": "DistributedData.getIsIncrementRestoreEnabled()", "testcase": false, "constructor": false}, {"identifier": "setIsIncrementRestoreEnabled", "parameters": "(boolean isIncrementRestoreEnabled)", "modifiers": "public", "return": "void", "signature": "void setIsIncrementRestoreEnabled(boolean isIncrementRestoreEnabled)", "full_signature": "public void setIsIncrementRestoreEnabled(boolean isIncrementRestoreEnabled)", "class_method_signature": "DistributedData.setIsIncrementRestoreEnabled(boolean isIncrementRestoreEnabled)", "testcase": false, "constructor": false}, {"identifier": "getDistributedInvocationType", "parameters": "(Method method)", "modifiers": "public static", "return": "Class<?>", "signature": "Class<?> getDistributedInvocationType(Method method)", "full_signature": "public static Class<?> getDistributedInvocationType(Method method)", "class_method_signature": "DistributedData.getDistributedInvocationType(Method method)", "testcase": false, "constructor": false}, {"identifier": "getDataClientClassName", "parameters": "(String dataClassName)", "modifiers": "public static", "return": "String", "signature": "String getDataClientClassName(String dataClassName)", "full_signature": "public static String getDataClientClassName(String dataClassName)", "class_method_signature": "DistributedData.getDataClientClassName(String dataClassName)", "testcase": false, "constructor": false}], "file": "adfs-hdfs-project/adfs-hdfs/src/main/java/com/taobao/adfs/distributed/DistributedData.java"}, "focal_method": {"identifier": "format", "parameters": "()", "modifiers": "synchronized public", "return": "void", "body": "synchronized public void format() throws IOException {\n    setDataVersion(0);\n    setIsInIncrementRestoreStage(false, false);\n  }", "signature": "void format()", "full_signature": "synchronized public void format()", "class_method_signature": "DistributedData.format()", "testcase": false, "constructor": false, "invocations": ["setDataVersion", "setIsInIncrementRestoreStage"]}, "repository": {"repo_id": 3937799, "url": "https://github.com/taobao/ADFS", "language": "Java", "is_fork": false, "fork_count": 50, "stargazer_count": 108, "size": 53300, "license": "licensed"}}