{"test_class": {"identifier": "ForbiddenCallRuleTest", "superclass": "", "interfaces": "", "fields": [], "file": "cobol-custom-rules/src/test/java/com/mycompany/cobol/sample/checks/ForbiddenCallRuleTest.java"}, "test_case": {"identifier": "testVisitNode", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testVisitNode() {\n    ForbiddenCallRule check = new ForbiddenCallRule();\n    CobolCheckVerifier.verify(\n      new File(\"src/test/resources/checks/SRC/ForbiddenCall.cbl\"),\n      check);\n  }", "signature": "void testVisitNode()", "full_signature": "@Test public void testVisitNode()", "class_method_signature": "ForbiddenCallRuleTest.testVisitNode()", "testcase": true, "constructor": false, "invocations": ["verify"]}, "focal_class": {"identifier": "ForbiddenCallRule", "superclass": "extends CobolCheck", "interfaces": "", "fields": [], "methods": [{"identifier": "init", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void init()", "full_signature": "@Override public void init()", "class_method_signature": "ForbiddenCallRule.init()", "testcase": false, "constructor": false}, {"identifier": "visitNode", "parameters": "(AstNode callStatementNode)", "modifiers": "@Override public", "return": "void", "signature": "void visitNode(AstNode callStatementNode)", "full_signature": "@Override public void visitNode(AstNode callStatementNode)", "class_method_signature": "ForbiddenCallRule.visitNode(AstNode callStatementNode)", "testcase": false, "constructor": false}], "file": "cobol-custom-rules/src/main/java/com/mycompany/cobol/sample/checks/ForbiddenCallRule.java"}, "focal_method": {"identifier": "visitNode", "parameters": "(AstNode callStatementNode)", "modifiers": "@Override public", "return": "void", "body": "@Override\n  public void visitNode(AstNode callStatementNode) {\n    AstNode calledProgramNode = callStatementNode.getFirstChild(getCobolGrammar().literal);\n    if (calledProgramNode != null && calledProgramNode.getTokenValue().indexOf(\"FORBIDDEN\") > -1) {\n      reportIssue(\"CALL to this program are forbidden.\").on(calledProgramNode);\n    }\n  }", "signature": "void visitNode(AstNode callStatementNode)", "full_signature": "@Override public void visitNode(AstNode callStatementNode)", "class_method_signature": "ForbiddenCallRule.visitNode(AstNode callStatementNode)", "testcase": false, "constructor": false, "invocations": ["getFirstChild", "getCobolGrammar", "indexOf", "getTokenValue", "on", "reportIssue"]}, "repository": {"repo_id": 71792401, "url": "https://github.com/SonarSource/sonar-custom-rules-examples", "language": "Java", "is_fork": false, "fork_count": 349, "stargazer_count": 156, "size": 190, "license": "licensed"}}