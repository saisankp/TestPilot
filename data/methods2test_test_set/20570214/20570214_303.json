{"test_class": {"identifier": "Ed25519SignTest", "superclass": "", "interfaces": "", "fields": [], "file": "java_src/src/test/java/com/google/crypto/tink/subtle/Ed25519SignTest.java"}, "test_case": {"identifier": "testSigningWithWycheproofVectors", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testSigningWithWycheproofVectors() throws Exception {\n    JSONObject json =\n        WycheproofTestUtil.readJson(\"../wycheproof/testvectors/eddsa_test.json\");\n    int errors = 0;\n    JSONArray testGroups = json.getJSONArray(\"testGroups\");\n    for (int i = 0; i < testGroups.length(); i++) {\n      JSONObject group = testGroups.getJSONObject(i);\n      JSONObject key = group.getJSONObject(\"key\");\n      byte[] privateKey = Hex.decode(key.getString(\"sk\"));\n      JSONArray tests = group.getJSONArray(\"tests\");\n      for (int j = 0; j < tests.length(); j++) {\n        JSONObject testcase = tests.getJSONObject(j);\n        String tcId =\n            String.format(\n                \"testcase %d (%s)\", testcase.getInt(\"tcId\"), testcase.getString(\"comment\"));\n        byte[] msg = getMessage(testcase);\n        byte[] sig = Hex.decode(testcase.getString(\"sig\"));\n        String result = testcase.getString(\"result\");\n        if (result.equals(\"invalid\")) {\n          continue;\n        }\n        Ed25519Sign signer = new Ed25519Sign(privateKey);\n        byte[] computedSig = signer.sign(msg);\n        assertArrayEquals(tcId, sig, computedSig);\n      }\n    }\n    assertEquals(0, errors);\n  }", "signature": "void testSigningWithWycheproofVectors()", "full_signature": "@Test public void testSigningWithWycheproofVectors()", "class_method_signature": "Ed25519SignTest.testSigningWithWycheproofVectors()", "testcase": true, "constructor": false, "invocations": ["readJson", "getJSONArray", "length", "getJSONObject", "getJSONObject", "decode", "getString", "getJSONArray", "length", "getJSONObject", "format", "getInt", "getString", "getMessage", "decode", "getString", "getString", "equals", "sign", "assertArrayEquals", "assertEquals"]}, "focal_class": {"identifier": "Ed25519Sign", "superclass": "", "interfaces": "implements PublicKeySign", "fields": [{"original_string": "public static final int SECRET_KEY_LEN = Field25519.FIELD_LEN;", "modifier": "public static final", "type": "int", "declarator": "SECRET_KEY_LEN = Field25519.FIELD_LEN", "var_name": "SECRET_KEY_LEN"}, {"original_string": "private final byte[] hashedPrivateKey;", "modifier": "private final", "type": "byte[]", "declarator": "hashedPrivateKey", "var_name": "hashedPrivateKey"}, {"original_string": "private final byte[] publicKey;", "modifier": "private final", "type": "byte[]", "declarator": "publicKey", "var_name": "publicKey"}], "methods": [{"identifier": "Ed25519Sign", "parameters": "(final byte[] privateKey)", "modifiers": "public", "return": "", "signature": " Ed25519Sign(final byte[] privateKey)", "full_signature": "public  Ed25519Sign(final byte[] privateKey)", "class_method_signature": "Ed25519Sign.Ed25519Sign(final byte[] privateKey)", "testcase": false, "constructor": true}, {"identifier": "sign", "parameters": "(final byte[] data)", "modifiers": "@Override public", "return": "byte[]", "signature": "byte[] sign(final byte[] data)", "full_signature": "@Override public byte[] sign(final byte[] data)", "class_method_signature": "Ed25519Sign.sign(final byte[] data)", "testcase": false, "constructor": false}], "file": "java_src/src/main/java/com/google/crypto/tink/subtle/Ed25519Sign.java"}, "focal_method": {"identifier": "sign", "parameters": "(final byte[] data)", "modifiers": "@Override public", "return": "byte[]", "body": "@Override\n  public byte[] sign(final byte[] data) throws GeneralSecurityException {\n    return Ed25519.sign(data, publicKey, hashedPrivateKey);\n  }", "signature": "byte[] sign(final byte[] data)", "full_signature": "@Override public byte[] sign(final byte[] data)", "class_method_signature": "Ed25519Sign.sign(final byte[] data)", "testcase": false, "constructor": false, "invocations": ["sign"]}, "repository": {"repo_id": 20570214, "url": "https://github.com/google/tink", "stars": 8884, "created": "6/6/2014 4:21:09 PM +00:00", "updates": "2020-01-27T11:52:16+00:00", "fork": "False", "license": "licensed"}}