{"test_class": {"identifier": "RateServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String BRE = \"BRE\";", "modifier": "private static final", "type": "String", "declarator": "BRE = \"BRE\"", "var_name": "BRE"}, {"original_string": "@Autowired\n\tprivate HistoricalRateRepository histoRepo;", "modifier": "@Autowired\n\tprivate", "type": "HistoricalRateRepository", "declarator": "histoRepo", "var_name": "histoRepo"}, {"original_string": "@Autowired\n\tprivate RateService rateService;", "modifier": "@Autowired\n\tprivate", "type": "RateService", "declarator": "rateService", "var_name": "rateService"}], "file": "trading-common/src/test/java/fr/ymanvieu/trading/common/rate/RateServiceTest.java"}, "test_case": {"identifier": "testGetLatest_Computed", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testGetLatest_Computed() {\n\n\t\tRate result = rateService.getLatest(EUR, GBP);\n\n\t\tassertThat(result.getFromcur().getCode()).isEqualTo(EUR);\n\t\tassertThat(result.getTocur().getCode()).isEqualTo(GBP);\n\t\tassertThat(result.getValue()).isEqualByComparingTo(\"0.7556613636\");\n\t\tassertThat(result.getDate()).isEqualTo(parse(\"2015-02-02T08:42:50\"));\n\t}", "signature": "void testGetLatest_Computed()", "full_signature": "@Test public void testGetLatest_Computed()", "class_method_signature": "RateServiceTest.testGetLatest_Computed()", "testcase": true, "constructor": false, "invocations": ["getLatest", "isEqualTo", "assertThat", "getCode", "getFromcur", "isEqualTo", "assertThat", "getCode", "getTocur", "isEqualByComparingTo", "assertThat", "getValue", "isEqualTo", "assertThat", "getDate", "parse"]}, "focal_class": {"identifier": "RateService", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String BASE_CURRENCY = CurrencyUtils.USD;", "modifier": "private static final", "type": "String", "declarator": "BASE_CURRENCY = CurrencyUtils.USD", "var_name": "BASE_CURRENCY"}, {"original_string": "private static final Sort SORT_ASC_DATE = Sort.by(Direction.ASC, \"date\");", "modifier": "private static final", "type": "Sort", "declarator": "SORT_ASC_DATE = Sort.by(Direction.ASC, \"date\")", "var_name": "SORT_ASC_DATE"}, {"original_string": "private static final Sort SORT_DESC_DATE = Sort.by(Direction.DESC, \"date\");", "modifier": "private static final", "type": "Sort", "declarator": "SORT_DESC_DATE = Sort.by(Direction.DESC, \"date\")", "var_name": "SORT_DESC_DATE"}, {"original_string": "@Autowired\n\tprivate HistoricalRateRepository historicalRateRepository;", "modifier": "@Autowired\n\tprivate", "type": "HistoricalRateRepository", "declarator": "historicalRateRepository", "var_name": "historicalRateRepository"}, {"original_string": "@Autowired\n\tprivate LatestRateRepository latestRateRepository;", "modifier": "@Autowired\n\tprivate", "type": "LatestRateRepository", "declarator": "latestRateRepository", "var_name": "latestRateRepository"}, {"original_string": "@Autowired\n\tprivate SymbolRepository symbolRepository;", "modifier": "@Autowired\n\tprivate", "type": "SymbolRepository", "declarator": "symbolRepository", "var_name": "symbolRepository"}, {"original_string": "@Autowired\n\tprivate RateMapper rateMapper;", "modifier": "@Autowired\n\tprivate", "type": "RateMapper", "declarator": "rateMapper", "var_name": "rateMapper"}], "methods": [{"identifier": "getAllLatestWithFavorites", "parameters": "(String username)", "modifiers": "public", "return": "List<FavoriteRate>", "signature": "List<FavoriteRate> getAllLatestWithFavorites(String username)", "full_signature": "public List<FavoriteRate> getAllLatestWithFavorites(String username)", "class_method_signature": "RateService.getAllLatestWithFavorites(String username)", "testcase": false, "constructor": false}, {"identifier": "getOldestRateDate", "parameters": "(String fromcur, String tocur)", "modifiers": "public", "return": "Instant", "signature": "Instant getOldestRateDate(String fromcur, String tocur)", "full_signature": "public Instant getOldestRateDate(String fromcur, String tocur)", "class_method_signature": "RateService.getOldestRateDate(String fromcur, String tocur)", "testcase": false, "constructor": false}, {"identifier": "getNewestRateDate", "parameters": "(String fromcur, String tocur)", "modifiers": "public", "return": "Instant", "signature": "Instant getNewestRateDate(String fromcur, String tocur)", "full_signature": "public Instant getNewestRateDate(String fromcur, String tocur)", "class_method_signature": "RateService.getNewestRateDate(String fromcur, String tocur)", "testcase": false, "constructor": false}, {"identifier": "getLatest", "parameters": "(String fromcur, String tocur)", "modifiers": "public", "return": "Rate", "signature": "Rate getLatest(String fromcur, String tocur)", "full_signature": "public Rate getLatest(String fromcur, String tocur)", "class_method_signature": "RateService.getLatest(String fromcur, String tocur)", "testcase": false, "constructor": false}, {"identifier": "addLatestRate", "parameters": "(Quote quote)", "modifiers": "public", "return": "void", "signature": "void addLatestRate(Quote quote)", "full_signature": "public void addLatestRate(Quote quote)", "class_method_signature": "RateService.addLatestRate(Quote quote)", "testcase": false, "constructor": false}, {"identifier": "getHistoricalValues", "parameters": "(String fromcur, String tocur, Instant startDate, Instant endDate)", "modifiers": "public", "return": "List<DateValue>", "signature": "List<DateValue> getHistoricalValues(String fromcur, String tocur, Instant startDate, Instant endDate)", "full_signature": "public List<DateValue> getHistoricalValues(String fromcur, String tocur, Instant startDate, Instant endDate)", "class_method_signature": "RateService.getHistoricalValues(String fromcur, String tocur, Instant startDate, Instant endDate)", "testcase": false, "constructor": false}, {"identifier": "addHistoricalRates", "parameters": "(List<Quote> quotes)", "modifiers": "@Transactional public", "return": "void", "signature": "void addHistoricalRates(List<Quote> quotes)", "full_signature": "@Transactional public void addHistoricalRates(List<Quote> quotes)", "class_method_signature": "RateService.addHistoricalRates(List<Quote> quotes)", "testcase": false, "constructor": false}], "file": "trading-common/src/main/java/fr/ymanvieu/trading/common/rate/RateService.java"}, "focal_method": {"identifier": "getLatest", "parameters": "(String fromcur, String tocur)", "modifiers": "public", "return": "Rate", "body": "public Rate getLatest(String fromcur, String tocur) {\n\t\t\n\t\tLatestRate lr = latestRateRepository.findByFromcurCodeAndTocurCode(fromcur, tocur);\n\n\t\tif (lr != null) {\n\t\t\treturn rateMapper.mapToRate(lr);\n\t\t}\n\n\t\tLatestRate lrBaseCurrency = latestRateRepository.findByFromcurCodeAndTocurCode(BASE_CURRENCY, tocur);\n\n\t\tLatestRate lrBaseCurrencyFromcur = latestRateRepository.findByFromcurCodeAndTocurCode(BASE_CURRENCY, fromcur);\n\n\t\tfinal BigDecimal rate;\n\t\tfinal SymbolEntity symbolFromcur;\n\t\tfinal SymbolEntity symbolTocur;\n\n\t\tInstant rateDate = lrBaseCurrencyFromcur.getDate();\n\n\t\tif (BASE_CURRENCY.equals(tocur)) {\n\t\t\trate = MathUtils.invert(lrBaseCurrencyFromcur.getValue());\n\t\t\tsymbolFromcur = lrBaseCurrencyFromcur.getTocur();\n\t\t\tsymbolTocur = lrBaseCurrencyFromcur.getFromcur();\n\t\t} else {\n\t\t\trate = MathUtils.divide(lrBaseCurrency.getValue(), lrBaseCurrencyFromcur.getValue());\n\n\t\t\tif (rateDate.isBefore(lrBaseCurrency.getDate())) {\n\t\t\t\trateDate = lrBaseCurrency.getDate();\n\t\t\t}\n\n\t\t\tsymbolFromcur = lrBaseCurrencyFromcur.getTocur();\n\t\t\tsymbolTocur = lrBaseCurrency.getTocur();\n\t\t}\n\n\t\treturn rateMapper.mapToRate(new LatestRate(symbolFromcur, symbolTocur, rate, rateDate));\n\t}", "signature": "Rate getLatest(String fromcur, String tocur)", "full_signature": "public Rate getLatest(String fromcur, String tocur)", "class_method_signature": "RateService.getLatest(String fromcur, String tocur)", "testcase": false, "constructor": false, "invocations": ["findByFromcurCodeAndTocurCode", "mapToRate", "findByFromcurCodeAndTocurCode", "findByFromcurCodeAndTocurCode", "getDate", "equals", "invert", "getValue", "getTocur", "getFromcur", "divide", "getValue", "getValue", "isBefore", "getDate", "getDate", "getTocur", "getTocur", "mapToRate"]}, "repository": {"repo_id": 51700398, "url": "https://github.com/ymanvieu/trading", "language": "Java", "is_fork": false, "fork_count": 0, "stargazer_count": 5, "size": 988, "license": "licensed"}}