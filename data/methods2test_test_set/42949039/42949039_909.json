{"test_class": {"identifier": "AutoRefreshCredentialProviderTest", "superclass": "extends AbstractCoreTest", "interfaces": "", "fields": [], "file": "herd-code/herd-tools/herd-tools-common/src/test/java/org/finra/herd/tools/common/databridge/AutoRefreshCredentialProviderTest.java"}, "test_case": {"identifier": "testAssertCredentialCachingBehavior", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testAssertCredentialCachingBehavior() throws Exception\n    {\n        AutoRefreshCredentialProvider autoRefreshCredentialProvider = new AutoRefreshCredentialProvider()\n        {\n            @Override\n            public AwsCredential getNewAwsCredential() throws Exception\n            {\n                AwsCredential awsCredential = new AwsCredential();\n                GregorianCalendar cal = new GregorianCalendar();\n                cal.setTimeInMillis(System.currentTimeMillis() + 1000);\n                awsCredential.setAwsSessionExpirationTime(DatatypeFactory.newInstance().newXMLGregorianCalendar(cal));\n                return awsCredential;\n            }\n        };\n\n        AwsCredential firstAwsCredential = autoRefreshCredentialProvider.getAwsCredential();\n        AwsCredential secondAwsCredential = autoRefreshCredentialProvider.getAwsCredential();\n        assertEquals(firstAwsCredential, secondAwsCredential);\n        Thread.sleep(1000);\n        secondAwsCredential = autoRefreshCredentialProvider.getAwsCredential();\n        assertNotEquals(firstAwsCredential, secondAwsCredential);\n    }", "signature": "void testAssertCredentialCachingBehavior()", "full_signature": "@Test public void testAssertCredentialCachingBehavior()", "class_method_signature": "AutoRefreshCredentialProviderTest.testAssertCredentialCachingBehavior()", "testcase": true, "constructor": false, "invocations": ["setTimeInMillis", "currentTimeMillis", "setAwsSessionExpirationTime", "newXMLGregorianCalendar", "newInstance", "getAwsCredential", "getAwsCredential", "assertEquals", "sleep", "getAwsCredential", "assertNotEquals"]}, "focal_class": {"identifier": "AutoRefreshCredentialProvider", "superclass": "", "interfaces": "implements HerdAWSCredentialsProvider", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(AutoRefreshCredentialProvider.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(AutoRefreshCredentialProvider.class)", "var_name": "LOGGER"}, {"original_string": "private Long sessionExpirationTime;", "modifier": "private", "type": "Long", "declarator": "sessionExpirationTime", "var_name": "sessionExpirationTime"}, {"original_string": "private AwsCredential currentAwsCredentials;", "modifier": "private", "type": "AwsCredential", "declarator": "currentAwsCredentials", "var_name": "currentAwsCredentials"}], "methods": [{"identifier": "getNewAwsCredential", "parameters": "()", "modifiers": "public abstract", "return": "AwsCredential", "signature": "AwsCredential getNewAwsCredential()", "full_signature": "public abstract AwsCredential getNewAwsCredential()", "class_method_signature": "AutoRefreshCredentialProvider.getNewAwsCredential()", "testcase": false, "constructor": false}, {"identifier": "getAwsCredential", "parameters": "()", "modifiers": "@Override public", "return": "AwsCredential", "signature": "AwsCredential getAwsCredential()", "full_signature": "@Override public AwsCredential getAwsCredential()", "class_method_signature": "AutoRefreshCredentialProvider.getAwsCredential()", "testcase": false, "constructor": false}], "file": "herd-code/herd-tools/herd-tools-common/src/main/java/org/finra/herd/tools/common/databridge/AutoRefreshCredentialProvider.java"}, "focal_method": {"identifier": "getAwsCredential", "parameters": "()", "modifiers": "@Override public", "return": "AwsCredential", "body": "@Override\n    public AwsCredential getAwsCredential()\n    {\n        if (sessionExpirationTime == null || System.currentTimeMillis() >= sessionExpirationTime)\n        {\n            try\n            {\n                currentAwsCredentials = getNewAwsCredential();\n            }\n            catch (Exception e)\n            {\n                LOGGER.warn(\"Error retrieving new credentials. {}\", e.toString(), e);\n                throw new IllegalStateException(e);\n            }\n            sessionExpirationTime = currentAwsCredentials.getAwsSessionExpirationTime().toGregorianCalendar().getTimeInMillis();\n        }\n        return currentAwsCredentials;\n    }", "signature": "AwsCredential getAwsCredential()", "full_signature": "@Override public AwsCredential getAwsCredential()", "class_method_signature": "AutoRefreshCredentialProvider.getAwsCredential()", "testcase": false, "constructor": false, "invocations": ["currentTimeMillis", "getNewAwsCredential", "warn", "toString", "getTimeInMillis", "toGregorianCalendar", "getAwsSessionExpirationTime"]}, "repository": {"repo_id": 42949039, "url": "https://github.com/FINRAOS/herd", "language": "Java", "is_fork": false, "fork_count": 36, "stargazer_count": 120, "size": 205797, "license": "licensed"}}