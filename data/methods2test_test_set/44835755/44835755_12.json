{"test_class": {"identifier": "ResponseUtilsTest", "superclass": "", "interfaces": "", "fields": [], "file": "mesos-rxjava-client/src/test/java/com/mesosphere/mesos/rx/java/ResponseUtilsTest.java"}, "test_case": {"identifier": "attemptToReadErrorResponse_responseContentIgnoredByDefaultWhenNotString", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void attemptToReadErrorResponse_responseContentIgnoredByDefaultWhenNotString() throws Exception {\n        final String errMsg = \"lies\";\n        final byte[] bytes = errMsg.getBytes(StandardCharsets.UTF_8);\n        final HttpClientResponse<ByteBuf> resp = response(Unpooled.copiedBuffer(bytes), (headers) -> {\n            headers.add(\"Content-Type\", \"application/json;charset=utf-8\");\n            headers.add(\"Content-Length\", bytes.length);\n        });\n\n        final String err = ResponseUtils.attemptToReadErrorResponse(resp).toBlocking().first();\n        assertThat(err).isNotEqualTo(\"lies\");\n\n        try {\n            resp.getContent().toBlocking().first();\n        } catch (IllegalStateException e) {\n            assertThat(e.getMessage()).isEqualTo(\"Content stream is already disposed.\");\n        }\n    }", "signature": "void attemptToReadErrorResponse_responseContentIgnoredByDefaultWhenNotString()", "full_signature": "@Test public void attemptToReadErrorResponse_responseContentIgnoredByDefaultWhenNotString()", "class_method_signature": "ResponseUtilsTest.attemptToReadErrorResponse_responseContentIgnoredByDefaultWhenNotString()", "testcase": true, "constructor": false, "invocations": ["getBytes", "response", "copiedBuffer", "add", "add", "first", "toBlocking", "attemptToReadErrorResponse", "isNotEqualTo", "assertThat", "first", "toBlocking", "getContent", "isEqualTo", "assertThat", "getMessage"]}, "focal_class": {"identifier": "ResponseUtils", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "ResponseUtils", "parameters": "()", "modifiers": "private", "return": "", "signature": " ResponseUtils()", "full_signature": "private  ResponseUtils()", "class_method_signature": "ResponseUtils.ResponseUtils()", "testcase": false, "constructor": true}, {"identifier": "attemptToReadErrorResponse", "parameters": "(@NotNull final HttpClientResponse<ByteBuf> resp)", "modifiers": "@NotNull static", "return": "Observable<String>", "signature": "Observable<String> attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp)", "full_signature": "@NotNull static Observable<String> attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp)", "class_method_signature": "ResponseUtils.attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp)", "testcase": false, "constructor": false}, {"identifier": "getErrMsg", "parameters": "(final String contentType)", "modifiers": "private static", "return": "String", "signature": "String getErrMsg(final String contentType)", "full_signature": "private static String getErrMsg(final String contentType)", "class_method_signature": "ResponseUtils.getErrMsg(final String contentType)", "testcase": false, "constructor": false}], "file": "mesos-rxjava-client/src/main/java/com/mesosphere/mesos/rx/java/ResponseUtils.java"}, "focal_method": {"identifier": "attemptToReadErrorResponse", "parameters": "(@NotNull final HttpClientResponse<ByteBuf> resp)", "modifiers": "@NotNull static", "return": "Observable<String>", "body": "@NotNull\n    static Observable<String> attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp) {\n        final HttpResponseHeaders headers = resp.getHeaders();\n        final String contentType = resp.getHeaders().get(HttpHeaderNames.CONTENT_TYPE);\n        if (headers.isContentLengthSet() && headers.getContentLength() > 0 ) {\n            if (contentType != null && contentType.startsWith(\"text/plain\")) {\n                return resp.getContent()\n                    .map(r -> r.toString(StandardCharsets.UTF_8));\n            } else {\n                resp.ignoreContent();\n                final String errMsg = getErrMsg(contentType);\n                return Observable.just(errMsg);\n            }\n        } else {\n            return Observable.just(\"\");\n        }\n    }", "signature": "Observable<String> attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp)", "full_signature": "@NotNull static Observable<String> attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp)", "class_method_signature": "ResponseUtils.attemptToReadErrorResponse(@NotNull final HttpClientResponse<ByteBuf> resp)", "testcase": false, "constructor": false, "invocations": ["getHeaders", "get", "getHeaders", "isContentLengthSet", "getContentLength", "startsWith", "map", "getContent", "toString", "ignoreContent", "getErrMsg", "just", "just"]}, "repository": {"repo_id": 44835755, "url": "https://github.com/mesosphere/mesos-rxjava", "language": "Java", "is_fork": false, "fork_count": 25, "stargazer_count": 40, "size": 666, "license": "licensed"}}