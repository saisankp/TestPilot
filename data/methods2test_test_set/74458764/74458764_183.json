{"test_class": {"identifier": "TestWebXmlParser", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final String invalidDescriptor = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \";", "modifier": "static final", "type": "String", "declarator": "invalidDescriptor = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"", "var_name": "invalidDescriptor"}, {"original_string": "static final String externalEntity = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<!DOCTYPE web-app PUBLIC \\\"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\\\" \"\n      +   \"\\\"http://java.sun.com/dtd/web-app_2_3.dtd\\\">\"\n      + \"<web-app></web-app>\";", "modifier": "static final", "type": "String", "declarator": "externalEntity = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<!DOCTYPE web-app PUBLIC \\\"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\\\" \"\n      +   \"\\\"http://java.sun.com/dtd/web-app_2_3.dtd\\\">\"\n      + \"<web-app></web-app>\"", "var_name": "externalEntity"}, {"original_string": "static final String withInvalidSessionDuration = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config>\" + \"<session-timeout>A</session-timeout>\" + \"</session-config>\" + \"</web-app>\";", "modifier": "static final", "type": "String", "declarator": "withInvalidSessionDuration = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config>\" + \"<session-timeout>A</session-timeout>\" + \"</session-config>\" + \"</web-app>\"", "var_name": "withInvalidSessionDuration"}, {"original_string": "static final String withEmptySessionDuration = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config>\" + \"<session-timeout>A</session-timeout>\" + \"</session-config>\" + \"</web-app>\";", "modifier": "static final", "type": "String", "declarator": "withEmptySessionDuration = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config>\" + \"<session-timeout>A</session-timeout>\" + \"</session-config>\" + \"</web-app>\"", "var_name": "withEmptySessionDuration"}, {"original_string": "static final String withInvalidTrackingMode = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><tracking-mode>BAD</tracking-mode></session-config>\"\n      + \"</web-app>\";", "modifier": "static final", "type": "String", "declarator": "withInvalidTrackingMode = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><tracking-mode>BAD</tracking-mode></session-config>\"\n      + \"</web-app>\"", "var_name": "withInvalidTrackingMode"}, {"original_string": "static final String withUrlTrackingMode = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><tracking-mode>URL</tracking-mode></session-config>\"\n      + \"</web-app>\";", "modifier": "static final", "type": "String", "declarator": "withUrlTrackingMode = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><tracking-mode>URL</tracking-mode></session-config>\"\n      + \"</web-app>\"", "var_name": "withUrlTrackingMode"}, {"original_string": "static final String withSessionConfig = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><cookie-config><secure>false</secure><http-only>true</http-only><path>/test</path></cookie-config>\"\n      + \"<tracking-mode>COOKIE</tracking-mode></session-config>\"\n      + \"</web-app>\";", "modifier": "static final", "type": "String", "declarator": "withSessionConfig = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><cookie-config><secure>false</secure><http-only>true</http-only><path>/test</path></cookie-config>\"\n      + \"<tracking-mode>COOKIE</tracking-mode></session-config>\"\n      + \"</web-app>\"", "var_name": "withSessionConfig"}, {"original_string": "static final String withMultipleTrackingModes = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><cookie-config><secure>false</secure><http-only>true</http-only><path>/test</path></cookie-config>\"\n      + \"<tracking-mode>COOKIE</tracking-mode><tracking-mode>URL</tracking-mode></session-config>\"\n      + \"</web-app>\";", "modifier": "static final", "type": "String", "declarator": "withMultipleTrackingModes = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?>\"\n      + \"<web-app xmlns=\\\"http://java.sun.com/xml/ns/javaee\\\" \"\n      + \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \"\n      + \"version=\\\"3.0\\\" xsi:schemaLocation=\\\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\\\">\"\n      + \"<session-config><cookie-config><secure>false</secure><http-only>true</http-only><path>/test</path></cookie-config>\"\n      + \"<tracking-mode>COOKIE</tracking-mode><tracking-mode>URL</tracking-mode></session-config>\"\n      + \"</web-app>\"", "var_name": "withMultipleTrackingModes"}], "file": "session-replacement/src/test/java/com/amadeus/session/servlet/TestWebXmlParser.java"}, "test_case": {"identifier": "testParseStreamDefaultSessionEmpty", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testParseStreamDefaultSessionEmpty() throws IOException {\n    String webXml = Descriptors.create(WebAppDescriptor.class).version(\"3.0\").exportAsString();\n    try (ByteArrayInputStream bais = new ByteArrayInputStream(webXml.getBytes(\"UTF-8\"))) {\n      SessionConfiguration sessionConfiguration = new SessionConfiguration();\n      WebXmlParser.parseStream(sessionConfiguration, bais);\n      assertEquals(1800, sessionConfiguration.getMaxInactiveInterval());\n    }\n  }", "signature": "void testParseStreamDefaultSessionEmpty()", "full_signature": "@Test public void testParseStreamDefaultSessionEmpty()", "class_method_signature": "TestWebXmlParser.testParseStreamDefaultSessionEmpty()", "testcase": true, "constructor": false, "invocations": ["exportAsString", "version", "create", "getBytes", "parseStream", "assertEquals", "getMaxInactiveInterval"]}, "focal_class": {"identifier": "WebXmlParser", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "WebXmlParser", "parameters": "()", "modifiers": "private", "return": "", "signature": " WebXmlParser()", "full_signature": "private  WebXmlParser()", "class_method_signature": "WebXmlParser.WebXmlParser()", "testcase": false, "constructor": true}, {"identifier": "parseWebXml", "parameters": "(SessionConfiguration conf, ServletContext context)", "modifiers": "static", "return": "void", "signature": "void parseWebXml(SessionConfiguration conf, ServletContext context)", "full_signature": "static void parseWebXml(SessionConfiguration conf, ServletContext context)", "class_method_signature": "WebXmlParser.parseWebXml(SessionConfiguration conf, ServletContext context)", "testcase": false, "constructor": false}, {"identifier": "parseStream", "parameters": "(SessionConfiguration conf, InputStream is)", "modifiers": "static", "return": "void", "signature": "void parseStream(SessionConfiguration conf, InputStream is)", "full_signature": "static void parseStream(SessionConfiguration conf, InputStream is)", "class_method_signature": "WebXmlParser.parseStream(SessionConfiguration conf, InputStream is)", "testcase": false, "constructor": false}, {"identifier": "checkDistributable", "parameters": "(SessionConfiguration conf, Document document, XPath xpath)", "modifiers": "private static", "return": "void", "signature": "void checkDistributable(SessionConfiguration conf, Document document, XPath xpath)", "full_signature": "private static void checkDistributable(SessionConfiguration conf, Document document, XPath xpath)", "class_method_signature": "WebXmlParser.checkDistributable(SessionConfiguration conf, Document document, XPath xpath)", "testcase": false, "constructor": false}, {"identifier": "lookForSessionTimeout", "parameters": "(SessionConfiguration conf, Document document, XPath xpath)", "modifiers": "private static", "return": "void", "signature": "void lookForSessionTimeout(SessionConfiguration conf, Document document, XPath xpath)", "full_signature": "private static void lookForSessionTimeout(SessionConfiguration conf, Document document, XPath xpath)", "class_method_signature": "WebXmlParser.lookForSessionTimeout(SessionConfiguration conf, Document document, XPath xpath)", "testcase": false, "constructor": false}, {"identifier": "lookForSessionConf", "parameters": "(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "modifiers": "private static", "return": "void", "signature": "void lookForSessionConf(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "full_signature": "private static void lookForSessionConf(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "class_method_signature": "WebXmlParser.lookForSessionConf(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "testcase": false, "constructor": false}, {"identifier": "lookForTrackingMode", "parameters": "(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "modifiers": "private static", "return": "void", "signature": "void lookForTrackingMode(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "full_signature": "private static void lookForTrackingMode(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "class_method_signature": "WebXmlParser.lookForTrackingMode(SessionConfiguration sessionConfiguration, Document document, XPath xpath)", "testcase": false, "constructor": false}, {"identifier": "sessionTracking", "parameters": "(String trackingMode)", "modifiers": "private static", "return": "String", "signature": "String sessionTracking(String trackingMode)", "full_signature": "private static String sessionTracking(String trackingMode)", "class_method_signature": "WebXmlParser.sessionTracking(String trackingMode)", "testcase": false, "constructor": false}, {"identifier": "isNonEmpty", "parameters": "(String value)", "modifiers": "private static", "return": "boolean", "signature": "boolean isNonEmpty(String value)", "full_signature": "private static boolean isNonEmpty(String value)", "class_method_signature": "WebXmlParser.isNonEmpty(String value)", "testcase": false, "constructor": false}], "file": "session-replacement/src/main/java/com/amadeus/session/servlet/WebXmlParser.java"}, "focal_method": {"identifier": "parseStream", "parameters": "(SessionConfiguration conf, InputStream is)", "modifiers": "static", "return": "void", "body": "static void parseStream(SessionConfiguration conf, InputStream is) {\n    if (is != null) {\n      try {\n        DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();\n        // We want to ignore schemas and dtd when parsing web.xml\n        builder.setEntityResolver(new EntityResolver() {\n          @Override\n          public InputSource resolveEntity(String publicId, String systemId) {\n            // Ignore entites!\n            return new InputSource(new StringReader(\"\"));\n          }\n        });\n        Document document = builder.parse(is);\n        XPath xpath = XPathFactory.newInstance().newXPath();\n        lookForSessionTimeout(conf, document, xpath);\n        lookForSessionConf(conf, document, xpath);\n        checkDistributable(conf, document, xpath);\n      } catch (SAXException | IOException | XPathExpressionException | ParserConfigurationException e) {\n        throw new IllegalStateException(\"An exception occured while parsing web.xml. \"\n            + \"Using default configuration: \" + conf, e);\n      }\n    }\n  }", "signature": "void parseStream(SessionConfiguration conf, InputStream is)", "full_signature": "static void parseStream(SessionConfiguration conf, InputStream is)", "class_method_signature": "WebXmlParser.parseStream(SessionConfiguration conf, InputStream is)", "testcase": false, "constructor": false, "invocations": ["newDocumentBuilder", "newInstance", "setEntityResolver", "parse", "newXPath", "newInstance", "lookForSessionTimeout", "lookForSessionConf", "checkDistributable"]}, "repository": {"repo_id": 74458764, "url": "https://github.com/AmadeusITGroup/HttpSessionReplacer", "language": "Java", "is_fork": false, "fork_count": 29, "stargazer_count": 45, "size": 514, "license": "licensed"}}