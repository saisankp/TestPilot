{"test_class": {"identifier": "SpoutWrapperTest", "superclass": "extends AbstractTest", "interfaces": "", "fields": [], "file": "flink-contrib/flink-storm/src/test/java/org/apache/flink/storm/wrappers/SpoutWrapperTest.java"}, "test_case": {"identifier": "testRunExecuteFixedNumber", "parameters": "()", "modifiers": "@SuppressWarnings(\"unchecked\") @Test public", "return": "void", "body": "@SuppressWarnings(\"unchecked\")\n\t@Test\n\tpublic void testRunExecuteFixedNumber() throws Exception {\n\t\tfinal SetupOutputFieldsDeclarer declarer = new SetupOutputFieldsDeclarer();\n\t\tdeclarer.declare(new Fields(\"dummy\"));\n\t\tPowerMockito.whenNew(SetupOutputFieldsDeclarer.class).withNoArguments()\n\t\t\t\t.thenReturn(declarer);\n\n\t\tfinal StreamingRuntimeContext taskContext = mock(StreamingRuntimeContext.class);\n\t\twhen(taskContext.getExecutionConfig()).thenReturn(mock(ExecutionConfig.class));\n\t\twhen(taskContext.getTaskName()).thenReturn(\"name\");\n\n\t\tfinal IRichSpout spout = mock(IRichSpout.class);\n\t\tfinal int numberOfCalls = this.r.nextInt(50);\n\t\tfinal SpoutWrapper<?> spoutWrapper = new SpoutWrapper<Object>(spout,\n\t\t\t\tnumberOfCalls);\n\t\tspoutWrapper.setRuntimeContext(taskContext);\n\n\t\tspoutWrapper.run(mock(SourceContext.class));\n\t\tverify(spout, times(numberOfCalls)).nextTuple();\n\t}", "signature": "void testRunExecuteFixedNumber()", "full_signature": "@SuppressWarnings(\"unchecked\") @Test public void testRunExecuteFixedNumber()", "class_method_signature": "SpoutWrapperTest.testRunExecuteFixedNumber()", "testcase": true, "constructor": false, "invocations": ["declare", "thenReturn", "withNoArguments", "whenNew", "mock", "thenReturn", "when", "getExecutionConfig", "mock", "thenReturn", "when", "getTaskName", "mock", "nextInt", "setRuntimeContext", "run", "mock", "nextTuple", "verify", "times"]}, "focal_class": {"identifier": "SpoutWrapper", "superclass": "extends RichParallelSourceFunction<OUT>", "interfaces": "implements StoppableFunction", "fields": [{"original_string": "private static final long serialVersionUID = -218340336648247605L;", "modifier": "private static final", "type": "long", "declarator": "serialVersionUID = -218340336648247605L", "var_name": "serialVersionUID"}, {"original_string": "private final HashMap<String, Integer> numberOfAttributes;", "modifier": "private final", "type": "HashMap<String, Integer>", "declarator": "numberOfAttributes", "var_name": "numberOfAttributes"}, {"original_string": "private final IRichSpout spout;", "modifier": "private final", "type": "IRichSpout", "declarator": "spout", "var_name": "spout"}, {"original_string": "private final String name;", "modifier": "private final", "type": "String", "declarator": "name", "var_name": "name"}, {"original_string": "private volatile boolean isRunning = true;", "modifier": "private volatile", "type": "boolean", "declarator": "isRunning = true", "var_name": "isRunning"}, {"original_string": "private Integer numberOfInvocations;", "modifier": "private", "type": "Integer", "declarator": "numberOfInvocations", "var_name": "numberOfInvocations"}, {"original_string": "private StormTopology stormTopology;", "modifier": "private", "type": "StormTopology", "declarator": "stormTopology", "var_name": "stormTopology"}], "methods": [{"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout)", "full_signature": "public  SpoutWrapper(final IRichSpout spout)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout)", "testcase": false, "constructor": true}, {"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout, final Integer numberOfInvocations)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout, final Integer numberOfInvocations)", "full_signature": "public  SpoutWrapper(final IRichSpout spout, final Integer numberOfInvocations)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout, final Integer numberOfInvocations)", "testcase": false, "constructor": true}, {"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout, final String[] rawOutputs)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout, final String[] rawOutputs)", "full_signature": "public  SpoutWrapper(final IRichSpout spout, final String[] rawOutputs)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout, final String[] rawOutputs)", "testcase": false, "constructor": true}, {"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout, final String[] rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout, final String[] rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "full_signature": "public  SpoutWrapper(final IRichSpout spout, final String[] rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout, final String[] rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "testcase": false, "constructor": true}, {"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout, final Collection<String> rawOutputs)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout, final Collection<String> rawOutputs)", "full_signature": "public  SpoutWrapper(final IRichSpout spout, final Collection<String> rawOutputs)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout, final Collection<String> rawOutputs)", "testcase": false, "constructor": true}, {"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "full_signature": "public  SpoutWrapper(final IRichSpout spout, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "testcase": false, "constructor": true}, {"identifier": "SpoutWrapper", "parameters": "(final IRichSpout spout, final String name, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "modifiers": "public", "return": "", "signature": " SpoutWrapper(final IRichSpout spout, final String name, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "full_signature": "public  SpoutWrapper(final IRichSpout spout, final String name, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "class_method_signature": "SpoutWrapper.SpoutWrapper(final IRichSpout spout, final String name, final Collection<String> rawOutputs,\n\t\t\tfinal Integer numberOfInvocations)", "testcase": false, "constructor": true}, {"identifier": "setStormTopology", "parameters": "(StormTopology stormTopology)", "modifiers": "public", "return": "void", "signature": "void setStormTopology(StormTopology stormTopology)", "full_signature": "public void setStormTopology(StormTopology stormTopology)", "class_method_signature": "SpoutWrapper.setStormTopology(StormTopology stormTopology)", "testcase": false, "constructor": false}, {"identifier": "run", "parameters": "(final SourceContext<OUT> ctx)", "modifiers": "@Override public final", "return": "void", "signature": "void run(final SourceContext<OUT> ctx)", "full_signature": "@Override public final void run(final SourceContext<OUT> ctx)", "class_method_signature": "SpoutWrapper.run(final SourceContext<OUT> ctx)", "testcase": false, "constructor": false}, {"identifier": "cancel", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void cancel()", "full_signature": "@Override public void cancel()", "class_method_signature": "SpoutWrapper.cancel()", "testcase": false, "constructor": false}, {"identifier": "stop", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void stop()", "full_signature": "@Override public void stop()", "class_method_signature": "SpoutWrapper.stop()", "testcase": false, "constructor": false}, {"identifier": "close", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void close()", "full_signature": "@Override public void close()", "class_method_signature": "SpoutWrapper.close()", "testcase": false, "constructor": false}], "file": "flink-contrib/flink-storm/src/main/java/org/apache/flink/storm/wrappers/SpoutWrapper.java"}, "focal_method": {"identifier": "run", "parameters": "(final SourceContext<OUT> ctx)", "modifiers": "@Override public final", "return": "void", "body": "@Override\n\tpublic final void run(final SourceContext<OUT> ctx) throws Exception {\n\t\tfinal GlobalJobParameters config = super.getRuntimeContext().getExecutionConfig()\n\t\t\t\t.getGlobalJobParameters();\n\t\tStormConfig stormConfig = new StormConfig();\n\n\t\tif (config != null) {\n\t\t\tif (config instanceof StormConfig) {\n\t\t\t\tstormConfig = (StormConfig) config;\n\t\t\t} else {\n\t\t\t\tstormConfig.putAll(config.toMap());\n\t\t\t}\n\t\t}\n\n\t\tfinal TopologyContext stormTopologyContext = WrapperSetupHelper.createTopologyContext(\n\t\t\t\t(StreamingRuntimeContext) super.getRuntimeContext(), this.spout, this.name,\n\t\t\t\tthis.stormTopology, stormConfig);\n\n\t\tSpoutCollector<OUT> collector = new SpoutCollector<OUT>(this.numberOfAttributes,\n\t\t\t\tstormTopologyContext.getThisTaskId(), ctx);\n\n\t\tthis.spout.open(stormConfig, stormTopologyContext, new SpoutOutputCollector(collector));\n\t\tthis.spout.activate();\n\n\t\tif (numberOfInvocations == null) {\n\t\t\tif (this.spout instanceof FiniteSpout) {\n\t\t\t\tfinal FiniteSpout finiteSpout = (FiniteSpout) this.spout;\n\n\t\t\t\twhile (this.isRunning && !finiteSpout.reachedEnd()) {\n\t\t\t\t\tfiniteSpout.nextTuple();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile (this.isRunning) {\n\t\t\t\t\tthis.spout.nextTuple();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tint counter = this.numberOfInvocations;\n\t\t\tif (counter >= 0) {\n\t\t\t\twhile ((--counter >= 0) && this.isRunning) {\n\t\t\t\t\tthis.spout.nextTuple();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdo {\n\t\t\t\t\tcollector.tupleEmitted = false;\n\t\t\t\t\tthis.spout.nextTuple();\n\t\t\t\t} while (collector.tupleEmitted && this.isRunning);\n\t\t\t}\n\t\t}\n\t}", "signature": "void run(final SourceContext<OUT> ctx)", "full_signature": "@Override public final void run(final SourceContext<OUT> ctx)", "class_method_signature": "SpoutWrapper.run(final SourceContext<OUT> ctx)", "testcase": false, "constructor": false, "invocations": ["getGlobalJobParameters", "getExecutionConfig", "getRuntimeContext", "putAll", "toMap", "createTopologyContext", "getRuntimeContext", "getThisTaskId", "open", "activate", "reachedEnd", "nextTuple", "nextTuple", "nextTuple", "nextTuple"]}, "repository": {"repo_id": 47972099, "url": "https://github.com/streamline-eu/ML-Pipelines", "language": "Java", "is_fork": false, "fork_count": 7, "stargazer_count": 7, "size": 85537, "license": "licensed"}}