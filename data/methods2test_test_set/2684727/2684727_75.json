{"test_class": {"identifier": "DefaultPurchaseWalletTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String TEST = \"test\";", "modifier": "private static final", "type": "String", "declarator": "TEST = \"test\"", "var_name": "TEST"}, {"original_string": "private static final String PURCHASE_TOKEN = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689\";", "modifier": "private static final", "type": "String", "declarator": "PURCHASE_TOKEN = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689\"", "var_name": "PURCHASE_TOKEN"}, {"original_string": "private static final String IN_APP_DATA_SIGNATURE = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689==\";", "modifier": "private static final", "type": "String", "declarator": "IN_APP_DATA_SIGNATURE = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689==\"", "var_name": "IN_APP_DATA_SIGNATURE"}, {"original_string": "private String purchaseData;", "modifier": "private", "type": "String", "declarator": "purchaseData", "var_name": "purchaseData"}, {"original_string": "DefaultPurchaseWallet defaultPurchaseWallet;", "modifier": "", "type": "DefaultPurchaseWallet", "declarator": "defaultPurchaseWallet", "var_name": "defaultPurchaseWallet"}, {"original_string": "SharedPreferences preferences;", "modifier": "", "type": "SharedPreferences", "declarator": "preferences", "var_name": "preferences"}, {"original_string": "ManagedProduct managedProduct;", "modifier": "", "type": "ManagedProduct", "declarator": "managedProduct", "var_name": "managedProduct"}, {"original_string": "@Mock\n    Lazy<SharedPreferences> sharedPreferencesLazy;", "modifier": "@Mock", "type": "Lazy<SharedPreferences>", "declarator": "sharedPreferencesLazy", "var_name": "sharedPreferencesLazy"}], "file": "app/src/test/java/co/smartreceipts/android/purchases/wallet/DefaultPurchaseWalletTest.java"}, "test_case": {"identifier": "updateRemotePurchases", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void updateRemotePurchases() {\n        assertFalse(defaultPurchaseWallet.hasActivePurchase(InAppPurchase.SmartReceiptsPlus));\n\n        final RemoteSubscription remoteSubscription = new RemoteSubscription(1, InAppPurchase.SmartReceiptsPlus, new Date());\n        defaultPurchaseWallet.updateRemotePurchases(Collections.singleton(remoteSubscription));\n        assertTrue(defaultPurchaseWallet.hasActivePurchase(InAppPurchase.SmartReceiptsPlus));\n\n        // Now ensure persisted\n        final PurchaseWallet newWallet = new DefaultPurchaseWallet(sharedPreferencesLazy);\n        assertTrue(newWallet.hasActivePurchase(InAppPurchase.SmartReceiptsPlus));\n    }", "signature": "void updateRemotePurchases()", "full_signature": "@Test public void updateRemotePurchases()", "class_method_signature": "DefaultPurchaseWalletTest.updateRemotePurchases()", "testcase": true, "constructor": false, "invocations": ["assertFalse", "hasActivePurchase", "updateRemotePurchases", "singleton", "assertTrue", "hasActivePurchase", "assertTrue", "hasActivePurchase"]}, "focal_class": {"identifier": "DefaultPurchaseWallet", "superclass": "", "interfaces": "implements PurchaseWallet", "fields": [{"original_string": "private static final String KEY_SKU_SET = \"key_sku_set\";", "modifier": "private static final", "type": "String", "declarator": "KEY_SKU_SET = \"key_sku_set\"", "var_name": "KEY_SKU_SET"}, {"original_string": "private static final String FORMAT_KEY_PURCHASE_DATA = \"%s_purchaseData\";", "modifier": "private static final", "type": "String", "declarator": "FORMAT_KEY_PURCHASE_DATA = \"%s_purchaseData\"", "var_name": "FORMAT_KEY_PURCHASE_DATA"}, {"original_string": "private static final String FORMAT_KEY_IN_APP_DATA_SIGNATURE = \"%s_inAppDataSignature\";", "modifier": "private static final", "type": "String", "declarator": "FORMAT_KEY_IN_APP_DATA_SIGNATURE = \"%s_inAppDataSignature\"", "var_name": "FORMAT_KEY_IN_APP_DATA_SIGNATURE"}, {"original_string": "private static final String KEY_REMOTE_SKU_SET = \"key_remote_purchase_sku_set\";", "modifier": "private static final", "type": "String", "declarator": "KEY_REMOTE_SKU_SET = \"key_remote_purchase_sku_set\"", "var_name": "KEY_REMOTE_SKU_SET"}, {"original_string": "private final Lazy<SharedPreferences> sharedPreferences;", "modifier": "private final", "type": "Lazy<SharedPreferences>", "declarator": "sharedPreferences", "var_name": "sharedPreferences"}, {"original_string": "private Map<InAppPurchase, ManagedProduct> locallyOwnedInAppPurchasesMap = null;", "modifier": "private", "type": "Map<InAppPurchase, ManagedProduct>", "declarator": "locallyOwnedInAppPurchasesMap = null", "var_name": "locallyOwnedInAppPurchasesMap"}, {"original_string": "private Set<InAppPurchase> remotelyOwnedPurchases = null;", "modifier": "private", "type": "Set<InAppPurchase>", "declarator": "remotelyOwnedPurchases = null", "var_name": "remotelyOwnedPurchases"}], "methods": [{"identifier": "DefaultPurchaseWallet", "parameters": "(@NonNull Lazy<SharedPreferences> preferences)", "modifiers": "@Inject public", "return": "", "signature": " DefaultPurchaseWallet(@NonNull Lazy<SharedPreferences> preferences)", "full_signature": "@Inject public  DefaultPurchaseWallet(@NonNull Lazy<SharedPreferences> preferences)", "class_method_signature": "DefaultPurchaseWallet.DefaultPurchaseWallet(@NonNull Lazy<SharedPreferences> preferences)", "testcase": false, "constructor": true}, {"identifier": "hasActivePurchase", "parameters": "(@NonNull InAppPurchase inAppPurchase)", "modifiers": "@Override public synchronized", "return": "boolean", "signature": "boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "full_signature": "@Override public synchronized boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "class_method_signature": "DefaultPurchaseWallet.hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "testcase": false, "constructor": false}, {"identifier": "getActiveLocalInAppPurchases", "parameters": "()", "modifiers": "@NonNull @Override public", "return": "Set<ManagedProduct>", "signature": "Set<ManagedProduct> getActiveLocalInAppPurchases()", "full_signature": "@NonNull @Override public Set<ManagedProduct> getActiveLocalInAppPurchases()", "class_method_signature": "DefaultPurchaseWallet.getActiveLocalInAppPurchases()", "testcase": false, "constructor": false}, {"identifier": "getLocalInAppManagedProduct", "parameters": "(@NonNull InAppPurchase inAppPurchase)", "modifiers": "@Nullable @Override public synchronized", "return": "ManagedProduct", "signature": "ManagedProduct getLocalInAppManagedProduct(@NonNull InAppPurchase inAppPurchase)", "full_signature": "@Nullable @Override public synchronized ManagedProduct getLocalInAppManagedProduct(@NonNull InAppPurchase inAppPurchase)", "class_method_signature": "DefaultPurchaseWallet.getLocalInAppManagedProduct(@NonNull InAppPurchase inAppPurchase)", "testcase": false, "constructor": false}, {"identifier": "updateLocalInAppPurchasesInWallet", "parameters": "(@NonNull Set<ManagedProduct> managedProducts)", "modifiers": "@Override public synchronized", "return": "void", "signature": "void updateLocalInAppPurchasesInWallet(@NonNull Set<ManagedProduct> managedProducts)", "full_signature": "@Override public synchronized void updateLocalInAppPurchasesInWallet(@NonNull Set<ManagedProduct> managedProducts)", "class_method_signature": "DefaultPurchaseWallet.updateLocalInAppPurchasesInWallet(@NonNull Set<ManagedProduct> managedProducts)", "testcase": false, "constructor": false}, {"identifier": "updateRemotePurchases", "parameters": "(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "modifiers": "@Override public synchronized", "return": "void", "signature": "void updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "full_signature": "@Override public synchronized void updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "class_method_signature": "DefaultPurchaseWallet.updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "testcase": false, "constructor": false}, {"identifier": "addLocalInAppPurchaseToWallet", "parameters": "(@NonNull ManagedProduct managedProduct)", "modifiers": "@Override public synchronized", "return": "void", "signature": "void addLocalInAppPurchaseToWallet(@NonNull ManagedProduct managedProduct)", "full_signature": "@Override public synchronized void addLocalInAppPurchaseToWallet(@NonNull ManagedProduct managedProduct)", "class_method_signature": "DefaultPurchaseWallet.addLocalInAppPurchaseToWallet(@NonNull ManagedProduct managedProduct)", "testcase": false, "constructor": false}, {"identifier": "getLocallyOwnedInAppPurchasesMap", "parameters": "()", "modifiers": "@NonNull private synchronized", "return": "Map<InAppPurchase, ManagedProduct>", "signature": "Map<InAppPurchase, ManagedProduct> getLocallyOwnedInAppPurchasesMap()", "full_signature": "@NonNull private synchronized Map<InAppPurchase, ManagedProduct> getLocallyOwnedInAppPurchasesMap()", "class_method_signature": "DefaultPurchaseWallet.getLocallyOwnedInAppPurchasesMap()", "testcase": false, "constructor": false}, {"identifier": "getRemotelyOwnedPurchases", "parameters": "()", "modifiers": "@NonNull private synchronized", "return": "Set<InAppPurchase>", "signature": "Set<InAppPurchase> getRemotelyOwnedPurchases()", "full_signature": "@NonNull private synchronized Set<InAppPurchase> getRemotelyOwnedPurchases()", "class_method_signature": "DefaultPurchaseWallet.getRemotelyOwnedPurchases()", "testcase": false, "constructor": false}, {"identifier": "persistWallet", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void persistWallet()", "full_signature": "private void persistWallet()", "class_method_signature": "DefaultPurchaseWallet.persistWallet()", "testcase": false, "constructor": false}, {"identifier": "getKeyForPurchaseData", "parameters": "(@NonNull InAppPurchase inAppPurchase)", "modifiers": "@NonNull private", "return": "String", "signature": "String getKeyForPurchaseData(@NonNull InAppPurchase inAppPurchase)", "full_signature": "@NonNull private String getKeyForPurchaseData(@NonNull InAppPurchase inAppPurchase)", "class_method_signature": "DefaultPurchaseWallet.getKeyForPurchaseData(@NonNull InAppPurchase inAppPurchase)", "testcase": false, "constructor": false}, {"identifier": "getKeyForInAppDataSignature", "parameters": "(@NonNull InAppPurchase inAppPurchase)", "modifiers": "@NonNull private", "return": "String", "signature": "String getKeyForInAppDataSignature(@NonNull InAppPurchase inAppPurchase)", "full_signature": "@NonNull private String getKeyForInAppDataSignature(@NonNull InAppPurchase inAppPurchase)", "class_method_signature": "DefaultPurchaseWallet.getKeyForInAppDataSignature(@NonNull InAppPurchase inAppPurchase)", "testcase": false, "constructor": false}], "file": "app/src/main/java/co/smartreceipts/android/purchases/wallet/DefaultPurchaseWallet.java"}, "focal_method": {"identifier": "updateRemotePurchases", "parameters": "(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "modifiers": "@Override public synchronized", "return": "void", "body": "@Override\n    public synchronized void updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions) {\n        final Set<InAppPurchase> remotePurchases = new HashSet<>();\n        for (final RemoteSubscription remoteSubscription : remoteSubscriptions) {\n            remotePurchases.add(remoteSubscription.getInAppPurchase());\n        }\n        if (!getRemotelyOwnedPurchases().equals(remotePurchases)) {\n            this.remotelyOwnedPurchases = remotePurchases;\n            persistWallet();\n        }\n    }", "signature": "void updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "full_signature": "@Override public synchronized void updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "class_method_signature": "DefaultPurchaseWallet.updateRemotePurchases(@NonNull Set<RemoteSubscription> remoteSubscriptions)", "testcase": false, "constructor": false, "invocations": ["add", "getInAppPurchase", "equals", "getRemotelyOwnedPurchases", "persistWallet"]}, "repository": {"repo_id": 2684727, "url": "https://github.com/wbaumann/SmartReceiptsLibrary", "stars": 166, "created": "11/1/2011 12:32:39 AM +00:00", "updates": "2020-01-26T22:04:24+00:00", "fork": "False", "license": "licensed"}}