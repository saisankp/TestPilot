{"test_class": {"identifier": "UrlUtilsTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "String localAddress = \"127.0.0.1\";", "modifier": "", "type": "String", "declarator": "localAddress = \"127.0.0.1\"", "var_name": "localAddress"}], "file": "dubbo-common/src/test/java/com/alibaba/dubbo/common/utils/UrlUtilsTest.java"}, "test_case": {"identifier": "testParseUrl2", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testParseUrl2() {\n        String address = \"192.168.0.1\";\n        String backupAddress1 = \"192.168.0.2\";\n        String backupAddress2 = \"192.168.0.3\";\n\n        Map<String, String> parameters = new HashMap<String, String>();\n        parameters.put(\"username\", \"root\");\n        parameters.put(\"password\", \"alibaba\");\n        parameters.put(\"port\", \"10000\");\n        parameters.put(\"protocol\", \"dubbo\");\n        URL url = UrlUtils.parseURL(address + \",\" + backupAddress1 + \",\" + backupAddress2, parameters);\n        assertEquals(\"192.168.0.1:10000\", url.getAddress());\n        assertEquals(\"root\", url.getUsername());\n        assertEquals(\"alibaba\", url.getPassword());\n        assertEquals(10000, url.getPort());\n        assertEquals(\"dubbo\", url.getProtocol());\n        assertEquals(\"192.168.0.2\" + \",\" + \"192.168.0.3\", url.getParameter(\"backup\"));\n    }", "signature": "void testParseUrl2()", "full_signature": "@Test public void testParseUrl2()", "class_method_signature": "UrlUtilsTest.testParseUrl2()", "testcase": true, "constructor": false, "invocations": ["put", "put", "put", "put", "parseURL", "assertEquals", "getAddress", "assertEquals", "getUsername", "assertEquals", "getPassword", "assertEquals", "getPort", "assertEquals", "getProtocol", "assertEquals", "getParameter"]}, "focal_class": {"identifier": "UrlUtils", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "parseURL", "parameters": "(String address, Map<String, String> defaults)", "modifiers": "public static", "return": "URL", "signature": "URL parseURL(String address, Map<String, String> defaults)", "full_signature": "public static URL parseURL(String address, Map<String, String> defaults)", "class_method_signature": "UrlUtils.parseURL(String address, Map<String, String> defaults)", "testcase": false, "constructor": false}, {"identifier": "parseURLs", "parameters": "(String address, Map<String, String> defaults)", "modifiers": "public static", "return": "List<URL>", "signature": "List<URL> parseURLs(String address, Map<String, String> defaults)", "full_signature": "public static List<URL> parseURLs(String address, Map<String, String> defaults)", "class_method_signature": "UrlUtils.parseURLs(String address, Map<String, String> defaults)", "testcase": false, "constructor": false}, {"identifier": "convertRegister", "parameters": "(Map<String, Map<String, String>> register)", "modifiers": "public static", "return": "Map<String, Map<String, String>>", "signature": "Map<String, Map<String, String>> convertRegister(Map<String, Map<String, String>> register)", "full_signature": "public static Map<String, Map<String, String>> convertRegister(Map<String, Map<String, String>> register)", "class_method_signature": "UrlUtils.convertRegister(Map<String, Map<String, String>> register)", "testcase": false, "constructor": false}, {"identifier": "convertSubscribe", "parameters": "(Map<String, String> subscribe)", "modifiers": "public static", "return": "Map<String, String>", "signature": "Map<String, String> convertSubscribe(Map<String, String> subscribe)", "full_signature": "public static Map<String, String> convertSubscribe(Map<String, String> subscribe)", "class_method_signature": "UrlUtils.convertSubscribe(Map<String, String> subscribe)", "testcase": false, "constructor": false}, {"identifier": "revertRegister", "parameters": "(Map<String, Map<String, String>> register)", "modifiers": "public static", "return": "Map<String, Map<String, String>>", "signature": "Map<String, Map<String, String>> revertRegister(Map<String, Map<String, String>> register)", "full_signature": "public static Map<String, Map<String, String>> revertRegister(Map<String, Map<String, String>> register)", "class_method_signature": "UrlUtils.revertRegister(Map<String, Map<String, String>> register)", "testcase": false, "constructor": false}, {"identifier": "revertSubscribe", "parameters": "(Map<String, String> subscribe)", "modifiers": "public static", "return": "Map<String, String>", "signature": "Map<String, String> revertSubscribe(Map<String, String> subscribe)", "full_signature": "public static Map<String, String> revertSubscribe(Map<String, String> subscribe)", "class_method_signature": "UrlUtils.revertSubscribe(Map<String, String> subscribe)", "testcase": false, "constructor": false}, {"identifier": "revertNotify", "parameters": "(Map<String, Map<String, String>> notify)", "modifiers": "public static", "return": "Map<String, Map<String, String>>", "signature": "Map<String, Map<String, String>> revertNotify(Map<String, Map<String, String>> notify)", "full_signature": "public static Map<String, Map<String, String>> revertNotify(Map<String, Map<String, String>> notify)", "class_method_signature": "UrlUtils.revertNotify(Map<String, Map<String, String>> notify)", "testcase": false, "constructor": false}, {"identifier": "revertForbid", "parameters": "(List<String> forbid, Set<URL> subscribed)", "modifiers": "public static", "return": "List<String>", "signature": "List<String> revertForbid(List<String> forbid, Set<URL> subscribed)", "full_signature": "public static List<String> revertForbid(List<String> forbid, Set<URL> subscribed)", "class_method_signature": "UrlUtils.revertForbid(List<String> forbid, Set<URL> subscribed)", "testcase": false, "constructor": false}, {"identifier": "getEmptyUrl", "parameters": "(String service, String category)", "modifiers": "public static", "return": "URL", "signature": "URL getEmptyUrl(String service, String category)", "full_signature": "public static URL getEmptyUrl(String service, String category)", "class_method_signature": "UrlUtils.getEmptyUrl(String service, String category)", "testcase": false, "constructor": false}, {"identifier": "isMatchCategory", "parameters": "(String category, String categories)", "modifiers": "public static", "return": "boolean", "signature": "boolean isMatchCategory(String category, String categories)", "full_signature": "public static boolean isMatchCategory(String category, String categories)", "class_method_signature": "UrlUtils.isMatchCategory(String category, String categories)", "testcase": false, "constructor": false}, {"identifier": "isMatch", "parameters": "(URL consumerUrl, URL providerUrl)", "modifiers": "public static", "return": "boolean", "signature": "boolean isMatch(URL consumerUrl, URL providerUrl)", "full_signature": "public static boolean isMatch(URL consumerUrl, URL providerUrl)", "class_method_signature": "UrlUtils.isMatch(URL consumerUrl, URL providerUrl)", "testcase": false, "constructor": false}, {"identifier": "isMatchGlobPattern", "parameters": "(String pattern, String value, URL param)", "modifiers": "public static", "return": "boolean", "signature": "boolean isMatchGlobPattern(String pattern, String value, URL param)", "full_signature": "public static boolean isMatchGlobPattern(String pattern, String value, URL param)", "class_method_signature": "UrlUtils.isMatchGlobPattern(String pattern, String value, URL param)", "testcase": false, "constructor": false}, {"identifier": "isMatchGlobPattern", "parameters": "(String pattern, String value)", "modifiers": "public static", "return": "boolean", "signature": "boolean isMatchGlobPattern(String pattern, String value)", "full_signature": "public static boolean isMatchGlobPattern(String pattern, String value)", "class_method_signature": "UrlUtils.isMatchGlobPattern(String pattern, String value)", "testcase": false, "constructor": false}, {"identifier": "isServiceKeyMatch", "parameters": "(URL pattern, URL value)", "modifiers": "public static", "return": "boolean", "signature": "boolean isServiceKeyMatch(URL pattern, URL value)", "full_signature": "public static boolean isServiceKeyMatch(URL pattern, URL value)", "class_method_signature": "UrlUtils.isServiceKeyMatch(URL pattern, URL value)", "testcase": false, "constructor": false}, {"identifier": "isItemMatch", "parameters": "(String pattern, String value)", "modifiers": "static", "return": "boolean", "signature": "boolean isItemMatch(String pattern, String value)", "full_signature": "static boolean isItemMatch(String pattern, String value)", "class_method_signature": "UrlUtils.isItemMatch(String pattern, String value)", "testcase": false, "constructor": false}], "file": "dubbo-common/src/main/java/com/alibaba/dubbo/common/utils/UrlUtils.java"}, "focal_method": {"identifier": "parseURL", "parameters": "(String address, Map<String, String> defaults)", "modifiers": "public static", "return": "URL", "body": "public static URL parseURL(String address, Map<String, String> defaults) {\n        if (address == null || address.length() == 0) {\n            return null;\n        }\n        String url;\n        if (address.indexOf(\"://\") >= 0) {\n            url = address;\n        } else {\n            String[] addresses = Constants.COMMA_SPLIT_PATTERN.split(address);\n            url = addresses[0];\n            if (addresses.length > 1) {\n                StringBuilder backup = new StringBuilder();\n                for (int i = 1; i < addresses.length; i++) {\n                    if (i > 1) {\n                        backup.append(\",\");\n                    }\n                    backup.append(addresses[i]);\n                }\n                url += \"?\" + Constants.BACKUP_KEY + \"=\" + backup.toString();\n            }\n        }\n        String defaultProtocol = defaults == null ? null : defaults.get(\"protocol\");\n        if (defaultProtocol == null || defaultProtocol.length() == 0) {\n            defaultProtocol = \"dubbo\";\n        }\n        String defaultUsername = defaults == null ? null : defaults.get(\"username\");\n        String defaultPassword = defaults == null ? null : defaults.get(\"password\");\n        int defaultPort = StringUtils.parseInteger(defaults == null ? null : defaults.get(\"port\"));\n        String defaultPath = defaults == null ? null : defaults.get(\"path\");\n        Map<String, String> defaultParameters = defaults == null ? null : new HashMap<String, String>(defaults);\n        if (defaultParameters != null) {\n            defaultParameters.remove(\"protocol\");\n            defaultParameters.remove(\"username\");\n            defaultParameters.remove(\"password\");\n            defaultParameters.remove(\"host\");\n            defaultParameters.remove(\"port\");\n            defaultParameters.remove(\"path\");\n        }\n        URL u = URL.valueOf(url);\n        boolean changed = false;\n        String protocol = u.getProtocol();\n        String username = u.getUsername();\n        String password = u.getPassword();\n        String host = u.getHost();\n        int port = u.getPort();\n        String path = u.getPath();\n        Map<String, String> parameters = new HashMap<String, String>(u.getParameters());\n        if ((protocol == null || protocol.length() == 0) && defaultProtocol != null && defaultProtocol.length() > 0) {\n            changed = true;\n            protocol = defaultProtocol;\n        }\n        if ((username == null || username.length() == 0) && defaultUsername != null && defaultUsername.length() > 0) {\n            changed = true;\n            username = defaultUsername;\n        }\n        if ((password == null || password.length() == 0) && defaultPassword != null && defaultPassword.length() > 0) {\n            changed = true;\n            password = defaultPassword;\n        }\n        /*if (u.isAnyHost() || u.isLocalHost()) {\n            changed = true;\n            host = NetUtils.getLocalHost();\n        }*/\n        if (port <= 0) {\n            if (defaultPort > 0) {\n                changed = true;\n                port = defaultPort;\n            } else {\n                changed = true;\n                port = 9090;\n            }\n        }\n        if (path == null || path.length() == 0) {\n            if (defaultPath != null && defaultPath.length() > 0) {\n                changed = true;\n                path = defaultPath;\n            }\n        }\n        if (defaultParameters != null && defaultParameters.size() > 0) {\n            for (Map.Entry<String, String> entry : defaultParameters.entrySet()) {\n                String key = entry.getKey();\n                String defaultValue = entry.getValue();\n                if (defaultValue != null && defaultValue.length() > 0) {\n                    String value = parameters.get(key);\n                    if (value == null || value.length() == 0) {\n                        changed = true;\n                        parameters.put(key, defaultValue);\n                    }\n                }\n            }\n        }\n        if (changed) {\n            u = new URL(protocol, username, password, host, port, path, parameters);\n        }\n        return u;\n    }", "signature": "URL parseURL(String address, Map<String, String> defaults)", "full_signature": "public static URL parseURL(String address, Map<String, String> defaults)", "class_method_signature": "UrlUtils.parseURL(String address, Map<String, String> defaults)", "testcase": false, "constructor": false, "invocations": ["length", "indexOf", "split", "append", "append", "toString", "get", "length", "get", "get", "parseInteger", "get", "get", "remove", "remove", "remove", "remove", "remove", "remove", "valueOf", "getProtocol", "getUsername", "getPassword", "getHost", "getPort", "getPath", "getParameters", "length", "length", "length", "length", "length", "length", "length", "length", "size", "entrySet", "getKey", "getValue", "length", "get", "length", "put"]}, "repository": {"repo_id": 189562861, "url": "https://github.com/smallFive55/dubbo-dubbo-2.6.6", "language": "Java", "is_fork": false, "fork_count": 11, "stargazer_count": 8, "size": 1428, "license": "licensed"}}