{"test_class": {"identifier": "FeatureBackendTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(FeatureBackendTest.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(FeatureBackendTest.class)", "var_name": "logger"}], "file": "karate-core/src/test/java/com/intuit/karate/core/FeatureBackendTest.java"}, "test_case": {"identifier": "testServer", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testServer() {\n        Feature feature = FeatureParser.parse(FileUtils.getFileRelativeTo(getClass(), \"server.feature\"));\n        FeaturesBackend backend = new FeaturesBackend(feature);\n        ScriptValueMap vars = backend.handle(getRequest(\"Billie\"));\n        Match.equals(vars.get(\"response\").getAsMap(), \"{ id: 1, name: 'Billie' }\");\n        vars = backend.handle(getRequest(\"Wild\"));\n        Match.equals(vars.get(\"response\").getAsMap(), \"{ id: 2, name: 'Wild' }\");\n        List<Map> list = vars.get(\"cats\").getAsList();\n        Match.equals(list, \"[{ id: 1, name: 'Billie' }, { id: 2, name: 'Wild' }]\");\n    }", "signature": "void testServer()", "full_signature": "@Test public void testServer()", "class_method_signature": "FeatureBackendTest.testServer()", "testcase": true, "constructor": false, "invocations": ["parse", "getFileRelativeTo", "getClass", "handle", "getRequest", "equals", "getAsMap", "get", "handle", "getRequest", "equals", "getAsMap", "get", "getAsList", "get", "equals"]}, "focal_class": {"identifier": "FeatureBackend", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String ALLOWED_METHODS = \"GET, HEAD, POST, PUT, DELETE, PATCH\";", "modifier": "private static final", "type": "String", "declarator": "ALLOWED_METHODS = \"GET, HEAD, POST, PUT, DELETE, PATCH\"", "var_name": "ALLOWED_METHODS"}, {"original_string": "private final Feature feature;", "modifier": "private final", "type": "Feature", "declarator": "feature", "var_name": "feature"}, {"original_string": "private final StepActions actions;", "modifier": "private final", "type": "StepActions", "declarator": "actions", "var_name": "actions"}, {"original_string": "private final ScenarioContext context;", "modifier": "private final", "type": "ScenarioContext", "declarator": "context", "var_name": "context"}, {"original_string": "private final String featureName;", "modifier": "private final", "type": "String", "declarator": "featureName", "var_name": "featureName"}, {"original_string": "private static final String VAR_AFTER_SCENARIO = \"afterScenario\";", "modifier": "private static final", "type": "String", "declarator": "VAR_AFTER_SCENARIO = \"afterScenario\"", "var_name": "VAR_AFTER_SCENARIO"}], "methods": [{"identifier": "putBinding", "parameters": "(String name, ScenarioContext context)", "modifiers": "private static", "return": "void", "signature": "void putBinding(String name, ScenarioContext context)", "full_signature": "private static void putBinding(String name, ScenarioContext context)", "class_method_signature": "FeatureBackend.putBinding(String name, ScenarioContext context)", "testcase": false, "constructor": false}, {"identifier": "putBinding2", "parameters": "(String name, ScenarioContext context)", "modifiers": "private static", "return": "void", "signature": "void putBinding2(String name, ScenarioContext context)", "full_signature": "private static void putBinding2(String name, ScenarioContext context)", "class_method_signature": "FeatureBackend.putBinding2(String name, ScenarioContext context)", "testcase": false, "constructor": false}, {"identifier": "getContext", "parameters": "()", "modifiers": "public", "return": "ScenarioContext", "signature": "ScenarioContext getContext()", "full_signature": "public ScenarioContext getContext()", "class_method_signature": "FeatureBackend.getContext()", "testcase": false, "constructor": false}, {"identifier": "getFeatureName", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getFeatureName()", "full_signature": "public String getFeatureName()", "class_method_signature": "FeatureBackend.getFeatureName()", "testcase": false, "constructor": false}, {"identifier": "FeatureBackend", "parameters": "(Feature feature)", "modifiers": "public", "return": "", "signature": " FeatureBackend(Feature feature)", "full_signature": "public  FeatureBackend(Feature feature)", "class_method_signature": "FeatureBackend.FeatureBackend(Feature feature)", "testcase": false, "constructor": true}, {"identifier": "FeatureBackend", "parameters": "(Feature feature, Map<String, Object> arg)", "modifiers": "public", "return": "", "signature": " FeatureBackend(Feature feature, Map<String, Object> arg)", "full_signature": "public  FeatureBackend(Feature feature, Map<String, Object> arg)", "class_method_signature": "FeatureBackend.FeatureBackend(Feature feature, Map<String, Object> arg)", "testcase": false, "constructor": true}, {"identifier": "handle", "parameters": "(ScriptValueMap args, Scenario scenario)", "modifiers": "public", "return": "ScriptValueMap", "signature": "ScriptValueMap handle(ScriptValueMap args, Scenario scenario)", "full_signature": "public ScriptValueMap handle(ScriptValueMap args, Scenario scenario)", "class_method_signature": "FeatureBackend.handle(ScriptValueMap args, Scenario scenario)", "testcase": false, "constructor": false}, {"identifier": "getMatchingScenarios", "parameters": "(ScriptValueMap args)", "modifiers": "public", "return": "List<FeatureScenarioMatch>", "signature": "List<FeatureScenarioMatch> getMatchingScenarios(ScriptValueMap args)", "full_signature": "public List<FeatureScenarioMatch> getMatchingScenarios(ScriptValueMap args)", "class_method_signature": "FeatureBackend.getMatchingScenarios(ScriptValueMap args)", "testcase": false, "constructor": false}, {"identifier": "isMatchingScenario", "parameters": "(Scenario scenario)", "modifiers": "private", "return": "boolean", "signature": "boolean isMatchingScenario(Scenario scenario)", "full_signature": "private boolean isMatchingScenario(Scenario scenario)", "class_method_signature": "FeatureBackend.isMatchingScenario(Scenario scenario)", "testcase": false, "constructor": false}, {"identifier": "getDefaultScenario", "parameters": "(ScriptValueMap args)", "modifiers": "public", "return": "Scenario", "signature": "Scenario getDefaultScenario(ScriptValueMap args)", "full_signature": "public Scenario getDefaultScenario(ScriptValueMap args)", "class_method_signature": "FeatureBackend.getDefaultScenario(ScriptValueMap args)", "testcase": false, "constructor": false}, {"identifier": "isDefaultScenario", "parameters": "(Scenario scenario)", "modifiers": "private", "return": "boolean", "signature": "boolean isDefaultScenario(Scenario scenario)", "full_signature": "private boolean isDefaultScenario(Scenario scenario)", "class_method_signature": "FeatureBackend.isDefaultScenario(Scenario scenario)", "testcase": false, "constructor": false}, {"identifier": "corsCheck", "parameters": "(HttpRequest request, long startTime)", "modifiers": "public", "return": "HttpResponse", "signature": "HttpResponse corsCheck(HttpRequest request, long startTime)", "full_signature": "public HttpResponse corsCheck(HttpRequest request, long startTime)", "class_method_signature": "FeatureBackend.corsCheck(HttpRequest request, long startTime)", "testcase": false, "constructor": false}, {"identifier": "buildResponse", "parameters": "(HttpRequest request, long startTime, Scenario scenario, ScriptValueMap args)", "modifiers": "public", "return": "HttpResponse", "signature": "HttpResponse buildResponse(HttpRequest request, long startTime, Scenario scenario, ScriptValueMap args)", "full_signature": "public HttpResponse buildResponse(HttpRequest request, long startTime, Scenario scenario, ScriptValueMap args)", "class_method_signature": "FeatureBackend.buildResponse(HttpRequest request, long startTime, Scenario scenario, ScriptValueMap args)", "testcase": false, "constructor": false}], "file": "karate-core/src/main/java/com/intuit/karate/core/FeatureBackend.java"}, "focal_method": {"identifier": "handle", "parameters": "(ScriptValueMap args, Scenario scenario)", "modifiers": "public", "return": "ScriptValueMap", "body": "public ScriptValueMap handle(ScriptValueMap args, Scenario scenario) {\n        context.vars.putAll(args);\n        // This forces context to be refreshed by matching scenarios context variables\n        isMatchingScenario(scenario);\n        for (Step step : scenario.getSteps()) {\n            Result result = Engine.executeStep(step, actions);\n            if (result.isAborted()) {\n                context.logger.debug(\"abort at {}:{}\", featureName, step.getLine());\n                break;\n            }\n            if (result.isFailed()) {\n                String message = \"server-side scenario failed - \" + featureName + \":\" + step.getLine();\n                context.logger.error(message);\n                throw new KarateException(message, result.getError());\n            }\n        }\n        return context.vars;\n    }", "signature": "ScriptValueMap handle(ScriptValueMap args, Scenario scenario)", "full_signature": "public ScriptValueMap handle(ScriptValueMap args, Scenario scenario)", "class_method_signature": "FeatureBackend.handle(ScriptValueMap args, Scenario scenario)", "testcase": false, "constructor": false, "invocations": ["putAll", "isMatchingScenario", "getSteps", "executeStep", "isAborted", "debug", "getLine", "isFailed", "getLine", "error", "getError"]}, "repository": {"repo_id": 81226206, "url": "https://github.com/intuit/karate", "stars": 2712, "created": "2/7/2017 3:59:17 PM +00:00", "updates": "2020-01-27T21:00:57+00:00", "fork": "False", "license": "licensed"}}