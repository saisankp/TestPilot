{"test_class": {"identifier": "AddRoleTaskTest", "superclass": "", "interfaces": "", "fields": [], "file": "server/src/test/java/org/axway/grapes/server/webapp/tasks/AddRoleTaskTest.java"}, "test_case": {"identifier": "testAddRole", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testAddRole(){\n        final RepositoryHandler repositoryHandler = mock(RepositoryHandler.class);\n        final AddRoleTask task = new AddRoleTask(repositoryHandler);\n\n        final ImmutableMultimap.Builder<String, String> builder = new ImmutableMultimap.Builder<String, String>();\n        builder.put(ServerAPI.USER_PARAM, \"user\");\n        builder.put(ServerAPI.USER_ROLE_PARAM, \"data_updater\");\n        Exception exception = null;\n\n        try {\n            task.execute(builder.build(), mock(PrintWriter.class));\n        } catch (Exception e) {\n            exception = e;\n        }\n\n        assertNull(exception);\n        verify(repositoryHandler, times(1)).addUserRole(\"user\", AvailableRoles.DATA_UPDATER);\n\n    }", "signature": "void testAddRole()", "full_signature": "@Test public void testAddRole()", "class_method_signature": "AddRoleTaskTest.testAddRole()", "testcase": true, "constructor": false, "invocations": ["mock", "put", "put", "execute", "build", "mock", "assertNull", "addUserRole", "verify", "times"]}, "focal_class": {"identifier": "AddRoleTask", "superclass": "extends Task", "interfaces": "", "fields": [{"original_string": "private final RepositoryHandler repoHandler;", "modifier": "private final", "type": "RepositoryHandler", "declarator": "repoHandler", "var_name": "repoHandler"}], "methods": [{"identifier": "AddRoleTask", "parameters": "(final RepositoryHandler repoHandler)", "modifiers": "public", "return": "", "signature": " AddRoleTask(final RepositoryHandler repoHandler)", "full_signature": "public  AddRoleTask(final RepositoryHandler repoHandler)", "class_method_signature": "AddRoleTask.AddRoleTask(final RepositoryHandler repoHandler)", "testcase": false, "constructor": true}, {"identifier": "execute", "parameters": "(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "modifiers": "@Override public", "return": "void", "signature": "void execute(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "full_signature": "@Override public void execute(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "class_method_signature": "AddRoleTask.execute(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "testcase": false, "constructor": false}], "file": "server/src/main/java/org/axway/grapes/server/webapp/tasks/AddRoleTask.java"}, "focal_method": {"identifier": "execute", "parameters": "(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "modifiers": "@Override public", "return": "void", "body": "@Override\n\tpublic void execute(final ImmutableMultimap<String, String> args, final PrintWriter printer) throws AuthenticationException, UnknownHostException {\n\t\tprinter.println(\"Adding role...\");\n        final String user = args.get(ServerAPI.USER_PARAM).asList().get(0);\n        final String roleParam = args.get(ServerAPI.USER_ROLE_PARAM).asList().get(0);\n        final AvailableRoles role = DbCredential.getRole(roleParam);\n\n        if(user == null || role == null){\n            printer.println(\"ERROR: Bad request! The provided credential are unhealthy or incomplete.\");\n            return;\n        }\n        \n\t\trepoHandler.addUserRole(user, role);\n\n\t\tprinter.println(\"Task performed successfully.\");\n\t}", "signature": "void execute(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "full_signature": "@Override public void execute(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "class_method_signature": "AddRoleTask.execute(final ImmutableMultimap<String, String> args, final PrintWriter printer)", "testcase": false, "constructor": false, "invocations": ["println", "get", "asList", "get", "get", "asList", "get", "getRole", "println", "addUserRole", "println"]}, "repository": {"repo_id": 14858974, "url": "https://github.com/Axway/Grapes", "language": "Java", "is_fork": false, "fork_count": 9, "stargazer_count": 8, "size": 3620, "license": "licensed"}}