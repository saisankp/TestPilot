{"test_class": {"identifier": "DbUpgradeUtilsTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Mock\n    private Connection connectionMock;", "modifier": "@Mock\n    private", "type": "Connection", "declarator": "connectionMock", "var_name": "connectionMock"}, {"original_string": "@Mock\n    private DatabaseAccessObject daoMock;", "modifier": "@Mock\n    private", "type": "DatabaseAccessObject", "declarator": "daoMock", "var_name": "daoMock"}], "file": "engine/schema/src/test/java/com/cloud/upgrade/dao/DbUpgradeUtilsTest.java"}, "test_case": {"identifier": "testDropTableColumnsIfExistWhenThreeKeysAreSuppliedAnOneDoesnotExist", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testDropTableColumnsIfExistWhenThreeKeysAreSuppliedAnOneDoesnotExist() throws Exception {\n        Connection conn = connectionMock;\n        String tableName = \"tableName\";\n        String column1 = \"column1\";\n        String column2 = \"column2\";\n        String column3 = \"column3\";\n        when(daoMock.columnExists(conn, tableName, column1)).thenReturn(true);\n        when(daoMock.columnExists(conn, tableName, column2)).thenReturn(false);\n        when(daoMock.columnExists(conn, tableName, column3)).thenReturn(true);\n        List<String> keys = Arrays.asList(new String[] {column1, column2, column3});\n\n        DbUpgradeUtils.dropTableColumnsIfExist(conn, tableName, keys);\n\n        verify(daoMock, times(1)).columnExists(conn, tableName, column1);\n        verify(daoMock, times(1)).dropColumn(conn, tableName, column1);\n        verify(daoMock, times(1)).columnExists(conn, tableName, column2);\n        verify(daoMock, times(0)).dropColumn(conn, tableName, column2);\n        verify(daoMock, times(1)).columnExists(conn, tableName, column3);\n        verify(daoMock, times(1)).dropColumn(conn, tableName, column3);\n    }", "signature": "void testDropTableColumnsIfExistWhenThreeKeysAreSuppliedAnOneDoesnotExist()", "full_signature": "@Test public void testDropTableColumnsIfExistWhenThreeKeysAreSuppliedAnOneDoesnotExist()", "class_method_signature": "DbUpgradeUtilsTest.testDropTableColumnsIfExistWhenThreeKeysAreSuppliedAnOneDoesnotExist()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "columnExists", "thenReturn", "when", "columnExists", "thenReturn", "when", "columnExists", "asList", "dropTableColumnsIfExist", "columnExists", "verify", "times", "dropColumn", "verify", "times", "columnExists", "verify", "times", "dropColumn", "verify", "times", "columnExists", "verify", "times", "dropColumn", "verify", "times"]}, "focal_class": {"identifier": "DbUpgradeUtils", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static DatabaseAccessObject dao = new DatabaseAccessObject();", "modifier": "private static", "type": "DatabaseAccessObject", "declarator": "dao = new DatabaseAccessObject()", "var_name": "dao"}], "methods": [{"identifier": "dropKeysIfExist", "parameters": "(Connection conn, String tableName, List<String> keys, boolean isForeignKey)", "modifiers": "public static", "return": "void", "signature": "void dropKeysIfExist(Connection conn, String tableName, List<String> keys, boolean isForeignKey)", "full_signature": "public static void dropKeysIfExist(Connection conn, String tableName, List<String> keys, boolean isForeignKey)", "class_method_signature": "DbUpgradeUtils.dropKeysIfExist(Connection conn, String tableName, List<String> keys, boolean isForeignKey)", "testcase": false, "constructor": false}, {"identifier": "dropPrimaryKeyIfExists", "parameters": "(Connection conn, String tableName)", "modifiers": "public static", "return": "void", "signature": "void dropPrimaryKeyIfExists(Connection conn, String tableName)", "full_signature": "public static void dropPrimaryKeyIfExists(Connection conn, String tableName)", "class_method_signature": "DbUpgradeUtils.dropPrimaryKeyIfExists(Connection conn, String tableName)", "testcase": false, "constructor": false}, {"identifier": "dropTableColumnsIfExist", "parameters": "(Connection conn, String tableName, List<String> columns)", "modifiers": "public static", "return": "void", "signature": "void dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns)", "full_signature": "public static void dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns)", "class_method_signature": "DbUpgradeUtils.dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns)", "testcase": false, "constructor": false}], "file": "engine/schema/src/main/java/com/cloud/upgrade/dao/DbUpgradeUtils.java"}, "focal_method": {"identifier": "dropTableColumnsIfExist", "parameters": "(Connection conn, String tableName, List<String> columns)", "modifiers": "public static", "return": "void", "body": "public static void dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns) {\n        for (String columnName : columns) {\n            if (dao.columnExists(conn, tableName, columnName)) {\n                dao.dropColumn(conn, tableName, columnName);\n            }\n        }\n    }", "signature": "void dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns)", "full_signature": "public static void dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns)", "class_method_signature": "DbUpgradeUtils.dropTableColumnsIfExist(Connection conn, String tableName, List<String> columns)", "testcase": false, "constructor": false, "invocations": ["columnExists", "dropColumn"]}, "repository": {"repo_id": 49943894, "url": "https://github.com/MissionCriticalCloudOldRepos/cosmic-core", "language": "Java", "is_fork": false, "fork_count": 3, "stargazer_count": 9, "size": 18165, "license": "licensed"}}