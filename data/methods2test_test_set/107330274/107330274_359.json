{"test_class": {"identifier": "MachineIdConstraintTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String MACHINE_ID = \"1234\";", "modifier": "private static final", "type": "String", "declarator": "MACHINE_ID = \"1234\"", "var_name": "MACHINE_ID"}, {"original_string": "private final SchedulerConfiguration schedulerConfiguration = mock(SchedulerConfiguration.class);", "modifier": "private final", "type": "SchedulerConfiguration", "declarator": "schedulerConfiguration = mock(SchedulerConfiguration.class)", "var_name": "schedulerConfiguration"}, {"original_string": "private final AgentManagementService agentManagementService = mock(AgentManagementService.class);", "modifier": "private final", "type": "AgentManagementService", "declarator": "agentManagementService = mock(AgentManagementService.class)", "var_name": "agentManagementService"}, {"original_string": "private final MachineIdConstraint constraint = new MachineIdConstraint(schedulerConfiguration, agentManagementService, MACHINE_ID);", "modifier": "private final", "type": "MachineIdConstraint", "declarator": "constraint = new MachineIdConstraint(schedulerConfiguration, agentManagementService, MACHINE_ID)", "var_name": "constraint"}], "file": "titus-server-master/src/test/java/com/netflix/titus/master/scheduler/constraint/MachineIdConstraintTest.java"}, "test_case": {"identifier": "machineIdDoesMatch", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void machineIdDoesMatch() {\n        AgentInstance instance = AgentGenerator.agentInstances().getValue().toBuilder().withId(MACHINE_ID).build();\n        when(agentManagementService.findAgentInstance(MACHINE_ID)).thenReturn(Optional.of(instance));\n        Result result = constraint.evaluate(createTaskRequest(TASK_ID), createVirtualMachineCurrentStateMock(MACHINE_ID), createTaskTrackerState());\n        assertThat(result.isSuccessful()).isTrue();\n    }", "signature": "void machineIdDoesMatch()", "full_signature": "@Test public void machineIdDoesMatch()", "class_method_signature": "MachineIdConstraintTest.machineIdDoesMatch()", "testcase": true, "constructor": false, "invocations": ["build", "withId", "toBuilder", "getValue", "agentInstances", "thenReturn", "when", "findAgentInstance", "of", "evaluate", "createTaskRequest", "createVirtualMachineCurrentStateMock", "createTaskTrackerState", "isTrue", "assertThat", "isSuccessful"]}, "focal_class": {"identifier": "MachineIdConstraint", "superclass": "", "interfaces": "implements ConstraintEvaluator", "fields": [{"original_string": "public static final String NAME = \"MachineIdConstraint\";", "modifier": "public static final", "type": "String", "declarator": "NAME = \"MachineIdConstraint\"", "var_name": "NAME"}, {"original_string": "private static final Result VALID = new Result(true, null);", "modifier": "private static final", "type": "Result", "declarator": "VALID = new Result(true, null)", "var_name": "VALID"}, {"original_string": "private static final Result MACHINE_DOES_NOT_EXIST = new Result(false, \"The machine does not exist\");", "modifier": "private static final", "type": "Result", "declarator": "MACHINE_DOES_NOT_EXIST = new Result(false, \"The machine does not exist\")", "var_name": "MACHINE_DOES_NOT_EXIST"}, {"original_string": "private static final Result MACHINE_ID_DOES_NOT_MATCH = new Result(false, \"The machine id does not match the specified id\");", "modifier": "private static final", "type": "Result", "declarator": "MACHINE_ID_DOES_NOT_MATCH = new Result(false, \"The machine id does not match the specified id\")", "var_name": "MACHINE_ID_DOES_NOT_MATCH"}, {"original_string": "private final SchedulerConfiguration configuration;", "modifier": "private final", "type": "SchedulerConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final AgentManagementService agentManagementService;", "modifier": "private final", "type": "AgentManagementService", "declarator": "agentManagementService", "var_name": "agentManagementService"}, {"original_string": "private final String machineId;", "modifier": "private final", "type": "String", "declarator": "machineId", "var_name": "machineId"}], "methods": [{"identifier": "MachineIdConstraint", "parameters": "(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineId)", "modifiers": "public", "return": "", "signature": " MachineIdConstraint(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineId)", "full_signature": "public  MachineIdConstraint(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineId)", "class_method_signature": "MachineIdConstraint.MachineIdConstraint(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineId)", "testcase": false, "constructor": true}, {"identifier": "getName", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String getName()", "full_signature": "@Override public String getName()", "class_method_signature": "MachineIdConstraint.getName()", "testcase": false, "constructor": false}, {"identifier": "evaluate", "parameters": "(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "modifiers": "@Override public", "return": "Result", "signature": "Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "full_signature": "@Override public Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "class_method_signature": "MachineIdConstraint.evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "testcase": false, "constructor": false}], "file": "titus-server-master/src/main/java/com/netflix/titus/master/scheduler/constraint/MachineIdConstraint.java"}, "focal_method": {"identifier": "evaluate", "parameters": "(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "modifiers": "@Override public", "return": "Result", "body": "@Override\n    public Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState) {\n        Optional<AgentInstance> instanceOpt = SchedulerUtils.findInstance(agentManagementService, configuration.getInstanceAttributeName(), targetVM);\n        if (!instanceOpt.isPresent()) {\n            return MACHINE_DOES_NOT_EXIST;\n        }\n\n        AgentInstance agentInstance = instanceOpt.get();\n        return agentInstance.getId().equalsIgnoreCase(machineId) ? VALID : MACHINE_ID_DOES_NOT_MATCH;\n    }", "signature": "Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "full_signature": "@Override public Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "class_method_signature": "MachineIdConstraint.evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "testcase": false, "constructor": false, "invocations": ["findInstance", "getInstanceAttributeName", "isPresent", "get", "equalsIgnoreCase", "getId"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}