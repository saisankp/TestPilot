{"test_class": {"identifier": "DoubleBondAcceptingAromaticityDetectorTest", "superclass": "extends CDKTestCase", "interfaces": "", "fields": [], "file": "legacy/src/test/java/org/openscience/cdk/aromaticity/DoubleBondAcceptingAromaticityDetectorTest.java"}, "test_case": {"identifier": "test3Amino2MethylPyridine", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void test3Amino2MethylPyridine() throws Exception {\n\n        IAtomContainer mol = new AtomContainer();\n        IAtom a1 = mol.getBuilder().newInstance(IAtom.class, \"N\");\n        a1.setPoint2d(new Point2d(3.7321, 1.345));\n        mol.addAtom(a1);\n        IAtom a2 = mol.getBuilder().newInstance(IAtom.class, \"N\");\n        a2.setPoint2d(new Point2d(4.5981, -1.155));\n        mol.addAtom(a2);\n        IAtom a3 = mol.getBuilder().newInstance(IAtom.class, \"C\");\n        a3.setPoint2d(new Point2d(2.866, -0.155));\n        mol.addAtom(a3);\n        IAtom a4 = mol.getBuilder().newInstance(IAtom.class, \"C\");\n        a4.setPoint2d(new Point2d(3.7321, 0.345));\n        mol.addAtom(a4);\n        IAtom a5 = mol.getBuilder().newInstance(IAtom.class, \"C\");\n        a5.setPoint2d(new Point2d(2.866, -1.155));\n        mol.addAtom(a5);\n        IAtom a6 = mol.getBuilder().newInstance(IAtom.class, \"C\");\n        a6.setPoint2d(new Point2d(2.0, 0.345));\n        mol.addAtom(a6);\n        IAtom a7 = mol.getBuilder().newInstance(IAtom.class, \"C\");\n        a7.setPoint2d(new Point2d(4.5981, -0.155));\n        mol.addAtom(a7);\n        IAtom a8 = mol.getBuilder().newInstance(IAtom.class, \"C\");\n        a8.setPoint2d(new Point2d(3.7321, -1.655));\n        mol.addAtom(a8);\n        IAtom a9 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a9.setPoint2d(new Point2d(2.3291, -1.465));\n        mol.addAtom(a9);\n        IAtom a10 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a10.setPoint2d(new Point2d(2.31, 0.8819));\n        mol.addAtom(a10);\n        IAtom a11 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a11.setPoint2d(new Point2d(1.4631, 0.655));\n        mol.addAtom(a11);\n        IAtom a12 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a12.setPoint2d(new Point2d(1.69, -0.1919));\n        mol.addAtom(a12);\n        IAtom a13 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a13.setPoint2d(new Point2d(5.135, 0.155));\n        mol.addAtom(a13);\n        IAtom a14 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a14.setPoint2d(new Point2d(3.7321, -2.275));\n        mol.addAtom(a14);\n        IAtom a15 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a15.setPoint2d(new Point2d(4.269, 1.655));\n        mol.addAtom(a15);\n        IAtom a16 = mol.getBuilder().newInstance(IAtom.class, \"H\");\n        a16.setPoint2d(new Point2d(3.1951, 1.655));\n        mol.addAtom(a16);\n        IBond b1 = mol.getBuilder().newInstance(IBond.class, a1, a4, IBond.Order.SINGLE);\n        mol.addBond(b1);\n        IBond b2 = mol.getBuilder().newInstance(IBond.class, a1, a15, IBond.Order.SINGLE);\n        mol.addBond(b2);\n        IBond b3 = mol.getBuilder().newInstance(IBond.class, a1, a16, IBond.Order.SINGLE);\n        mol.addBond(b3);\n        IBond b4 = mol.getBuilder().newInstance(IBond.class, a2, a7, IBond.Order.DOUBLE);\n        mol.addBond(b4);\n        IBond b5 = mol.getBuilder().newInstance(IBond.class, a2, a8, IBond.Order.SINGLE);\n        mol.addBond(b5);\n        IBond b6 = mol.getBuilder().newInstance(IBond.class, a3, a4, IBond.Order.DOUBLE);\n        mol.addBond(b6);\n        IBond b7 = mol.getBuilder().newInstance(IBond.class, a3, a5, IBond.Order.SINGLE);\n        mol.addBond(b7);\n        IBond b8 = mol.getBuilder().newInstance(IBond.class, a3, a6, IBond.Order.SINGLE);\n        mol.addBond(b8);\n        IBond b9 = mol.getBuilder().newInstance(IBond.class, a4, a7, IBond.Order.SINGLE);\n        mol.addBond(b9);\n        IBond b10 = mol.getBuilder().newInstance(IBond.class, a5, a8, IBond.Order.DOUBLE);\n        mol.addBond(b10);\n        IBond b11 = mol.getBuilder().newInstance(IBond.class, a5, a9, IBond.Order.SINGLE);\n        mol.addBond(b11);\n        IBond b12 = mol.getBuilder().newInstance(IBond.class, a6, a10, IBond.Order.SINGLE);\n        mol.addBond(b12);\n        IBond b13 = mol.getBuilder().newInstance(IBond.class, a6, a11, IBond.Order.SINGLE);\n        mol.addBond(b13);\n        IBond b14 = mol.getBuilder().newInstance(IBond.class, a6, a12, IBond.Order.SINGLE);\n        mol.addBond(b14);\n        IBond b15 = mol.getBuilder().newInstance(IBond.class, a7, a13, IBond.Order.SINGLE);\n        mol.addBond(b15);\n        IBond b16 = mol.getBuilder().newInstance(IBond.class, a8, a14, IBond.Order.SINGLE);\n        mol.addBond(b16);\n\n        AtomContainerManipulator.percieveAtomTypesAndConfigureAtoms(mol);\n        boolean isAromatic = DoubleBondAcceptingAromaticityDetector.detectAromaticity(mol);\n        Assert.assertTrue(isAromatic);\n\n        Iterator<IAtom> atoms = mol.atoms().iterator();\n        int nCarom = 0;\n        int nCalip = 0;\n        int nNarom = 0;\n        int nNaliph = 0;\n        while (atoms.hasNext()) {\n            IAtom atom = atoms.next();\n            if (atom.getSymbol().equals(\"C\")) {\n                if (atom.getFlag(CDKConstants.ISAROMATIC))\n                    nCarom++;\n                else\n                    nCalip++;\n            } else if (atom.getSymbol().equals(\"N\")) {\n                if (atom.getFlag(CDKConstants.ISAROMATIC))\n                    nNarom++;\n                else\n                    nNaliph++;\n            }\n\n        }\n        Assert.assertEquals(5, nCarom);\n        Assert.assertEquals(1, nCalip);\n        Assert.assertEquals(1, nNarom);\n        Assert.assertEquals(1, nNaliph);\n    }", "signature": "void test3Amino2MethylPyridine()", "full_signature": "@Test public void test3Amino2MethylPyridine()", "class_method_signature": "DoubleBondAcceptingAromaticityDetectorTest.test3Amino2MethylPyridine()", "testcase": true, "constructor": false, "invocations": ["newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "setPoint2d", "addAtom", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "newInstance", "getBuilder", "addBond", "percieveAtomTypesAndConfigureAtoms", "detectAromaticity", "assertTrue", "iterator", "atoms", "hasNext", "next", "equals", "getSymbol", "getFlag", "equals", "getSymbol", "getFlag", "assertEquals", "assertEquals", "assertEquals", "assertEquals"]}, "focal_class": {"identifier": "DoubleBondAcceptingAromaticityDetector", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static AtomTypeFactory factory = null;", "modifier": "private static", "type": "AtomTypeFactory", "declarator": "factory = null", "var_name": "factory"}], "methods": [{"identifier": "detectAromaticity", "parameters": "(IAtomContainer atomContainer)", "modifiers": "public static", "return": "boolean", "signature": "boolean detectAromaticity(IAtomContainer atomContainer)", "full_signature": "public static boolean detectAromaticity(IAtomContainer atomContainer)", "class_method_signature": "DoubleBondAcceptingAromaticityDetector.detectAromaticity(IAtomContainer atomContainer)", "testcase": false, "constructor": false}, {"identifier": "isHueckelValid", "parameters": "(IAtomContainer singleRing)", "modifiers": "private static", "return": "boolean", "signature": "boolean isHueckelValid(IAtomContainer singleRing)", "full_signature": "private static boolean isHueckelValid(IAtomContainer singleRing)", "class_method_signature": "DoubleBondAcceptingAromaticityDetector.isHueckelValid(IAtomContainer singleRing)", "testcase": false, "constructor": false}, {"identifier": "atomIsPotentiallyAromatic", "parameters": "(IAtom atom)", "modifiers": "private static", "return": "boolean", "signature": "boolean atomIsPotentiallyAromatic(IAtom atom)", "full_signature": "private static boolean atomIsPotentiallyAromatic(IAtom atom)", "class_method_signature": "DoubleBondAcceptingAromaticityDetector.atomIsPotentiallyAromatic(IAtom atom)", "testcase": false, "constructor": false}, {"identifier": "getLonePairCount", "parameters": "(IAtom atom)", "modifiers": "private static", "return": "int", "signature": "int getLonePairCount(IAtom atom)", "full_signature": "private static int getLonePairCount(IAtom atom)", "class_method_signature": "DoubleBondAcceptingAromaticityDetector.getLonePairCount(IAtom atom)", "testcase": false, "constructor": false}, {"identifier": "markRingAtomsAndBondsAromatic", "parameters": "(IAtomContainer container)", "modifiers": "private static", "return": "void", "signature": "void markRingAtomsAndBondsAromatic(IAtomContainer container)", "full_signature": "private static void markRingAtomsAndBondsAromatic(IAtomContainer container)", "class_method_signature": "DoubleBondAcceptingAromaticityDetector.markRingAtomsAndBondsAromatic(IAtomContainer container)", "testcase": false, "constructor": false}], "file": "legacy/src/main/java/org/openscience/cdk/aromaticity/DoubleBondAcceptingAromaticityDetector.java"}, "focal_method": {"identifier": "detectAromaticity", "parameters": "(IAtomContainer atomContainer)", "modifiers": "public static", "return": "boolean", "body": "public static boolean detectAromaticity(IAtomContainer atomContainer) throws CDKException {\n        SpanningTree spanningTree = new SpanningTree(atomContainer);\n        IAtomContainer ringSystems = spanningTree.getCyclicFragmentsContainer();\n        if (ringSystems.getAtomCount() == 0) {\n            // If there are no rings, then there cannot be any aromaticity\n            return false;\n        }\n        // disregard all atoms we know that cannot be aromatic anyway\n        for (IAtom atom : ringSystems.atoms())\n            if (!atomIsPotentiallyAromatic(atom)) ringSystems.removeAtom(atom);\n\n        // FIXME: should not really mark them here\n        Iterator<IAtom> atoms = ringSystems.atoms().iterator();\n        while (atoms.hasNext())\n            atoms.next().setFlag(CDKConstants.ISINRING, true);\n        Iterator<IBond> bonds = ringSystems.bonds().iterator();\n        while (bonds.hasNext())\n            bonds.next().setFlag(CDKConstants.ISINRING, true);\n\n        boolean foundSomeAromaticity = false;\n        Iterator<IAtomContainer> isolatedRingSystems = ConnectivityChecker.partitionIntoMolecules(ringSystems)\n                .atomContainers().iterator();\n        while (isolatedRingSystems.hasNext()) {\n            IAtomContainer isolatedSystem = isolatedRingSystems.next();\n            IRingSet singleRings = Cycles.sssr(isolatedSystem).toRingSet();\n            Iterator<IAtomContainer> singleRingsIterator = singleRings.atomContainers().iterator();\n            int maxRingSize = 20;\n            boolean allRingsAreAromatic = true;\n            // test single rings in SSSR\n            while (singleRingsIterator.hasNext()) {\n                IAtomContainer singleRing = singleRingsIterator.next();\n                if (singleRing.getAtomCount() > maxRingSize) maxRingSize = singleRing.getAtomCount();\n                // possibly aromatic\n                boolean ringIsAromatic = isHueckelValid(singleRing);\n                foundSomeAromaticity |= ringIsAromatic;\n                allRingsAreAromatic &= ringIsAromatic;\n                if (ringIsAromatic) markRingAtomsAndBondsAromatic(singleRing);\n            }\n            // OK, what about the one larger ring (if no aromaticity found in SSSR)?\n            if (!allRingsAreAromatic && singleRings.getAtomContainerCount() <= 3) {\n                // every ring system consisting of more than two rings is too difficult\n                Iterator<IAtomContainer> allRingsIterator = new AllRingsFinder()\n                        .findAllRingsInIsolatedRingSystem(isolatedSystem).atomContainers().iterator();\n                while (allRingsIterator.hasNext()) {\n                    // there should be exactly three rings, of which only one has a size larger\n                    // than the two previous ones\n                    IAtomContainer ring = allRingsIterator.next();\n                    if (ring.getAtomCount() <= maxRingSize) {\n                        // possibly aromatic\n                        boolean ringIsAromatic = isHueckelValid(ring);\n                        foundSomeAromaticity |= ringIsAromatic;\n                        if (ringIsAromatic) markRingAtomsAndBondsAromatic(ring);\n                    }\n                }\n            }\n        }\n\n        return foundSomeAromaticity;\n    }", "signature": "boolean detectAromaticity(IAtomContainer atomContainer)", "full_signature": "public static boolean detectAromaticity(IAtomContainer atomContainer)", "class_method_signature": "DoubleBondAcceptingAromaticityDetector.detectAromaticity(IAtomContainer atomContainer)", "testcase": false, "constructor": false, "invocations": ["getCyclicFragmentsContainer", "getAtomCount", "atoms", "atomIsPotentiallyAromatic", "removeAtom", "iterator", "atoms", "hasNext", "setFlag", "next", "iterator", "bonds", "hasNext", "setFlag", "next", "iterator", "atomContainers", "partitionIntoMolecules", "hasNext", "next", "toRingSet", "sssr", "iterator", "atomContainers", "hasNext", "next", "getAtomCount", "getAtomCount", "isHueckelValid", "markRingAtomsAndBondsAromatic", "getAtomContainerCount", "iterator", "atomContainers", "findAllRingsInIsolatedRingSystem", "hasNext", "next", "getAtomCount", "isHueckelValid", "markRingAtomsAndBondsAromatic"]}, "repository": {"repo_id": 660443, "url": "https://github.com/cdk/cdk", "stars": 220, "created": "5/11/2010 8:30:07 AM +00:00", "updates": "2020-01-27T19:04:04+00:00", "fork": "False", "license": "licensed"}}