{"test_class": {"identifier": "SecurityUtilsTest", "superclass": "", "interfaces": "", "fields": [], "file": "Editor/src/test/java/ch/hsr/servicestoolkit/editor/security/SecurityUtilsTest.java"}, "test_case": {"identifier": "testGetCurrentLogin", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetCurrentLogin() {\n        SecurityContext securityContext = SecurityContextHolder.createEmptyContext();\n        securityContext.setAuthentication(new UsernamePasswordAuthenticationToken(\"admin\", \"admin\"));\n        SecurityContextHolder.setContext(securityContext);\n        String login = SecurityUtils.getCurrentLogin();\n        assertThat(login).isEqualTo(\"admin\");\n    }", "signature": "void testGetCurrentLogin()", "full_signature": "@Test public void testGetCurrentLogin()", "class_method_signature": "SecurityUtilsTest.testGetCurrentLogin()", "testcase": true, "constructor": false, "invocations": ["createEmptyContext", "setAuthentication", "setContext", "getCurrentLogin", "isEqualTo", "assertThat"]}, "focal_class": {"identifier": "SecurityUtils", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "SecurityUtils", "parameters": "()", "modifiers": "private", "return": "", "signature": " SecurityUtils()", "full_signature": "private  SecurityUtils()", "class_method_signature": "SecurityUtils.SecurityUtils()", "testcase": false, "constructor": true}, {"identifier": "getCurrentLogin", "parameters": "()", "modifiers": "public static", "return": "String", "signature": "String getCurrentLogin()", "full_signature": "public static String getCurrentLogin()", "class_method_signature": "SecurityUtils.getCurrentLogin()", "testcase": false, "constructor": false}, {"identifier": "isAuthenticated", "parameters": "()", "modifiers": "public static", "return": "boolean", "signature": "boolean isAuthenticated()", "full_signature": "public static boolean isAuthenticated()", "class_method_signature": "SecurityUtils.isAuthenticated()", "testcase": false, "constructor": false}, {"identifier": "isUserInRole", "parameters": "(String authority)", "modifiers": "public static", "return": "boolean", "signature": "boolean isUserInRole(String authority)", "full_signature": "public static boolean isUserInRole(String authority)", "class_method_signature": "SecurityUtils.isUserInRole(String authority)", "testcase": false, "constructor": false}], "file": "Editor/src/main/java/ch/hsr/servicestoolkit/editor/security/SecurityUtils.java"}, "focal_method": {"identifier": "getCurrentLogin", "parameters": "()", "modifiers": "public static", "return": "String", "body": "public static String getCurrentLogin() {\n        SecurityContext securityContext = SecurityContextHolder.getContext();\n        Authentication authentication = securityContext.getAuthentication();\n        UserDetails springSecurityUser = null;\n        String userName = null;\n        if(authentication != null) {\n            if (authentication.getPrincipal() instanceof UserDetails) {\n                springSecurityUser = (UserDetails) authentication.getPrincipal();\n                userName = springSecurityUser.getUsername();\n            } else if (authentication.getPrincipal() instanceof String) {\n                userName = (String) authentication.getPrincipal();\n            }\n        }\n        return userName;\n    }", "signature": "String getCurrentLogin()", "full_signature": "public static String getCurrentLogin()", "class_method_signature": "SecurityUtils.getCurrentLogin()", "testcase": false, "constructor": false, "invocations": ["getContext", "getAuthentication", "getPrincipal", "getPrincipal", "getUsername", "getPrincipal", "getPrincipal"]}, "repository": {"repo_id": 42585709, "url": "https://github.com/ServiceCutter/ServiceCutter", "language": "Java", "is_fork": false, "fork_count": 9, "stargazer_count": 29, "size": 8580, "license": "licensed"}}