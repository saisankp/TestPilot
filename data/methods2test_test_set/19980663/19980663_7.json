{"test_class": {"identifier": "DocumentResourceTest", "superclass": "extends FoxtrotResourceTest", "interfaces": "", "fields": [{"original_string": "@Rule\n    public ResourceTestRule resources = ResourceTestRule.builder()\n            .addResource(new DocumentResource(getQueryStore(), new TableTranslator(new SegregationConfiguration())))\n            .addProvider(new FoxtrotExceptionMapper(getMapper()))\n            .setMapper(objectMapper)\n            .build();", "modifier": "@Rule\n    public", "type": "ResourceTestRule", "declarator": "resources = ResourceTestRule.builder()\n            .addResource(new DocumentResource(getQueryStore(), new TableTranslator(new SegregationConfiguration())))\n            .addProvider(new FoxtrotExceptionMapper(getMapper()))\n            .setMapper(objectMapper)\n            .build()", "var_name": "resources"}], "file": "foxtrot-server/src/test/java/com/flipkart/foxtrot/server/resources/DocumentResourceTest.java"}, "test_case": {"identifier": "testSaveDocuments", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testSaveDocuments() throws Exception {\n        List<Document> documents = new ArrayList<Document>();\n        String id1 = UUID.randomUUID()\n                .toString();\n        Document document1 = new Document(id1, System.currentTimeMillis(), getMapper().getNodeFactory()\n                .objectNode()\n                .put(\"D\", \"data\"));\n        String id2 = UUID.randomUUID()\n                .toString();\n        Document document2 = new Document(id2, System.currentTimeMillis(), getMapper().getNodeFactory()\n                .objectNode()\n                .put(\"D\", \"data\"));\n        documents.add(document1);\n        documents.add(document2);\n        Entity<List<Document>> listEntity = Entity.json(documents);\n        resources.client()\n                .target(String.format(\"/v1/document/%s/bulk\", TestUtils.TEST_TABLE_NAME))\n                .request()\n                .post(listEntity);\n        getElasticsearchConnection().refresh(ElasticsearchUtils.getIndices(TestUtils.TEST_TABLE_NAME));\n        compare(document1, getQueryStore().get(TestUtils.TEST_TABLE_NAME, id1));\n        compare(document2, getQueryStore().get(TestUtils.TEST_TABLE_NAME, id2));\n    }", "signature": "void testSaveDocuments()", "full_signature": "@Test public void testSaveDocuments()", "class_method_signature": "DocumentResourceTest.testSaveDocuments()", "testcase": true, "constructor": false, "invocations": ["toString", "randomUUID", "currentTimeMillis", "put", "objectNode", "getNodeFactory", "getMapper", "toString", "randomUUID", "currentTimeMillis", "put", "objectNode", "getNodeFactory", "getMapper", "add", "add", "json", "post", "request", "target", "client", "format", "refresh", "getElasticsearchConnection", "getIndices", "compare", "get", "getQueryStore", "compare", "get", "getQueryStore"]}, "focal_class": {"identifier": "DocumentResource", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final QueryStore queryStore;", "modifier": "private final", "type": "QueryStore", "declarator": "queryStore", "var_name": "queryStore"}, {"original_string": "private final TableTranslator tableTranslator;", "modifier": "private final", "type": "TableTranslator", "declarator": "tableTranslator", "var_name": "tableTranslator"}], "methods": [{"identifier": "DocumentResource", "parameters": "(QueryStore queryStore, TableTranslator tableTranslator)", "modifiers": "@Inject public", "return": "", "signature": " DocumentResource(QueryStore queryStore, TableTranslator tableTranslator)", "full_signature": "@Inject public  DocumentResource(QueryStore queryStore, TableTranslator tableTranslator)", "class_method_signature": "DocumentResource.DocumentResource(QueryStore queryStore, TableTranslator tableTranslator)", "testcase": false, "constructor": true}, {"identifier": "saveDocument", "parameters": "(@PathParam(\"table\") String table, @Valid final Document document)", "modifiers": "@POST @Consumes(MediaType.APPLICATION_JSON) @Timed @ApiOperation(\"Save Document\") public", "return": "Response", "signature": "Response saveDocument(@PathParam(\"table\") String table, @Valid final Document document)", "full_signature": "@POST @Consumes(MediaType.APPLICATION_JSON) @Timed @ApiOperation(\"Save Document\") public Response saveDocument(@PathParam(\"table\") String table, @Valid final Document document)", "class_method_signature": "DocumentResource.saveDocument(@PathParam(\"table\") String table, @Valid final Document document)", "testcase": false, "constructor": false}, {"identifier": "saveDocuments", "parameters": "(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "modifiers": "@POST @Path(\"/bulk\") @Consumes(MediaType.APPLICATION_JSON) @Timed @ApiOperation(\"Save list of documents\") public", "return": "Response", "signature": "Response saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "full_signature": "@POST @Path(\"/bulk\") @Consumes(MediaType.APPLICATION_JSON) @Timed @ApiOperation(\"Save list of documents\") public Response saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "class_method_signature": "DocumentResource.saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "testcase": false, "constructor": false}, {"identifier": "getDocument", "parameters": "(@PathParam(\"table\") final String table, @PathParam(\"id\") @NotNull final String id)", "modifiers": "@GET @Path(\"/{id}\") @Timed @ApiOperation(\"Get Document\") public", "return": "Response", "signature": "Response getDocument(@PathParam(\"table\") final String table, @PathParam(\"id\") @NotNull final String id)", "full_signature": "@GET @Path(\"/{id}\") @Timed @ApiOperation(\"Get Document\") public Response getDocument(@PathParam(\"table\") final String table, @PathParam(\"id\") @NotNull final String id)", "class_method_signature": "DocumentResource.getDocument(@PathParam(\"table\") final String table, @PathParam(\"id\") @NotNull final String id)", "testcase": false, "constructor": false}, {"identifier": "getDocuments", "parameters": "(@PathParam(\"table\") final String table, @QueryParam(\"id\") @NotNull final List<String> ids)", "modifiers": "@GET @Timed @ApiOperation(\"Get Documents\") public", "return": "Response", "signature": "Response getDocuments(@PathParam(\"table\") final String table, @QueryParam(\"id\") @NotNull final List<String> ids)", "full_signature": "@GET @Timed @ApiOperation(\"Get Documents\") public Response getDocuments(@PathParam(\"table\") final String table, @QueryParam(\"id\") @NotNull final List<String> ids)", "class_method_signature": "DocumentResource.getDocuments(@PathParam(\"table\") final String table, @QueryParam(\"id\") @NotNull final List<String> ids)", "testcase": false, "constructor": false}, {"identifier": "getTableVsDocuments", "parameters": "(String table, List<Document> documents)", "modifiers": "private", "return": "Map<String, List<Document>>", "signature": "Map<String, List<Document>> getTableVsDocuments(String table, List<Document> documents)", "full_signature": "private Map<String, List<Document>> getTableVsDocuments(String table, List<Document> documents)", "class_method_signature": "DocumentResource.getTableVsDocuments(String table, List<Document> documents)", "testcase": false, "constructor": false}], "file": "foxtrot-server/src/main/java/com/flipkart/foxtrot/server/resources/DocumentResource.java"}, "focal_method": {"identifier": "saveDocuments", "parameters": "(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "modifiers": "@POST @Path(\"/bulk\") @Consumes(MediaType.APPLICATION_JSON) @Timed @ApiOperation(\"Save list of documents\") public", "return": "Response", "body": "@POST\n    @Path(\"/bulk\")\n    @Consumes(MediaType.APPLICATION_JSON)\n    @Timed\n    @ApiOperation(\"Save list of documents\")\n    public Response saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents) {\n        Map<String, List<Document>> tableVsDocuments = getTableVsDocuments(table, documents);\n        for(Map.Entry<String, List<Document>> entry : CollectionUtils.nullSafeSet(tableVsDocuments.entrySet())) {\n            queryStore.save(entry.getKey(), entry.getValue());\n        }\n        return Response.created(URI.create(\"/\" + table))\n                .build();\n    }", "signature": "Response saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "full_signature": "@POST @Path(\"/bulk\") @Consumes(MediaType.APPLICATION_JSON) @Timed @ApiOperation(\"Save list of documents\") public Response saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "class_method_signature": "DocumentResource.saveDocuments(@PathParam(\"table\") String table, @Valid final List<Document> documents)", "testcase": false, "constructor": false, "invocations": ["getTableVsDocuments", "nullSafeSet", "entrySet", "save", "getKey", "getValue", "build", "created", "create"]}, "repository": {"repo_id": 19980663, "url": "https://github.com/Flipkart/foxtrot", "stars": 22, "created": "5/20/2014 12:52:55 PM +00:00", "updates": "2020-01-07T07:05:03+00:00", "fork": "False", "license": "licensed"}}