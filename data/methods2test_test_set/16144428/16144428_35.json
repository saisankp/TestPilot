{"test_class": {"identifier": "WmfDumpFileManagerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "MockWebResourceFetcher wrf;", "modifier": "", "type": "MockWebResourceFetcher", "declarator": "wrf", "var_name": "wrf"}, {"original_string": "MockDirectoryManager dm;", "modifier": "", "type": "MockDirectoryManager", "declarator": "dm", "var_name": "dm"}, {"original_string": "Path dmPath;", "modifier": "", "type": "Path", "declarator": "dmPath", "var_name": "dmPath"}], "file": "wdtk-dumpfiles/src/test/java/org/wikidata/wdtk/dumpfiles/wmf/WmfDumpFileManagerTest.java"}, "test_case": {"identifier": "getAllRelevantDumpsMainDumpMissing", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void getAllRelevantDumpsMainDumpMissing() throws IOException {\n\t\tsetLocalDump(\"20140220\", DumpContentType.DAILY, true);\n\t\tsetLocalDump(\"20140210\", DumpContentType.CURRENT, true);\n\n\t\tWmfDumpFileManager dumpFileManager = new WmfDumpFileManager(\n\t\t\t\t\"wikidatawiki\", dm, wrf);\n\n\t\tList<? extends MwDumpFile> dumpFiles = dumpFileManager\n\t\t\t\t.findAllRelevantRevisionDumps(false);\n\n\t\tassertEquals(dumpFiles.size(), 1);\n\t\tassertEquals(dumpFiles.get(0).getDumpContentType(),\n\t\t\t\tDumpContentType.DAILY);\n\t\tassertEquals(dumpFiles.get(0).getDateStamp(), \"20140220\");\n\t\tassertTrue(dumpFiles.get(0) instanceof WmfLocalDumpFile);\n\t}", "signature": "void getAllRelevantDumpsMainDumpMissing()", "full_signature": "@Test public void getAllRelevantDumpsMainDumpMissing()", "class_method_signature": "WmfDumpFileManagerTest.getAllRelevantDumpsMainDumpMissing()", "testcase": true, "constructor": false, "invocations": ["setLocalDump", "setLocalDump", "findAllRelevantRevisionDumps", "assertEquals", "size", "assertEquals", "getDumpContentType", "get", "assertEquals", "getDateStamp", "get", "assertTrue", "get"]}, "focal_class": {"identifier": "WmfDumpFileManager", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final Logger logger = LoggerFactory\n\t\t\t.getLogger(WmfDumpFileManager.class);", "modifier": "static final", "type": "Logger", "declarator": "logger = LoggerFactory\n\t\t\t.getLogger(WmfDumpFileManager.class)", "var_name": "logger"}, {"original_string": "static final String DATE_STAMP_PATTERN = \"\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\";", "modifier": "static final", "type": "String", "declarator": "DATE_STAMP_PATTERN = \"\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\\\\d\"", "var_name": "DATE_STAMP_PATTERN"}, {"original_string": "public static final String DOWNLOAD_DIRECTORY_NAME = \"dumpfiles\";", "modifier": "public static final", "type": "String", "declarator": "DOWNLOAD_DIRECTORY_NAME = \"dumpfiles\"", "var_name": "DOWNLOAD_DIRECTORY_NAME"}, {"original_string": "final String projectName;", "modifier": "final", "type": "String", "declarator": "projectName", "var_name": "projectName"}, {"original_string": "final DirectoryManager dumpfileDirectoryManager;", "modifier": "final", "type": "DirectoryManager", "declarator": "dumpfileDirectoryManager", "var_name": "dumpfileDirectoryManager"}, {"original_string": "final WebResourceFetcher webResourceFetcher;", "modifier": "final", "type": "WebResourceFetcher", "declarator": "webResourceFetcher", "var_name": "webResourceFetcher"}], "methods": [{"identifier": "WmfDumpFileManager", "parameters": "(String projectName,\n\t\t\tDirectoryManager downloadDirectoryManager,\n\t\t\tWebResourceFetcher webResourceFetcher)", "modifiers": "public", "return": "", "signature": " WmfDumpFileManager(String projectName,\n\t\t\tDirectoryManager downloadDirectoryManager,\n\t\t\tWebResourceFetcher webResourceFetcher)", "full_signature": "public  WmfDumpFileManager(String projectName,\n\t\t\tDirectoryManager downloadDirectoryManager,\n\t\t\tWebResourceFetcher webResourceFetcher)", "class_method_signature": "WmfDumpFileManager.WmfDumpFileManager(String projectName,\n\t\t\tDirectoryManager downloadDirectoryManager,\n\t\t\tWebResourceFetcher webResourceFetcher)", "testcase": false, "constructor": true}, {"identifier": "findAllRelevantRevisionDumps", "parameters": "(boolean preferCurrent)", "modifiers": "public", "return": "List<MwDumpFile>", "signature": "List<MwDumpFile> findAllRelevantRevisionDumps(boolean preferCurrent)", "full_signature": "public List<MwDumpFile> findAllRelevantRevisionDumps(boolean preferCurrent)", "class_method_signature": "WmfDumpFileManager.findAllRelevantRevisionDumps(boolean preferCurrent)", "testcase": false, "constructor": false}, {"identifier": "findMostRecentDump", "parameters": "(DumpContentType dumpContentType)", "modifiers": "public", "return": "MwDumpFile", "signature": "MwDumpFile findMostRecentDump(DumpContentType dumpContentType)", "full_signature": "public MwDumpFile findMostRecentDump(DumpContentType dumpContentType)", "class_method_signature": "WmfDumpFileManager.findMostRecentDump(DumpContentType dumpContentType)", "testcase": false, "constructor": false}, {"identifier": "findAllDumps", "parameters": "(DumpContentType dumpContentType)", "modifiers": "public", "return": "List<MwDumpFile>", "signature": "List<MwDumpFile> findAllDumps(DumpContentType dumpContentType)", "full_signature": "public List<MwDumpFile> findAllDumps(DumpContentType dumpContentType)", "class_method_signature": "WmfDumpFileManager.findAllDumps(DumpContentType dumpContentType)", "testcase": false, "constructor": false}, {"identifier": "mergeDumpLists", "parameters": "(List<MwDumpFile> localDumps,\n\t\t\tList<MwDumpFile> onlineDumps)", "modifiers": "", "return": "List<MwDumpFile>", "signature": "List<MwDumpFile> mergeDumpLists(List<MwDumpFile> localDumps,\n\t\t\tList<MwDumpFile> onlineDumps)", "full_signature": " List<MwDumpFile> mergeDumpLists(List<MwDumpFile> localDumps,\n\t\t\tList<MwDumpFile> onlineDumps)", "class_method_signature": "WmfDumpFileManager.mergeDumpLists(List<MwDumpFile> localDumps,\n\t\t\tList<MwDumpFile> onlineDumps)", "testcase": false, "constructor": false}, {"identifier": "findDumpsLocally", "parameters": "(DumpContentType dumpContentType)", "modifiers": "", "return": "List<MwDumpFile>", "signature": "List<MwDumpFile> findDumpsLocally(DumpContentType dumpContentType)", "full_signature": " List<MwDumpFile> findDumpsLocally(DumpContentType dumpContentType)", "class_method_signature": "WmfDumpFileManager.findDumpsLocally(DumpContentType dumpContentType)", "testcase": false, "constructor": false}, {"identifier": "findDumpsOnline", "parameters": "(DumpContentType dumpContentType)", "modifiers": "", "return": "List<MwDumpFile>", "signature": "List<MwDumpFile> findDumpsOnline(DumpContentType dumpContentType)", "full_signature": " List<MwDumpFile> findDumpsOnline(DumpContentType dumpContentType)", "class_method_signature": "WmfDumpFileManager.findDumpsOnline(DumpContentType dumpContentType)", "testcase": false, "constructor": false}, {"identifier": "findDumpDatesOnline", "parameters": "(DumpContentType dumpContentType)", "modifiers": "", "return": "List<String>", "signature": "List<String> findDumpDatesOnline(DumpContentType dumpContentType)", "full_signature": " List<String> findDumpDatesOnline(DumpContentType dumpContentType)", "class_method_signature": "WmfDumpFileManager.findDumpDatesOnline(DumpContentType dumpContentType)", "testcase": false, "constructor": false}], "file": "wdtk-dumpfiles/src/main/java/org/wikidata/wdtk/dumpfiles/wmf/WmfDumpFileManager.java"}, "focal_method": {"identifier": "findAllRelevantRevisionDumps", "parameters": "(boolean preferCurrent)", "modifiers": "public", "return": "List<MwDumpFile>", "body": "public List<MwDumpFile> findAllRelevantRevisionDumps(boolean preferCurrent) {\n\t\tMwDumpFile mainDump;\n\t\tif (preferCurrent) {\n\t\t\tmainDump = findMostRecentDump(DumpContentType.CURRENT);\n\t\t} else {\n\t\t\tmainDump = findMostRecentDump(DumpContentType.FULL);\n\t\t}\n\t\tif (mainDump == null) {\n\t\t\treturn findAllDumps(DumpContentType.DAILY);\n\t\t}\n\n\t\tList<MwDumpFile> result = new ArrayList<>();\n\n\t\tfor (MwDumpFile dumpFile : findAllDumps(DumpContentType.DAILY)) {\n\t\t\tif (dumpFile.getDateStamp().compareTo(mainDump.getDateStamp()) > 0) {\n\t\t\t\tresult.add(dumpFile);\n\t\t\t}\n\t\t}\n\n\t\tresult.add(mainDump);\n\n\t\tif (logger.isInfoEnabled()) {\n\t\t\tStringBuilder logMessage = new StringBuilder();\n\t\t\tlogMessage.append(\"Found \")\n\t\t\t\t\t.append(result.size())\n\t\t\t\t\t.append(\" relevant dumps to process:\");\n\t\t\tfor (MwDumpFile dumpFile : result) {\n\t\t\t\tlogMessage.append(\"\\n * \").append(dumpFile.toString());\n\t\t\t}\n\t\t\tlogger.info(logMessage.toString());\n\t\t}\n\n\t\treturn result;\n\t}", "signature": "List<MwDumpFile> findAllRelevantRevisionDumps(boolean preferCurrent)", "full_signature": "public List<MwDumpFile> findAllRelevantRevisionDumps(boolean preferCurrent)", "class_method_signature": "WmfDumpFileManager.findAllRelevantRevisionDumps(boolean preferCurrent)", "testcase": false, "constructor": false, "invocations": ["findMostRecentDump", "findMostRecentDump", "findAllDumps", "findAllDumps", "compareTo", "getDateStamp", "getDateStamp", "add", "add", "isInfoEnabled", "append", "append", "append", "size", "append", "append", "toString", "info", "toString"]}, "repository": {"repo_id": 16144428, "url": "https://github.com/Wikidata/Wikidata-Toolkit", "language": "Java", "is_fork": false, "fork_count": 80, "stargazer_count": 264, "size": 11241, "license": "licensed"}}