{"test_class": {"identifier": "CrlDaoTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final long LAST_UPDATE_TIME_OLDER_24H = System.currentTimeMillis() - 24 * 60 * 60 * 1000;", "modifier": "private static final", "type": "long", "declarator": "LAST_UPDATE_TIME_OLDER_24H = System.currentTimeMillis() - 24 * 60 * 60 * 1000", "var_name": "LAST_UPDATE_TIME_OLDER_24H"}, {"original_string": "private static final long LAST_UPDATE_TIME_WITHIN_24H = System.currentTimeMillis() - 2 * 60 * 60 * 1000;", "modifier": "private static final", "type": "long", "declarator": "LAST_UPDATE_TIME_WITHIN_24H = System.currentTimeMillis() - 2 * 60 * 60 * 1000", "var_name": "LAST_UPDATE_TIME_WITHIN_24H"}], "file": "poseidas/src/test/java/de/governikus/eumw/poseidas/eidserver/crl/CrlDaoTest.java"}, "test_case": {"identifier": "crlIsOlderThan24HoursReturnTrue", "parameters": "()", "modifiers": "@Test @DisplayName(\"returns true when last CRL update was within 24 hours\")", "return": "void", "body": "@Test\n  @DisplayName(\"returns true when last CRL update was within 24 hours\")\n  void crlIsOlderThan24HoursReturnTrue()\n  {\n    X509CRL x509CRLMock = Mockito.mock(X509CRL.class);\n    CrlDao crlDao = new CrlDao(x509CRLMock, LAST_UPDATE_TIME_OLDER_24H);\n    boolean isCrlOlderThan24Hours = crlDao.isCrlOlderThan24Hours();\n\n    Assertions.assertTrue(isCrlOlderThan24Hours);\n  }", "signature": "void crlIsOlderThan24HoursReturnTrue()", "full_signature": "@Test @DisplayName(\"returns true when last CRL update was within 24 hours\") void crlIsOlderThan24HoursReturnTrue()", "class_method_signature": "CrlDaoTest.crlIsOlderThan24HoursReturnTrue()", "testcase": true, "constructor": false, "invocations": ["mock", "isCrlOlderThan24Hours", "assertTrue"]}, "focal_class": {"identifier": "CrlDao", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Getter\n  private X509CRL x509CRL;", "modifier": "@Getter\n  private", "type": "X509CRL", "declarator": "x509CRL", "var_name": "x509CRL"}, {"original_string": "@Getter\n  private final long lastUpdate;", "modifier": "@Getter\n  private final", "type": "long", "declarator": "lastUpdate", "var_name": "lastUpdate"}], "methods": [{"identifier": "CrlDao", "parameters": "(X509CRL crl, long currentTimeMillis)", "modifiers": "public", "return": "", "signature": " CrlDao(X509CRL crl, long currentTimeMillis)", "full_signature": "public  CrlDao(X509CRL crl, long currentTimeMillis)", "class_method_signature": "CrlDao.CrlDao(X509CRL crl, long currentTimeMillis)", "testcase": false, "constructor": true}, {"identifier": "isCrlOlderThan24Hours", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isCrlOlderThan24Hours()", "full_signature": "public boolean isCrlOlderThan24Hours()", "class_method_signature": "CrlDao.isCrlOlderThan24Hours()", "testcase": false, "constructor": false}], "file": "poseidas/src/main/java/de/governikus/eumw/poseidas/eidserver/crl/CrlDao.java"}, "focal_method": {"identifier": "isCrlOlderThan24Hours", "parameters": "()", "modifiers": "public", "return": "boolean", "body": "public boolean isCrlOlderThan24Hours()\n  {\n    return System.currentTimeMillis() >= lastUpdate + 24 * 60 * 60 * 1000;\n  }", "signature": "boolean isCrlOlderThan24Hours()", "full_signature": "public boolean isCrlOlderThan24Hours()", "class_method_signature": "CrlDao.isCrlOlderThan24Hours()", "testcase": false, "constructor": false, "invocations": ["currentTimeMillis"]}, "repository": {"repo_id": 133799133, "url": "https://github.com/Governikus/eidas-middleware", "language": "Java", "is_fork": false, "fork_count": 11, "stargazer_count": 15, "size": 2286, "license": "licensed"}}