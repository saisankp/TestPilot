{"test_class": {"identifier": "JDBCBranchQueriesTest", "superclass": "extends PostgresTestCase", "interfaces": "", "fields": [{"original_string": "private DeveloperQueries developerQueries;", "modifier": "private", "type": "DeveloperQueries", "declarator": "developerQueries", "var_name": "developerQueries"}, {"original_string": "private ProjectQueries projectQueries;", "modifier": "private", "type": "ProjectQueries", "declarator": "projectQueries", "var_name": "projectQueries"}, {"original_string": "private BranchQueries queries;", "modifier": "private", "type": "BranchQueries", "declarator": "queries", "var_name": "queries"}, {"original_string": "private int projectId;", "modifier": "private", "type": "int", "declarator": "projectId", "var_name": "projectId"}, {"original_string": "private String mainDev;", "modifier": "private", "type": "String", "declarator": "mainDev", "var_name": "mainDev"}, {"original_string": "private SmellQueries smellQueries;", "modifier": "private", "type": "SmellQueries", "declarator": "smellQueries", "var_name": "smellQueries"}, {"original_string": "private CommitQueries commitQueries;", "modifier": "private", "type": "CommitQueries", "declarator": "commitQueries", "var_name": "commitQueries"}, {"original_string": "private Commit originCommit;", "modifier": "private", "type": "Commit", "declarator": "originCommit", "var_name": "originCommit"}, {"original_string": "private Commit mergedIntoCommit;", "modifier": "private", "type": "Commit", "declarator": "mergedIntoCommit", "var_name": "mergedIntoCommit"}, {"original_string": "private int mergedIntoCommitId;", "modifier": "private", "type": "int", "declarator": "mergedIntoCommitId", "var_name": "mergedIntoCommitId"}, {"original_string": "private int originCommitId;", "modifier": "private", "type": "int", "declarator": "originCommitId", "var_name": "originCommitId"}], "file": "SmellTracker/src/test/java/fr/inria/sniffer/tracker/analysis/persistence/queries/JDBCBranchQueriesTest.java"}, "test_case": {"identifier": "testBranchInsertionStatement", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testBranchInsertionStatement() {\n        long count = 0;\n\n        // We can call on not persisted commits.\n        // Warning: This will return null for both commit, which should be limited to the master branch\n        Commit notPersistedOriginCommit = generateCommit(\"origin\", 0);\n        Commit notPersistedMergedCommit = generateCommit(\"merged\", 42);\n        executeSuccess(queries.branchInsertionStatement(projectId, 9,\n                notPersistedOriginCommit, notPersistedMergedCommit));\n        assertEquals(++count, getBranchCount());\n\n        // We can insert any branch\n        Commit anotherCommit = prepareCommit(\"another\", 4);\n        executeSuccess(queries.branchInsertionStatement(projectId, 0, originCommit, mergedIntoCommit));\n        assertEquals(++count, getBranchCount());\n\n        // We can insert another branch ordinal\n        executeSuccess(queries.branchInsertionStatement(projectId, 1, originCommit, mergedIntoCommit));\n        assertEquals(++count, getBranchCount());\n        executeSuccess(queries.branchInsertionStatement(projectId, 2, anotherCommit, mergedIntoCommit));\n        assertEquals(++count, getBranchCount());\n        executeSuccess(queries.branchInsertionStatement(projectId, 3, mergedIntoCommit, anotherCommit));\n        assertEquals(++count, getBranchCount());\n\n        // We can insert the same branch ordinal in another project\n        int secondProjectID = createProject(\"anotherProject\", projectQueries);\n        executeSuccess(queries.branchInsertionStatement(secondProjectID, 0, originCommit, mergedIntoCommit));\n        assertEquals(++count, getBranchCount());\n\n        // We don't insert the same ordinal, whichever the commit\n        executeNothinhDone(queries.branchInsertionStatement(projectId, 0, originCommit, mergedIntoCommit));\n        assertEquals(count, getBranchCount());\n        executeNothinhDone(queries.branchInsertionStatement(projectId, 0, anotherCommit, mergedIntoCommit));\n        assertEquals(count, getBranchCount());\n        executeNothinhDone(queries.branchInsertionStatement(projectId, 0, mergedIntoCommit, anotherCommit));\n        assertEquals(count, getBranchCount());\n    }", "signature": "void testBranchInsertionStatement()", "full_signature": "@Test public void testBranchInsertionStatement()", "class_method_signature": "JDBCBranchQueriesTest.testBranchInsertionStatement()", "testcase": true, "constructor": false, "invocations": ["generateCommit", "generateCommit", "executeSuccess", "branchInsertionStatement", "assertEquals", "getBranchCount", "prepareCommit", "executeSuccess", "branchInsertionStatement", "assertEquals", "getBranchCount", "executeSuccess", "branchInsertionStatement", "assertEquals", "getBranchCount", "executeSuccess", "branchInsertionStatement", "assertEquals", "getBranchCount", "executeSuccess", "branchInsertionStatement", "assertEquals", "getBranchCount", "createProject", "executeSuccess", "branchInsertionStatement", "assertEquals", "getBranchCount", "executeNothinhDone", "branchInsertionStatement", "assertEquals", "getBranchCount", "executeNothinhDone", "branchInsertionStatement", "assertEquals", "getBranchCount", "executeNothinhDone", "branchInsertionStatement", "assertEquals", "getBranchCount"]}, "focal_class": {"identifier": "JDBCBranchQueries", "superclass": "extends JDBCQueriesHelper", "interfaces": "implements BranchQueries", "fields": [{"original_string": "private CommitQueries commitQueries;", "modifier": "private", "type": "CommitQueries", "declarator": "commitQueries", "var_name": "commitQueries"}, {"original_string": "private SmellQueries smellQueries;", "modifier": "private", "type": "SmellQueries", "declarator": "smellQueries", "var_name": "smellQueries"}], "methods": [{"identifier": "JDBCBranchQueries", "parameters": "(CommitQueries commitQueries, SmellQueries smellQueries)", "modifiers": "public", "return": "", "signature": " JDBCBranchQueries(CommitQueries commitQueries, SmellQueries smellQueries)", "full_signature": "public  JDBCBranchQueries(CommitQueries commitQueries, SmellQueries smellQueries)", "class_method_signature": "JDBCBranchQueries.JDBCBranchQueries(CommitQueries commitQueries, SmellQueries smellQueries)", "testcase": false, "constructor": true}, {"identifier": "branchInsertionStatement", "parameters": "(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "modifiers": "@Override public", "return": "String", "signature": "String branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "full_signature": "@Override public String branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "class_method_signature": "JDBCBranchQueries.branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "testcase": false, "constructor": false}, {"identifier": "branchCommitInsertionQuery", "parameters": "(int projectId, int branchOrdinal, String commitSha, int ordinal)", "modifiers": "@Override public", "return": "String", "signature": "String branchCommitInsertionQuery(int projectId, int branchOrdinal, String commitSha, int ordinal)", "full_signature": "@Override public String branchCommitInsertionQuery(int projectId, int branchOrdinal, String commitSha, int ordinal)", "class_method_signature": "JDBCBranchQueries.branchCommitInsertionQuery(int projectId, int branchOrdinal, String commitSha, int ordinal)", "testcase": false, "constructor": false}, {"identifier": "idFromOrdinalQueryStatement", "parameters": "(int projectId, int branchOrdinal)", "modifiers": "@Override public", "return": "String", "signature": "String idFromOrdinalQueryStatement(int projectId, int branchOrdinal)", "full_signature": "@Override public String idFromOrdinalQueryStatement(int projectId, int branchOrdinal)", "class_method_signature": "JDBCBranchQueries.idFromOrdinalQueryStatement(int projectId, int branchOrdinal)", "testcase": false, "constructor": false}, {"identifier": "idFromCommitQueryStatement", "parameters": "(int projectId, Commit commit)", "modifiers": "public", "return": "String", "signature": "String idFromCommitQueryStatement(int projectId, Commit commit)", "full_signature": "public String idFromCommitQueryStatement(int projectId, Commit commit)", "class_method_signature": "JDBCBranchQueries.idFromCommitQueryStatement(int projectId, Commit commit)", "testcase": false, "constructor": false}, {"identifier": "parentCommitSmellsQuery", "parameters": "(int projectId, int branchId, String smellType)", "modifiers": "@Override public", "return": "String", "signature": "String parentCommitSmellsQuery(int projectId, int branchId, String smellType)", "full_signature": "@Override public String parentCommitSmellsQuery(int projectId, int branchId, String smellType)", "class_method_signature": "JDBCBranchQueries.parentCommitSmellsQuery(int projectId, int branchId, String smellType)", "testcase": false, "constructor": false}, {"identifier": "lastCommitSmellsQuery", "parameters": "(int projectId, Commit merge, String smellType)", "modifiers": "@Override public", "return": "String", "signature": "String lastCommitSmellsQuery(int projectId, Commit merge, String smellType)", "full_signature": "@Override public String lastCommitSmellsQuery(int projectId, Commit merge, String smellType)", "class_method_signature": "JDBCBranchQueries.lastCommitSmellsQuery(int projectId, Commit merge, String smellType)", "testcase": false, "constructor": false}, {"identifier": "mergedBranchIdQuery", "parameters": "(int projectId, Commit commit)", "modifiers": "@Override public", "return": "String", "signature": "String mergedBranchIdQuery(int projectId, Commit commit)", "full_signature": "@Override public String mergedBranchIdQuery(int projectId, Commit commit)", "class_method_signature": "JDBCBranchQueries.mergedBranchIdQuery(int projectId, Commit commit)", "testcase": false, "constructor": false}, {"identifier": "shaFromOrdinalQuery", "parameters": "(int projectId, int branchId, int ordinal)", "modifiers": "@Override public", "return": "String", "signature": "String shaFromOrdinalQuery(int projectId, int branchId, int ordinal)", "full_signature": "@Override public String shaFromOrdinalQuery(int projectId, int branchId, int ordinal)", "class_method_signature": "JDBCBranchQueries.shaFromOrdinalQuery(int projectId, int branchId, int ordinal)", "testcase": false, "constructor": false}, {"identifier": "shaFromOrdinalQuery", "parameters": "(int projectId, int branchId, int ordinal, boolean paprikaOnly)", "modifiers": "@Override public", "return": "String", "signature": "String shaFromOrdinalQuery(int projectId, int branchId, int ordinal, boolean paprikaOnly)", "full_signature": "@Override public String shaFromOrdinalQuery(int projectId, int branchId, int ordinal, boolean paprikaOnly)", "class_method_signature": "JDBCBranchQueries.shaFromOrdinalQuery(int projectId, int branchId, int ordinal, boolean paprikaOnly)", "testcase": false, "constructor": false}, {"identifier": "parentCommitIdQuery", "parameters": "(int projectId, int branchId)", "modifiers": "@Override public", "return": "String", "signature": "String parentCommitIdQuery(int projectId, int branchId)", "full_signature": "@Override public String parentCommitIdQuery(int projectId, int branchId)", "class_method_signature": "JDBCBranchQueries.parentCommitIdQuery(int projectId, int branchId)", "testcase": false, "constructor": false}, {"identifier": "parentCommitShaQuery", "parameters": "(int projectId, int branchId)", "modifiers": "@Override public", "return": "String", "signature": "String parentCommitShaQuery(int projectId, int branchId)", "full_signature": "@Override public String parentCommitShaQuery(int projectId, int branchId)", "class_method_signature": "JDBCBranchQueries.parentCommitShaQuery(int projectId, int branchId)", "testcase": false, "constructor": false}, {"identifier": "lastCommitShaQuery", "parameters": "(int projectId, int branchId)", "modifiers": "@Override public", "return": "String", "signature": "String lastCommitShaQuery(int projectId, int branchId)", "full_signature": "@Override public String lastCommitShaQuery(int projectId, int branchId)", "class_method_signature": "JDBCBranchQueries.lastCommitShaQuery(int projectId, int branchId)", "testcase": false, "constructor": false}, {"identifier": "lastCommitIdQuery", "parameters": "(int projectId, int branchId)", "modifiers": "@Override public", "return": "String", "signature": "String lastCommitIdQuery(int projectId, int branchId)", "full_signature": "@Override public String lastCommitIdQuery(int projectId, int branchId)", "class_method_signature": "JDBCBranchQueries.lastCommitIdQuery(int projectId, int branchId)", "testcase": false, "constructor": false}, {"identifier": "commitOrdinalQuery", "parameters": "(int projectId, int branchId, Commit commit)", "modifiers": "@Override public", "return": "String", "signature": "String commitOrdinalQuery(int projectId, int branchId, Commit commit)", "full_signature": "@Override public String commitOrdinalQuery(int projectId, int branchId, Commit commit)", "class_method_signature": "JDBCBranchQueries.commitOrdinalQuery(int projectId, int branchId, Commit commit)", "testcase": false, "constructor": false}, {"identifier": "branchLastCommitQuery", "parameters": "(int projectId, int branchId, String field)", "modifiers": "private", "return": "String", "signature": "String branchLastCommitQuery(int projectId, int branchId, String field)", "full_signature": "private String branchLastCommitQuery(int projectId, int branchId, String field)", "class_method_signature": "JDBCBranchQueries.branchLastCommitQuery(int projectId, int branchId, String field)", "testcase": false, "constructor": false}, {"identifier": "branchLastCommitQuery", "parameters": "(int projectId, String branchId, String field)", "modifiers": "private", "return": "String", "signature": "String branchLastCommitQuery(int projectId, String branchId, String field)", "full_signature": "private String branchLastCommitQuery(int projectId, String branchId, String field)", "class_method_signature": "JDBCBranchQueries.branchLastCommitQuery(int projectId, String branchId, String field)", "testcase": false, "constructor": false}], "file": "SmellTracker/src/main/java/fr/inria/sniffer/tracker/analysis/persistence/queries/JDBCBranchQueries.java"}, "focal_method": {"identifier": "branchInsertionStatement", "parameters": "(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "modifiers": "@Override public", "return": "String", "body": "@Override\n    public String branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto) {\n        String parentCommitQuery = parentCommit == null ? null : \"(\" + commitQueries.idFromShaQuery(projectId, parentCommit.sha) + \")\";\n        String mergedIntoQuery = mergedInto == null ? null : \"(\" + commitQueries.idFromShaQuery(projectId, mergedInto.sha) + \")\";\n        return \"INSERT INTO branch (project_id, ordinal, parent_commit, merged_into) VALUES ('\"\n                + projectId + \"', '\" + ordinal + \"', \" + parentCommitQuery + \", \" + mergedIntoQuery\n                + \") ON CONFLICT DO NOTHING;\";\n    }", "signature": "String branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "full_signature": "@Override public String branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "class_method_signature": "JDBCBranchQueries.branchInsertionStatement(int projectId, int ordinal, Commit parentCommit, Commit mergedInto)", "testcase": false, "constructor": false, "invocations": ["idFromShaQuery", "idFromShaQuery"]}, "repository": {"repo_id": 175298978, "url": "https://github.com/HabchiSarra/Sniffer", "language": "Java", "is_fork": false, "fork_count": 2, "stargazer_count": 10, "size": 587, "license": "licensed"}}