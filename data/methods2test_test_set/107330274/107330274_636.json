{"test_class": {"identifier": "TaskEvictionResultStoreStepTest", "superclass": "extends AbstractTaskRelocationTest", "interfaces": "", "fields": [{"original_string": "private final RelocationConfiguration configuration = Archaius2Ext.newConfiguration(RelocationConfiguration.class);", "modifier": "private final", "type": "RelocationConfiguration", "declarator": "configuration = Archaius2Ext.newConfiguration(RelocationConfiguration.class)", "var_name": "configuration"}, {"original_string": "private final RelocationTransactionLogger transactionLog = new RelocationTransactionLogger(jobOperations);", "modifier": "private final", "type": "RelocationTransactionLogger", "declarator": "transactionLog = new RelocationTransactionLogger(jobOperations)", "var_name": "transactionLog"}, {"original_string": "private TaskRelocationResultStore store = mock(TaskRelocationResultStore.class);", "modifier": "private", "type": "TaskRelocationResultStore", "declarator": "store = mock(TaskRelocationResultStore.class)", "var_name": "store"}, {"original_string": "private TaskEvictionResultStoreStep step;", "modifier": "private", "type": "TaskEvictionResultStoreStep", "declarator": "step", "var_name": "step"}], "file": "titus-supplementary-component/task-relocation/src/test/java/com/netflix/titus/supplementary/relocation/workflow/step/TaskEvictionResultStoreStepTest.java"}, "test_case": {"identifier": "testStoreFailure", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testStoreFailure() {\n        when(store.createTaskRelocationStatuses(anyList())).thenReturn(Mono.error(new RuntimeException(\"Simulated store error\")));\n\n        TaskRelocationStatus relocationStatus = TaskRelocationPlanGenerator.oneSuccessfulRelocation();\n        step.storeTaskEvictionResults(Collections.singletonMap(relocationStatus.getTaskId(), relocationStatus));\n\n        verify(store, times(1)).createTaskRelocationStatuses(anyList());\n    }", "signature": "void testStoreFailure()", "full_signature": "@Test public void testStoreFailure()", "class_method_signature": "TaskEvictionResultStoreStepTest.testStoreFailure()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "createTaskRelocationStatuses", "anyList", "error", "oneSuccessfulRelocation", "storeTaskEvictionResults", "singletonMap", "getTaskId", "createTaskRelocationStatuses", "verify", "times", "anyList"]}, "focal_class": {"identifier": "TaskEvictionResultStoreStep", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(TaskEvictionResultStoreStep.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(TaskEvictionResultStoreStep.class)", "var_name": "logger"}, {"original_string": "private static final String STEP_NAME = \"taskEvictionResultStoreStep\";", "modifier": "private static final", "type": "String", "declarator": "STEP_NAME = \"taskEvictionResultStoreStep\"", "var_name": "STEP_NAME"}, {"original_string": "private final RelocationConfiguration configuration;", "modifier": "private final", "type": "RelocationConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final TaskRelocationResultStore store;", "modifier": "private final", "type": "TaskRelocationResultStore", "declarator": "store", "var_name": "store"}, {"original_string": "private final RelocationTransactionLogger transactionLog;", "modifier": "private final", "type": "RelocationTransactionLogger", "declarator": "transactionLog", "var_name": "transactionLog"}, {"original_string": "private final StepMetrics metrics;", "modifier": "private final", "type": "StepMetrics", "declarator": "metrics", "var_name": "metrics"}], "methods": [{"identifier": "TaskEvictionResultStoreStep", "parameters": "(RelocationConfiguration configuration,\n                                       TaskRelocationResultStore store,\n                                       RelocationTransactionLogger transactionLog,\n                                       TitusRuntime titusRuntime)", "modifiers": "public", "return": "", "signature": " TaskEvictionResultStoreStep(RelocationConfiguration configuration,\n                                       TaskRelocationResultStore store,\n                                       RelocationTransactionLogger transactionLog,\n                                       TitusRuntime titusRuntime)", "full_signature": "public  TaskEvictionResultStoreStep(RelocationConfiguration configuration,\n                                       TaskRelocationResultStore store,\n                                       RelocationTransactionLogger transactionLog,\n                                       TitusRuntime titusRuntime)", "class_method_signature": "TaskEvictionResultStoreStep.TaskEvictionResultStoreStep(RelocationConfiguration configuration,\n                                       TaskRelocationResultStore store,\n                                       RelocationTransactionLogger transactionLog,\n                                       TitusRuntime titusRuntime)", "testcase": false, "constructor": true}, {"identifier": "storeTaskEvictionResults", "parameters": "(Map<String, TaskRelocationStatus> taskEvictionResults)", "modifiers": "public", "return": "void", "signature": "void storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults)", "full_signature": "public void storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults)", "class_method_signature": "TaskEvictionResultStoreStep.storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults)", "testcase": false, "constructor": false}, {"identifier": "execute", "parameters": "(Map<String, TaskRelocationStatus> taskEvictionResults)", "modifiers": "private", "return": "int", "signature": "int execute(Map<String, TaskRelocationStatus> taskEvictionResults)", "full_signature": "private int execute(Map<String, TaskRelocationStatus> taskEvictionResults)", "class_method_signature": "TaskEvictionResultStoreStep.execute(Map<String, TaskRelocationStatus> taskEvictionResults)", "testcase": false, "constructor": false}], "file": "titus-supplementary-component/task-relocation/src/main/java/com/netflix/titus/supplementary/relocation/workflow/step/TaskEvictionResultStoreStep.java"}, "focal_method": {"identifier": "storeTaskEvictionResults", "parameters": "(Map<String, TaskRelocationStatus> taskEvictionResults)", "modifiers": "public", "return": "void", "body": "public void storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults) {\n        Stopwatch stopwatch = Stopwatch.createStarted();\n        try {\n            int updates = execute(taskEvictionResults);\n            metrics.onSuccess(updates, stopwatch.elapsed(TimeUnit.MILLISECONDS));\n        } catch (Exception e) {\n            logger.error(\"Step processing error\", e);\n            metrics.onError(stopwatch.elapsed(TimeUnit.MILLISECONDS));\n            throw e;\n        }\n    }", "signature": "void storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults)", "full_signature": "public void storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults)", "class_method_signature": "TaskEvictionResultStoreStep.storeTaskEvictionResults(Map<String, TaskRelocationStatus> taskEvictionResults)", "testcase": false, "constructor": false, "invocations": ["createStarted", "execute", "onSuccess", "elapsed", "error", "onError", "elapsed"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}