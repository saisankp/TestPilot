{"test_class": {"identifier": "RawMapreduceTest", "superclass": "", "interfaces": "", "fields": [], "file": "big/src/main/java/com/zqh/hadoop/mr/secondary/RawMapreduceTest.java"}, "test_case": {"identifier": "integrationTest", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void integrationTest() throws Exception {\n        final MapReduceTester runner = new MapReduceTester();\n\n        MapReduceTester.TestJob job = new MapReduceTester.TestJob(){\n            @Override\n            public void run(MapReduceTester.JobArgs args) throws Exception {\n                String usersString =\n                        \"1\\tmatthew@test.com\\tEN\\tUS\\n\"\n                                + \"2\\tmatthew@test2.com\\tEN\\tGB\\n\"\n                                + \"3\\tmatthew@test3.com\\tFR\\tFR\";\n\n                String transactionString =\n                        \"1\\t1\\t1\\t300\\ta jumper\\n\"\n                                + \"2\\t1\\t2\\t300\\ta jumper\\n\"\n                                + \"3\\t1\\t2\\t300\\ta jumper\\n\"\n                                + \"4\\t2\\t3\\t100\\ta rubber chicken\\n\"\n                                + \"5\\t1\\t3\\t300\\ta jumper\";\n\n                Path transactions = runner.registerString(transactionString);\n                Path users = runner.registerString(usersString);\n                Path staging = runner.registerDirectory(false);\n                Path output = runner.registerDirectory(false);\n\n                RawMapreduce.main(args.conf, transactions, users, staging, output);\n\n                List<String> results = runner.collectStrings(output);\n                Assert.assertEquals(\"number of results is correct\", results.size(), 2);\n                List<String> expected = Arrays.asList(\"1\\t3\", \"2\\t1\");\n                Assert.assertThat(results, is(expected));\n            }\n        };\n        runner.run(job);\n    }", "signature": "void integrationTest()", "full_signature": "@Test public void integrationTest()", "class_method_signature": "RawMapreduceTest.integrationTest()", "testcase": true, "constructor": false, "invocations": ["registerString", "registerString", "registerDirectory", "registerDirectory", "main", "collectStrings", "assertEquals", "size", "asList", "assertThat", "is", "run"]}, "focal_class": {"identifier": "RawMapreduce", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "main", "parameters": "( String[] args )", "modifiers": "public static", "return": "void", "signature": "void main( String[] args )", "full_signature": "public static void main( String[] args )", "class_method_signature": "RawMapreduce.main( String[] args )", "testcase": false, "constructor": false}, {"identifier": "main", "parameters": "(Configuration conf, Path transactions, Path users, Path staging, Path output)", "modifiers": "public static", "return": "void", "signature": "void main(Configuration conf, Path transactions, Path users, Path staging, Path output)", "full_signature": "public static void main(Configuration conf, Path transactions, Path users, Path staging, Path output)", "class_method_signature": "RawMapreduce.main(Configuration conf, Path transactions, Path users, Path staging, Path output)", "testcase": false, "constructor": false}, {"identifier": "runFirstJob", "parameters": "(Path transactions, Path users, Path output, Configuration conf)", "modifiers": "protected static", "return": "void", "signature": "void runFirstJob(Path transactions, Path users, Path output, Configuration conf)", "full_signature": "protected static void runFirstJob(Path transactions, Path users, Path output, Configuration conf)", "class_method_signature": "RawMapreduce.runFirstJob(Path transactions, Path users, Path output, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "runSecondJob", "parameters": "(Path input, Path output, Configuration conf)", "modifiers": "protected static", "return": "void", "signature": "void runSecondJob(Path input, Path output, Configuration conf)", "full_signature": "protected static void runSecondJob(Path input, Path output, Configuration conf)", "class_method_signature": "RawMapreduce.runSecondJob(Path input, Path output, Configuration conf)", "testcase": false, "constructor": false}], "file": "big/src/main/java/com/zqh/hadoop/mr/secondary/RawMapreduce.java"}, "focal_method": {"identifier": "main", "parameters": "( String[] args )", "modifiers": "public static", "return": "void", "body": "public static void main( String[] args ) throws Exception {\n        args = new String[]{\n                \"/home/hadoop/data/mralgs/transaction\",\n                \"/home/hadoop/data/mralgs/users\",\n                \"/home/hadoop/data/tmp/staging\",\n                \"/home/hadoop/data/tmp/out\"\n        };\n\n        Path transactions = new Path(args[0]);\n        Path users = new Path(args[1]);\n        Path staging = new Path(args[2]);\n        Path output = new Path(args[3]);\n        main(new Configuration(), transactions, users, staging, output );\n    }", "signature": "void main( String[] args )", "full_signature": "public static void main( String[] args )", "class_method_signature": "RawMapreduce.main( String[] args )", "testcase": false, "constructor": false, "invocations": ["main"]}, "repository": {"repo_id": 33645537, "url": "https://github.com/zqhxuyuan/tutorials", "language": "Java", "is_fork": false, "fork_count": 8, "stargazer_count": 5, "size": 35273, "license": "licensed"}}