{"test_class": {"identifier": "MachineGroupConstraintTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String MACHINE_ID = \"1234\";", "modifier": "private static final", "type": "String", "declarator": "MACHINE_ID = \"1234\"", "var_name": "MACHINE_ID"}, {"original_string": "private static final String MACHINE_GROUP = \"group-1234\";", "modifier": "private static final", "type": "String", "declarator": "MACHINE_GROUP = \"group-1234\"", "var_name": "MACHINE_GROUP"}, {"original_string": "private final SchedulerConfiguration schedulerConfiguration = mock(SchedulerConfiguration.class);", "modifier": "private final", "type": "SchedulerConfiguration", "declarator": "schedulerConfiguration = mock(SchedulerConfiguration.class)", "var_name": "schedulerConfiguration"}, {"original_string": "private final AgentManagementService agentManagementService = mock(AgentManagementService.class);", "modifier": "private final", "type": "AgentManagementService", "declarator": "agentManagementService = mock(AgentManagementService.class)", "var_name": "agentManagementService"}, {"original_string": "private final MachineGroupConstraint constraint = new MachineGroupConstraint(schedulerConfiguration, agentManagementService, MACHINE_GROUP);", "modifier": "private final", "type": "MachineGroupConstraint", "declarator": "constraint = new MachineGroupConstraint(schedulerConfiguration, agentManagementService, MACHINE_GROUP)", "var_name": "constraint"}], "file": "titus-server-master/src/test/java/com/netflix/titus/master/scheduler/constraint/MachineGroupConstraintTest.java"}, "test_case": {"identifier": "machineGroupDoesMatch", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void machineGroupDoesMatch() {\n        AgentInstance instance = AgentGenerator.agentInstances().getValue().toBuilder().withId(MACHINE_ID).withInstanceGroupId(MACHINE_GROUP).build();\n        when(agentManagementService.findAgentInstance(MACHINE_ID)).thenReturn(Optional.of(instance));\n        Result result = constraint.evaluate(createTaskRequest(TASK_ID), createVirtualMachineCurrentStateMock(MACHINE_ID), createTaskTrackerState());\n        assertThat(result.isSuccessful()).isTrue();\n    }", "signature": "void machineGroupDoesMatch()", "full_signature": "@Test public void machineGroupDoesMatch()", "class_method_signature": "MachineGroupConstraintTest.machineGroupDoesMatch()", "testcase": true, "constructor": false, "invocations": ["build", "withInstanceGroupId", "withId", "toBuilder", "getValue", "agentInstances", "thenReturn", "when", "findAgentInstance", "of", "evaluate", "createTaskRequest", "createVirtualMachineCurrentStateMock", "createTaskTrackerState", "isTrue", "assertThat", "isSuccessful"]}, "focal_class": {"identifier": "MachineGroupConstraint", "superclass": "", "interfaces": "implements ConstraintEvaluator", "fields": [{"original_string": "public static final String NAME = \"MachineGroupConstraint\";", "modifier": "public static final", "type": "String", "declarator": "NAME = \"MachineGroupConstraint\"", "var_name": "NAME"}, {"original_string": "private static final Result VALID = new Result(true, null);", "modifier": "private static final", "type": "Result", "declarator": "VALID = new Result(true, null)", "var_name": "VALID"}, {"original_string": "private static final Result MACHINE_DOES_NOT_EXIST = new Result(false, \"The machine does not exist\");", "modifier": "private static final", "type": "Result", "declarator": "MACHINE_DOES_NOT_EXIST = new Result(false, \"The machine does not exist\")", "var_name": "MACHINE_DOES_NOT_EXIST"}, {"original_string": "private static final Result MACHINE_GROUP_DOES_NOT_MATCH = new Result(false, \"The machine group does not match the specified name\");", "modifier": "private static final", "type": "Result", "declarator": "MACHINE_GROUP_DOES_NOT_MATCH = new Result(false, \"The machine group does not match the specified name\")", "var_name": "MACHINE_GROUP_DOES_NOT_MATCH"}, {"original_string": "private final SchedulerConfiguration configuration;", "modifier": "private final", "type": "SchedulerConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final AgentManagementService agentManagementService;", "modifier": "private final", "type": "AgentManagementService", "declarator": "agentManagementService", "var_name": "agentManagementService"}, {"original_string": "private final String machineGroup;", "modifier": "private final", "type": "String", "declarator": "machineGroup", "var_name": "machineGroup"}], "methods": [{"identifier": "MachineGroupConstraint", "parameters": "(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineGroup)", "modifiers": "public", "return": "", "signature": " MachineGroupConstraint(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineGroup)", "full_signature": "public  MachineGroupConstraint(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineGroup)", "class_method_signature": "MachineGroupConstraint.MachineGroupConstraint(SchedulerConfiguration configuration, AgentManagementService agentManagementService, String machineGroup)", "testcase": false, "constructor": true}, {"identifier": "getName", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String getName()", "full_signature": "@Override public String getName()", "class_method_signature": "MachineGroupConstraint.getName()", "testcase": false, "constructor": false}, {"identifier": "evaluate", "parameters": "(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "modifiers": "@Override public", "return": "Result", "signature": "Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "full_signature": "@Override public Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "class_method_signature": "MachineGroupConstraint.evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "testcase": false, "constructor": false}], "file": "titus-server-master/src/main/java/com/netflix/titus/master/scheduler/constraint/MachineGroupConstraint.java"}, "focal_method": {"identifier": "evaluate", "parameters": "(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "modifiers": "@Override public", "return": "Result", "body": "@Override\n    public Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState) {\n        Optional<AgentInstance> instanceOpt = SchedulerUtils.findInstance(agentManagementService, configuration.getInstanceAttributeName(), targetVM);\n        if (!instanceOpt.isPresent()) {\n            return MACHINE_DOES_NOT_EXIST;\n        }\n\n        AgentInstance agentInstance = instanceOpt.get();\n\n        return agentInstance.getInstanceGroupId().equalsIgnoreCase(machineGroup) ? VALID : MACHINE_GROUP_DOES_NOT_MATCH;\n    }", "signature": "Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "full_signature": "@Override public Result evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "class_method_signature": "MachineGroupConstraint.evaluate(TaskRequest taskRequest, VirtualMachineCurrentState targetVM, TaskTrackerState taskTrackerState)", "testcase": false, "constructor": false, "invocations": ["findInstance", "getInstanceAttributeName", "isPresent", "get", "equalsIgnoreCase", "getInstanceGroupId"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}