{"test_class": {"identifier": "KStreamTransformTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private String topicName = \"topic\";", "modifier": "private", "type": "String", "declarator": "topicName = \"topic\"", "var_name": "topicName"}, {"original_string": "final private Serde<Integer> intSerde = Serdes.Integer();", "modifier": "final private", "type": "Serde<Integer>", "declarator": "intSerde = Serdes.Integer()", "var_name": "intSerde"}, {"original_string": "private KStreamTestDriver driver;", "modifier": "private", "type": "KStreamTestDriver", "declarator": "driver", "var_name": "driver"}], "file": "streams/src/test/java/org/apache/kafka/streams/kstream/internals/KStreamTransformTest.java"}, "test_case": {"identifier": "testTransform", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testTransform() {\n        KStreamBuilder builder = new KStreamBuilder();\n\n        TransformerSupplier<Integer, Integer, KeyValue<Integer, Integer>> transformerSupplier =\n            new TransformerSupplier<Integer, Integer, KeyValue<Integer, Integer>>() {\n                public Transformer<Integer, Integer, KeyValue<Integer, Integer>> get() {\n                    return new Transformer<Integer, Integer, KeyValue<Integer, Integer>>() {\n\n                        private int total = 0;\n\n                        @Override\n                        public void init(ProcessorContext context) {\n                        }\n\n                        @Override\n                        public KeyValue<Integer, Integer> transform(Integer key, Integer value) {\n                            total += value;\n                            return KeyValue.pair(key * 2, total);\n                        }\n\n                        @Override\n                        public KeyValue<Integer, Integer> punctuate(long timestamp) {\n                            return KeyValue.pair(-1, (int) timestamp);\n                        }\n\n                        @Override\n                        public void close() {\n                        }\n                    };\n                }\n            };\n\n        final int[] expectedKeys = {1, 10, 100, 1000};\n\n        MockProcessorSupplier<Integer, Integer> processor = new MockProcessorSupplier<>();\n        KStream<Integer, Integer> stream = builder.stream(intSerde, intSerde, topicName);\n        stream.transform(transformerSupplier).process(processor);\n\n        driver = new KStreamTestDriver(builder);\n        for (int i = 0; i < expectedKeys.length; i++) {\n            driver.process(topicName, expectedKeys[i], expectedKeys[i] * 10);\n        }\n\n        driver.punctuate(2);\n        driver.punctuate(3);\n\n        assertEquals(6, processor.processed.size());\n\n        String[] expected = {\"2:10\", \"20:110\", \"200:1110\", \"2000:11110\", \"-1:2\", \"-1:3\"};\n\n        for (int i = 0; i < expected.length; i++) {\n            assertEquals(expected[i], processor.processed.get(i));\n        }\n    }", "signature": "void testTransform()", "full_signature": "@Test public void testTransform()", "class_method_signature": "KStreamTransformTest.testTransform()", "testcase": true, "constructor": false, "invocations": ["pair", "pair", "stream", "process", "transform", "process", "punctuate", "punctuate", "assertEquals", "size", "assertEquals", "get"]}, "focal_class": {"identifier": "KStreamTransform", "superclass": "", "interfaces": "implements ProcessorSupplier<K, V>", "fields": [{"original_string": "private final TransformerSupplier<K, V, KeyValue<K1, V1>> transformerSupplier;", "modifier": "private final", "type": "TransformerSupplier<K, V, KeyValue<K1, V1>>", "declarator": "transformerSupplier", "var_name": "transformerSupplier"}], "methods": [{"identifier": "KStreamTransform", "parameters": "(TransformerSupplier<K, V, KeyValue<K1, V1>> transformerSupplier)", "modifiers": "public", "return": "", "signature": " KStreamTransform(TransformerSupplier<K, V, KeyValue<K1, V1>> transformerSupplier)", "full_signature": "public  KStreamTransform(TransformerSupplier<K, V, KeyValue<K1, V1>> transformerSupplier)", "class_method_signature": "KStreamTransform.KStreamTransform(TransformerSupplier<K, V, KeyValue<K1, V1>> transformerSupplier)", "testcase": false, "constructor": true}, {"identifier": "get", "parameters": "()", "modifiers": "@Override public", "return": "Processor<K, V>", "signature": "Processor<K, V> get()", "full_signature": "@Override public Processor<K, V> get()", "class_method_signature": "KStreamTransform.get()", "testcase": false, "constructor": false}], "file": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/KStreamTransform.java"}, "focal_method": {"identifier": "get", "parameters": "()", "modifiers": "@Override public", "return": "Processor<K, V>", "body": "@Override\n    public Processor<K, V> get() {\n        return new KStreamTransformProcessor<>(transformerSupplier.get());\n    }", "signature": "Processor<K, V> get()", "full_signature": "@Override public Processor<K, V> get()", "class_method_signature": "KStreamTransform.get()", "testcase": false, "constructor": false, "invocations": ["get"]}, "repository": {"repo_id": 135978112, "url": "https://github.com/anurnomeru/kafka-0.10.0.1-source-reading", "language": "Java", "is_fork": false, "fork_count": 1, "stargazer_count": 7, "size": 2953, "license": "licensed"}}