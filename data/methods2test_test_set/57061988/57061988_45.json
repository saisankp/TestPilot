{"test_class": {"identifier": "RsaCredentialHelperTest", "superclass": "", "interfaces": "", "fields": [], "file": "components/credentials/src/test/java/org/cloudfoundry/credhub/utils/RsaCredentialHelperTest.java"}, "test_case": {"identifier": "getKeyLength_whenPublicKeyIsInvalid_throwsException", "parameters": "()", "modifiers": "@Test(expected = RuntimeException.class) public", "return": "void", "body": "@Test(expected = RuntimeException.class)\n  public void getKeyLength_whenPublicKeyIsInvalid_throwsException() {\n    final RsaCredentialVersionData rsaCredentialData = new RsaCredentialVersionData(\"testRsa\");\n    final String publicKey = \"This is a key that is obviously incorrect. Is it not?\";\n    rsaCredentialData.setPublicKey(publicKey);\n    final RsaCredentialHelper rsaHelper = new RsaCredentialHelper(rsaCredentialData);\n\n    rsaHelper.getKeyLength();\n  }", "signature": "void getKeyLength_whenPublicKeyIsInvalid_throwsException()", "full_signature": "@Test(expected = RuntimeException.class) public void getKeyLength_whenPublicKeyIsInvalid_throwsException()", "class_method_signature": "RsaCredentialHelperTest.getKeyLength_whenPublicKeyIsInvalid_throwsException()", "testcase": true, "constructor": false, "invocations": ["setPublicKey", "getKeyLength"]}, "focal_class": {"identifier": "RsaCredentialHelper", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String RSA_START = \"-----BEGIN PUBLIC KEY-----\\n\";", "modifier": "private static final", "type": "String", "declarator": "RSA_START = \"-----BEGIN PUBLIC KEY-----\\n\"", "var_name": "RSA_START"}, {"original_string": "private static final String RSA_END = \"\\n-----END PUBLIC KEY-----\";", "modifier": "private static final", "type": "String", "declarator": "RSA_END = \"\\n-----END PUBLIC KEY-----\"", "var_name": "RSA_END"}, {"original_string": "private static final String NEW_LINE = \"\\n\";", "modifier": "private static final", "type": "String", "declarator": "NEW_LINE = \"\\n\"", "var_name": "NEW_LINE"}, {"original_string": "private final RsaCredentialVersionData rsaCredentialData;", "modifier": "private final", "type": "RsaCredentialVersionData", "declarator": "rsaCredentialData", "var_name": "rsaCredentialData"}], "methods": [{"identifier": "RsaCredentialHelper", "parameters": "(final RsaCredentialVersionData rsaCredentialData)", "modifiers": "public", "return": "", "signature": " RsaCredentialHelper(final RsaCredentialVersionData rsaCredentialData)", "full_signature": "public  RsaCredentialHelper(final RsaCredentialVersionData rsaCredentialData)", "class_method_signature": "RsaCredentialHelper.RsaCredentialHelper(final RsaCredentialVersionData rsaCredentialData)", "testcase": false, "constructor": true}, {"identifier": "getKeyLength", "parameters": "()", "modifiers": "public", "return": "int", "signature": "int getKeyLength()", "full_signature": "public int getKeyLength()", "class_method_signature": "RsaCredentialHelper.getKeyLength()", "testcase": false, "constructor": false}], "file": "components/credentials/src/main/java/org/cloudfoundry/credhub/utils/RsaCredentialHelper.java"}, "focal_method": {"identifier": "getKeyLength", "parameters": "()", "modifiers": "public", "return": "int", "body": "public int getKeyLength() {\n    final String publicKey = rsaCredentialData.getPublicKey();\n\n    if (StringUtils.isEmpty(publicKey)) {\n      return 0;\n    }\n\n    try {\n      final String key = publicKey\n        .replaceFirst(RSA_START, \"\")\n        .replaceFirst(RSA_END, \"\")\n        .replaceAll(NEW_LINE, \"\");\n      final byte[] byteKey = Base64.decodeBase64(key.getBytes(UTF_8));\n      final X509EncodedKeySpec x509publicKey = new X509EncodedKeySpec(byteKey);\n      final KeyFactory kf = KeyFactory.getInstance(\"RSA\");\n      return ((RSAPublicKey) kf.generatePublic(x509publicKey)).getModulus().bitLength();\n    } catch (final NoSuchAlgorithmException | InvalidKeySpecException e) {\n      throw new RuntimeException(e);\n    }\n  }", "signature": "int getKeyLength()", "full_signature": "public int getKeyLength()", "class_method_signature": "RsaCredentialHelper.getKeyLength()", "testcase": false, "constructor": false, "invocations": ["getPublicKey", "isEmpty", "replaceAll", "replaceFirst", "replaceFirst", "decodeBase64", "getBytes", "getInstance", "bitLength", "getModulus", "generatePublic"]}, "repository": {"repo_id": 57061988, "url": "https://github.com/cloudfoundry-incubator/credhub", "stars": 167, "created": "4/25/2016 5:30:51 PM +00:00", "updates": "2020-01-27T21:31:19+00:00", "fork": "False", "license": "licensed"}}