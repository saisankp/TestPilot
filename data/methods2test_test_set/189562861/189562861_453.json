{"test_class": {"identifier": "DubboMonitorFactoryTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private DubboMonitorFactory dubboMonitorFactory;", "modifier": "private", "type": "DubboMonitorFactory", "declarator": "dubboMonitorFactory", "var_name": "dubboMonitorFactory"}, {"original_string": "@Mock\n    private ProxyFactory proxyFactory;", "modifier": "@Mock\n    private", "type": "ProxyFactory", "declarator": "proxyFactory", "var_name": "proxyFactory"}], "file": "dubbo-monitor/dubbo-monitor-default/src/test/java/com/alibaba/dubbo/monitor/dubbo/DubboMonitorFactoryTest.java"}, "test_case": {"identifier": "testCreateMonitor", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testCreateMonitor() {\n        URL urlWithoutPath = URL.valueOf(\"http://10.10.10.11\");\n        Monitor monitor = dubboMonitorFactory.createMonitor(urlWithoutPath);\n        assertThat(monitor, not(nullValue()));\n\n        URL urlWithFilterKey = URL.valueOf(\"http://10.10.10.11/\").addParameter(Constants.REFERENCE_FILTER_KEY, \"testFilter\");\n        monitor = dubboMonitorFactory.createMonitor(urlWithFilterKey);\n\n        assertThat(monitor, not(nullValue()));\n        ArgumentCaptor<Invoker> invokerArgumentCaptor = ArgumentCaptor.forClass(Invoker.class);\n        verify(proxyFactory, atLeastOnce()).getProxy(invokerArgumentCaptor.capture());\n\n        Invoker invoker = invokerArgumentCaptor.getValue();\n        assertThat(invoker.getUrl().getParameter(Constants.REFERENCE_FILTER_KEY), containsString(\"testFilter\"));\n    }", "signature": "void testCreateMonitor()", "full_signature": "@Test public void testCreateMonitor()", "class_method_signature": "DubboMonitorFactoryTest.testCreateMonitor()", "testcase": true, "constructor": false, "invocations": ["valueOf", "createMonitor", "assertThat", "not", "nullValue", "addParameter", "valueOf", "createMonitor", "assertThat", "not", "nullValue", "forClass", "getProxy", "verify", "atLeastOnce", "capture", "getValue", "assertThat", "getParameter", "getUrl", "containsString"]}, "focal_class": {"identifier": "DubboMonitorFactory", "superclass": "extends AbstractMonitorFactory", "interfaces": "", "fields": [{"original_string": "private Protocol protocol;", "modifier": "private", "type": "Protocol", "declarator": "protocol", "var_name": "protocol"}, {"original_string": "private ProxyFactory proxyFactory;", "modifier": "private", "type": "ProxyFactory", "declarator": "proxyFactory", "var_name": "proxyFactory"}], "methods": [{"identifier": "setProtocol", "parameters": "(Protocol protocol)", "modifiers": "public", "return": "void", "signature": "void setProtocol(Protocol protocol)", "full_signature": "public void setProtocol(Protocol protocol)", "class_method_signature": "DubboMonitorFactory.setProtocol(Protocol protocol)", "testcase": false, "constructor": false}, {"identifier": "setProxyFactory", "parameters": "(ProxyFactory proxyFactory)", "modifiers": "public", "return": "void", "signature": "void setProxyFactory(ProxyFactory proxyFactory)", "full_signature": "public void setProxyFactory(ProxyFactory proxyFactory)", "class_method_signature": "DubboMonitorFactory.setProxyFactory(ProxyFactory proxyFactory)", "testcase": false, "constructor": false}, {"identifier": "createMonitor", "parameters": "(URL url)", "modifiers": "@Override protected", "return": "Monitor", "signature": "Monitor createMonitor(URL url)", "full_signature": "@Override protected Monitor createMonitor(URL url)", "class_method_signature": "DubboMonitorFactory.createMonitor(URL url)", "testcase": false, "constructor": false}], "file": "dubbo-monitor/dubbo-monitor-default/src/main/java/com/alibaba/dubbo/monitor/dubbo/DubboMonitorFactory.java"}, "focal_method": {"identifier": "createMonitor", "parameters": "(URL url)", "modifiers": "@Override protected", "return": "Monitor", "body": "@Override\n    protected Monitor createMonitor(URL url) {\n        url = url.setProtocol(url.getParameter(Constants.PROTOCOL_KEY, \"dubbo\"));\n        if (url.getPath() == null || url.getPath().length() == 0) {\n            url = url.setPath(MonitorService.class.getName());\n        }\n        String filter = url.getParameter(Constants.REFERENCE_FILTER_KEY);\n        if (filter == null || filter.length() == 0) {\n            filter = \"\";\n        } else {\n            filter = filter + \",\";\n        }\n        url = url.addParameters(Constants.CLUSTER_KEY, \"failsafe\", Constants.CHECK_KEY, String.valueOf(false),\n                Constants.REFERENCE_FILTER_KEY, filter + \"-monitor\");\n        Invoker<MonitorService> monitorInvoker = protocol.refer(MonitorService.class, url);\n        MonitorService monitorService = proxyFactory.getProxy(monitorInvoker);\n        return new DubboMonitor(monitorInvoker, monitorService);\n    }", "signature": "Monitor createMonitor(URL url)", "full_signature": "@Override protected Monitor createMonitor(URL url)", "class_method_signature": "DubboMonitorFactory.createMonitor(URL url)", "testcase": false, "constructor": false, "invocations": ["setProtocol", "getParameter", "getPath", "length", "getPath", "setPath", "getName", "getParameter", "length", "addParameters", "valueOf", "refer", "getProxy"]}, "repository": {"repo_id": 189562861, "url": "https://github.com/smallFive55/dubbo-dubbo-2.6.6", "language": "Java", "is_fork": false, "fork_count": 11, "stargazer_count": 8, "size": 1428, "license": "licensed"}}