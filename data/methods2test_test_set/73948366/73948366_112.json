{"test_class": {"identifier": "ZMSFileMTLSChangeLogStoreTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "String keyPath;", "modifier": "", "type": "String", "declarator": "keyPath", "var_name": "keyPath"}, {"original_string": "String certPath;", "modifier": "", "type": "String", "declarator": "certPath", "var_name": "certPath"}, {"original_string": "String trustStorePath;", "modifier": "", "type": "String", "declarator": "trustStorePath", "var_name": "trustStorePath"}, {"original_string": "String trustStorePassword = \"123456\";", "modifier": "", "type": "String", "declarator": "trustStorePassword = \"123456\"", "var_name": "trustStorePassword"}, {"original_string": "private final String FSTORE_PATH = \"/tmp/zts_file_store_unit_test\";", "modifier": "private final", "type": "String", "declarator": "FSTORE_PATH = \"/tmp/zts_file_store_unit_test\"", "var_name": "FSTORE_PATH"}], "file": "libs/java/server_common/src/test/java/com/yahoo/athenz/common/server/store/impl/ZMSFileMTLSChangeLogStoreTest.java"}, "test_case": {"identifier": "testGetUpdatedSignedDomains", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetUpdatedSignedDomains() throws InterruptedException, IOException, KeyRefresherException {\n        MockZMSFileMTLSChangeLogStore store = new MockZMSFileMTLSChangeLogStore(FSTORE_PATH, keyPath, certPath,\n                trustStorePath, trustStorePassword);\n        MockZMSFileChangeLogStoreCommon cstore = new MockZMSFileChangeLogStoreCommon(FSTORE_PATH);\n        store.setChangeLogStoreCommon(cstore);\n\n        List<SignedDomain> domains = new ArrayList<>();\n        DomainData domData = new DomainData().setName(\"athenz\");\n        SignedDomain domain = new SignedDomain().setDomain(domData);\n        domains.add(domain);\n        SignedDomains signedDomains = new SignedDomains().setDomains(domains);\n\n        store.setSignedDomains(signedDomains);\n        StringBuilder str = new StringBuilder();\n\n        assertNull(store.getUpdatedSignedDomains(str));\n\n        // now let's set the tag header\n\n        cstore.setTagHeader(Timestamp.fromCurrentTime().toString());\n        SignedDomains retDoamins = store.getUpdatedSignedDomains(str);\n        assertNotNull(retDoamins);\n        assertEquals(retDoamins.getDomains().size(), 1);\n        assertEquals(retDoamins.getDomains().get(0).getDomain().getName(), \"athenz\");\n\n        // now set the signed domains to be null\n\n        store.setSignedDomains(null);\n        str.setLength(0);\n        assertNull(store.getUpdatedSignedDomains(str));\n    }", "signature": "void testGetUpdatedSignedDomains()", "full_signature": "@Test public void testGetUpdatedSignedDomains()", "class_method_signature": "ZMSFileMTLSChangeLogStoreTest.testGetUpdatedSignedDomains()", "testcase": true, "constructor": false, "invocations": ["setChangeLogStoreCommon", "setName", "setDomain", "add", "setDomains", "setSignedDomains", "assertNull", "getUpdatedSignedDomains", "setTagHeader", "toString", "fromCurrentTime", "getUpdatedSignedDomains", "assertNotNull", "assertEquals", "size", "getDomains", "assertEquals", "getName", "getDomain", "get", "getDomains", "setSignedDomains", "setLength", "assertNull", "getUpdatedSignedDomains"]}, "focal_class": {"identifier": "ZMSFileMTLSChangeLogStore", "superclass": "", "interfaces": "implements ChangeLogStore", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(ZMSFileMTLSChangeLogStore.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(ZMSFileMTLSChangeLogStore.class)", "var_name": "LOGGER"}, {"original_string": "private ZMSClient zmsClient;", "modifier": "private", "type": "ZMSClient", "declarator": "zmsClient", "var_name": "zmsClient"}, {"original_string": "private ZMSFileChangeLogStoreCommon changeLogStoreCommon;", "modifier": "private", "type": "ZMSFileChangeLogStoreCommon", "declarator": "changeLogStoreCommon", "var_name": "changeLogStoreCommon"}], "methods": [{"identifier": "ZMSFileMTLSChangeLogStore", "parameters": "(String rootDirectory, final String keyPath, final String certPath,\n                                     final String trustStorePath, final String trustStorePassword)", "modifiers": "public", "return": "", "signature": " ZMSFileMTLSChangeLogStore(String rootDirectory, final String keyPath, final String certPath,\n                                     final String trustStorePath, final String trustStorePassword)", "full_signature": "public  ZMSFileMTLSChangeLogStore(String rootDirectory, final String keyPath, final String certPath,\n                                     final String trustStorePath, final String trustStorePassword)", "class_method_signature": "ZMSFileMTLSChangeLogStore.ZMSFileMTLSChangeLogStore(String rootDirectory, final String keyPath, final String certPath,\n                                     final String trustStorePath, final String trustStorePassword)", "testcase": false, "constructor": true}, {"identifier": "supportsFullRefresh", "parameters": "()", "modifiers": "@Override public", "return": "boolean", "signature": "boolean supportsFullRefresh()", "full_signature": "@Override public boolean supportsFullRefresh()", "class_method_signature": "ZMSFileMTLSChangeLogStore.supportsFullRefresh()", "testcase": false, "constructor": false}, {"identifier": "getLocalSignedDomain", "parameters": "(String domainName)", "modifiers": "@Override public", "return": "SignedDomain", "signature": "SignedDomain getLocalSignedDomain(String domainName)", "full_signature": "@Override public SignedDomain getLocalSignedDomain(String domainName)", "class_method_signature": "ZMSFileMTLSChangeLogStore.getLocalSignedDomain(String domainName)", "testcase": false, "constructor": false}, {"identifier": "getServerSignedDomain", "parameters": "(String domainName)", "modifiers": "@Override public", "return": "SignedDomain", "signature": "SignedDomain getServerSignedDomain(String domainName)", "full_signature": "@Override public SignedDomain getServerSignedDomain(String domainName)", "class_method_signature": "ZMSFileMTLSChangeLogStore.getServerSignedDomain(String domainName)", "testcase": false, "constructor": false}, {"identifier": "removeLocalDomain", "parameters": "(String domainName)", "modifiers": "@Override public", "return": "void", "signature": "void removeLocalDomain(String domainName)", "full_signature": "@Override public void removeLocalDomain(String domainName)", "class_method_signature": "ZMSFileMTLSChangeLogStore.removeLocalDomain(String domainName)", "testcase": false, "constructor": false}, {"identifier": "saveLocalDomain", "parameters": "(String domainName, SignedDomain signedDomain)", "modifiers": "@Override public", "return": "void", "signature": "void saveLocalDomain(String domainName, SignedDomain signedDomain)", "full_signature": "@Override public void saveLocalDomain(String domainName, SignedDomain signedDomain)", "class_method_signature": "ZMSFileMTLSChangeLogStore.saveLocalDomain(String domainName, SignedDomain signedDomain)", "testcase": false, "constructor": false}, {"identifier": "getLocalDomainList", "parameters": "()", "modifiers": "@Override public", "return": "List<String>", "signature": "List<String> getLocalDomainList()", "full_signature": "@Override public List<String> getLocalDomainList()", "class_method_signature": "ZMSFileMTLSChangeLogStore.getLocalDomainList()", "testcase": false, "constructor": false}, {"identifier": "getServerDomainList", "parameters": "()", "modifiers": "@Override public", "return": "Set<String>", "signature": "Set<String> getServerDomainList()", "full_signature": "@Override public Set<String> getServerDomainList()", "class_method_signature": "ZMSFileMTLSChangeLogStore.getServerDomainList()", "testcase": false, "constructor": false}, {"identifier": "getServerDomainModifiedList", "parameters": "()", "modifiers": "@Override public", "return": "SignedDomains", "signature": "SignedDomains getServerDomainModifiedList()", "full_signature": "@Override public SignedDomains getServerDomainModifiedList()", "class_method_signature": "ZMSFileMTLSChangeLogStore.getServerDomainModifiedList()", "testcase": false, "constructor": false}, {"identifier": "setLastModificationTimestamp", "parameters": "(String newLastModTime)", "modifiers": "@Override public", "return": "void", "signature": "void setLastModificationTimestamp(String newLastModTime)", "full_signature": "@Override public void setLastModificationTimestamp(String newLastModTime)", "class_method_signature": "ZMSFileMTLSChangeLogStore.setLastModificationTimestamp(String newLastModTime)", "testcase": false, "constructor": false}, {"identifier": "getUpdatedSignedDomains", "parameters": "(StringBuilder lastModTimeBuffer)", "modifiers": "@Override public", "return": "SignedDomains", "signature": "SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "full_signature": "@Override public SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "class_method_signature": "ZMSFileMTLSChangeLogStore.getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "testcase": false, "constructor": false}, {"identifier": "setZMSClient", "parameters": "(ZMSClient client)", "modifiers": "", "return": "void", "signature": "void setZMSClient(ZMSClient client)", "full_signature": " void setZMSClient(ZMSClient client)", "class_method_signature": "ZMSFileMTLSChangeLogStore.setZMSClient(ZMSClient client)", "testcase": false, "constructor": false}, {"identifier": "setChangeLogStoreCommon", "parameters": "(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "modifiers": "", "return": "void", "signature": "void setChangeLogStoreCommon(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "full_signature": " void setChangeLogStoreCommon(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "class_method_signature": "ZMSFileMTLSChangeLogStore.setChangeLogStoreCommon(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "testcase": false, "constructor": false}], "file": "libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/ZMSFileMTLSChangeLogStore.java"}, "focal_method": {"identifier": "getUpdatedSignedDomains", "parameters": "(StringBuilder lastModTimeBuffer)", "modifiers": "@Override public", "return": "SignedDomains", "body": "@Override\n    public SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer) {\n\n        try {\n            return changeLogStoreCommon.getUpdatedSignedDomains(zmsClient, lastModTimeBuffer);\n        } catch (ZMSClientException ex) {\n            LOGGER.error(\"Error when refreshing data from ZMS: {}\", ex.getMessage());\n            return null;\n        }\n    }", "signature": "SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "full_signature": "@Override public SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "class_method_signature": "ZMSFileMTLSChangeLogStore.getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "testcase": false, "constructor": false, "invocations": ["getUpdatedSignedDomains", "error", "getMessage"]}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}