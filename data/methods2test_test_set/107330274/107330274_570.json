{"test_class": {"identifier": "CassandraJobStoreTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final long STARTUP_TIMEOUT_MS = 30_000L;", "modifier": "private static final", "type": "long", "declarator": "STARTUP_TIMEOUT_MS = 30_000L", "var_name": "STARTUP_TIMEOUT_MS"}, {"original_string": "private static final int INITIAL_BUCKET_COUNT = 1;", "modifier": "private static final", "type": "int", "declarator": "INITIAL_BUCKET_COUNT = 1", "var_name": "INITIAL_BUCKET_COUNT"}, {"original_string": "private static final int MAX_BUCKET_SIZE = 10;", "modifier": "private static final", "type": "int", "declarator": "MAX_BUCKET_SIZE = 10", "var_name": "MAX_BUCKET_SIZE"}, {"original_string": "private static final String CONFIGURATION_FILE_NAME = \"relocated-cassandra.yaml\";", "modifier": "private static final", "type": "String", "declarator": "CONFIGURATION_FILE_NAME = \"relocated-cassandra.yaml\"", "var_name": "CONFIGURATION_FILE_NAME"}, {"original_string": "public static final int MAX_CONCURRENCY = 10;", "modifier": "public static final", "type": "int", "declarator": "MAX_CONCURRENCY = 10", "var_name": "MAX_CONCURRENCY"}, {"original_string": "@Rule\n    public CassandraCQLUnit cassandraCqlUnit = new CassandraCQLUnit(\n            new ClassPathCQLDataSet(\"tables.cql\", \"titus_integration_tests\"),\n            CONFIGURATION_FILE_NAME,\n            STARTUP_TIMEOUT_MS\n    );", "modifier": "@Rule\n    public", "type": "CassandraCQLUnit", "declarator": "cassandraCqlUnit = new CassandraCQLUnit(\n            new ClassPathCQLDataSet(\"tables.cql\", \"titus_integration_tests\"),\n            CONFIGURATION_FILE_NAME,\n            STARTUP_TIMEOUT_MS\n    )", "var_name": "cassandraCqlUnit"}, {"original_string": "private static final CassandraStoreConfiguration CONFIGURATION = new TestCassandraStoreConfiguration();", "modifier": "private static final", "type": "CassandraStoreConfiguration", "declarator": "CONFIGURATION = new TestCassandraStoreConfiguration()", "var_name": "CONFIGURATION"}], "file": "titus-ext/cassandra/src/test/java/com/netflix/titus/ext/cassandra/store/CassandraJobStoreTest.java"}, "test_case": {"identifier": "testStoreTask", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testStoreTask() {\n        JobStore store = getJobStore();\n        Job<BatchJobExt> job = createBatchJobObject();\n        store.init().await();\n        store.storeJob(job).await();\n        Pair<List<Job<?>>, Integer> jobsAndErrors = store.retrieveJobs().toBlocking().first();\n        assertThat(jobsAndErrors.getLeft().get(0)).isEqualTo(job);\n        Task task = createTaskObject(job);\n        store.storeTask(task).await();\n        Task retrievedTask = store.retrieveTask(task.getId()).toBlocking().first();\n        assertThat(task).isEqualTo(retrievedTask);\n    }", "signature": "void testStoreTask()", "full_signature": "@Test public void testStoreTask()", "class_method_signature": "CassandraJobStoreTest.testStoreTask()", "testcase": true, "constructor": false, "invocations": ["getJobStore", "createBatchJobObject", "await", "init", "await", "storeJob", "first", "toBlocking", "retrieveJobs", "isEqualTo", "assertThat", "get", "getLeft", "createTaskObject", "await", "storeTask", "first", "toBlocking", "retrieveTask", "getId", "isEqualTo", "assertThat"]}, "focal_class": {"identifier": "CassandraJobStore", "superclass": "", "interfaces": "implements JobStore", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(CassandraJobStore.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(CassandraJobStore.class)", "var_name": "logger"}, {"original_string": "private static final int INITIAL_BUCKET_COUNT = 100;", "modifier": "private static final", "type": "int", "declarator": "INITIAL_BUCKET_COUNT = 100", "var_name": "INITIAL_BUCKET_COUNT"}, {"original_string": "private static final int MAX_BUCKET_SIZE = 2_000;", "modifier": "private static final", "type": "int", "declarator": "MAX_BUCKET_SIZE = 2_000", "var_name": "MAX_BUCKET_SIZE"}, {"original_string": "private static final String METRIC_NAME_ROOT = \"titusMaster.jobManager.cassandra\";", "modifier": "private static final", "type": "String", "declarator": "METRIC_NAME_ROOT = \"titusMaster.jobManager.cassandra\"", "var_name": "METRIC_NAME_ROOT"}, {"original_string": "private static final String RETRIEVE_ACTIVE_JOB_ID_BUCKETS_STRING = \"SELECT distinct bucket FROM active_job_ids\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ACTIVE_JOB_ID_BUCKETS_STRING = \"SELECT distinct bucket FROM active_job_ids\"", "var_name": "RETRIEVE_ACTIVE_JOB_ID_BUCKETS_STRING"}, {"original_string": "private static final String RETRIEVE_ACTIVE_JOB_IDS_STRING = \"SELECT job_id FROM active_job_ids WHERE bucket = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ACTIVE_JOB_IDS_STRING = \"SELECT job_id FROM active_job_ids WHERE bucket = ?;\"", "var_name": "RETRIEVE_ACTIVE_JOB_IDS_STRING"}, {"original_string": "private static final String RETRIEVE_ACTIVE_JOB_STRING = \"SELECT value FROM active_jobs WHERE job_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ACTIVE_JOB_STRING = \"SELECT value FROM active_jobs WHERE job_id = ?;\"", "var_name": "RETRIEVE_ACTIVE_JOB_STRING"}, {"original_string": "private static final String RETRIEVE_ARCHIVED_JOB_STRING = \"SELECT value FROM archived_jobs WHERE job_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ARCHIVED_JOB_STRING = \"SELECT value FROM archived_jobs WHERE job_id = ?;\"", "var_name": "RETRIEVE_ARCHIVED_JOB_STRING"}, {"original_string": "private static final String RETRIEVE_ACTIVE_TASK_IDS_FOR_JOB_STRING = \"SELECT task_id FROM active_task_ids WHERE job_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ACTIVE_TASK_IDS_FOR_JOB_STRING = \"SELECT task_id FROM active_task_ids WHERE job_id = ?;\"", "var_name": "RETRIEVE_ACTIVE_TASK_IDS_FOR_JOB_STRING"}, {"original_string": "private static final String RETRIEVE_ARCHIVED_TASK_IDS_FOR_JOB_STRING = \"SELECT task_id FROM archived_task_ids WHERE job_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ARCHIVED_TASK_IDS_FOR_JOB_STRING = \"SELECT task_id FROM archived_task_ids WHERE job_id = ?;\"", "var_name": "RETRIEVE_ARCHIVED_TASK_IDS_FOR_JOB_STRING"}, {"original_string": "private static final String RETRIEVE_ACTIVE_TASK_STRING = \"SELECT value FROM active_tasks WHERE task_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ACTIVE_TASK_STRING = \"SELECT value FROM active_tasks WHERE task_id = ?;\"", "var_name": "RETRIEVE_ACTIVE_TASK_STRING"}, {"original_string": "private static final String RETRIEVE_ARCHIVED_TASK_STRING = \"SELECT value FROM archived_tasks WHERE task_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "RETRIEVE_ARCHIVED_TASK_STRING = \"SELECT value FROM archived_tasks WHERE task_id = ?;\"", "var_name": "RETRIEVE_ARCHIVED_TASK_STRING"}, {"original_string": "private final PreparedStatement retrieveActiveJobIdBucketsStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveActiveJobIdBucketsStatement", "var_name": "retrieveActiveJobIdBucketsStatement"}, {"original_string": "private final PreparedStatement retrieveActiveJobIdsStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveActiveJobIdsStatement", "var_name": "retrieveActiveJobIdsStatement"}, {"original_string": "private final PreparedStatement retrieveActiveJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveActiveJobStatement", "var_name": "retrieveActiveJobStatement"}, {"original_string": "private final PreparedStatement retrieveArchivedJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveArchivedJobStatement", "var_name": "retrieveArchivedJobStatement"}, {"original_string": "private final PreparedStatement retrieveActiveTaskIdsForJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveActiveTaskIdsForJobStatement", "var_name": "retrieveActiveTaskIdsForJobStatement"}, {"original_string": "private final PreparedStatement retrieveArchivedTaskIdsForJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveArchivedTaskIdsForJobStatement", "var_name": "retrieveArchivedTaskIdsForJobStatement"}, {"original_string": "private final PreparedStatement retrieveActiveTaskStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveActiveTaskStatement", "var_name": "retrieveActiveTaskStatement"}, {"original_string": "private final PreparedStatement retrieveArchivedTaskStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "retrieveArchivedTaskStatement", "var_name": "retrieveArchivedTaskStatement"}, {"original_string": "private static final String INSERT_ACTIVE_JOB_ID_STRING = \"INSERT INTO active_job_ids (bucket, job_id) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ACTIVE_JOB_ID_STRING = \"INSERT INTO active_job_ids (bucket, job_id) VALUES (?, ?);\"", "var_name": "INSERT_ACTIVE_JOB_ID_STRING"}, {"original_string": "private static final String INSERT_ACTIVE_JOB_STRING = \"INSERT INTO active_jobs (job_id, value) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ACTIVE_JOB_STRING = \"INSERT INTO active_jobs (job_id, value) VALUES (?, ?);\"", "var_name": "INSERT_ACTIVE_JOB_STRING"}, {"original_string": "private static final String INSERT_ARCHIVED_JOB_STRING = \"INSERT INTO archived_jobs (job_id, value) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ARCHIVED_JOB_STRING = \"INSERT INTO archived_jobs (job_id, value) VALUES (?, ?);\"", "var_name": "INSERT_ARCHIVED_JOB_STRING"}, {"original_string": "private static final String INSERT_ACTIVE_TASK_ID_STRING = \"INSERT INTO active_task_ids (job_id, task_id) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ACTIVE_TASK_ID_STRING = \"INSERT INTO active_task_ids (job_id, task_id) VALUES (?, ?);\"", "var_name": "INSERT_ACTIVE_TASK_ID_STRING"}, {"original_string": "private static final String INSERT_ACTIVE_TASK_STRING = \"INSERT INTO active_tasks (task_id, value) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ACTIVE_TASK_STRING = \"INSERT INTO active_tasks (task_id, value) VALUES (?, ?);\"", "var_name": "INSERT_ACTIVE_TASK_STRING"}, {"original_string": "private static final String INSERT_ARCHIVED_TASK_ID_STRING = \"INSERT INTO archived_task_ids (job_id, task_id) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ARCHIVED_TASK_ID_STRING = \"INSERT INTO archived_task_ids (job_id, task_id) VALUES (?, ?);\"", "var_name": "INSERT_ARCHIVED_TASK_ID_STRING"}, {"original_string": "private static final String INSERT_ARCHIVED_TASK_STRING = \"INSERT INTO archived_tasks (task_id, value) VALUES (?, ?);\";", "modifier": "private static final", "type": "String", "declarator": "INSERT_ARCHIVED_TASK_STRING = \"INSERT INTO archived_tasks (task_id, value) VALUES (?, ?);\"", "var_name": "INSERT_ARCHIVED_TASK_STRING"}, {"original_string": "private final PreparedStatement insertActiveJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertActiveJobStatement", "var_name": "insertActiveJobStatement"}, {"original_string": "private final PreparedStatement insertActiveJobIdStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertActiveJobIdStatement", "var_name": "insertActiveJobIdStatement"}, {"original_string": "private final PreparedStatement insertArchivedJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertArchivedJobStatement", "var_name": "insertArchivedJobStatement"}, {"original_string": "private final PreparedStatement insertActiveTaskStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertActiveTaskStatement", "var_name": "insertActiveTaskStatement"}, {"original_string": "private final PreparedStatement insertActiveTaskIdStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertActiveTaskIdStatement", "var_name": "insertActiveTaskIdStatement"}, {"original_string": "private final PreparedStatement insertArchivedTaskIdStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertArchivedTaskIdStatement", "var_name": "insertArchivedTaskIdStatement"}, {"original_string": "private final PreparedStatement insertArchivedTaskStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "insertArchivedTaskStatement", "var_name": "insertArchivedTaskStatement"}, {"original_string": "private static final String DELETE_ACTIVE_JOB_ID_STRING = \"DELETE FROM active_job_ids WHERE bucket = ? and job_id = ?\";", "modifier": "private static final", "type": "String", "declarator": "DELETE_ACTIVE_JOB_ID_STRING = \"DELETE FROM active_job_ids WHERE bucket = ? and job_id = ?\"", "var_name": "DELETE_ACTIVE_JOB_ID_STRING"}, {"original_string": "private static final String DELETE_ACTIVE_JOB_STRING = \"DELETE FROM active_jobs WHERE job_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "DELETE_ACTIVE_JOB_STRING = \"DELETE FROM active_jobs WHERE job_id = ?;\"", "var_name": "DELETE_ACTIVE_JOB_STRING"}, {"original_string": "private static final String DELETE_ACTIVE_TASK_ID_STRING = \"DELETE FROM active_task_ids WHERE job_id = ? and task_id = ?\";", "modifier": "private static final", "type": "String", "declarator": "DELETE_ACTIVE_TASK_ID_STRING = \"DELETE FROM active_task_ids WHERE job_id = ? and task_id = ?\"", "var_name": "DELETE_ACTIVE_TASK_ID_STRING"}, {"original_string": "private static final String DELETE_ACTIVE_TASK_STRING = \"DELETE FROM active_tasks WHERE task_id = ?;\";", "modifier": "private static final", "type": "String", "declarator": "DELETE_ACTIVE_TASK_STRING = \"DELETE FROM active_tasks WHERE task_id = ?;\"", "var_name": "DELETE_ACTIVE_TASK_STRING"}, {"original_string": "private final PreparedStatement deleteActiveJobIdStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "deleteActiveJobIdStatement", "var_name": "deleteActiveJobIdStatement"}, {"original_string": "private final PreparedStatement deleteActiveJobStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "deleteActiveJobStatement", "var_name": "deleteActiveJobStatement"}, {"original_string": "private final PreparedStatement deleteActiveTaskIdStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "deleteActiveTaskIdStatement", "var_name": "deleteActiveTaskIdStatement"}, {"original_string": "private final PreparedStatement deleteActiveTaskStatement;", "modifier": "private final", "type": "PreparedStatement", "declarator": "deleteActiveTaskStatement", "var_name": "deleteActiveTaskStatement"}, {"original_string": "private final TitusRuntime titusRuntime;", "modifier": "private final", "type": "TitusRuntime", "declarator": "titusRuntime", "var_name": "titusRuntime"}, {"original_string": "private final Session session;", "modifier": "private final", "type": "Session", "declarator": "session", "var_name": "session"}, {"original_string": "private final ObjectMapper mapper;", "modifier": "private final", "type": "ObjectMapper", "declarator": "mapper", "var_name": "mapper"}, {"original_string": "private final BalancedBucketManager<String> activeJobIdsBucketManager;", "modifier": "private final", "type": "BalancedBucketManager<String>", "declarator": "activeJobIdsBucketManager", "var_name": "activeJobIdsBucketManager"}, {"original_string": "private final CassandraStoreConfiguration configuration;", "modifier": "private final", "type": "CassandraStoreConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final Optional<FitInjection> fitDriverInjection;", "modifier": "private final", "type": "Optional<FitInjection>", "declarator": "fitDriverInjection", "var_name": "fitDriverInjection"}, {"original_string": "private final Optional<FitInjection> fitBadDataInjection;", "modifier": "private final", "type": "Optional<FitInjection>", "declarator": "fitBadDataInjection", "var_name": "fitBadDataInjection"}], "methods": [{"identifier": "CassandraJobStore", "parameters": "(CassandraStoreConfiguration configuration,\n                             Session session,\n                             TitusRuntime titusRuntime)", "modifiers": "@Inject public", "return": "", "signature": " CassandraJobStore(CassandraStoreConfiguration configuration,\n                             Session session,\n                             TitusRuntime titusRuntime)", "full_signature": "@Inject public  CassandraJobStore(CassandraStoreConfiguration configuration,\n                             Session session,\n                             TitusRuntime titusRuntime)", "class_method_signature": "CassandraJobStore.CassandraJobStore(CassandraStoreConfiguration configuration,\n                             Session session,\n                             TitusRuntime titusRuntime)", "testcase": false, "constructor": true}, {"identifier": "CassandraJobStore", "parameters": "(CassandraStoreConfiguration configuration,\n                      Session session,\n                      TitusRuntime titusRuntime,\n                      ObjectMapper mapper,\n                      int initialBucketCount,\n                      int maxBucketSize)", "modifiers": "", "return": "", "signature": " CassandraJobStore(CassandraStoreConfiguration configuration,\n                      Session session,\n                      TitusRuntime titusRuntime,\n                      ObjectMapper mapper,\n                      int initialBucketCount,\n                      int maxBucketSize)", "full_signature": "  CassandraJobStore(CassandraStoreConfiguration configuration,\n                      Session session,\n                      TitusRuntime titusRuntime,\n                      ObjectMapper mapper,\n                      int initialBucketCount,\n                      int maxBucketSize)", "class_method_signature": "CassandraJobStore.CassandraJobStore(CassandraStoreConfiguration configuration,\n                      Session session,\n                      TitusRuntime titusRuntime,\n                      ObjectMapper mapper,\n                      int initialBucketCount,\n                      int maxBucketSize)", "testcase": false, "constructor": true}, {"identifier": "init", "parameters": "()", "modifiers": "@Override public", "return": "Completable", "signature": "Completable init()", "full_signature": "@Override public Completable init()", "class_method_signature": "CassandraJobStore.init()", "testcase": false, "constructor": false}, {"identifier": "retrieveJobs", "parameters": "()", "modifiers": "@Override public", "return": "Observable<Pair<List<Job<?>>, Integer>>", "signature": "Observable<Pair<List<Job<?>>, Integer>> retrieveJobs()", "full_signature": "@Override public Observable<Pair<List<Job<?>>, Integer>> retrieveJobs()", "class_method_signature": "CassandraJobStore.retrieveJobs()", "testcase": false, "constructor": false}, {"identifier": "retrieveJob", "parameters": "(String jobId)", "modifiers": "@Override public", "return": "Observable<Job<?>>", "signature": "Observable<Job<?>> retrieveJob(String jobId)", "full_signature": "@Override public Observable<Job<?>> retrieveJob(String jobId)", "class_method_signature": "CassandraJobStore.retrieveJob(String jobId)", "testcase": false, "constructor": false}, {"identifier": "storeJob", "parameters": "(Job job)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable storeJob(Job job)", "full_signature": "@Override public Completable storeJob(Job job)", "class_method_signature": "CassandraJobStore.storeJob(Job job)", "testcase": false, "constructor": false}, {"identifier": "writeJobToString", "parameters": "(Job job)", "modifiers": "private", "return": "String", "signature": "String writeJobToString(Job job)", "full_signature": "private String writeJobToString(Job job)", "class_method_signature": "CassandraJobStore.writeJobToString(Job job)", "testcase": false, "constructor": false}, {"identifier": "updateJob", "parameters": "(Job job)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable updateJob(Job job)", "full_signature": "@Override public Completable updateJob(Job job)", "class_method_signature": "CassandraJobStore.updateJob(Job job)", "testcase": false, "constructor": false}, {"identifier": "deleteJob", "parameters": "(Job job)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable deleteJob(Job job)", "full_signature": "@Override public Completable deleteJob(Job job)", "class_method_signature": "CassandraJobStore.deleteJob(Job job)", "testcase": false, "constructor": false}, {"identifier": "checkTaskConsistency", "parameters": "(List<Task> tasks)", "modifiers": "private", "return": "List<Task>", "signature": "List<Task> checkTaskConsistency(List<Task> tasks)", "full_signature": "private List<Task> checkTaskConsistency(List<Task> tasks)", "class_method_signature": "CassandraJobStore.checkTaskConsistency(List<Task> tasks)", "testcase": false, "constructor": false}, {"identifier": "retrieveTasksForJob", "parameters": "(String jobId)", "modifiers": "@Override public", "return": "Observable<Pair<List<Task>, Integer>>", "signature": "Observable<Pair<List<Task>, Integer>> retrieveTasksForJob(String jobId)", "full_signature": "@Override public Observable<Pair<List<Task>, Integer>> retrieveTasksForJob(String jobId)", "class_method_signature": "CassandraJobStore.retrieveTasksForJob(String jobId)", "testcase": false, "constructor": false}, {"identifier": "retrieveTask", "parameters": "(String taskId)", "modifiers": "@Override public", "return": "Observable<Task>", "signature": "Observable<Task> retrieveTask(String taskId)", "full_signature": "@Override public Observable<Task> retrieveTask(String taskId)", "class_method_signature": "CassandraJobStore.retrieveTask(String taskId)", "testcase": false, "constructor": false}, {"identifier": "storeTask", "parameters": "(Task task)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable storeTask(Task task)", "full_signature": "@Override public Completable storeTask(Task task)", "class_method_signature": "CassandraJobStore.storeTask(Task task)", "testcase": false, "constructor": false}, {"identifier": "updateTask", "parameters": "(Task task)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable updateTask(Task task)", "full_signature": "@Override public Completable updateTask(Task task)", "class_method_signature": "CassandraJobStore.updateTask(Task task)", "testcase": false, "constructor": false}, {"identifier": "replaceTask", "parameters": "(Task oldTask, Task newTask)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable replaceTask(Task oldTask, Task newTask)", "full_signature": "@Override public Completable replaceTask(Task oldTask, Task newTask)", "class_method_signature": "CassandraJobStore.replaceTask(Task oldTask, Task newTask)", "testcase": false, "constructor": false}, {"identifier": "moveTask", "parameters": "(Job jobFrom, Job jobTo, Task taskAfter)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable moveTask(Job jobFrom, Job jobTo, Task taskAfter)", "full_signature": "@Override public Completable moveTask(Job jobFrom, Job jobTo, Task taskAfter)", "class_method_signature": "CassandraJobStore.moveTask(Job jobFrom, Job jobTo, Task taskAfter)", "testcase": false, "constructor": false}, {"identifier": "deleteTask", "parameters": "(Task task)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable deleteTask(Task task)", "full_signature": "@Override public Completable deleteTask(Task task)", "class_method_signature": "CassandraJobStore.deleteTask(Task task)", "testcase": false, "constructor": false}, {"identifier": "retrieveArchivedJob", "parameters": "(String jobId)", "modifiers": "@Override public", "return": "Observable<Job<?>>", "signature": "Observable<Job<?>> retrieveArchivedJob(String jobId)", "full_signature": "@Override public Observable<Job<?>> retrieveArchivedJob(String jobId)", "class_method_signature": "CassandraJobStore.retrieveArchivedJob(String jobId)", "testcase": false, "constructor": false}, {"identifier": "retrieveArchivedTasksForJob", "parameters": "(String jobId)", "modifiers": "@Override public", "return": "Observable<Task>", "signature": "Observable<Task> retrieveArchivedTasksForJob(String jobId)", "full_signature": "@Override public Observable<Task> retrieveArchivedTasksForJob(String jobId)", "class_method_signature": "CassandraJobStore.retrieveArchivedTasksForJob(String jobId)", "testcase": false, "constructor": false}, {"identifier": "retrieveTasksForJob", "parameters": "(String jobId, PreparedStatement taskIdStatement, PreparedStatement taskStatement)", "modifiers": "private", "return": "Observable<Task>", "signature": "Observable<Task> retrieveTasksForJob(String jobId, PreparedStatement taskIdStatement, PreparedStatement taskStatement)", "full_signature": "private Observable<Task> retrieveTasksForJob(String jobId, PreparedStatement taskIdStatement, PreparedStatement taskStatement)", "class_method_signature": "CassandraJobStore.retrieveTasksForJob(String jobId, PreparedStatement taskIdStatement, PreparedStatement taskStatement)", "testcase": false, "constructor": false}, {"identifier": "retrieveArchivedTask", "parameters": "(String taskId)", "modifiers": "@Override public", "return": "Observable<Task>", "signature": "Observable<Task> retrieveArchivedTask(String taskId)", "full_signature": "@Override public Observable<Task> retrieveArchivedTask(String taskId)", "class_method_signature": "CassandraJobStore.retrieveArchivedTask(String taskId)", "testcase": false, "constructor": false}, {"identifier": "retrieveEntityById", "parameters": "(String id, Class<T> type, PreparedStatement preparedStatement)", "modifiers": "private", "return": "Observable<T>", "signature": "Observable<T> retrieveEntityById(String id, Class<T> type, PreparedStatement preparedStatement)", "full_signature": "private Observable<T> retrieveEntityById(String id, Class<T> type, PreparedStatement preparedStatement)", "class_method_signature": "CassandraJobStore.retrieveEntityById(String id, Class<T> type, PreparedStatement preparedStatement)", "testcase": false, "constructor": false}, {"identifier": "deserializeTask", "parameters": "(String value)", "modifiers": "private", "return": "Task", "signature": "Task deserializeTask(String value)", "full_signature": "private Task deserializeTask(String value)", "class_method_signature": "CassandraJobStore.deserializeTask(String value)", "testcase": false, "constructor": false}, {"identifier": "isJobActive", "parameters": "(String jobId)", "modifiers": "private", "return": "boolean", "signature": "boolean isJobActive(String jobId)", "full_signature": "private boolean isJobActive(String jobId)", "class_method_signature": "CassandraJobStore.isJobActive(String jobId)", "testcase": false, "constructor": false}, {"identifier": "getArchiveJobBatchStatement", "parameters": "(Job job)", "modifiers": "private", "return": "BatchStatement", "signature": "BatchStatement getArchiveJobBatchStatement(Job job)", "full_signature": "private BatchStatement getArchiveJobBatchStatement(Job job)", "class_method_signature": "CassandraJobStore.getArchiveJobBatchStatement(Job job)", "testcase": false, "constructor": false}, {"identifier": "getArchiveTaskBatchStatement", "parameters": "(Task task)", "modifiers": "private", "return": "BatchStatement", "signature": "BatchStatement getArchiveTaskBatchStatement(Task task)", "full_signature": "private BatchStatement getArchiveTaskBatchStatement(Task task)", "class_method_signature": "CassandraJobStore.getArchiveTaskBatchStatement(Task task)", "testcase": false, "constructor": false}, {"identifier": "execute", "parameters": "(Statement statement)", "modifiers": "private", "return": "Observable<ResultSet>", "signature": "Observable<ResultSet> execute(Statement statement)", "full_signature": "private Observable<ResultSet> execute(Statement statement)", "class_method_signature": "CassandraJobStore.execute(Statement statement)", "testcase": false, "constructor": false}, {"identifier": "getConcurrencyLimit", "parameters": "()", "modifiers": "private", "return": "int", "signature": "int getConcurrencyLimit()", "full_signature": "private int getConcurrencyLimit()", "class_method_signature": "CassandraJobStore.getConcurrencyLimit()", "testcase": false, "constructor": false}, {"identifier": "checkIfJobIsActive", "parameters": "(String jobId)", "modifiers": "private", "return": "void", "signature": "void checkIfJobIsActive(String jobId)", "full_signature": "private void checkIfJobIsActive(String jobId)", "class_method_signature": "CassandraJobStore.checkIfJobIsActive(String jobId)", "testcase": false, "constructor": false}, {"identifier": "checkIfJobAlreadyExists", "parameters": "(String jobId)", "modifiers": "private", "return": "void", "signature": "void checkIfJobAlreadyExists(String jobId)", "full_signature": "private void checkIfJobAlreadyExists(String jobId)", "class_method_signature": "CassandraJobStore.checkIfJobAlreadyExists(String jobId)", "testcase": false, "constructor": false}], "file": "titus-ext/cassandra/src/main/java/com/netflix/titus/ext/cassandra/store/CassandraJobStore.java"}, "focal_method": {"identifier": "storeTask", "parameters": "(Task task)", "modifiers": "@Override public", "return": "Completable", "body": "@Override\n    public Completable storeTask(Task task) {\n        return Observable.fromCallable((Callable<Statement>) () -> {\n            String jobId = task.getJobId();\n            String taskId = task.getId();\n            checkIfJobIsActive(jobId);\n            String taskJsonString = ObjectMappers.writeValueAsString(mapper, task);\n            Statement taskStatement = insertActiveTaskStatement.bind(taskId, taskJsonString);\n            Statement taskIdStatement = insertActiveTaskIdStatement.bind(jobId, taskId);\n\n            BatchStatement batchStatement = new BatchStatement();\n            batchStatement.add(taskStatement);\n            batchStatement.add(taskIdStatement);\n\n            transactionLogger().logBeforeCreate(insertActiveTaskStatement, \"storeTask\", task);\n\n            return batchStatement;\n        }).flatMap(statement ->\n                execute(statement).doOnNext(rs -> transactionLogger().logAfterCreate(insertActiveTaskStatement, \"storeTask\", task))\n        ).toCompletable();\n    }", "signature": "Completable storeTask(Task task)", "full_signature": "@Override public Completable storeTask(Task task)", "class_method_signature": "CassandraJobStore.storeTask(Task task)", "testcase": false, "constructor": false, "invocations": ["toCompletable", "flatMap", "fromCallable", "getJobId", "getId", "checkIfJobIsActive", "writeValueAsString", "bind", "bind", "add", "add", "logBeforeCreate", "transactionLogger", "doOnNext", "execute", "logAfterCreate", "transactionLogger"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}