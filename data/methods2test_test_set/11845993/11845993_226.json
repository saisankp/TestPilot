{"test_class": {"identifier": "IndexSelectorTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private Clock clock;", "modifier": "private", "type": "Clock", "declarator": "clock", "var_name": "clock"}, {"original_string": "private IndexSelector indexSelector;", "modifier": "private", "type": "IndexSelector", "declarator": "indexSelector", "var_name": "indexSelector"}], "file": "stagemonitor-core/src/test/java/org/stagemonitor/core/elasticsearch/IndexSelectorTest.java"}, "test_case": {"identifier": "testSelectIndexYearChange2Days", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testSelectIndexYearChange2Days() throws Exception {\n\t\tfinal String indexPattern = indexSelector.getIndexPatternOlderThanDays(\"metrics-\", 2);\n\t\tassertEquals(\"metrics-*,-metrics-1970.01.*,-metrics-1969.12.31,-metrics-1969.12.30\", indexPattern);\n\t}", "signature": "void testSelectIndexYearChange2Days()", "full_signature": "@Test public void testSelectIndexYearChange2Days()", "class_method_signature": "IndexSelectorTest.testSelectIndexYearChange2Days()", "testcase": true, "constructor": false, "invocations": ["getIndexPatternOlderThanDays", "assertEquals"]}, "focal_class": {"identifier": "IndexSelector", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final Clock clock;", "modifier": "private final", "type": "Clock", "declarator": "clock", "var_name": "clock"}], "methods": [{"identifier": "IndexSelector", "parameters": "(Clock clock)", "modifiers": "public", "return": "", "signature": " IndexSelector(Clock clock)", "full_signature": "public  IndexSelector(Clock clock)", "class_method_signature": "IndexSelector.IndexSelector(Clock clock)", "testcase": false, "constructor": true}, {"identifier": "getIndexPatternOlderThanDays", "parameters": "(String prefix, int days)", "modifiers": "public", "return": "String", "signature": "String getIndexPatternOlderThanDays(String prefix, int days)", "full_signature": "public String getIndexPatternOlderThanDays(String prefix, int days)", "class_method_signature": "IndexSelector.getIndexPatternOlderThanDays(String prefix, int days)", "testcase": false, "constructor": false}, {"identifier": "excludeMonths", "parameters": "(String prefix, GregorianCalendar now, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "modifiers": "private", "return": "void", "signature": "void excludeMonths(String prefix, GregorianCalendar now, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "full_signature": "private void excludeMonths(String prefix, GregorianCalendar now, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "class_method_signature": "IndexSelector.excludeMonths(String prefix, GregorianCalendar now, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "testcase": false, "constructor": false}, {"identifier": "excludeDays", "parameters": "(String prefix, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "modifiers": "private", "return": "void", "signature": "void excludeDays(String prefix, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "full_signature": "private void excludeDays(String prefix, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "class_method_signature": "IndexSelector.excludeDays(String prefix, StringBuilder sb, GregorianCalendar lastDayToExclude, GregorianCalendar alreadyExcluded)", "testcase": false, "constructor": false}, {"identifier": "getLastDayToExclude", "parameters": "(int days)", "modifiers": "private", "return": "GregorianCalendar", "signature": "GregorianCalendar getLastDayToExclude(int days)", "full_signature": "private GregorianCalendar getLastDayToExclude(int days)", "class_method_signature": "IndexSelector.getLastDayToExclude(int days)", "testcase": false, "constructor": false}, {"identifier": "getNowUTC", "parameters": "()", "modifiers": "private", "return": "GregorianCalendar", "signature": "GregorianCalendar getNowUTC()", "full_signature": "private GregorianCalendar getNowUTC()", "class_method_signature": "IndexSelector.getNowUTC()", "testcase": false, "constructor": false}, {"identifier": "formatTwoDigitsLeadingZero", "parameters": "(int i)", "modifiers": "private static", "return": "String", "signature": "String formatTwoDigitsLeadingZero(int i)", "full_signature": "private static String formatTwoDigitsLeadingZero(int i)", "class_method_signature": "IndexSelector.formatTwoDigitsLeadingZero(int i)", "testcase": false, "constructor": false}], "file": "stagemonitor-core/src/main/java/org/stagemonitor/core/elasticsearch/IndexSelector.java"}, "focal_method": {"identifier": "getIndexPatternOlderThanDays", "parameters": "(String prefix, int days)", "modifiers": "public", "return": "String", "body": "public String getIndexPatternOlderThanDays(String prefix, int days) {\n\t\t// select all indices, then exclude months and days that are not older than the days parameter\n\t\t// Example:\n\t\t// stagemonitor-metrics-*,-stagemonitor-metrics-2015.10.*,-stagemonitor-metrics-2015.09.30\n\t\tfinal StringBuilder indexPattern = new StringBuilder(prefix).append('*');\n\n\t\tfinal GregorianCalendar now = getNowUTC();\n\t\tfinal GregorianCalendar lastDayToExclude = getLastDayToExclude(days);\n\t\tfinal GregorianCalendar alreadyExcluded = getNowUTC();\n\n\t\texcludeMonths(prefix, now, indexPattern, lastDayToExclude, alreadyExcluded);\n\t\texcludeDays(prefix, indexPattern, lastDayToExclude, alreadyExcluded);\n\n\t\treturn indexPattern.toString();\n\t}", "signature": "String getIndexPatternOlderThanDays(String prefix, int days)", "full_signature": "public String getIndexPatternOlderThanDays(String prefix, int days)", "class_method_signature": "IndexSelector.getIndexPatternOlderThanDays(String prefix, int days)", "testcase": false, "constructor": false, "invocations": ["append", "getNowUTC", "getLastDayToExclude", "getNowUTC", "excludeMonths", "excludeDays", "toString"]}, "repository": {"repo_id": 11845993, "url": "https://github.com/stagemonitor/stagemonitor", "language": "Java", "is_fork": false, "fork_count": 268, "stargazer_count": 1585, "size": 10342, "license": "licensed"}}