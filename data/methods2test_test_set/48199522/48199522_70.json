{"test_class": {"identifier": "GoogleMonitoringIngesterTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(GoogleMonitoringIngesterTest.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(GoogleMonitoringIngesterTest.class)", "var_name": "log"}, {"original_string": "private MacroBaseConf conf;", "modifier": "private", "type": "MacroBaseConf", "declarator": "conf", "var_name": "conf"}], "file": "contrib/src/test/java/macrobase/ingest/GoogleMonitoringIngesterTest.java"}, "test_case": {"identifier": "testConvertToStream", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testConvertToStream() throws Exception {\n        Map<String, Map<String, Record>> byTime = new TreeMap<>();\n\n        Record record1 = new Record();\n        record1.attributes = new TreeMap<>();\n        record1.attributes.put(\"attr1\", \"foo\");\n        record1.attributes.put(\"attr2\", \"bar\");\n        record1.values = new HashMap<>();\n        record1.values.put(\"custom.googleapis.com/test\", 77.0);\n\n        Record record2 = new Record();\n        record2.attributes = new TreeMap<>();\n        record2.attributes.put(\"attr1\", \"foo\");\n        record2.attributes.put(\"attr2\", \"baz\");\n        record2.values = new HashMap<>();\n        record2.values.put(\"custom.googleapis.com/test\", 88.0);\n\n        // This record is incomplete and should be skipped.\n        Record record3 = new Record();\n        record3.attributes = new TreeMap<>();\n        record3.attributes.put(\"attr1\", \"foo\");\n        record3.attributes.put(\"attr2\", \"bar\");\n        record3.values = new HashMap<>();\n\n        Record record4 = new Record();\n        record4.attributes = new TreeMap<>();\n        record4.attributes.put(\"attr1\", \"foo\");\n        record4.attributes.put(\"attr2\", \"bar\");\n        record4.values = new HashMap<>();\n        record4.values.put(\"custom.googleapis.com/test\", 99.0);\n\n        Map<String, Record> recordMap1 = new HashMap<>();\n        recordMap1.put(\"attr-map-key1\", record1);\n        recordMap1.put(\"attr-map-key2\", record2);\n\n        Map<String, Record> recordMap2 = new HashMap<>();\n        recordMap2.put(\"attr-map-key1\", record3);\n\n        Map<String, Record> recordMap3 = new HashMap<>();\n        recordMap3.put(\"attr-map-key1\", record4);\n\n        byTime.put(\"2016-08-08T00:00:00Z\", recordMap1);\n        byTime.put(\"2016-08-08T00:00:01Z\", recordMap2);\n        byTime.put(\"2016-08-08T00:00:02Z\", recordMap3);\n\n        GoogleMonitoringIngester ingester = new GoogleMonitoringIngester(conf);\n        MBStream<Datum> stream = ingester.convertToStream(byTime);\n\n        List<Datum> data = stream.drain();\n        assertEquals(3, data.size(), 0.0);\n\n        assertEquals(77, data.get(0).metrics().getEntry(0), 0.0);\n        assertEquals(0, data.get(0).attributes().get(0), 0.0);\n        assertEquals(1, data.get(0).attributes().get(1), 0.0);\n\n        assertEquals(88, data.get(1).metrics().getEntry(0), 0.0);\n        assertEquals(0, data.get(1).attributes().get(0), 0.0);\n        assertEquals(2, data.get(1).attributes().get(1), 0.0);\n\n        assertEquals(99, data.get(2).metrics().getEntry(0), 0.0);\n        assertEquals(0, data.get(2).attributes().get(0), 0.0);\n        assertEquals(1, data.get(2).attributes().get(1), 0.0);\n    }", "signature": "void testConvertToStream()", "full_signature": "@Test public void testConvertToStream()", "class_method_signature": "GoogleMonitoringIngesterTest.testConvertToStream()", "testcase": true, "constructor": false, "invocations": ["put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "put", "convertToStream", "drain", "assertEquals", "size", "assertEquals", "getEntry", "metrics", "get", "assertEquals", "get", "attributes", "get", "assertEquals", "get", "attributes", "get", "assertEquals", "getEntry", "metrics", "get", "assertEquals", "get", "attributes", "get", "assertEquals", "get", "attributes", "get", "assertEquals", "getEntry", "metrics", "get", "assertEquals", "get", "attributes", "get", "assertEquals", "get", "attributes", "get"]}, "focal_class": {"identifier": "GoogleMonitoringIngester", "superclass": "extends DataIngester", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(GoogleMonitoringIngester.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(GoogleMonitoringIngester.class)", "var_name": "log"}, {"original_string": "public static final String GOOGLE_MONITORING_QUERIES = \"macrobase.loader.googlemonitoring.queries\";", "modifier": "public static final", "type": "String", "declarator": "GOOGLE_MONITORING_QUERIES = \"macrobase.loader.googlemonitoring.queries\"", "var_name": "GOOGLE_MONITORING_QUERIES"}, {"original_string": "public static final String GOOGLE_MONITORING_START_TIME = \"macrobase.loader.googlemonitoring.startTime\";", "modifier": "public static final", "type": "String", "declarator": "GOOGLE_MONITORING_START_TIME = \"macrobase.loader.googlemonitoring.startTime\"", "var_name": "GOOGLE_MONITORING_START_TIME"}, {"original_string": "public static final String GOOGLE_MONITORING_END_TIME = \"macrobase.loader.googlemonitoring.endTime\";", "modifier": "public static final", "type": "String", "declarator": "GOOGLE_MONITORING_END_TIME = \"macrobase.loader.googlemonitoring.endTime\"", "var_name": "GOOGLE_MONITORING_END_TIME"}, {"original_string": "private MBStream<Datum> dataStream;", "modifier": "private", "type": "MBStream<Datum>", "declarator": "dataStream", "var_name": "dataStream"}, {"original_string": "private boolean loaded = false;", "modifier": "private", "type": "boolean", "declarator": "loaded = false", "var_name": "loaded"}, {"original_string": "private int pointsAdded = 0;", "modifier": "private", "type": "int", "declarator": "pointsAdded = 0", "var_name": "pointsAdded"}, {"original_string": "private int skippedTimeSeries = 0;", "modifier": "private", "type": "int", "declarator": "skippedTimeSeries = 0", "var_name": "skippedTimeSeries"}, {"original_string": "private int skippedPoints = 0;", "modifier": "private", "type": "int", "declarator": "skippedPoints = 0", "var_name": "skippedPoints"}], "methods": [{"identifier": "GoogleMonitoringIngester", "parameters": "(MacroBaseConf conf)", "modifiers": "public", "return": "", "signature": " GoogleMonitoringIngester(MacroBaseConf conf)", "full_signature": "public  GoogleMonitoringIngester(MacroBaseConf conf)", "class_method_signature": "GoogleMonitoringIngester.GoogleMonitoringIngester(MacroBaseConf conf)", "testcase": false, "constructor": true}, {"identifier": "getStream", "parameters": "()", "modifiers": "@Override public", "return": "MBStream<Datum>", "signature": "MBStream<Datum> getStream()", "full_signature": "@Override public MBStream<Datum> getStream()", "class_method_signature": "GoogleMonitoringIngester.getStream()", "testcase": false, "constructor": false}, {"identifier": "getQueries", "parameters": "(String queryJson)", "modifiers": "", "return": "QueryConf", "signature": "QueryConf getQueries(String queryJson)", "full_signature": " QueryConf getQueries(String queryJson)", "class_method_signature": "GoogleMonitoringIngester.getQueries(String queryJson)", "testcase": false, "constructor": false}, {"identifier": "processResponse", "parameters": "(ListTimeSeriesResponse response, List<String> allMetrics,\n                         Map<String, Map<String, Record>> byTime)", "modifiers": "", "return": "void", "signature": "void processResponse(ListTimeSeriesResponse response, List<String> allMetrics,\n                         Map<String, Map<String, Record>> byTime)", "full_signature": " void processResponse(ListTimeSeriesResponse response, List<String> allMetrics,\n                         Map<String, Map<String, Record>> byTime)", "class_method_signature": "GoogleMonitoringIngester.processResponse(ListTimeSeriesResponse response, List<String> allMetrics,\n                         Map<String, Map<String, Record>> byTime)", "testcase": false, "constructor": false}, {"identifier": "processRecord", "parameters": "(Record rec)", "modifiers": "", "return": "Datum", "signature": "Datum processRecord(Record rec)", "full_signature": " Datum processRecord(Record rec)", "class_method_signature": "GoogleMonitoringIngester.processRecord(Record rec)", "testcase": false, "constructor": false}, {"identifier": "convertToStream", "parameters": "(Map<String, Map<String, Record>> byTime)", "modifiers": "", "return": "MBStream<Datum>", "signature": "MBStream<Datum> convertToStream(Map<String, Map<String, Record>> byTime)", "full_signature": " MBStream<Datum> convertToStream(Map<String, Map<String, Record>> byTime)", "class_method_signature": "GoogleMonitoringIngester.convertToStream(Map<String, Map<String, Record>> byTime)", "testcase": false, "constructor": false}, {"identifier": "buildClient", "parameters": "()", "modifiers": "private", "return": "Monitoring", "signature": "Monitoring buildClient()", "full_signature": "private Monitoring buildClient()", "class_method_signature": "GoogleMonitoringIngester.buildClient()", "testcase": false, "constructor": false}], "file": "contrib/src/main/java/macrobase/ingest/GoogleMonitoringIngester.java"}, "focal_method": {"identifier": "convertToStream", "parameters": "(Map<String, Map<String, Record>> byTime)", "modifiers": "", "return": "MBStream<Datum>", "body": "MBStream<Datum> convertToStream(Map<String, Map<String, Record>> byTime) {\n        MBStream<Datum> stream = new MBStream<>();\n        for (Entry<String, Map<String, Record>> entry : byTime.entrySet()) {\n            for (Record rec : entry.getValue().values()) {\n                try {\n                    stream.add(processRecord(rec));\n                    ++pointsAdded;\n                } catch (Exception e) {\n                    // The record was incomplete.\n                    ++skippedPoints;\n                }\n            }\n        }\n\n        return stream;\n    }", "signature": "MBStream<Datum> convertToStream(Map<String, Map<String, Record>> byTime)", "full_signature": " MBStream<Datum> convertToStream(Map<String, Map<String, Record>> byTime)", "class_method_signature": "GoogleMonitoringIngester.convertToStream(Map<String, Map<String, Record>> byTime)", "testcase": false, "constructor": false, "invocations": ["entrySet", "values", "getValue", "add", "processRecord"]}, "repository": {"repo_id": 48199522, "url": "https://github.com/stanford-futuredata/macrobase", "language": "Java", "is_fork": false, "fork_count": 116, "stargazer_count": 606, "size": 27614, "license": "licensed"}}