{"test_class": {"identifier": "ModuleHandlerTest", "superclass": "", "interfaces": "", "fields": [], "file": "server/src/test/java/org/axway/grapes/server/core/ModuleHandlerTest.java"}, "test_case": {"identifier": "getModuleLicenses", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getModuleLicenses(){\n        // Arrange\n        final DbModule module = new DbModule();\n        module.setName(\"module\");\n        module.setVersion(\"1.0.0-SNAPSHOT\");\n\n        final DbArtifact artifact1 = new DbArtifact();\n        artifact1.setArtifactId(\"artifact1\");\n        artifact1.setVersion(\"1.0.0-SNAPSHOT\");\n        module.addArtifact(artifact1);\n\n        final DbLicense license = new DbLicense();\n        license.setName(\"test\");\n        license.setLongName(\"License for Grapes tests\");\n        artifact1.addLicense(license);\n\n        final RepositoryHandler repositoryHandler = mock(RepositoryHandler.class);\n        when(repositoryHandler.getModule(module.getId())).thenReturn(module);\n        when(repositoryHandler.getArtifact(artifact1.getGavc())).thenReturn(artifact1);\n        // when(repositoryHandler.getMatchingLicenses(license.getName())).thenReturn(asSet(license));\n\n        final ModuleHandler sut = new ModuleHandler(repositoryHandler);\n\n        LicenseMatcher licenseMatcherMock = mock(LicenseMatcher.class);\n        when(licenseMatcherMock.getMatchingLicenses(license.getName())).thenReturn(asSet(license));\n\n        // Act\n        final List<DbLicense> licenses = sut.getModuleLicenses(module.getId(), licenseMatcherMock);\n\n        // Assert\n        assertNotNull(licenses);\n        assertEquals(1, licenses.size());\n        assertEquals(license, licenses.get(0));\n    }", "signature": "void getModuleLicenses()", "full_signature": "@Test public void getModuleLicenses()", "class_method_signature": "ModuleHandlerTest.getModuleLicenses()", "testcase": true, "constructor": false, "invocations": ["setName", "setVersion", "setArtifactId", "setVersion", "addArtifact", "setName", "setLongName", "addLicense", "mock", "thenReturn", "when", "getModule", "getId", "thenReturn", "when", "getArtifact", "getGavc", "mock", "thenReturn", "when", "getMatchingLicenses", "getName", "asSet", "getModuleLicenses", "getId", "assertNotNull", "assertEquals", "size", "assertEquals", "get"]}, "focal_class": {"identifier": "ModuleHandler", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(ModuleHandler.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(ModuleHandler.class)", "var_name": "LOG"}, {"original_string": "private final RepositoryHandler repositoryHandler;", "modifier": "private final", "type": "RepositoryHandler", "declarator": "repositoryHandler", "var_name": "repositoryHandler"}, {"original_string": "private CacheAccess<String, PromotionReportView> cache = null;", "modifier": "private", "type": "CacheAccess<String, PromotionReportView>", "declarator": "cache = null", "var_name": "cache"}, {"original_string": "private CacheUtils cacheUtils = new CacheUtils();", "modifier": "private", "type": "CacheUtils", "declarator": "cacheUtils = new CacheUtils()", "var_name": "cacheUtils"}, {"original_string": "private LicenseMatcher licenseMatcher;", "modifier": "private", "type": "LicenseMatcher", "declarator": "licenseMatcher", "var_name": "licenseMatcher"}], "methods": [{"identifier": "ModuleHandler", "parameters": "(final RepositoryHandler repositoryHandler)", "modifiers": "public", "return": "", "signature": " ModuleHandler(final RepositoryHandler repositoryHandler)", "full_signature": "public  ModuleHandler(final RepositoryHandler repositoryHandler)", "class_method_signature": "ModuleHandler.ModuleHandler(final RepositoryHandler repositoryHandler)", "testcase": false, "constructor": true}, {"identifier": "store", "parameters": "(final DbModule dbModule)", "modifiers": "public", "return": "void", "signature": "void store(final DbModule dbModule)", "full_signature": "public void store(final DbModule dbModule)", "class_method_signature": "ModuleHandler.store(final DbModule dbModule)", "testcase": false, "constructor": false}, {"identifier": "getModuleNames", "parameters": "(final FiltersHolder filters)", "modifiers": "public", "return": "List<String>", "signature": "List<String> getModuleNames(final FiltersHolder filters)", "full_signature": "public List<String> getModuleNames(final FiltersHolder filters)", "class_method_signature": "ModuleHandler.getModuleNames(final FiltersHolder filters)", "testcase": false, "constructor": false}, {"identifier": "getModuleVersions", "parameters": "(final String name, final FiltersHolder filters)", "modifiers": "public", "return": "List<String>", "signature": "List<String> getModuleVersions(final String name, final FiltersHolder filters)", "full_signature": "public List<String> getModuleVersions(final String name, final FiltersHolder filters)", "class_method_signature": "ModuleHandler.getModuleVersions(final String name, final FiltersHolder filters)", "testcase": false, "constructor": false}, {"identifier": "getModule", "parameters": "(final String moduleId)", "modifiers": "public", "return": "DbModule", "signature": "DbModule getModule(final String moduleId)", "full_signature": "public DbModule getModule(final String moduleId)", "class_method_signature": "ModuleHandler.getModule(final String moduleId)", "testcase": false, "constructor": false}, {"identifier": "deleteModule", "parameters": "(final String moduleId)", "modifiers": "public", "return": "void", "signature": "void deleteModule(final String moduleId)", "full_signature": "public void deleteModule(final String moduleId)", "class_method_signature": "ModuleHandler.deleteModule(final String moduleId)", "testcase": false, "constructor": false}, {"identifier": "getModuleLicenses", "parameters": "(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "modifiers": "public", "return": "List<DbLicense>", "signature": "List<DbLicense> getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "full_signature": "public List<DbLicense> getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "class_method_signature": "ModuleHandler.getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "testcase": false, "constructor": false}, {"identifier": "promoteModule", "parameters": "(final String moduleId)", "modifiers": "public", "return": "void", "signature": "void promoteModule(final String moduleId)", "full_signature": "public void promoteModule(final String moduleId)", "class_method_signature": "ModuleHandler.promoteModule(final String moduleId)", "testcase": false, "constructor": false}, {"identifier": "getPromotionReport", "parameters": "(final String moduleId)", "modifiers": "public", "return": "PromotionReportView", "signature": "PromotionReportView getPromotionReport(final String moduleId)", "full_signature": "public PromotionReportView getPromotionReport(final String moduleId)", "class_method_signature": "ModuleHandler.getPromotionReport(final String moduleId)", "testcase": false, "constructor": false}, {"identifier": "removeDuplicates", "parameters": "(List<Dependency> deps)", "modifiers": "private", "return": "void", "signature": "void removeDuplicates(List<Dependency> deps)", "full_signature": "private void removeDuplicates(List<Dependency> deps)", "class_method_signature": "ModuleHandler.removeDuplicates(List<Dependency> deps)", "testcase": false, "constructor": false}, {"identifier": "getOrganization", "parameters": "(final DbModule module)", "modifiers": "public", "return": "DbOrganization", "signature": "DbOrganization getOrganization(final DbModule module)", "full_signature": "public DbOrganization getOrganization(final DbModule module)", "class_method_signature": "ModuleHandler.getOrganization(final DbModule module)", "testcase": false, "constructor": false}, {"identifier": "getModules", "parameters": "(final FiltersHolder filters)", "modifiers": "public", "return": "List<DbModule>", "signature": "List<DbModule> getModules(final FiltersHolder filters)", "full_signature": "public List<DbModule> getModules(final FiltersHolder filters)", "class_method_signature": "ModuleHandler.getModules(final FiltersHolder filters)", "testcase": false, "constructor": false}], "file": "server/src/main/java/org/axway/grapes/server/core/ModuleHandler.java"}, "focal_method": {"identifier": "getModuleLicenses", "parameters": "(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "modifiers": "public", "return": "List<DbLicense>", "body": "public List<DbLicense> getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher) {\n        final DbModule module = getModule(moduleId);\n\n        final List<DbLicense> licenses = new ArrayList<>();\n        final FiltersHolder filters = new FiltersHolder();\n        final ArtifactHandler artifactHandler = new ArtifactHandler(repositoryHandler, licenseMatcher);\n\n        for (final String gavc : DataUtils.getAllArtifacts(module)) {\n            licenses.addAll(artifactHandler.getArtifactLicenses(gavc, filters));\n        }\n\n        return licenses;\n    }", "signature": "List<DbLicense> getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "full_signature": "public List<DbLicense> getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "class_method_signature": "ModuleHandler.getModuleLicenses(final String moduleId,\n                                             final LicenseMatcher licenseMatcher)", "testcase": false, "constructor": false, "invocations": ["getModule", "getAllArtifacts", "addAll", "getArtifactLicenses"]}, "repository": {"repo_id": 14858974, "url": "https://github.com/Axway/Grapes", "language": "Java", "is_fork": false, "fork_count": 9, "stargazer_count": 8, "size": 3620, "license": "licensed"}}