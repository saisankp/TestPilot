{"test_class": {"identifier": "KiePMMLSegmentationFactoryTest", "superclass": "extends AbstractKiePMMLFactoryTest", "interfaces": "", "fields": [], "file": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-mining/kie-pmml-models-mining-compiler/src/test/java/org/kie/pmml/models/mining/compiler/factories/KiePMMLSegmentationFactoryTest.java"}, "test_case": {"identifier": "getSegmentationSourcesMap", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getSegmentationSourcesMap() {\n        final String segmentationName = \"SEGMENTATION_NAME\";\n        final String packageName = \"packagename\";\n        final List<KiePMMLModel> nestedModels = new ArrayList<>();\n        final Map<String, String> retrieved = KiePMMLSegmentationFactory.getSegmentationSourcesMap(packageName,\n                                                                                                   DATA_DICTIONARY,\n                                                                                                   TRANSFORMATION_DICTIONARY,\n                                                                                                   MINING_MODEL.getSegmentation(),\n                                                                                                   segmentationName,\n                                                                                                   KNOWLEDGE_BUILDER,\n                                                                                                   nestedModels);\n        assertNotNull(retrieved);\n        int expectedNestedModels = MINING_MODEL.getSegmentation().getSegments().size();\n        assertEquals(expectedNestedModels, nestedModels.size());\n    }", "signature": "void getSegmentationSourcesMap()", "full_signature": "@Test public void getSegmentationSourcesMap()", "class_method_signature": "KiePMMLSegmentationFactoryTest.getSegmentationSourcesMap()", "testcase": true, "constructor": false, "invocations": ["getSegmentationSourcesMap", "getSegmentation", "assertNotNull", "size", "getSegments", "getSegmentation", "assertEquals", "size"]}, "focal_class": {"identifier": "KiePMMLSegmentationFactory", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final String KIE_PMML_SEGMENTATION_TEMPLATE_JAVA = \"KiePMMLSegmentationTemplate.tmpl\";", "modifier": "static final", "type": "String", "declarator": "KIE_PMML_SEGMENTATION_TEMPLATE_JAVA = \"KiePMMLSegmentationTemplate.tmpl\"", "var_name": "KIE_PMML_SEGMENTATION_TEMPLATE_JAVA"}, {"original_string": "static final String KIE_PMML_SEGMENTATION_TEMPLATE = \"KiePMMLSegmentationTemplate\";", "modifier": "static final", "type": "String", "declarator": "KIE_PMML_SEGMENTATION_TEMPLATE = \"KiePMMLSegmentationTemplate\"", "var_name": "KIE_PMML_SEGMENTATION_TEMPLATE"}, {"original_string": "private static final Logger logger = LoggerFactory.getLogger(KiePMMLSegmentationFactory.class.getName());", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(KiePMMLSegmentationFactory.class.getName())", "var_name": "logger"}], "methods": [{"identifier": "KiePMMLSegmentationFactory", "parameters": "()", "modifiers": "private", "return": "", "signature": " KiePMMLSegmentationFactory()", "full_signature": "private  KiePMMLSegmentationFactory()", "class_method_signature": "KiePMMLSegmentationFactory.KiePMMLSegmentationFactory()", "testcase": false, "constructor": true}, {"identifier": "getSegmentation", "parameters": "(final DataDictionary dataDictionary,\n                                                      final TransformationDictionary transformationDictionary,\n                                                      final Segmentation segmentation,\n                                                      final String segmentationName,\n                                                      final KnowledgeBuilder kBuilder)", "modifiers": "public static", "return": "KiePMMLSegmentation", "signature": "KiePMMLSegmentation getSegmentation(final DataDictionary dataDictionary,\n                                                      final TransformationDictionary transformationDictionary,\n                                                      final Segmentation segmentation,\n                                                      final String segmentationName,\n                                                      final KnowledgeBuilder kBuilder)", "full_signature": "public static KiePMMLSegmentation getSegmentation(final DataDictionary dataDictionary,\n                                                      final TransformationDictionary transformationDictionary,\n                                                      final Segmentation segmentation,\n                                                      final String segmentationName,\n                                                      final KnowledgeBuilder kBuilder)", "class_method_signature": "KiePMMLSegmentationFactory.getSegmentation(final DataDictionary dataDictionary,\n                                                      final TransformationDictionary transformationDictionary,\n                                                      final Segmentation segmentation,\n                                                      final String segmentationName,\n                                                      final KnowledgeBuilder kBuilder)", "testcase": false, "constructor": false}, {"identifier": "getSegmentationSourcesMap", "parameters": "(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "modifiers": "public static", "return": "Map<String, String>", "signature": "Map<String, String> getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "full_signature": "public static Map<String, String> getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "class_method_signature": "KiePMMLSegmentationFactory.getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "testcase": false, "constructor": false}, {"identifier": "setConstructor", "parameters": "(final String generatedClassName,\n                               final String segmentationName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final MULTIPLE_MODEL_METHOD multipleModelMethod,\n                               final Set<String> segmentsClasses)", "modifiers": "static", "return": "void", "signature": "void setConstructor(final String generatedClassName,\n                               final String segmentationName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final MULTIPLE_MODEL_METHOD multipleModelMethod,\n                               final Set<String> segmentsClasses)", "full_signature": "static void setConstructor(final String generatedClassName,\n                               final String segmentationName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final MULTIPLE_MODEL_METHOD multipleModelMethod,\n                               final Set<String> segmentsClasses)", "class_method_signature": "KiePMMLSegmentationFactory.setConstructor(final String generatedClassName,\n                               final String segmentationName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final MULTIPLE_MODEL_METHOD multipleModelMethod,\n                               final Set<String> segmentsClasses)", "testcase": false, "constructor": false}], "file": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-mining/kie-pmml-models-mining-compiler/src/main/java/org/kie/pmml/models/mining/compiler/factories/KiePMMLSegmentationFactory.java"}, "focal_method": {"identifier": "getSegmentationSourcesMap", "parameters": "(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "modifiers": "public static", "return": "Map<String, String>", "body": "public static Map<String, String> getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels) {\n        logger.debug(\"getSegmentationSourcesMap {}\", segmentation);\n        final String packageName = getSanitizedPackageName(parentPackageName + \".\" + segmentationName);\n        final Map<String, String> toReturn = getSegmentsSourcesMap(packageName,\n                                                                   dataDictionary,\n                                                                   transformationDictionary,\n                                                                   segmentation.getSegments(),\n                                                                  kBuilder,\n                                                                   nestedModels);\n        String className = getSanitizedClassName(segmentationName);\n        CompilationUnit cloneCU = JavaParserUtils.getKiePMMLModelCompilationUnit(className, packageName,\n                                                                                 KIE_PMML_SEGMENTATION_TEMPLATE_JAVA,\n                                                                                 KIE_PMML_SEGMENTATION_TEMPLATE);\n        ClassOrInterfaceDeclaration segmentationTemplate = cloneCU.getClassByName(className)\n                .orElseThrow(() -> new KiePMMLException(MAIN_CLASS_NOT_FOUND + \": \" + className));\n        final ConstructorDeclaration constructorDeclaration =\n                segmentationTemplate.getDefaultConstructor().orElseThrow(() -> new KiePMMLInternalException(String.format(MISSING_DEFAULT_CONSTRUCTOR, segmentationName)));\n        Set<String> segmentsClasses = segmentation.getSegments().stream()\n                .map(segment -> getSanitizedPackageName(packageName + \".\" + segment.getId()) + \".\" + getSanitizedClassName(segment.getId()))\n                .collect(Collectors.toSet());\n        if (!toReturn.keySet().containsAll(segmentsClasses)) {\n            String missingClasses = String.join(\", \", segmentsClasses);\n            throw new KiePMMLException(\"Expected generated class \" + missingClasses + \" not found\");\n        }\n        setConstructor(className,\n                       segmentationName,\n                       constructorDeclaration,\n                       MULTIPLE_MODEL_METHOD.byName(segmentation.getMultipleModelMethod().value()),\n                       segmentsClasses);\n        toReturn.put(getFullClassName(cloneCU), cloneCU.toString());\n        return toReturn;\n    }", "signature": "Map<String, String> getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "full_signature": "public static Map<String, String> getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "class_method_signature": "KiePMMLSegmentationFactory.getSegmentationSourcesMap(final String parentPackageName,\n                                                                final DataDictionary dataDictionary,\n                                                                final TransformationDictionary transformationDictionary,\n                                                                final Segmentation segmentation,\n                                                                final String segmentationName,\n                                                                final KnowledgeBuilder kBuilder,\n                                                                final List<KiePMMLModel> nestedModels)", "testcase": false, "constructor": false, "invocations": ["debug", "getSanitizedPackageName", "getSegmentsSourcesMap", "getSegments", "getSanitizedClassName", "getKiePMMLModelCompilationUnit", "orElseThrow", "getClassByName", "orElseThrow", "getDefaultConstructor", "format", "collect", "map", "stream", "getSegments", "getSanitizedPackageName", "getId", "getSanitizedClassName", "getId", "toSet", "containsAll", "keySet", "join", "setConstructor", "byName", "value", "getMultipleModelMethod", "put", "getFullClassName", "toString"]}, "repository": {"repo_id": 1381673, "url": "https://github.com/kiegroup/drools", "stars": 2733, "created": "2/18/2011 8:37:05 AM +00:00", "updates": "2020-01-27T13:12:15+00:00", "fork": "False", "license": "licensed"}}