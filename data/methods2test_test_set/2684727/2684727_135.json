{"test_class": {"identifier": "OcrInformationalTooltipInteractorTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "OcrInformationalTooltipInteractor interactor;", "modifier": "", "type": "OcrInformationalTooltipInteractor", "declarator": "interactor", "var_name": "interactor"}, {"original_string": "@Mock\n    Analytics analytics;", "modifier": "@Mock", "type": "Analytics", "declarator": "analytics", "var_name": "analytics"}, {"original_string": "@Mock\n    OcrInformationalTooltipStateTracker stateTracker;", "modifier": "@Mock", "type": "OcrInformationalTooltipStateTracker", "declarator": "stateTracker", "var_name": "stateTracker"}, {"original_string": "@Mock\n    OcrPurchaseTracker ocrPurchaseTracker;", "modifier": "@Mock", "type": "OcrPurchaseTracker", "declarator": "ocrPurchaseTracker", "var_name": "ocrPurchaseTracker"}, {"original_string": "@Mock\n    IdentityManager identityManager;", "modifier": "@Mock", "type": "IdentityManager", "declarator": "identityManager", "var_name": "identityManager"}, {"original_string": "@Mock\n    ConfigurationManager configurationManager;", "modifier": "@Mock", "type": "ConfigurationManager", "declarator": "configurationManager", "var_name": "configurationManager"}], "file": "app/src/test/java/co/smartreceipts/android/ocr/widget/tooltip/OcrInformationalTooltipInteractorTest.java"}, "test_case": {"identifier": "getShowOcrTooltipForNoRemainingPurchasesWhenNotSetToShowTooltip", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getShowOcrTooltipForNoRemainingPurchasesWhenNotSetToShowTooltip() {\n        when(stateTracker.shouldShowOcrInfo()).thenReturn(Single.just(false));\n        when(ocrPurchaseTracker.hasAvailableScans()).thenReturn(false);\n        when(identityManager.isLoggedIn()).thenReturn(true);\n\n        TestObserver<OcrTooltipMessageType> testObserver = interactor.getShowOcrTooltip().test();\n        testObserver.awaitTerminalEvent();\n        testObserver.assertNoValues();\n        testObserver.assertComplete();\n        testObserver.assertNoErrors();\n        verify(stateTracker, never()).setShouldShowOcrInfo(anyBoolean());\n    }", "signature": "void getShowOcrTooltipForNoRemainingPurchasesWhenNotSetToShowTooltip()", "full_signature": "@Test public void getShowOcrTooltipForNoRemainingPurchasesWhenNotSetToShowTooltip()", "class_method_signature": "OcrInformationalTooltipInteractorTest.getShowOcrTooltipForNoRemainingPurchasesWhenNotSetToShowTooltip()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "shouldShowOcrInfo", "just", "thenReturn", "when", "hasAvailableScans", "thenReturn", "when", "isLoggedIn", "test", "getShowOcrTooltip", "awaitTerminalEvent", "assertNoValues", "assertComplete", "assertNoErrors", "setShouldShowOcrInfo", "verify", "never", "anyBoolean"]}, "focal_class": {"identifier": "OcrInformationalTooltipInteractor", "superclass": "", "interfaces": "", "fields": [{"original_string": "@VisibleForTesting\n    static final int SCANS_LEFT_TO_INFORM = 5;", "modifier": "@VisibleForTesting\n    static final", "type": "int", "declarator": "SCANS_LEFT_TO_INFORM = 5", "var_name": "SCANS_LEFT_TO_INFORM"}, {"original_string": "private final Analytics analytics;", "modifier": "private final", "type": "Analytics", "declarator": "analytics", "var_name": "analytics"}, {"original_string": "private final OcrInformationalTooltipStateTracker stateTracker;", "modifier": "private final", "type": "OcrInformationalTooltipStateTracker", "declarator": "stateTracker", "var_name": "stateTracker"}, {"original_string": "private final OcrPurchaseTracker ocrPurchaseTracker;", "modifier": "private final", "type": "OcrPurchaseTracker", "declarator": "ocrPurchaseTracker", "var_name": "ocrPurchaseTracker"}, {"original_string": "private final IdentityManager identityManager;", "modifier": "private final", "type": "IdentityManager", "declarator": "identityManager", "var_name": "identityManager"}, {"original_string": "private final ConfigurationManager configurationManager;", "modifier": "private final", "type": "ConfigurationManager", "declarator": "configurationManager", "var_name": "configurationManager"}, {"original_string": "private final Scheduler scheduler;", "modifier": "private final", "type": "Scheduler", "declarator": "scheduler", "var_name": "scheduler"}, {"original_string": "private int lastRemainingScans = 0;", "modifier": "private", "type": "int", "declarator": "lastRemainingScans = 0", "var_name": "lastRemainingScans"}], "methods": [{"identifier": "OcrInformationalTooltipInteractor", "parameters": "(@NonNull Analytics analytics,\n                                             @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                             @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                             @NonNull IdentityManager identityManager,\n                                             @NonNull ConfigurationManager configurationManager)", "modifiers": "@Inject public", "return": "", "signature": " OcrInformationalTooltipInteractor(@NonNull Analytics analytics,\n                                             @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                             @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                             @NonNull IdentityManager identityManager,\n                                             @NonNull ConfigurationManager configurationManager)", "full_signature": "@Inject public  OcrInformationalTooltipInteractor(@NonNull Analytics analytics,\n                                             @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                             @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                             @NonNull IdentityManager identityManager,\n                                             @NonNull ConfigurationManager configurationManager)", "class_method_signature": "OcrInformationalTooltipInteractor.OcrInformationalTooltipInteractor(@NonNull Analytics analytics,\n                                             @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                             @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                             @NonNull IdentityManager identityManager,\n                                             @NonNull ConfigurationManager configurationManager)", "testcase": false, "constructor": true}, {"identifier": "OcrInformationalTooltipInteractor", "parameters": "(@NonNull Analytics analytics,\n                                      @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                      @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                      @NonNull IdentityManager identityManager,\n                                      @NonNull ConfigurationManager configurationManager,\n                                      @NonNull Scheduler scheduler)", "modifiers": "@VisibleForTesting", "return": "", "signature": " OcrInformationalTooltipInteractor(@NonNull Analytics analytics,\n                                      @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                      @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                      @NonNull IdentityManager identityManager,\n                                      @NonNull ConfigurationManager configurationManager,\n                                      @NonNull Scheduler scheduler)", "full_signature": "@VisibleForTesting  OcrInformationalTooltipInteractor(@NonNull Analytics analytics,\n                                      @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                      @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                      @NonNull IdentityManager identityManager,\n                                      @NonNull ConfigurationManager configurationManager,\n                                      @NonNull Scheduler scheduler)", "class_method_signature": "OcrInformationalTooltipInteractor.OcrInformationalTooltipInteractor(@NonNull Analytics analytics,\n                                      @NonNull OcrInformationalTooltipStateTracker stateTracker,\n                                      @NonNull OcrPurchaseTracker ocrPurchaseTracker,\n                                      @NonNull IdentityManager identityManager,\n                                      @NonNull ConfigurationManager configurationManager,\n                                      @NonNull Scheduler scheduler)", "testcase": false, "constructor": true}, {"identifier": "initialize", "parameters": "()", "modifiers": "@SuppressLint(\"CheckResult\") @SuppressWarnings(\"ResultOfMethodCallIgnored\") public", "return": "void", "signature": "void initialize()", "full_signature": "@SuppressLint(\"CheckResult\") @SuppressWarnings(\"ResultOfMethodCallIgnored\") public void initialize()", "class_method_signature": "OcrInformationalTooltipInteractor.initialize()", "testcase": false, "constructor": false}, {"identifier": "getShowOcrTooltip", "parameters": "()", "modifiers": "@NonNull public", "return": "Observable<OcrTooltipMessageType>", "signature": "Observable<OcrTooltipMessageType> getShowOcrTooltip()", "full_signature": "@NonNull public Observable<OcrTooltipMessageType> getShowOcrTooltip()", "class_method_signature": "OcrInformationalTooltipInteractor.getShowOcrTooltip()", "testcase": false, "constructor": false}, {"identifier": "markTooltipInteraction", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void markTooltipInteraction()", "full_signature": "public void markTooltipInteraction()", "class_method_signature": "OcrInformationalTooltipInteractor.markTooltipInteraction()", "testcase": false, "constructor": false}], "file": "app/src/main/java/co/smartreceipts/android/ocr/widget/tooltip/OcrInformationalTooltipInteractor.java"}, "focal_method": {"identifier": "getShowOcrTooltip", "parameters": "()", "modifiers": "@NonNull public", "return": "Observable<OcrTooltipMessageType>", "body": "@NonNull\n    public Observable<OcrTooltipMessageType> getShowOcrTooltip() {\n        // configurationManager.isEnabled(ConfigurableResourceFeature.Ocr)\n        return stateTracker.shouldShowOcrInfo()\n                .subscribeOn(Schedulers.computation())\n                .flatMapObservable(shouldShowTooltip -> {\n                    if (shouldShowTooltip) {\n                        if (!configurationManager.isEnabled(ConfigurableResourceFeature.Ocr)) {\n                            Logger.info(OcrInformationalTooltipInteractor.this, \"OCR is not configured. Disabling the tooltip\");\n                            return Observable.empty();\n                        }\n                        if (ocrPurchaseTracker.getRemainingScans() > 0 && ocrPurchaseTracker.getRemainingScans() <= SCANS_LEFT_TO_INFORM) {\n                            return Observable.just(OcrTooltipMessageType.LimitedScansRemaining);\n                        }\n                        if (identityManager.isLoggedIn()) {\n                            if (ocrPurchaseTracker.hasAvailableScans()) {\n                                return Observable.empty();\n                            } else {\n                                return Observable.just(OcrTooltipMessageType.NoScansRemaining);\n                            }\n                        } else {\n                            return Observable.just(OcrTooltipMessageType.NotConfigured);\n                        }\n                    } else {\n                        return Observable.empty();\n                    }\n                })\n                .doOnNext(ocrTooltipMessageType -> {\n                    Logger.info(OcrInformationalTooltipInteractor.this, \"Displaying OCR Tooltip: {}\", ocrTooltipMessageType);\n                    analytics.record(new DefaultDataPointEvent(Events.Ocr.OcrInfoTooltipShown).addDataPoint(new DataPoint(\"type\", ocrTooltipMessageType)));\n                });\n    }", "signature": "Observable<OcrTooltipMessageType> getShowOcrTooltip()", "full_signature": "@NonNull public Observable<OcrTooltipMessageType> getShowOcrTooltip()", "class_method_signature": "OcrInformationalTooltipInteractor.getShowOcrTooltip()", "testcase": false, "constructor": false, "invocations": ["doOnNext", "flatMapObservable", "subscribeOn", "shouldShowOcrInfo", "computation", "isEnabled", "info", "empty", "getRemainingScans", "getRemainingScans", "just", "isLoggedIn", "hasAvailableScans", "empty", "just", "just", "empty", "info", "record", "addDataPoint"]}, "repository": {"repo_id": 2684727, "url": "https://github.com/wbaumann/SmartReceiptsLibrary", "stars": 166, "created": "11/1/2011 12:32:39 AM +00:00", "updates": "2020-01-26T22:04:24+00:00", "fork": "False", "license": "licensed"}}