{"test_class": {"identifier": "UpgradesTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private TestUpgradeOperation operation1;", "modifier": "private", "type": "TestUpgradeOperation", "declarator": "operation1", "var_name": "operation1"}, {"original_string": "private TestUpgradeOperation operation2;", "modifier": "private", "type": "TestUpgradeOperation", "declarator": "operation2", "var_name": "operation2"}, {"original_string": "private TestUpgradeOperation operation3;", "modifier": "private", "type": "TestUpgradeOperation", "declarator": "operation3", "var_name": "operation3"}, {"original_string": "private Upgrades testUpgrades;", "modifier": "private", "type": "Upgrades", "declarator": "testUpgrades", "var_name": "testUpgrades"}], "file": "modeshape-jcr/src/test/java/org/modeshape/jcr/UpgradesTest.java"}, "test_case": {"identifier": "shouldApplyOnlyLatestUpgrades", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void shouldApplyOnlyLatestUpgrades() throws Exception {\n        testUpgrades.applyUpgradesSince(0, null);\n        operation1.assertCalled();\n        operation2.assertCalled();\n        operation3.assertCalled();\n\n        testUpgrades.applyUpgradesSince(1, null);\n        operation1.assertCalled();\n        operation2.assertCalled();\n        operation3.assertCalled();\n\n        testUpgrades.applyUpgradesSince(2, null);\n        operation1.assertNotCalled();\n        operation2.assertCalled();\n        operation3.assertCalled();\n\n        testUpgrades.applyUpgradesSince(3, null);\n        operation1.assertNotCalled();\n        operation2.assertNotCalled();\n        operation3.assertCalled();\n\n        testUpgrades.applyUpgradesSince(4, null);\n        operation1.assertNotCalled();\n        operation2.assertNotCalled();\n        operation3.assertNotCalled();\n\n        testUpgrades.applyUpgradesSince(5, null);\n        operation1.assertNotCalled();\n        operation2.assertNotCalled();\n        operation3.assertNotCalled();\n    }", "signature": "void shouldApplyOnlyLatestUpgrades()", "full_signature": "@Test public void shouldApplyOnlyLatestUpgrades()", "class_method_signature": "UpgradesTest.shouldApplyOnlyLatestUpgrades()", "testcase": true, "constructor": false, "invocations": ["applyUpgradesSince", "assertCalled", "assertCalled", "assertCalled", "applyUpgradesSince", "assertCalled", "assertCalled", "assertCalled", "applyUpgradesSince", "assertNotCalled", "assertCalled", "assertCalled", "applyUpgradesSince", "assertNotCalled", "assertNotCalled", "assertCalled", "applyUpgradesSince", "assertNotCalled", "assertNotCalled", "assertNotCalled", "applyUpgradesSince", "assertNotCalled", "assertNotCalled", "assertNotCalled"]}, "focal_class": {"identifier": "Upgrades", "superclass": "", "interfaces": "", "fields": [{"original_string": "protected static final Logger LOGGER = Logger.getLogger(Upgrades.class);", "modifier": "protected static final", "type": "Logger", "declarator": "LOGGER = Logger.getLogger(Upgrades.class)", "var_name": "LOGGER"}, {"original_string": "protected static final int EMPTY_UPGRADES_ID = 0;", "modifier": "protected static final", "type": "int", "declarator": "EMPTY_UPGRADES_ID = 0", "var_name": "EMPTY_UPGRADES_ID"}, {"original_string": "public static final Upgrades STANDARD_UPGRADES;", "modifier": "public static final", "type": "Upgrades", "declarator": "STANDARD_UPGRADES", "var_name": "STANDARD_UPGRADES"}, {"original_string": "private final List<UpgradeOperation> operations = new ArrayList<>();", "modifier": "private final", "type": "List<UpgradeOperation>", "declarator": "operations = new ArrayList<>()", "var_name": "operations"}], "methods": [{"identifier": "Upgrades", "parameters": "( UpgradeOperation... operations )", "modifiers": "protected", "return": "", "signature": " Upgrades( UpgradeOperation... operations )", "full_signature": "protected  Upgrades( UpgradeOperation... operations )", "class_method_signature": "Upgrades.Upgrades( UpgradeOperation... operations )", "testcase": false, "constructor": true}, {"identifier": "applyUpgradesSince", "parameters": "( int lastId,\n                                         Context resources )", "modifiers": "public final", "return": "int", "signature": "int applyUpgradesSince( int lastId,\n                                         Context resources )", "full_signature": "public final int applyUpgradesSince( int lastId,\n                                         Context resources )", "class_method_signature": "Upgrades.applyUpgradesSince( int lastId,\n                                         Context resources )", "testcase": false, "constructor": false}, {"identifier": "isUpgradeRequired", "parameters": "( int lastId )", "modifiers": "public final", "return": "boolean", "signature": "boolean isUpgradeRequired( int lastId )", "full_signature": "public final boolean isUpgradeRequired( int lastId )", "class_method_signature": "Upgrades.isUpgradeRequired( int lastId )", "testcase": false, "constructor": false}, {"identifier": "getLatestAvailableUpgradeId", "parameters": "()", "modifiers": "public final", "return": "int", "signature": "int getLatestAvailableUpgradeId()", "full_signature": "public final int getLatestAvailableUpgradeId()", "class_method_signature": "Upgrades.getLatestAvailableUpgradeId()", "testcase": false, "constructor": false}], "file": "modeshape-jcr/src/main/java/org/modeshape/jcr/Upgrades.java"}, "focal_method": {"identifier": "applyUpgradesSince", "parameters": "( int lastId,\n                                         Context resources )", "modifiers": "public final", "return": "int", "body": "public final int applyUpgradesSince( int lastId,\n                                         Context resources ) {\n        int lastUpgradeId = lastId;\n        for (UpgradeOperation op : operations) {\n            if (op.getId() <= lastId) continue;\n            LOGGER.debug(\"Upgrade {0}: starting\", op);\n            op.apply(resources);\n            LOGGER.debug(\"Upgrade {0}: complete\", op);\n            lastUpgradeId = op.getId();\n        }\n        return lastUpgradeId;\n    }", "signature": "int applyUpgradesSince( int lastId,\n                                         Context resources )", "full_signature": "public final int applyUpgradesSince( int lastId,\n                                         Context resources )", "class_method_signature": "Upgrades.applyUpgradesSince( int lastId,\n                                         Context resources )", "testcase": false, "constructor": false, "invocations": ["getId", "debug", "apply", "debug", "getId"]}, "repository": {"repo_id": 1244027, "url": "https://github.com/ModeShape/modeshape", "language": "Java", "is_fork": false, "fork_count": 213, "stargazer_count": 208, "size": 134266, "license": "licensed"}}