{"test_class": {"identifier": "ExtensionLoaderTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(ExtensionLoaderTest.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(ExtensionLoaderTest.class)", "var_name": "LOGGER"}], "file": "core/api/src/test/java/com/alipay/sofa/rpc/ext/ExtensionLoaderTest.java"}, "test_case": {"identifier": "testLoadFromFile", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testLoadFromFile() throws Exception {\n        ExtensionLoader loader = new ExtensionLoader<Filter>(Filter.class, false, null);\n        loader.loadFromFile(\"META-INF/ext1/\");\n        Assert.assertTrue(loader.getAllExtensions().isEmpty());\n\n        // test right extension\n        loader = new ExtensionLoader<Filter>(Filter.class, false, null);\n        loader.loadFromFile(\"META-INF/ext2/\");\n        Assert.assertFalse(loader.getAllExtensions().isEmpty());\n        ExtensionClass extensionClass = loader.getExtensionClass(\"rightxx0\");\n        Assert.assertNotNull(extensionClass);\n        Assert.assertTrue(extensionClass.getOrder() == 123);\n\n        loader = new ExtensionLoader<Filter>(Filter.class, false, new TestErrorLoadListener());\n        loader.loadFromFile(\"META-INF/ext3/\");\n        Assert.assertFalse(loader.getAllExtensions().isEmpty());\n        extensionClass = loader.getExtensionClass(\"rightxx0\");\n        Assert.assertNotNull(extensionClass);\n        extensionClass = loader.getExtensionClass(\"rightxx1\");\n        Assert.assertNotNull(extensionClass);\n        Assert.assertTrue(extensionClass.getOrder() == 128);\n\n        loader = new ExtensionLoader<Filter>(Filter.class, false, new TestLoadListener());\n        loader.loadFromFile(\"META-INF/ext4/\");\n        Assert.assertFalse(loader.getAllExtensions().isEmpty());\n        extensionClass = loader.getExtensionClass(\"rightxx0\");\n        Assert.assertNotNull(extensionClass);\n        Assert.assertTrue(extensionClass.getOrder() == 123);\n        extensionClass = loader.getExtensionClass(\"rightxx1\");\n        Assert.assertNotNull(extensionClass);\n        Assert.assertTrue(extensionClass.getOrder() == 128);\n\n    }", "signature": "void testLoadFromFile()", "full_signature": "@Test public void testLoadFromFile()", "class_method_signature": "ExtensionLoaderTest.testLoadFromFile()", "testcase": true, "constructor": false, "invocations": ["loadFromFile", "assertTrue", "isEmpty", "getAllExtensions", "loadFromFile", "assertFalse", "isEmpty", "getAllExtensions", "getExtensionClass", "assertNotNull", "assertTrue", "getOrder", "loadFromFile", "assertFalse", "isEmpty", "getAllExtensions", "getExtensionClass", "assertNotNull", "getExtensionClass", "assertNotNull", "assertTrue", "getOrder", "loadFromFile", "assertFalse", "isEmpty", "getAllExtensions", "getExtensionClass", "assertNotNull", "assertTrue", "getOrder", "getExtensionClass", "assertNotNull", "assertTrue", "getOrder"]}, "focal_class": {"identifier": "ExtensionLoader", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final static Logger                              LOGGER         = LoggerFactory\n                                                                                .getLogger(ExtensionLoader.class);", "modifier": "private final static", "type": "Logger", "declarator": "LOGGER         = LoggerFactory\n                                                                                .getLogger(ExtensionLoader.class)", "var_name": "LOGGER"}, {"original_string": "private static final String                              LOAD_FROM_CODE = \"DYNAMIC LOAD EXTENSION BY CODE\";", "modifier": "private static final", "type": "String", "declarator": "LOAD_FROM_CODE = \"DYNAMIC LOAD EXTENSION BY CODE\"", "var_name": "LOAD_FROM_CODE"}, {"original_string": "protected final Class<T>                                 interfaceClass;", "modifier": "protected final", "type": "Class<T>", "declarator": "interfaceClass", "var_name": "interfaceClass"}, {"original_string": "protected final String                                   interfaceName;", "modifier": "protected final", "type": "String", "declarator": "interfaceName", "var_name": "interfaceName"}, {"original_string": "protected final Extensible                               extensible;", "modifier": "protected final", "type": "Extensible", "declarator": "extensible", "var_name": "extensible"}, {"original_string": "protected final ConcurrentMap<String, ExtensionClass<T>> all;", "modifier": "protected final", "type": "ConcurrentMap<String, ExtensionClass<T>>", "declarator": "all", "var_name": "all"}, {"original_string": "protected final ConcurrentMap<String, T>                 factory;", "modifier": "protected final", "type": "ConcurrentMap<String, T>", "declarator": "factory", "var_name": "factory"}, {"original_string": "protected final List<ExtensionLoaderListener<T>>         listeners;", "modifier": "protected final", "type": "List<ExtensionLoaderListener<T>>", "declarator": "listeners", "var_name": "listeners"}], "methods": [{"identifier": "ExtensionLoader", "parameters": "(Class<T> interfaceClass, ExtensionLoaderListener<T> listener)", "modifiers": "public", "return": "", "signature": " ExtensionLoader(Class<T> interfaceClass, ExtensionLoaderListener<T> listener)", "full_signature": "public  ExtensionLoader(Class<T> interfaceClass, ExtensionLoaderListener<T> listener)", "class_method_signature": "ExtensionLoader.ExtensionLoader(Class<T> interfaceClass, ExtensionLoaderListener<T> listener)", "testcase": false, "constructor": true}, {"identifier": "ExtensionLoader", "parameters": "(Class<T> interfaceClass)", "modifiers": "protected", "return": "", "signature": " ExtensionLoader(Class<T> interfaceClass)", "full_signature": "protected  ExtensionLoader(Class<T> interfaceClass)", "class_method_signature": "ExtensionLoader.ExtensionLoader(Class<T> interfaceClass)", "testcase": false, "constructor": true}, {"identifier": "ExtensionLoader", "parameters": "(Class<T> interfaceClass, boolean autoLoad, ExtensionLoaderListener<T> listener)", "modifiers": "protected", "return": "", "signature": " ExtensionLoader(Class<T> interfaceClass, boolean autoLoad, ExtensionLoaderListener<T> listener)", "full_signature": "protected  ExtensionLoader(Class<T> interfaceClass, boolean autoLoad, ExtensionLoaderListener<T> listener)", "class_method_signature": "ExtensionLoader.ExtensionLoader(Class<T> interfaceClass, boolean autoLoad, ExtensionLoaderListener<T> listener)", "testcase": false, "constructor": true}, {"identifier": "loadFromFile", "parameters": "(String path)", "modifiers": "protected synchronized", "return": "void", "signature": "void loadFromFile(String path)", "full_signature": "protected synchronized void loadFromFile(String path)", "class_method_signature": "ExtensionLoader.loadFromFile(String path)", "testcase": false, "constructor": false}, {"identifier": "loadFromClassLoader", "parameters": "(ClassLoader classLoader, String fullFileName)", "modifiers": "protected", "return": "void", "signature": "void loadFromClassLoader(ClassLoader classLoader, String fullFileName)", "full_signature": "protected void loadFromClassLoader(ClassLoader classLoader, String fullFileName)", "class_method_signature": "ExtensionLoader.loadFromClassLoader(ClassLoader classLoader, String fullFileName)", "testcase": false, "constructor": false}, {"identifier": "readLine", "parameters": "(URL url, String line)", "modifiers": "protected", "return": "void", "signature": "void readLine(URL url, String line)", "full_signature": "protected void readLine(URL url, String line)", "class_method_signature": "ExtensionLoader.readLine(URL url, String line)", "testcase": false, "constructor": false}, {"identifier": "loadExtension", "parameters": "(String alias, Class loadedClazz, String location, String className)", "modifiers": "private", "return": "void", "signature": "void loadExtension(String alias, Class loadedClazz, String location, String className)", "full_signature": "private void loadExtension(String alias, Class loadedClazz, String location, String className)", "class_method_signature": "ExtensionLoader.loadExtension(String alias, Class loadedClazz, String location, String className)", "testcase": false, "constructor": false}, {"identifier": "buildClass", "parameters": "(Extension extension, Class<? extends T> implClass, String alias)", "modifiers": "private", "return": "ExtensionClass<T>", "signature": "ExtensionClass<T> buildClass(Extension extension, Class<? extends T> implClass, String alias)", "full_signature": "private ExtensionClass<T> buildClass(Extension extension, Class<? extends T> implClass, String alias)", "class_method_signature": "ExtensionLoader.buildClass(Extension extension, Class<? extends T> implClass, String alias)", "testcase": false, "constructor": false}, {"identifier": "loadSuccess", "parameters": "(String alias, ExtensionClass<T> extensionClass)", "modifiers": "private", "return": "void", "signature": "void loadSuccess(String alias, ExtensionClass<T> extensionClass)", "full_signature": "private void loadSuccess(String alias, ExtensionClass<T> extensionClass)", "class_method_signature": "ExtensionLoader.loadSuccess(String alias, ExtensionClass<T> extensionClass)", "testcase": false, "constructor": false}, {"identifier": "parseAliasAndClassName", "parameters": "(String line)", "modifiers": "protected", "return": "String[]", "signature": "String[] parseAliasAndClassName(String line)", "full_signature": "protected String[] parseAliasAndClassName(String line)", "class_method_signature": "ExtensionLoader.parseAliasAndClassName(String line)", "testcase": false, "constructor": false}, {"identifier": "getAllExtensions", "parameters": "()", "modifiers": "public", "return": "ConcurrentMap<String, ExtensionClass<T>>", "signature": "ConcurrentMap<String, ExtensionClass<T>> getAllExtensions()", "full_signature": "public ConcurrentMap<String, ExtensionClass<T>> getAllExtensions()", "class_method_signature": "ExtensionLoader.getAllExtensions()", "testcase": false, "constructor": false}, {"identifier": "getExtensionClass", "parameters": "(String alias)", "modifiers": "public", "return": "ExtensionClass<T>", "signature": "ExtensionClass<T> getExtensionClass(String alias)", "full_signature": "public ExtensionClass<T> getExtensionClass(String alias)", "class_method_signature": "ExtensionLoader.getExtensionClass(String alias)", "testcase": false, "constructor": false}, {"identifier": "getExtension", "parameters": "(String alias)", "modifiers": "public", "return": "T", "signature": "T getExtension(String alias)", "full_signature": "public T getExtension(String alias)", "class_method_signature": "ExtensionLoader.getExtension(String alias)", "testcase": false, "constructor": false}, {"identifier": "getExtension", "parameters": "(String alias, Class[] argTypes, Object[] args)", "modifiers": "public", "return": "T", "signature": "T getExtension(String alias, Class[] argTypes, Object[] args)", "full_signature": "public T getExtension(String alias, Class[] argTypes, Object[] args)", "class_method_signature": "ExtensionLoader.getExtension(String alias, Class[] argTypes, Object[] args)", "testcase": false, "constructor": false}, {"identifier": "loadExtension", "parameters": "(Class loadedClass)", "modifiers": "public", "return": "void", "signature": "void loadExtension(Class loadedClass)", "full_signature": "public void loadExtension(Class loadedClass)", "class_method_signature": "ExtensionLoader.loadExtension(Class loadedClass)", "testcase": false, "constructor": false}, {"identifier": "addListener", "parameters": "(ExtensionLoaderListener<T> listener)", "modifiers": "public", "return": "void", "signature": "void addListener(ExtensionLoaderListener<T> listener)", "full_signature": "public void addListener(ExtensionLoaderListener<T> listener)", "class_method_signature": "ExtensionLoader.addListener(ExtensionLoaderListener<T> listener)", "testcase": false, "constructor": false}], "file": "core/api/src/main/java/com/alipay/sofa/rpc/ext/ExtensionLoader.java"}, "focal_method": {"identifier": "loadFromFile", "parameters": "(String path)", "modifiers": "protected synchronized", "return": "void", "body": "protected synchronized void loadFromFile(String path) {\n        if (LOGGER.isDebugEnabled()) {\n            LOGGER.debug(\"Loading extension of extensible {} from path: {}\", interfaceName, path);\n        }\n        // \u9ed8\u8ba4\u5982\u679c\u4e0d\u6307\u5b9a\u6587\u4ef6\u540d\u5b57\uff0c\u5c31\u662f\u63a5\u53e3\u540d\n        String file = StringUtils.isBlank(extensible.file()) ? interfaceName : extensible.file().trim();\n        String fullFileName = path + file;\n        try {\n            ClassLoader classLoader = ClassLoaderUtils.getClassLoader(getClass());\n            loadFromClassLoader(classLoader, fullFileName);\n        } catch (Throwable t) {\n            if (LOGGER.isDebugEnabled()) {\n                LOGGER.debug(\"Failed to load extension of extensible \" + interfaceName + \" from path:\" + fullFileName,\n                    t);\n            }\n        }\n    }", "signature": "void loadFromFile(String path)", "full_signature": "protected synchronized void loadFromFile(String path)", "class_method_signature": "ExtensionLoader.loadFromFile(String path)", "testcase": false, "constructor": false, "invocations": ["isDebugEnabled", "debug", "isBlank", "file", "trim", "file", "getClassLoader", "getClass", "loadFromClassLoader", "isDebugEnabled", "debug"]}, "repository": {"repo_id": 128709824, "url": "https://github.com/sofastack/sofa-rpc", "stars": 3001, "created": "4/9/2018 3:32:04 AM +00:00", "updates": "2020-01-22T02:08:51+00:00", "fork": "False", "license": "licensed"}}