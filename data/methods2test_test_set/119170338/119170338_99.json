{"test_class": {"identifier": "HypergeometricTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Hypergeometric hypergeometric = new Hypergeometric();", "modifier": "private static final", "type": "Hypergeometric", "declarator": "hypergeometric = new Hypergeometric()", "var_name": "hypergeometric"}, {"original_string": "private static final double EPSILON = 0.00001;", "modifier": "private static final", "type": "double", "declarator": "EPSILON = 0.00001", "var_name": "EPSILON"}], "file": "phenol-analysis/src/test/java/org/monarchinitiative/phenol/stats/HypergeometricTest.java"}, "test_case": {"identifier": "test_phyper_underrepresentation", "parameters": "()", "modifiers": "@Test", "return": "void", "body": "@Test\n  void test_phyper_underrepresentation() {\n    int N = 60; // # total number of genes\n    int n = 13; // # study set\n    int n_t = 2; // # number genes in study set annotated to t\n    int m_t = 5; // # number of genes in population annotated to t\n    double result = hypergeometric.phyper(n_t, N, m_t, n, true);\n    assertEquals(0.9370032, result, EPSILON);\n  }", "signature": "void test_phyper_underrepresentation()", "full_signature": "@Test void test_phyper_underrepresentation()", "class_method_signature": "HypergeometricTest.test_phyper_underrepresentation()", "testcase": true, "constructor": false, "invocations": ["phyper", "assertEquals"]}, "focal_class": {"identifier": "Hypergeometric", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final Vector<Double> lfactorial;", "modifier": "private final", "type": "Vector<Double>", "declarator": "lfactorial", "var_name": "lfactorial"}], "methods": [{"identifier": "Hypergeometric", "parameters": "()", "modifiers": "public", "return": "", "signature": " Hypergeometric()", "full_signature": "public  Hypergeometric()", "class_method_signature": "Hypergeometric.Hypergeometric()", "testcase": false, "constructor": true}, {"identifier": "phypergeometric", "parameters": "(int n, double p, int k, int r)", "modifiers": "public", "return": "double", "signature": "double phypergeometric(int n, double p, int k, int r)", "full_signature": "public double phypergeometric(int n, double p, int k, int r)", "class_method_signature": "Hypergeometric.phypergeometric(int n, double p, int k, int r)", "testcase": false, "constructor": false}, {"identifier": "phypergeometric", "parameters": "(int m, int m_t, int n, int n_t)", "modifiers": "public", "return": "double", "signature": "double phypergeometric(int m, int m_t, int n, int n_t)", "full_signature": "public double phypergeometric(int m, int m_t, int n, int n_t)", "class_method_signature": "Hypergeometric.phypergeometric(int m, int m_t, int n, int n_t)", "testcase": false, "constructor": false}, {"identifier": "dhyper", "parameters": "(int x, int N, int M, int n)", "modifiers": "public", "return": "double", "signature": "double dhyper(int x, int N, int M, int n)", "full_signature": "public double dhyper(int x, int N, int M, int n)", "class_method_signature": "Hypergeometric.dhyper(int x, int N, int M, int n)", "testcase": false, "constructor": false}, {"identifier": "phyper", "parameters": "(int x, int N, int M, int n, boolean lowerTail)", "modifiers": "public", "return": "double", "signature": "double phyper(int x, int N, int M, int n, boolean lowerTail)", "full_signature": "public double phyper(int x, int N, int M, int n, boolean lowerTail)", "class_method_signature": "Hypergeometric.phyper(int x, int N, int M, int n, boolean lowerTail)", "testcase": false, "constructor": false}, {"identifier": "lNchooseK", "parameters": "(int n, int k)", "modifiers": "public", "return": "double", "signature": "double lNchooseK(int n, int k)", "full_signature": "public double lNchooseK(int n, int k)", "class_method_signature": "Hypergeometric.lNchooseK(int n, int k)", "testcase": false, "constructor": false}, {"identifier": "logfact", "parameters": "(int i)", "modifiers": "public", "return": "double", "signature": "double logfact(int i)", "full_signature": "public double logfact(int i)", "class_method_signature": "Hypergeometric.logfact(int i)", "testcase": false, "constructor": false}], "file": "phenol-analysis/src/main/java/org/monarchinitiative/phenol/stats/Hypergeometric.java"}, "focal_method": {"identifier": "phyper", "parameters": "(int x, int N, int M, int n, boolean lowerTail)", "modifiers": "public", "return": "double", "body": "public double phyper(int x, int N, int M, int n, boolean lowerTail) {\n    int i;\n    int up;\n    double p;\n\n    up = Math.min(n, M);\n    p = 0;\n\n    if (x < up / 2) {\n      for (i = x; i >= 0; i--)\n        p += dhyper(i, N, M, n);\n\n      if (lowerTail) return p;\n      else return 1 - p;\n    } else {\n      for (i = x + 1; i <= up; i++)\n        p += dhyper(i, N, M, n);\n\n      if (lowerTail) return 1 - p;\n      else return p;\n    }\n  }", "signature": "double phyper(int x, int N, int M, int n, boolean lowerTail)", "full_signature": "public double phyper(int x, int N, int M, int n, boolean lowerTail)", "class_method_signature": "Hypergeometric.phyper(int x, int N, int M, int n, boolean lowerTail)", "testcase": false, "constructor": false, "invocations": ["min", "dhyper", "dhyper"]}, "repository": {"repo_id": 119170338, "url": "https://github.com/monarch-initiative/phenol", "language": "Java", "is_fork": false, "fork_count": 3, "stargazer_count": 9, "size": 5832, "license": "licensed"}}