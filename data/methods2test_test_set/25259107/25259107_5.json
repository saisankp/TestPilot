{"test_class": {"identifier": "ClientDataTest", "superclass": "", "interfaces": "", "fields": [], "file": "u2flib-server-core/src/test/java/com/yubico/u2f/data/messages/ClientDataTest.java"}, "test_case": {"identifier": "shouldCheckContent", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void shouldCheckContent() throws U2fBadInputException {\n        ClientData clientData = new ClientData(CLIENT_DATA_REGISTRATION_BASE64);\n        clientData.checkContent(\"navigator.id.finishEnrollment\", SERVER_CHALLENGE_REGISTER_BASE64, Optional.<Set<String>>of(ImmutableSet.of(APP_ID_ENROLL)));\n    }", "signature": "void shouldCheckContent()", "full_signature": "@Test public void shouldCheckContent()", "class_method_signature": "ClientDataTest.shouldCheckContent()", "testcase": true, "constructor": false, "invocations": ["checkContent", "of", "of"]}, "focal_class": {"identifier": "ClientData", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String TYPE_PARAM = \"typ\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_PARAM = \"typ\"", "var_name": "TYPE_PARAM"}, {"original_string": "private static final String CHALLENGE_PARAM = \"challenge\";", "modifier": "private static final", "type": "String", "declarator": "CHALLENGE_PARAM = \"challenge\"", "var_name": "CHALLENGE_PARAM"}, {"original_string": "private static final String ORIGIN_PARAM = \"origin\";", "modifier": "private static final", "type": "String", "declarator": "ORIGIN_PARAM = \"origin\"", "var_name": "ORIGIN_PARAM"}, {"original_string": "private final String type;", "modifier": "private final", "type": "String", "declarator": "type", "var_name": "type"}, {"original_string": "private final String challenge;", "modifier": "private final", "type": "String", "declarator": "challenge", "var_name": "challenge"}, {"original_string": "private final String origin;", "modifier": "private final", "type": "String", "declarator": "origin", "var_name": "origin"}, {"original_string": "private final String rawClientData;", "modifier": "private final", "type": "String", "declarator": "rawClientData", "var_name": "rawClientData"}], "methods": [{"identifier": "asJson", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String asJson()", "full_signature": "public String asJson()", "class_method_signature": "ClientData.asJson()", "testcase": false, "constructor": false}, {"identifier": "ClientData", "parameters": "(String clientData)", "modifiers": "public", "return": "", "signature": " ClientData(String clientData)", "full_signature": "public  ClientData(String clientData)", "class_method_signature": "ClientData.ClientData(String clientData)", "testcase": false, "constructor": true}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "ClientData.toString()", "testcase": false, "constructor": false}, {"identifier": "getChallenge", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getChallenge()", "full_signature": "public String getChallenge()", "class_method_signature": "ClientData.getChallenge()", "testcase": false, "constructor": false}, {"identifier": "getString", "parameters": "(JsonNode data, String key)", "modifiers": "private static", "return": "String", "signature": "String getString(JsonNode data, String key)", "full_signature": "private static String getString(JsonNode data, String key)", "class_method_signature": "ClientData.getString(JsonNode data, String key)", "testcase": false, "constructor": false}, {"identifier": "checkContent", "parameters": "(String type, String challenge, Optional<Set<String>> facets)", "modifiers": "public", "return": "void", "signature": "void checkContent(String type, String challenge, Optional<Set<String>> facets)", "full_signature": "public void checkContent(String type, String challenge, Optional<Set<String>> facets)", "class_method_signature": "ClientData.checkContent(String type, String challenge, Optional<Set<String>> facets)", "testcase": false, "constructor": false}, {"identifier": "verifyOrigin", "parameters": "(String origin, Set<String> allowedOrigins)", "modifiers": "private static", "return": "void", "signature": "void verifyOrigin(String origin, Set<String> allowedOrigins)", "full_signature": "private static void verifyOrigin(String origin, Set<String> allowedOrigins)", "class_method_signature": "ClientData.verifyOrigin(String origin, Set<String> allowedOrigins)", "testcase": false, "constructor": false}, {"identifier": "canonicalizeOrigins", "parameters": "(Set<String> origins)", "modifiers": "public static", "return": "Set<String>", "signature": "Set<String> canonicalizeOrigins(Set<String> origins)", "full_signature": "public static Set<String> canonicalizeOrigins(Set<String> origins)", "class_method_signature": "ClientData.canonicalizeOrigins(Set<String> origins)", "testcase": false, "constructor": false}, {"identifier": "canonicalizeOrigin", "parameters": "(String url)", "modifiers": "public static", "return": "String", "signature": "String canonicalizeOrigin(String url)", "full_signature": "public static String canonicalizeOrigin(String url)", "class_method_signature": "ClientData.canonicalizeOrigin(String url)", "testcase": false, "constructor": false}], "file": "u2flib-server-core/src/main/java/com/yubico/u2f/data/messages/ClientData.java"}, "focal_method": {"identifier": "checkContent", "parameters": "(String type, String challenge, Optional<Set<String>> facets)", "modifiers": "public", "return": "void", "body": "public void checkContent(String type, String challenge, Optional<Set<String>> facets) throws U2fBadInputException {\n        if (!type.equals(this.type)) {\n            throw new U2fBadInputException(\"Bad clientData: wrong type \" + this.type);\n        }\n        if (!challenge.equals(this.challenge)) {\n            throw new U2fBadInputException(\"Bad clientData: wrong challenge\");\n        }\n        if (facets.isPresent()) {\n            Set<String> allowedFacets = canonicalizeOrigins(facets.get());\n            String canonicalOrigin;\n            try {\n                canonicalOrigin = canonicalizeOrigin(origin);\n            } catch (RuntimeException e) {\n                throw new U2fBadInputException(\"Bad clientData: Malformed origin\", e);\n            }\n            verifyOrigin(canonicalOrigin, allowedFacets);\n        }\n    }", "signature": "void checkContent(String type, String challenge, Optional<Set<String>> facets)", "full_signature": "public void checkContent(String type, String challenge, Optional<Set<String>> facets)", "class_method_signature": "ClientData.checkContent(String type, String challenge, Optional<Set<String>> facets)", "testcase": false, "constructor": false, "invocations": ["equals", "equals", "isPresent", "canonicalizeOrigins", "get", "canonicalizeOrigin", "verifyOrigin"]}, "repository": {"repo_id": 25259107, "url": "https://github.com/Yubico/java-u2flib-server", "language": "Java", "is_fork": false, "fork_count": 55, "stargazer_count": 127, "size": 896, "license": "licensed"}}