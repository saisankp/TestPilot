{"test_class": {"identifier": "StreamToActionBusCallbackTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private JavaToSiddhiSerializer javaToSiddhiSerializer;", "modifier": "private", "type": "JavaToSiddhiSerializer", "declarator": "javaToSiddhiSerializer", "var_name": "javaToSiddhiSerializer"}, {"original_string": "private JavaToAvroSerializer javaToAvroSerializer;", "modifier": "private", "type": "JavaToAvroSerializer", "declarator": "javaToAvroSerializer", "var_name": "javaToAvroSerializer"}, {"original_string": "private StreamMetadataService metadataService;", "modifier": "private", "type": "StreamMetadataService", "declarator": "metadataService", "var_name": "metadataService"}, {"original_string": "private SiddhiManager siddhiManager;", "modifier": "private", "type": "SiddhiManager", "declarator": "siddhiManager", "var_name": "siddhiManager"}, {"original_string": "private StreamToActionBusCallback cbk;", "modifier": "private", "type": "StreamToActionBusCallback", "declarator": "cbk", "var_name": "cbk"}, {"original_string": "private static final String streamName= \"testStream\";", "modifier": "private static final", "type": "String", "declarator": "streamName= \"testStream\"", "var_name": "streamName"}, {"original_string": "@Mock\n    private Producer<String, String> producer;", "modifier": "@Mock\n    private", "type": "Producer<String, String>", "declarator": "producer", "var_name": "producer"}, {"original_string": "@Mock\n    private Producer<String, byte[]> avroProducer;", "modifier": "@Mock\n    private", "type": "Producer<String, byte[]>", "declarator": "avroProducer", "var_name": "avroProducer"}], "file": "engine/src/test/java/com/stratio/decision/callbacks/StreamToActionBusCallbackTest.java"}, "test_case": {"identifier": "testReceive", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testReceive() throws Exception {\n        StratioStreamingMessage message= StreamsHelper.getSampleMessage();\n        Event event= javaToSiddhiSerializer.serialize(message);\n        Event[] inEvents= {event};\n        Event[] removeEvents= {event};\n\n        Exception ex= null;\n        try {\n            cbk.receive(123456789L, inEvents, removeEvents);\n        } catch (Exception e) {ex= e;}\n\n        assertNull(\"Unexpected exception found\", ex);\n\n    }", "signature": "void testReceive()", "full_signature": "@Test public void testReceive()", "class_method_signature": "StreamToActionBusCallbackTest.testReceive()", "testcase": true, "constructor": false, "invocations": ["getSampleMessage", "serialize", "receive", "assertNull"]}, "focal_class": {"identifier": "StreamToActionBusCallback", "superclass": "extends ActionControllerCallback", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(StreamToActionBusCallback.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(StreamToActionBusCallback.class)", "var_name": "log"}, {"original_string": "private final String streamName;", "modifier": "private final", "type": "String", "declarator": "streamName", "var_name": "streamName"}, {"original_string": "private final Producer<String, byte[]> avroProducer;", "modifier": "private final", "type": "Producer<String, byte[]>", "declarator": "avroProducer", "var_name": "avroProducer"}, {"original_string": "private final Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer;", "modifier": "private final", "type": "Serializer<StratioStreamingMessage, Event>", "declarator": "javaToSiddhiSerializer", "var_name": "javaToSiddhiSerializer"}, {"original_string": "private final Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer;", "modifier": "private final", "type": "Serializer<StratioStreamingMessage, byte[]>", "declarator": "javaToAvroSerializer", "var_name": "javaToAvroSerializer"}, {"original_string": "private String groupId;", "modifier": "private", "type": "String", "declarator": "groupId", "var_name": "groupId"}], "methods": [{"identifier": "StreamToActionBusCallback", "parameters": "(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer)", "modifiers": "public", "return": "", "signature": " StreamToActionBusCallback(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer)", "full_signature": "public  StreamToActionBusCallback(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer)", "class_method_signature": "StreamToActionBusCallback.StreamToActionBusCallback(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer)", "testcase": false, "constructor": true}, {"identifier": "StreamToActionBusCallback", "parameters": "(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer,\n            String groupId)", "modifiers": "public", "return": "", "signature": " StreamToActionBusCallback(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer,\n            String groupId)", "full_signature": "public  StreamToActionBusCallback(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer,\n            String groupId)", "class_method_signature": "StreamToActionBusCallback.StreamToActionBusCallback(Set<StreamAction> activeActions, String streamName,\n            Producer<String, byte[]> avroProducer,\n            Serializer<StratioStreamingMessage, Event> javaToSiddhiSerializer,\n            Serializer<StratioStreamingMessage, byte[]> javaToAvroSerializer,\n            String groupId)", "testcase": false, "constructor": true}, {"identifier": "receive", "parameters": "(long timeStamp, Event[] inEvents, Event[] removeEvents)", "modifiers": "@Override public", "return": "void", "signature": "void receive(long timeStamp, Event[] inEvents, Event[] removeEvents)", "full_signature": "@Override public void receive(long timeStamp, Event[] inEvents, Event[] removeEvents)", "class_method_signature": "StreamToActionBusCallback.receive(long timeStamp, Event[] inEvents, Event[] removeEvents)", "testcase": false, "constructor": false}], "file": "engine/src/main/java/com/stratio/decision/callbacks/StreamToActionBusCallback.java"}, "focal_method": {"identifier": "receive", "parameters": "(long timeStamp, Event[] inEvents, Event[] removeEvents)", "modifiers": "@Override public", "return": "void", "body": "@Override\n    public void receive(long timeStamp, Event[] inEvents, Event[] removeEvents) {\n        if (log.isDebugEnabled()) {\n            log.debug(\"Receiving {} events from stream {}\", inEvents.length, streamName);\n        }\n\n        String topicAction = InternalTopic.TOPIC_ACTION.getTopicName();\n        if (groupId !=null){\n            topicAction = topicAction.concat(\"_\").concat(groupId);\n        }\n\n        List<KeyedMessage<String, byte[]>> messages = new ArrayList<>();\n\n        for (Event event : inEvents) {\n            StratioStreamingMessage messageObject = javaToSiddhiSerializer.deserialize(event);\n\n            messageObject.setStreamName(streamName);\n            messageObject.setActiveActions(this.activeActions);\n\n            messages.add(new KeyedMessage<String, byte[]>(topicAction,\n                    javaToAvroSerializer.serialize(messageObject)));\n\n        }\n\n        if (messages.size() != 0) {\n            avroProducer.send(messages);\n        }\n    }", "signature": "void receive(long timeStamp, Event[] inEvents, Event[] removeEvents)", "full_signature": "@Override public void receive(long timeStamp, Event[] inEvents, Event[] removeEvents)", "class_method_signature": "StreamToActionBusCallback.receive(long timeStamp, Event[] inEvents, Event[] removeEvents)", "testcase": false, "constructor": false, "invocations": ["isDebugEnabled", "debug", "getTopicName", "concat", "concat", "deserialize", "setStreamName", "setActiveActions", "add", "serialize", "size", "send"]}, "repository": {"repo_id": 20521495, "url": "https://github.com/Stratio/Decision", "language": "Java", "is_fork": false, "fork_count": 85, "stargazer_count": 305, "size": 41858, "license": "licensed"}}