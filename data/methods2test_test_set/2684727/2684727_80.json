{"test_class": {"identifier": "PlusPurchaseWalletTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String TEST = \"test\";", "modifier": "private static final", "type": "String", "declarator": "TEST = \"test\"", "var_name": "TEST"}, {"original_string": "private static final String PURCHASE_TOKEN = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689\";", "modifier": "private static final", "type": "String", "declarator": "PURCHASE_TOKEN = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689\"", "var_name": "PURCHASE_TOKEN"}, {"original_string": "private static final String IN_APP_DATA_SIGNATURE = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689==\";", "modifier": "private static final", "type": "String", "declarator": "IN_APP_DATA_SIGNATURE = \"012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689012345689ABCDEF012345689ABCDEF012345689ABCDEF012345689==\"", "var_name": "IN_APP_DATA_SIGNATURE"}, {"original_string": "private String purchaseData;", "modifier": "private", "type": "String", "declarator": "purchaseData", "var_name": "purchaseData"}, {"original_string": "PlusPurchaseWallet plusPurchaseWallet;", "modifier": "", "type": "PlusPurchaseWallet", "declarator": "plusPurchaseWallet", "var_name": "plusPurchaseWallet"}, {"original_string": "SharedPreferences preferences;", "modifier": "", "type": "SharedPreferences", "declarator": "preferences", "var_name": "preferences"}, {"original_string": "ManagedProduct managedProduct;", "modifier": "", "type": "ManagedProduct", "declarator": "managedProduct", "var_name": "managedProduct"}, {"original_string": "@Mock\n    Lazy<SharedPreferences> sharedPreferencesLazy;", "modifier": "@Mock", "type": "Lazy<SharedPreferences>", "declarator": "sharedPreferencesLazy", "var_name": "sharedPreferencesLazy"}], "file": "app/src/test/java/co/smartreceipts/android/purchases/wallet/PlusPurchaseWalletTest.java"}, "test_case": {"identifier": "ensureUpdatedPurchaseListIsPersistedAndPlusRemains", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void ensureUpdatedPurchaseListIsPersistedAndPlusRemains() {\n        // First add it\n        plusPurchaseWallet.addLocalInAppPurchaseToWallet(managedProduct);\n\n        // Then revoke it\n        plusPurchaseWallet.updateLocalInAppPurchasesInWallet(Collections.<ManagedProduct>emptySet());\n        final PurchaseWallet newWallet = new PlusPurchaseWallet(sharedPreferencesLazy);\n\n        assertTrue(newWallet.hasActivePurchase(InAppPurchase.SmartReceiptsPlus));\n        assertNull(newWallet.getLocalInAppManagedProduct(InAppPurchase.SmartReceiptsPlus));\n        assertTrue(plusPurchaseWallet.hasActivePurchase(InAppPurchase.SmartReceiptsPlus));\n        assertNull(plusPurchaseWallet.getLocalInAppManagedProduct(InAppPurchase.SmartReceiptsPlus));\n\n        assertFalse(newWallet.hasActivePurchase(InAppPurchase.OcrScans50));\n        assertNull(newWallet.getLocalInAppManagedProduct(InAppPurchase.OcrScans50));\n        assertFalse(plusPurchaseWallet.hasActivePurchase(InAppPurchase.OcrScans50));\n        assertNull(plusPurchaseWallet.getLocalInAppManagedProduct(InAppPurchase.OcrScans50));\n\n        assertEquals(newWallet.getActiveLocalInAppPurchases(), Collections.emptySet());\n        assertEquals(plusPurchaseWallet.getActiveLocalInAppPurchases(), Collections.emptySet());\n\n        assertEquals(preferences.getStringSet(\"key_sku_set\", Collections.<String>emptySet()), Collections.emptySet());\n        assertFalse(preferences.contains(\"ocr_purchase_1_purchaseData\"));\n        assertFalse(preferences.contains(\"ocr_purchase_1_inAppDataSignature\"));\n    }", "signature": "void ensureUpdatedPurchaseListIsPersistedAndPlusRemains()", "full_signature": "@Test public void ensureUpdatedPurchaseListIsPersistedAndPlusRemains()", "class_method_signature": "PlusPurchaseWalletTest.ensureUpdatedPurchaseListIsPersistedAndPlusRemains()", "testcase": true, "constructor": false, "invocations": ["addLocalInAppPurchaseToWallet", "updateLocalInAppPurchasesInWallet", "emptySet", "assertTrue", "hasActivePurchase", "assertNull", "getLocalInAppManagedProduct", "assertTrue", "hasActivePurchase", "assertNull", "getLocalInAppManagedProduct", "assertFalse", "hasActivePurchase", "assertNull", "getLocalInAppManagedProduct", "assertFalse", "hasActivePurchase", "assertNull", "getLocalInAppManagedProduct", "assertEquals", "getActiveLocalInAppPurchases", "emptySet", "assertEquals", "getActiveLocalInAppPurchases", "emptySet", "assertEquals", "getStringSet", "emptySet", "emptySet", "assertFalse", "contains", "assertFalse", "contains"]}, "focal_class": {"identifier": "PlusPurchaseWallet", "superclass": "extends DefaultPurchaseWallet", "interfaces": "", "fields": [], "methods": [{"identifier": "PlusPurchaseWallet", "parameters": "(@NonNull Lazy<SharedPreferences> preferences)", "modifiers": "@Inject public", "return": "", "signature": " PlusPurchaseWallet(@NonNull Lazy<SharedPreferences> preferences)", "full_signature": "@Inject public  PlusPurchaseWallet(@NonNull Lazy<SharedPreferences> preferences)", "class_method_signature": "PlusPurchaseWallet.PlusPurchaseWallet(@NonNull Lazy<SharedPreferences> preferences)", "testcase": false, "constructor": true}, {"identifier": "hasActivePurchase", "parameters": "(@NonNull InAppPurchase inAppPurchase)", "modifiers": "@Override public synchronized", "return": "boolean", "signature": "boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "full_signature": "@Override public synchronized boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "class_method_signature": "PlusPurchaseWallet.hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "testcase": false, "constructor": false}], "file": "app/src/main/java/co/smartreceipts/android/purchases/wallet/PlusPurchaseWallet.java"}, "focal_method": {"identifier": "hasActivePurchase", "parameters": "(@NonNull InAppPurchase inAppPurchase)", "modifiers": "@Override public synchronized", "return": "boolean", "body": "@Override\n    public synchronized boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase) {\n        if (inAppPurchase == InAppPurchase.SmartReceiptsPlus) {\n            return true;\n        } else {\n            return super.hasActivePurchase(inAppPurchase);\n        }\n    }", "signature": "boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "full_signature": "@Override public synchronized boolean hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "class_method_signature": "PlusPurchaseWallet.hasActivePurchase(@NonNull InAppPurchase inAppPurchase)", "testcase": false, "constructor": false, "invocations": ["hasActivePurchase"]}, "repository": {"repo_id": 2684727, "url": "https://github.com/wbaumann/SmartReceiptsLibrary", "stars": 166, "created": "11/1/2011 12:32:39 AM +00:00", "updates": "2020-01-26T22:04:24+00:00", "fork": "False", "license": "licensed"}}