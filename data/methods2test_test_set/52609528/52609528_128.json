{"test_class": {"identifier": "KafkaProducerRepositoryTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private Vertx vertx;", "modifier": "private", "type": "Vertx", "declarator": "vertx", "var_name": "vertx"}, {"original_string": "private KafkaProducerRepository repository;", "modifier": "private", "type": "KafkaProducerRepository", "declarator": "repository", "var_name": "repository"}, {"original_string": "private final Map<String, String> configs = new HashMap<String, String>() {{\n        put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"bootstrap.servers\", \"localhost:9092\");\n    }};", "modifier": "private final", "type": "Map<String, String>", "declarator": "configs = new HashMap<String, String>() {{\n        put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"bootstrap.servers\", \"localhost:9092\");\n    }}", "var_name": "configs"}, {"original_string": "private final Map<String, String> configs_2 = new HashMap<String, String>() {{\n        put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"bootstrap.servers\", \"localhost:9093\");\n        put(\"acks\", \"1\");\n    }};", "modifier": "private final", "type": "Map<String, String>", "declarator": "configs_2 = new HashMap<String, String>() {{\n        put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\");\n        put(\"bootstrap.servers\", \"localhost:9093\");\n        put(\"acks\", \"1\");\n    }}", "var_name": "configs_2"}], "file": "gateleen-kafka/src/test/java/org/swisspush/gateleen/kafka/KafkaProducerRepositoryTest.java"}, "test_case": {"identifier": "findMatchingKafkaProducer", "parameters": "(TestContext context)", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void findMatchingKafkaProducer(TestContext context) {\n        Pattern pattern_1 = patternFrom(\"my.topic.*\");\n        Pattern pattern_2 = patternFrom(\".+\");\n        repository.addKafkaProducer(new KafkaConfiguration(pattern_1, configs));\n        repository.addKafkaProducer(new KafkaConfiguration(pattern_2, configs_2));\n\n        //\n        final Optional<Pair<KafkaProducer<String, String>, Pattern>> anyTopic = repository.findMatchingKafkaProducer(\"anyTopic\");\n        context.assertTrue(anyTopic.isPresent());\n        context.assertEquals(pattern_2.pattern(), anyTopic.get().getRight().pattern());\n\n        final Optional<Pair<KafkaProducer<String, String>, Pattern>> myTopicX = repository.findMatchingKafkaProducer(\"my.topic.x\");\n        context.assertTrue(myTopicX.isPresent());\n        context.assertEquals(pattern_1.pattern(), myTopicX.get().getRight().pattern());\n    }", "signature": "void findMatchingKafkaProducer(TestContext context)", "full_signature": "@Test public void findMatchingKafkaProducer(TestContext context)", "class_method_signature": "KafkaProducerRepositoryTest.findMatchingKafkaProducer(TestContext context)", "testcase": true, "constructor": false, "invocations": ["patternFrom", "patternFrom", "addKafkaProducer", "addKafkaProducer", "findMatchingKafkaProducer", "assertTrue", "isPresent", "assertEquals", "pattern", "pattern", "getRight", "get", "findMatchingKafkaProducer", "assertTrue", "isPresent", "assertEquals", "pattern", "pattern", "getRight", "get"]}, "focal_class": {"identifier": "KafkaProducerRepository", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final Logger log = LoggerFactory.getLogger(KafkaProducerRepository.class);", "modifier": "private final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(KafkaProducerRepository.class)", "var_name": "log"}, {"original_string": "private final Vertx vertx;", "modifier": "private final", "type": "Vertx", "declarator": "vertx", "var_name": "vertx"}, {"original_string": "private final Map<Pattern, KafkaProducer<String, String>> kafkaProducers;", "modifier": "private final", "type": "Map<Pattern, KafkaProducer<String, String>>", "declarator": "kafkaProducers", "var_name": "kafkaProducers"}], "methods": [{"identifier": "KafkaProducerRepository", "parameters": "(Vertx vertx)", "modifiers": "public", "return": "", "signature": " KafkaProducerRepository(Vertx vertx)", "full_signature": "public  KafkaProducerRepository(Vertx vertx)", "class_method_signature": "KafkaProducerRepository.KafkaProducerRepository(Vertx vertx)", "testcase": false, "constructor": true}, {"identifier": "addKafkaProducer", "parameters": "(KafkaConfiguration config)", "modifiers": "", "return": "void", "signature": "void addKafkaProducer(KafkaConfiguration config)", "full_signature": " void addKafkaProducer(KafkaConfiguration config)", "class_method_signature": "KafkaProducerRepository.addKafkaProducer(KafkaConfiguration config)", "testcase": false, "constructor": false}, {"identifier": "findMatchingKafkaProducer", "parameters": "(String topic)", "modifiers": "", "return": "Optional<Pair<KafkaProducer<String, String>, Pattern>>", "signature": "Optional<Pair<KafkaProducer<String, String>, Pattern>> findMatchingKafkaProducer(String topic)", "full_signature": " Optional<Pair<KafkaProducer<String, String>, Pattern>> findMatchingKafkaProducer(String topic)", "class_method_signature": "KafkaProducerRepository.findMatchingKafkaProducer(String topic)", "testcase": false, "constructor": false}, {"identifier": "closeAll", "parameters": "()", "modifiers": "", "return": "Future<Void>", "signature": "Future<Void> closeAll()", "full_signature": " Future<Void> closeAll()", "class_method_signature": "KafkaProducerRepository.closeAll()", "testcase": false, "constructor": false}], "file": "gateleen-kafka/src/main/java/org/swisspush/gateleen/kafka/KafkaProducerRepository.java"}, "focal_method": {"identifier": "findMatchingKafkaProducer", "parameters": "(String topic)", "modifiers": "", "return": "Optional<Pair<KafkaProducer<String, String>, Pattern>>", "body": "Optional<Pair<KafkaProducer<String, String>, Pattern>> findMatchingKafkaProducer(String topic){\n        for (Map.Entry<Pattern, KafkaProducer<String, String>> entry : kafkaProducers.entrySet()) {\n            Matcher matcher = entry.getKey().matcher(topic);\n            if(matcher.matches()){\n                log.info(\"Found matching KafkaProducer with pattern '{}' for topic '{}' found\", entry.getKey().pattern(), topic);\n                return Optional.of(Pair.of(entry.getValue(), entry.getKey()));\n            }\n        }\n        log.info(\"No matching KafkaProducer for topic '{}' found\", topic);\n        return Optional.empty();\n    }", "signature": "Optional<Pair<KafkaProducer<String, String>, Pattern>> findMatchingKafkaProducer(String topic)", "full_signature": " Optional<Pair<KafkaProducer<String, String>, Pattern>> findMatchingKafkaProducer(String topic)", "class_method_signature": "KafkaProducerRepository.findMatchingKafkaProducer(String topic)", "testcase": false, "constructor": false, "invocations": ["entrySet", "matcher", "getKey", "matches", "info", "pattern", "getKey", "of", "of", "getValue", "getKey", "info", "empty"]}, "repository": {"repo_id": 52609528, "url": "https://github.com/swisspush/gateleen", "language": "Java", "is_fork": false, "fork_count": 28, "stargazer_count": 63, "size": 2919, "license": "licensed"}}