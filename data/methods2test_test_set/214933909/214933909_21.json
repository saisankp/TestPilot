{"test_class": {"identifier": "HintsStrategyTest", "superclass": "", "interfaces": "", "fields": [], "file": "das-client/src/test/java/com/ppdai/das/strategy/HintsStrategyTest.java"}, "test_case": {"identifier": "testLocateTableShards", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testLocateTableShards() {\n        HintsStrategy test = new HintsStrategy();\n        Map<String, String> settings = new HashMap<>();\n        settings.put(HintsStrategy.SHARD_BY_TABLE, \"true\");\n        \n\n        Set<String> shardedTables = new HashSet<>();\n        shardedTables.add(\"t1\");\n        shardedTables.add(\"t2\");\n        shardedTables.add(\"T1\");\n        shardedTables.add(\"T2\");\n\n        test.initialize(settings);\n        assertTrue(test.isShardByTable());\n        assertEquals(0, test.locateTableShards(new TableShardingContext(\"appId\", \"logicDbName\", \"t1\", set(\"1\", \"2\", \"3\"), new Hints(), ConditionList.andList())).size());\n        assertEquals(set(\"1\"), test.locateTableShards(new TableShardingContext(\"appId\", \"logicDbName\", \"t1\", set(\"1\", \"2\", \"3\"), new Hints().inTableShard(1), ConditionList.andList())));\n        assertEquals(set(\"1\"), test.locateTableShards(new TableShardingContext(\"appId\", \"logicDbName\", \"t1\", set(\"1\", \"2\", \"3\"), new Hints().inTableShard(\"1\"), ConditionList.andList())));\n    }", "signature": "void testLocateTableShards()", "full_signature": "@Test public void testLocateTableShards()", "class_method_signature": "HintsStrategyTest.testLocateTableShards()", "testcase": true, "constructor": false, "invocations": ["put", "add", "add", "add", "add", "initialize", "assertTrue", "isShardByTable", "assertEquals", "size", "locateTableShards", "set", "andList", "assertEquals", "set", "locateTableShards", "set", "inTableShard", "andList", "assertEquals", "set", "locateTableShards", "set", "inTableShard", "andList"]}, "focal_class": {"identifier": "HintsStrategy", "superclass": "extends AbstractShardingStrategy", "interfaces": "", "fields": [{"original_string": "public static final String SHARD_BY_DB = \"shardByDb\";", "modifier": "public static final", "type": "String", "declarator": "SHARD_BY_DB = \"shardByDb\"", "var_name": "SHARD_BY_DB"}, {"original_string": "public static final String SHARD_BY_TABLE = \"shardByTable\";", "modifier": "public static final", "type": "String", "declarator": "SHARD_BY_TABLE = \"shardByTable\"", "var_name": "SHARD_BY_TABLE"}], "methods": [{"identifier": "initialize", "parameters": "(Map<String, String> settings)", "modifiers": "@Override public", "return": "void", "signature": "void initialize(Map<String, String> settings)", "full_signature": "@Override public void initialize(Map<String, String> settings)", "class_method_signature": "HintsStrategy.initialize(Map<String, String> settings)", "testcase": false, "constructor": false}, {"identifier": "locateDbShards", "parameters": "(ShardingContext ctx)", "modifiers": "@Override public", "return": "Set<String>", "signature": "Set<String> locateDbShards(ShardingContext ctx)", "full_signature": "@Override public Set<String> locateDbShards(ShardingContext ctx)", "class_method_signature": "HintsStrategy.locateDbShards(ShardingContext ctx)", "testcase": false, "constructor": false}, {"identifier": "locateTableShards", "parameters": "(TableShardingContext ctx)", "modifiers": "@Override public", "return": "Set<String>", "signature": "Set<String> locateTableShards(TableShardingContext ctx)", "full_signature": "@Override public Set<String> locateTableShards(TableShardingContext ctx)", "class_method_signature": "HintsStrategy.locateTableShards(TableShardingContext ctx)", "testcase": false, "constructor": false}], "file": "das-client/src/main/java/com/ppdai/das/strategy/HintsStrategy.java"}, "focal_method": {"identifier": "locateTableShards", "parameters": "(TableShardingContext ctx)", "modifiers": "@Override public", "return": "Set<String>", "body": "@Override\n    public Set<String> locateTableShards(TableShardingContext ctx) {\n        return toSet(ctx.getHints().getTableShard());\n    }", "signature": "Set<String> locateTableShards(TableShardingContext ctx)", "full_signature": "@Override public Set<String> locateTableShards(TableShardingContext ctx)", "class_method_signature": "HintsStrategy.locateTableShards(TableShardingContext ctx)", "testcase": false, "constructor": false, "invocations": ["toSet", "getTableShard", "getHints"]}, "repository": {"repo_id": 214933909, "url": "https://github.com/ppdaicorp/das", "stars": 55, "created": "10/14/2019 2:49:17 AM +00:00", "updates": "2020-01-20T09:24:23+00:00", "fork": "False", "license": "licensed"}}