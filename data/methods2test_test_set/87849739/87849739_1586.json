{"test_class": {"identifier": "GrantRevokeIndexTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static String subjectId;", "modifier": "private static", "type": "String", "declarator": "subjectId", "var_name": "subjectId"}, {"original_string": "private static String anotherSubjectId;", "modifier": "private static", "type": "String", "declarator": "anotherSubjectId", "var_name": "anotherSubjectId"}, {"original_string": "private static Set<String> permissions;", "modifier": "private static", "type": "Set<String>", "declarator": "permissions", "var_name": "permissions"}, {"original_string": "private PermissionSubjectsMap grantedMap = null;", "modifier": "private", "type": "PermissionSubjectsMap", "declarator": "grantedMap = null", "var_name": "grantedMap"}, {"original_string": "private PermissionSubjectsMap revokedMap = null;", "modifier": "private", "type": "PermissionSubjectsMap", "declarator": "revokedMap = null", "var_name": "revokedMap"}, {"original_string": "private GrantRevokeIndex underTest = null;", "modifier": "private", "type": "GrantRevokeIndex", "declarator": "underTest = null", "var_name": "underTest"}], "file": "model/enforcers/src/test/java/org/eclipse/ditto/model/enforcers/trie/GrantRevokeIndexTest.java"}, "test_case": {"identifier": "anotherSubjectIdHasNoReadPermissionBecauseRevokedWithSameWeight", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void anotherSubjectIdHasNoReadPermissionBecauseRevokedWithSameWeight() {\n        final boolean hasPermissions = underTest.hasPermissions(Collections.singleton(anotherSubjectId),\n                Collections.singleton(\"READ\"));\n\n        assertThat(hasPermissions).isFalse();\n    }", "signature": "void anotherSubjectIdHasNoReadPermissionBecauseRevokedWithSameWeight()", "full_signature": "@Test public void anotherSubjectIdHasNoReadPermissionBecauseRevokedWithSameWeight()", "class_method_signature": "GrantRevokeIndexTest.anotherSubjectIdHasNoReadPermissionBecauseRevokedWithSameWeight()", "testcase": true, "constructor": false, "invocations": ["hasPermissions", "singleton", "singleton", "isFalse", "assertThat"]}, "focal_class": {"identifier": "GrantRevokeIndex", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final PermissionSubjectsMap grantMap;", "modifier": "private final", "type": "PermissionSubjectsMap", "declarator": "grantMap", "var_name": "grantMap"}, {"original_string": "private final PermissionSubjectsMap revokeMap;", "modifier": "private final", "type": "PermissionSubjectsMap", "declarator": "revokeMap", "var_name": "revokeMap"}], "methods": [{"identifier": "GrantRevokeIndex", "parameters": "()", "modifiers": "", "return": "", "signature": " GrantRevokeIndex()", "full_signature": "  GrantRevokeIndex()", "class_method_signature": "GrantRevokeIndex.GrantRevokeIndex()", "testcase": false, "constructor": true}, {"identifier": "GrantRevokeIndex", "parameters": "(final PermissionSubjectsMap grantMap, final PermissionSubjectsMap revokeMap)", "modifiers": "", "return": "", "signature": " GrantRevokeIndex(final PermissionSubjectsMap grantMap, final PermissionSubjectsMap revokeMap)", "full_signature": "  GrantRevokeIndex(final PermissionSubjectsMap grantMap, final PermissionSubjectsMap revokeMap)", "class_method_signature": "GrantRevokeIndex.GrantRevokeIndex(final PermissionSubjectsMap grantMap, final PermissionSubjectsMap revokeMap)", "testcase": false, "constructor": true}, {"identifier": "getGranted", "parameters": "()", "modifiers": "", "return": "PermissionSubjectsMap", "signature": "PermissionSubjectsMap getGranted()", "full_signature": " PermissionSubjectsMap getGranted()", "class_method_signature": "GrantRevokeIndex.getGranted()", "testcase": false, "constructor": false}, {"identifier": "getRevoked", "parameters": "()", "modifiers": "", "return": "PermissionSubjectsMap", "signature": "PermissionSubjectsMap getRevoked()", "full_signature": " PermissionSubjectsMap getRevoked()", "class_method_signature": "GrantRevokeIndex.getRevoked()", "testcase": false, "constructor": false}, {"identifier": "copyWithDecrementedWeight", "parameters": "()", "modifiers": "", "return": "GrantRevokeIndex", "signature": "GrantRevokeIndex copyWithDecrementedWeight()", "full_signature": " GrantRevokeIndex copyWithDecrementedWeight()", "class_method_signature": "GrantRevokeIndex.copyWithDecrementedWeight()", "testcase": false, "constructor": false}, {"identifier": "overrideBy", "parameters": "(final GrantRevokeIndex update)", "modifiers": "", "return": "GrantRevokeIndex", "signature": "GrantRevokeIndex overrideBy(final GrantRevokeIndex update)", "full_signature": " GrantRevokeIndex overrideBy(final GrantRevokeIndex update)", "class_method_signature": "GrantRevokeIndex.overrideBy(final GrantRevokeIndex update)", "testcase": false, "constructor": false}, {"identifier": "hasPermissions", "parameters": "(final Collection<String> subjectIds, final Collection<String> permissions)", "modifiers": "", "return": "boolean", "signature": "boolean hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions)", "full_signature": " boolean hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions)", "class_method_signature": "GrantRevokeIndex.hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "getEffectedSubjectIds", "parameters": "(final Set<String> permissions)", "modifiers": "@Deprecated", "return": "EffectedSubjectIds", "signature": "EffectedSubjectIds getEffectedSubjectIds(final Set<String> permissions)", "full_signature": "@Deprecated EffectedSubjectIds getEffectedSubjectIds(final Set<String> permissions)", "class_method_signature": "GrantRevokeIndex.getEffectedSubjectIds(final Set<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "getEffectedSubjects", "parameters": "(final Set<String> permissions)", "modifiers": "", "return": "EffectedSubjects", "signature": "EffectedSubjects getEffectedSubjects(final Set<String> permissions)", "full_signature": " EffectedSubjects getEffectedSubjects(final Set<String> permissions)", "class_method_signature": "GrantRevokeIndex.getEffectedSubjects(final Set<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "getGrantedSubjectIds", "parameters": "(final Set<String> permissions)", "modifiers": "@Deprecated", "return": "Set<String>", "signature": "Set<String> getGrantedSubjectIds(final Set<String> permissions)", "full_signature": "@Deprecated Set<String> getGrantedSubjectIds(final Set<String> permissions)", "class_method_signature": "GrantRevokeIndex.getGrantedSubjectIds(final Set<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "getGrantedSubjects", "parameters": "(final Set<String> permissions)", "modifiers": "", "return": "Set<AuthorizationSubject>", "signature": "Set<AuthorizationSubject> getGrantedSubjects(final Set<String> permissions)", "full_signature": " Set<AuthorizationSubject> getGrantedSubjects(final Set<String> permissions)", "class_method_signature": "GrantRevokeIndex.getGrantedSubjects(final Set<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "getAuthorizationSubjects", "parameters": "(final Collection<String> authSubjectIds)", "modifiers": "private static", "return": "Set<AuthorizationSubject>", "signature": "Set<AuthorizationSubject> getAuthorizationSubjects(final Collection<String> authSubjectIds)", "full_signature": "private static Set<AuthorizationSubject> getAuthorizationSubjects(final Collection<String> authSubjectIds)", "class_method_signature": "GrantRevokeIndex.getAuthorizationSubjects(final Collection<String> authSubjectIds)", "testcase": false, "constructor": false}, {"identifier": "getRevokedSubjectIds", "parameters": "(final Set<String> permissions)", "modifiers": "@Deprecated", "return": "Set<String>", "signature": "Set<String> getRevokedSubjectIds(final Set<String> permissions)", "full_signature": "@Deprecated Set<String> getRevokedSubjectIds(final Set<String> permissions)", "class_method_signature": "GrantRevokeIndex.getRevokedSubjectIds(final Set<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "getRevokedSubjects", "parameters": "(final Set<String> permissions)", "modifiers": "", "return": "Set<AuthorizationSubject>", "signature": "Set<AuthorizationSubject> getRevokedSubjects(final Set<String> permissions)", "full_signature": " Set<AuthorizationSubject> getRevokedSubjects(final Set<String> permissions)", "class_method_signature": "GrantRevokeIndex.getRevokedSubjects(final Set<String> permissions)", "testcase": false, "constructor": false}, {"identifier": "equals", "parameters": "(final Object o)", "modifiers": "@Override public", "return": "boolean", "signature": "boolean equals(final Object o)", "full_signature": "@Override public boolean equals(final Object o)", "class_method_signature": "GrantRevokeIndex.equals(final Object o)", "testcase": false, "constructor": false}, {"identifier": "hashCode", "parameters": "()", "modifiers": "@Override public", "return": "int", "signature": "int hashCode()", "full_signature": "@Override public int hashCode()", "class_method_signature": "GrantRevokeIndex.hashCode()", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "GrantRevokeIndex.toString()", "testcase": false, "constructor": false}], "file": "model/enforcers/src/main/java/org/eclipse/ditto/model/enforcers/trie/GrantRevokeIndex.java"}, "focal_method": {"identifier": "hasPermissions", "parameters": "(final Collection<String> subjectIds, final Collection<String> permissions)", "modifiers": "", "return": "boolean", "body": "boolean hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions) {\n        final Optional<Integer> grantWeight = grantMap.getMaxNonemptyWeightForAllPermissions(subjectIds, permissions);\n        final Optional<Integer> revokeWeight = revokeMap.getMaxWeightForAllPermissions(subjectIds, permissions);\n\n        return grantWeight.isPresent() && (!revokeWeight.isPresent() || revokeWeight.get() < grantWeight.get());\n    }", "signature": "boolean hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions)", "full_signature": " boolean hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions)", "class_method_signature": "GrantRevokeIndex.hasPermissions(final Collection<String> subjectIds, final Collection<String> permissions)", "testcase": false, "constructor": false, "invocations": ["getMaxNonemptyWeightForAllPermissions", "getMaxWeightForAllPermissions", "isPresent", "isPresent", "get", "get"]}, "repository": {"repo_id": 87849739, "url": "https://github.com/eclipse/ditto", "stars": 139, "created": "4/10/2017 7:29:57 PM +00:00", "updates": "2020-01-27T14:02:39+00:00", "fork": "False", "license": "licensed"}}