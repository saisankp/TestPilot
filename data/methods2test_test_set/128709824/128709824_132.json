{"test_class": {"identifier": "RpcInternalContextTest", "superclass": "", "interfaces": "", "fields": [], "file": "core/api/src/test/java/com/alipay/sofa/rpc/context/RpcInternalContextTest.java"}, "test_case": {"identifier": "testClear", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testClear() {\n        RpcInternalContext context = RpcInternalContext.getContext();\n        context.setRemoteAddress(\"127.0.0.1\", 1234);\n        context.setLocalAddress(\"127.0.0.1\", 2345);\n        context.setFuture(new ResponseFuture<String>() {\n            @Override\n            public boolean cancel(boolean mayInterruptIfRunning) {\n                return false;\n            }\n\n            @Override\n            public boolean isCancelled() {\n                return false;\n            }\n\n            @Override\n            public boolean isDone() {\n                return false;\n            }\n\n            @Override\n            public String get() throws InterruptedException, ExecutionException {\n                return null;\n            }\n\n            @Override\n            public String get(long timeout, TimeUnit unit) throws InterruptedException, ExecutionException,\n                TimeoutException {\n                return null;\n            }\n\n            @Override\n            public ResponseFuture addListeners(List<SofaResponseCallback> sofaResponseCallbacks) {\n                return null;\n            }\n\n            @Override\n            public ResponseFuture addListener(SofaResponseCallback sofaResponseCallback) {\n                return null;\n            }\n        });\n\n        context.setProviderInfo(ProviderHelper.toProviderInfo(\"127.0.0.1:80\"));\n        context.setAttachment(\"_xxxx\", \"yyyy\");\n\n        context.clear();\n        Assert.assertNull(context.getRemoteAddress());\n        Assert.assertNull(context.getLocalAddress());\n        Assert.assertNull(context.getFuture());\n        Assert.assertFalse(context.isProviderSide());\n        Assert.assertFalse(context.isConsumerSide());\n        Assert.assertNull(context.getProviderInfo());\n        Assert.assertTrue(context.getAttachments().isEmpty());\n        Assert.assertNotNull(context.getStopWatch());\n        Assert.assertTrue(context.getStopWatch().read() == 0);\n\n        Assert.assertNotNull(context.toString());\n    }", "signature": "void testClear()", "full_signature": "@Test public void testClear()", "class_method_signature": "RpcInternalContextTest.testClear()", "testcase": true, "constructor": false, "invocations": ["getContext", "setRemoteAddress", "setLocalAddress", "setFuture", "setProviderInfo", "toProviderInfo", "setAttachment", "clear", "assertNull", "getRemoteAddress", "assertNull", "getLocalAddress", "assertNull", "getFuture", "assertFalse", "isProviderSide", "assertFalse", "isConsumerSide", "assertNull", "getProviderInfo", "assertTrue", "isEmpty", "getAttachments", "assertNotNull", "getStopWatch", "assertTrue", "read", "getStopWatch", "assertNotNull", "toString"]}, "focal_class": {"identifier": "RpcInternalContext", "superclass": "", "interfaces": "implements Cloneable", "fields": [{"original_string": "private static final boolean                                ATTACHMENT_ENABLE = RpcConfigs\n                                                                                      .getBooleanValue(RpcOptions.CONTEXT_ATTACHMENT_ENABLE);", "modifier": "private static final", "type": "boolean", "declarator": "ATTACHMENT_ENABLE = RpcConfigs\n                                                                                      .getBooleanValue(RpcOptions.CONTEXT_ATTACHMENT_ENABLE)", "var_name": "ATTACHMENT_ENABLE"}, {"original_string": "private static final ThreadLocal<RpcInternalContext>        LOCAL             = new ThreadLocal<RpcInternalContext>();", "modifier": "private static final", "type": "ThreadLocal<RpcInternalContext>", "declarator": "LOCAL             = new ThreadLocal<RpcInternalContext>()", "var_name": "LOCAL"}, {"original_string": "private static final ThreadLocal<Deque<RpcInternalContext>> DEQUE_LOCAL       = new ThreadLocal<Deque<RpcInternalContext>>();", "modifier": "private static final", "type": "ThreadLocal<Deque<RpcInternalContext>>", "declarator": "DEQUE_LOCAL       = new ThreadLocal<Deque<RpcInternalContext>>()", "var_name": "DEQUE_LOCAL"}, {"original_string": "private ResponseFuture<?>   future;", "modifier": "private", "type": "ResponseFuture<?>", "declarator": "future", "var_name": "future"}, {"original_string": "private InetSocketAddress   localAddress;", "modifier": "private", "type": "InetSocketAddress", "declarator": "localAddress", "var_name": "localAddress"}, {"original_string": "private InetSocketAddress   remoteAddress;", "modifier": "private", "type": "InetSocketAddress", "declarator": "remoteAddress", "var_name": "remoteAddress"}, {"original_string": "private Map<String, Object> attachments = new ConcurrentHashMap<String, Object>();", "modifier": "private", "type": "Map<String, Object>", "declarator": "attachments = new ConcurrentHashMap<String, Object>()", "var_name": "attachments"}, {"original_string": "private StopWatch           stopWatch   = new StopWatch();", "modifier": "private", "type": "StopWatch", "declarator": "stopWatch   = new StopWatch()", "var_name": "stopWatch"}, {"original_string": "private Boolean             providerSide;", "modifier": "private", "type": "Boolean", "declarator": "providerSide", "var_name": "providerSide"}, {"original_string": "private ProviderInfo        providerInfo;", "modifier": "private", "type": "ProviderInfo", "declarator": "providerInfo", "var_name": "providerInfo"}], "methods": [{"identifier": "setContext", "parameters": "(RpcInternalContext context)", "modifiers": "public static", "return": "void", "signature": "void setContext(RpcInternalContext context)", "full_signature": "public static void setContext(RpcInternalContext context)", "class_method_signature": "RpcInternalContext.setContext(RpcInternalContext context)", "testcase": false, "constructor": false}, {"identifier": "getContext", "parameters": "()", "modifiers": "public static", "return": "RpcInternalContext", "signature": "RpcInternalContext getContext()", "full_signature": "public static RpcInternalContext getContext()", "class_method_signature": "RpcInternalContext.getContext()", "testcase": false, "constructor": false}, {"identifier": "peekContext", "parameters": "()", "modifiers": "public static", "return": "RpcInternalContext", "signature": "RpcInternalContext peekContext()", "full_signature": "public static RpcInternalContext peekContext()", "class_method_signature": "RpcInternalContext.peekContext()", "testcase": false, "constructor": false}, {"identifier": "removeContext", "parameters": "()", "modifiers": "public static", "return": "void", "signature": "void removeContext()", "full_signature": "public static void removeContext()", "class_method_signature": "RpcInternalContext.removeContext()", "testcase": false, "constructor": false}, {"identifier": "pushContext", "parameters": "()", "modifiers": "public static", "return": "void", "signature": "void pushContext()", "full_signature": "public static void pushContext()", "class_method_signature": "RpcInternalContext.pushContext()", "testcase": false, "constructor": false}, {"identifier": "popContext", "parameters": "()", "modifiers": "public static", "return": "void", "signature": "void popContext()", "full_signature": "public static void popContext()", "class_method_signature": "RpcInternalContext.popContext()", "testcase": false, "constructor": false}, {"identifier": "removeAllContext", "parameters": "()", "modifiers": "public static", "return": "void", "signature": "void removeAllContext()", "full_signature": "public static void removeAllContext()", "class_method_signature": "RpcInternalContext.removeAllContext()", "testcase": false, "constructor": false}, {"identifier": "isAttachmentEnable", "parameters": "()", "modifiers": "public static", "return": "boolean", "signature": "boolean isAttachmentEnable()", "full_signature": "public static boolean isAttachmentEnable()", "class_method_signature": "RpcInternalContext.isAttachmentEnable()", "testcase": false, "constructor": false}, {"identifier": "RpcInternalContext", "parameters": "()", "modifiers": "protected", "return": "", "signature": " RpcInternalContext()", "full_signature": "protected  RpcInternalContext()", "class_method_signature": "RpcInternalContext.RpcInternalContext()", "testcase": false, "constructor": true}, {"identifier": "isProviderSide", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isProviderSide()", "full_signature": "public boolean isProviderSide()", "class_method_signature": "RpcInternalContext.isProviderSide()", "testcase": false, "constructor": false}, {"identifier": "setProviderSide", "parameters": "(Boolean isProviderSide)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setProviderSide(Boolean isProviderSide)", "full_signature": "public RpcInternalContext setProviderSide(Boolean isProviderSide)", "class_method_signature": "RpcInternalContext.setProviderSide(Boolean isProviderSide)", "testcase": false, "constructor": false}, {"identifier": "isConsumerSide", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isConsumerSide()", "full_signature": "public boolean isConsumerSide()", "class_method_signature": "RpcInternalContext.isConsumerSide()", "testcase": false, "constructor": false}, {"identifier": "getFuture", "parameters": "()", "modifiers": "@SuppressWarnings(\"unchecked\") public", "return": "ResponseFuture<T>", "signature": "ResponseFuture<T> getFuture()", "full_signature": "@SuppressWarnings(\"unchecked\") public ResponseFuture<T> getFuture()", "class_method_signature": "RpcInternalContext.getFuture()", "testcase": false, "constructor": false}, {"identifier": "setFuture", "parameters": "(ResponseFuture<?> future)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setFuture(ResponseFuture<?> future)", "full_signature": "public RpcInternalContext setFuture(ResponseFuture<?> future)", "class_method_signature": "RpcInternalContext.setFuture(ResponseFuture<?> future)", "testcase": false, "constructor": false}, {"identifier": "setLocalAddress", "parameters": "(InetSocketAddress address)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setLocalAddress(InetSocketAddress address)", "full_signature": "public RpcInternalContext setLocalAddress(InetSocketAddress address)", "class_method_signature": "RpcInternalContext.setLocalAddress(InetSocketAddress address)", "testcase": false, "constructor": false}, {"identifier": "setLocalAddress", "parameters": "(String host, int port)", "modifiers": "@Deprecated public", "return": "RpcInternalContext", "signature": "RpcInternalContext setLocalAddress(String host, int port)", "full_signature": "@Deprecated public RpcInternalContext setLocalAddress(String host, int port)", "class_method_signature": "RpcInternalContext.setLocalAddress(String host, int port)", "testcase": false, "constructor": false}, {"identifier": "getLocalAddress", "parameters": "()", "modifiers": "public", "return": "InetSocketAddress", "signature": "InetSocketAddress getLocalAddress()", "full_signature": "public InetSocketAddress getLocalAddress()", "class_method_signature": "RpcInternalContext.getLocalAddress()", "testcase": false, "constructor": false}, {"identifier": "setRemoteAddress", "parameters": "(InetSocketAddress address)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setRemoteAddress(InetSocketAddress address)", "full_signature": "public RpcInternalContext setRemoteAddress(InetSocketAddress address)", "class_method_signature": "RpcInternalContext.setRemoteAddress(InetSocketAddress address)", "testcase": false, "constructor": false}, {"identifier": "setRemoteAddress", "parameters": "(String host, int port)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setRemoteAddress(String host, int port)", "full_signature": "public RpcInternalContext setRemoteAddress(String host, int port)", "class_method_signature": "RpcInternalContext.setRemoteAddress(String host, int port)", "testcase": false, "constructor": false}, {"identifier": "getRemoteAddress", "parameters": "()", "modifiers": "public", "return": "InetSocketAddress", "signature": "InetSocketAddress getRemoteAddress()", "full_signature": "public InetSocketAddress getRemoteAddress()", "class_method_signature": "RpcInternalContext.getRemoteAddress()", "testcase": false, "constructor": false}, {"identifier": "getRemoteHostName", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getRemoteHostName()", "full_signature": "public String getRemoteHostName()", "class_method_signature": "RpcInternalContext.getRemoteHostName()", "testcase": false, "constructor": false}, {"identifier": "getAttachment", "parameters": "(String key)", "modifiers": "public", "return": "Object", "signature": "Object getAttachment(String key)", "full_signature": "public Object getAttachment(String key)", "class_method_signature": "RpcInternalContext.getAttachment(String key)", "testcase": false, "constructor": false}, {"identifier": "setAttachment", "parameters": "(String key, Object value)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setAttachment(String key, Object value)", "full_signature": "public RpcInternalContext setAttachment(String key, Object value)", "class_method_signature": "RpcInternalContext.setAttachment(String key, Object value)", "testcase": false, "constructor": false}, {"identifier": "removeAttachment", "parameters": "(String key)", "modifiers": "public", "return": "Object", "signature": "Object removeAttachment(String key)", "full_signature": "public Object removeAttachment(String key)", "class_method_signature": "RpcInternalContext.removeAttachment(String key)", "testcase": false, "constructor": false}, {"identifier": "getAttachments", "parameters": "()", "modifiers": "public", "return": "Map<String, Object>", "signature": "Map<String, Object> getAttachments()", "full_signature": "public Map<String, Object> getAttachments()", "class_method_signature": "RpcInternalContext.getAttachments()", "testcase": false, "constructor": false}, {"identifier": "setAttachments", "parameters": "(Map<String, Object> attachments)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setAttachments(Map<String, Object> attachments)", "full_signature": "public RpcInternalContext setAttachments(Map<String, Object> attachments)", "class_method_signature": "RpcInternalContext.setAttachments(Map<String, Object> attachments)", "testcase": false, "constructor": false}, {"identifier": "clearAttachments", "parameters": "()", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext clearAttachments()", "full_signature": "public RpcInternalContext clearAttachments()", "class_method_signature": "RpcInternalContext.clearAttachments()", "testcase": false, "constructor": false}, {"identifier": "getStopWatch", "parameters": "()", "modifiers": "public", "return": "StopWatch", "signature": "StopWatch getStopWatch()", "full_signature": "public StopWatch getStopWatch()", "class_method_signature": "RpcInternalContext.getStopWatch()", "testcase": false, "constructor": false}, {"identifier": "clear", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void clear()", "full_signature": "public void clear()", "class_method_signature": "RpcInternalContext.clear()", "testcase": false, "constructor": false}, {"identifier": "setProviderInfo", "parameters": "(ProviderInfo providerInfo)", "modifiers": "public", "return": "RpcInternalContext", "signature": "RpcInternalContext setProviderInfo(ProviderInfo providerInfo)", "full_signature": "public RpcInternalContext setProviderInfo(ProviderInfo providerInfo)", "class_method_signature": "RpcInternalContext.setProviderInfo(ProviderInfo providerInfo)", "testcase": false, "constructor": false}, {"identifier": "getProviderInfo", "parameters": "()", "modifiers": "public", "return": "ProviderInfo", "signature": "ProviderInfo getProviderInfo()", "full_signature": "public ProviderInfo getProviderInfo()", "class_method_signature": "RpcInternalContext.getProviderInfo()", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "RpcInternalContext.toString()", "testcase": false, "constructor": false}, {"identifier": "clone", "parameters": "()", "modifiers": "@Override public", "return": "RpcInternalContext", "signature": "RpcInternalContext clone()", "full_signature": "@Override public RpcInternalContext clone()", "class_method_signature": "RpcInternalContext.clone()", "testcase": false, "constructor": false}, {"identifier": "isValidInternalParamKey", "parameters": "(String key)", "modifiers": "public static", "return": "boolean", "signature": "boolean isValidInternalParamKey(String key)", "full_signature": "public static boolean isValidInternalParamKey(String key)", "class_method_signature": "RpcInternalContext.isValidInternalParamKey(String key)", "testcase": false, "constructor": false}, {"identifier": "isHiddenParamKey", "parameters": "(String key)", "modifiers": "static", "return": "boolean", "signature": "boolean isHiddenParamKey(String key)", "full_signature": "static boolean isHiddenParamKey(String key)", "class_method_signature": "RpcInternalContext.isHiddenParamKey(String key)", "testcase": false, "constructor": false}], "file": "core/api/src/main/java/com/alipay/sofa/rpc/context/RpcInternalContext.java"}, "focal_method": {"identifier": "clear", "parameters": "()", "modifiers": "public", "return": "void", "body": "public void clear() {\n        this.setRemoteAddress(null).setLocalAddress(null).setFuture(null).setProviderSide(null)\n            .setProviderInfo(null);\n        this.attachments = new ConcurrentHashMap<String, Object>();\n        this.stopWatch.reset();\n    }", "signature": "void clear()", "full_signature": "public void clear()", "class_method_signature": "RpcInternalContext.clear()", "testcase": false, "constructor": false, "invocations": ["setProviderInfo", "setProviderSide", "setFuture", "setLocalAddress", "setRemoteAddress", "reset"]}, "repository": {"repo_id": 128709824, "url": "https://github.com/sofastack/sofa-rpc", "stars": 3001, "created": "4/9/2018 3:32:04 AM +00:00", "updates": "2020-01-22T02:08:51+00:00", "fork": "False", "license": "licensed"}}