{"test_class": {"identifier": "ZMSFileChangeLogStoreTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final String FSTORE_PATH = \"/tmp/zts_file_store_unit_test\";", "modifier": "private final", "type": "String", "declarator": "FSTORE_PATH = \"/tmp/zts_file_store_unit_test\"", "var_name": "FSTORE_PATH"}], "file": "libs/java/server_common/src/test/java/com/yahoo/athenz/common/server/store/impl/ZMSFileChangeLogStoreTest.java"}, "test_case": {"identifier": "testGetLocalDomainListSingle", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetLocalDomainListSingle() throws IOException {\n\n        File rootDir = new File(FSTORE_PATH);\n        //noinspection ResultOfMethodCallIgnored\n        rootDir.mkdirs();\n        Struct lastModStruct = new Struct();\n        lastModStruct.put(\"lastModTime\", 1001);\n        File file = new File(FSTORE_PATH, \".lastModTime\");\n        Path path = Paths.get(file.toURI());\n        Files.write(path, JSON.bytes(lastModStruct));\n\n        ZMSFileChangeLogStore fstore = new ZMSFileChangeLogStore(FSTORE_PATH, null, null);\n        ZMSFileChangeLogStoreCommon cstore = new ZMSFileChangeLogStoreCommon(FSTORE_PATH);\n\n        Struct data = new Struct();\n        data.put(\"key\", \"val1\");\n        cstore.put(\"test1\", JSON.bytes(data));\n        \n        List<String> ls = fstore.getLocalDomainList();\n        assertEquals(ls.size(), 1);\n        assertTrue(ls.contains(\"test1\"));\n    }", "signature": "void testGetLocalDomainListSingle()", "full_signature": "@Test public void testGetLocalDomainListSingle()", "class_method_signature": "ZMSFileChangeLogStoreTest.testGetLocalDomainListSingle()", "testcase": true, "constructor": false, "invocations": ["mkdirs", "put", "get", "toURI", "write", "bytes", "put", "put", "bytes", "getLocalDomainList", "assertEquals", "size", "assertTrue", "contains"]}, "focal_class": {"identifier": "ZMSFileChangeLogStore", "superclass": "", "interfaces": "implements ChangeLogStore", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(ZMSFileChangeLogStore.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(ZMSFileChangeLogStore.class)", "var_name": "LOGGER"}, {"original_string": "private final PrivateKey privateKey;", "modifier": "private final", "type": "PrivateKey", "declarator": "privateKey", "var_name": "privateKey"}, {"original_string": "private final String privateKeyId;", "modifier": "private final", "type": "String", "declarator": "privateKeyId", "var_name": "privateKeyId"}, {"original_string": "private final Authority authority;", "modifier": "private final", "type": "Authority", "declarator": "authority", "var_name": "authority"}, {"original_string": "private final String zmsUrl;", "modifier": "private final", "type": "String", "declarator": "zmsUrl", "var_name": "zmsUrl"}, {"original_string": "private ZMSFileChangeLogStoreCommon changeLogStoreCommon;", "modifier": "private", "type": "ZMSFileChangeLogStoreCommon", "declarator": "changeLogStoreCommon", "var_name": "changeLogStoreCommon"}], "methods": [{"identifier": "ZMSFileChangeLogStore", "parameters": "(String rootDirectory, PrivateKey privateKey, String privateKeyId)", "modifiers": "public", "return": "", "signature": " ZMSFileChangeLogStore(String rootDirectory, PrivateKey privateKey, String privateKeyId)", "full_signature": "public  ZMSFileChangeLogStore(String rootDirectory, PrivateKey privateKey, String privateKeyId)", "class_method_signature": "ZMSFileChangeLogStore.ZMSFileChangeLogStore(String rootDirectory, PrivateKey privateKey, String privateKeyId)", "testcase": false, "constructor": true}, {"identifier": "supportsFullRefresh", "parameters": "()", "modifiers": "@Override public", "return": "boolean", "signature": "boolean supportsFullRefresh()", "full_signature": "@Override public boolean supportsFullRefresh()", "class_method_signature": "ZMSFileChangeLogStore.supportsFullRefresh()", "testcase": false, "constructor": false}, {"identifier": "getLocalSignedDomain", "parameters": "(String domainName)", "modifiers": "@Override public", "return": "SignedDomain", "signature": "SignedDomain getLocalSignedDomain(String domainName)", "full_signature": "@Override public SignedDomain getLocalSignedDomain(String domainName)", "class_method_signature": "ZMSFileChangeLogStore.getLocalSignedDomain(String domainName)", "testcase": false, "constructor": false}, {"identifier": "getServerSignedDomain", "parameters": "(String domainName)", "modifiers": "@Override public", "return": "SignedDomain", "signature": "SignedDomain getServerSignedDomain(String domainName)", "full_signature": "@Override public SignedDomain getServerSignedDomain(String domainName)", "class_method_signature": "ZMSFileChangeLogStore.getServerSignedDomain(String domainName)", "testcase": false, "constructor": false}, {"identifier": "removeLocalDomain", "parameters": "(String domainName)", "modifiers": "@Override public", "return": "void", "signature": "void removeLocalDomain(String domainName)", "full_signature": "@Override public void removeLocalDomain(String domainName)", "class_method_signature": "ZMSFileChangeLogStore.removeLocalDomain(String domainName)", "testcase": false, "constructor": false}, {"identifier": "saveLocalDomain", "parameters": "(String domainName, SignedDomain signedDomain)", "modifiers": "@Override public", "return": "void", "signature": "void saveLocalDomain(String domainName, SignedDomain signedDomain)", "full_signature": "@Override public void saveLocalDomain(String domainName, SignedDomain signedDomain)", "class_method_signature": "ZMSFileChangeLogStore.saveLocalDomain(String domainName, SignedDomain signedDomain)", "testcase": false, "constructor": false}, {"identifier": "getLocalDomainList", "parameters": "()", "modifiers": "@Override public", "return": "List<String>", "signature": "List<String> getLocalDomainList()", "full_signature": "@Override public List<String> getLocalDomainList()", "class_method_signature": "ZMSFileChangeLogStore.getLocalDomainList()", "testcase": false, "constructor": false}, {"identifier": "getZMSClient", "parameters": "()", "modifiers": "public", "return": "ZMSClient", "signature": "ZMSClient getZMSClient()", "full_signature": "public ZMSClient getZMSClient()", "class_method_signature": "ZMSFileChangeLogStore.getZMSClient()", "testcase": false, "constructor": false}, {"identifier": "getServerDomainList", "parameters": "()", "modifiers": "@Override public", "return": "Set<String>", "signature": "Set<String> getServerDomainList()", "full_signature": "@Override public Set<String> getServerDomainList()", "class_method_signature": "ZMSFileChangeLogStore.getServerDomainList()", "testcase": false, "constructor": false}, {"identifier": "getServerDomainModifiedList", "parameters": "()", "modifiers": "@Override public", "return": "SignedDomains", "signature": "SignedDomains getServerDomainModifiedList()", "full_signature": "@Override public SignedDomains getServerDomainModifiedList()", "class_method_signature": "ZMSFileChangeLogStore.getServerDomainModifiedList()", "testcase": false, "constructor": false}, {"identifier": "setLastModificationTimestamp", "parameters": "(String newLastModTime)", "modifiers": "@Override public", "return": "void", "signature": "void setLastModificationTimestamp(String newLastModTime)", "full_signature": "@Override public void setLastModificationTimestamp(String newLastModTime)", "class_method_signature": "ZMSFileChangeLogStore.setLastModificationTimestamp(String newLastModTime)", "testcase": false, "constructor": false}, {"identifier": "getUpdatedSignedDomains", "parameters": "(StringBuilder lastModTimeBuffer)", "modifiers": "@Override public", "return": "SignedDomains", "signature": "SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "full_signature": "@Override public SignedDomains getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "class_method_signature": "ZMSFileChangeLogStore.getUpdatedSignedDomains(StringBuilder lastModTimeBuffer)", "testcase": false, "constructor": false}, {"identifier": "setChangeLogStoreCommon", "parameters": "(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "modifiers": "public", "return": "void", "signature": "void setChangeLogStoreCommon(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "full_signature": "public void setChangeLogStoreCommon(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "class_method_signature": "ZMSFileChangeLogStore.setChangeLogStoreCommon(ZMSFileChangeLogStoreCommon changeLogStoreCommon)", "testcase": false, "constructor": false}], "file": "libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/ZMSFileChangeLogStore.java"}, "focal_method": {"identifier": "getLocalDomainList", "parameters": "()", "modifiers": "@Override public", "return": "List<String>", "body": "@Override\n    public List<String> getLocalDomainList() {\n        return changeLogStoreCommon.getLocalDomainList();\n    }", "signature": "List<String> getLocalDomainList()", "full_signature": "@Override public List<String> getLocalDomainList()", "class_method_signature": "ZMSFileChangeLogStore.getLocalDomainList()", "testcase": false, "constructor": false, "invocations": ["getLocalDomainList"]}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}