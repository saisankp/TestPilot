{"test_class": {"identifier": "AccountServiceRedisImplTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final static Logger LOGGER = LoggerFactory.getLogger(AccountServiceRedisImplTest.class);", "modifier": "private final static", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(AccountServiceRedisImplTest.class)", "var_name": "LOGGER"}, {"original_string": "@Autowired\n    private AccountService accountService ;", "modifier": "@Autowired\n    private", "type": "AccountService", "declarator": "accountService", "var_name": "accountService"}], "file": "cim-forward-route/src/test/java/com/crossoverjie/cim/route/service/impl/AccountServiceRedisImplTest.java"}, "test_case": {"identifier": "loadRouteRelated", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void loadRouteRelated() throws Exception {\n        for (int i = 0; i < 100; i++) {\n\n            Map<Long, CIMServerResVO> longCIMServerResVOMap = accountService.loadRouteRelated();\n            LOGGER.info(\"longCIMServerResVOMap={},cun={}\" , JSON.toJSONString(longCIMServerResVOMap),i);\n        }\n        TimeUnit.SECONDS.sleep(10);\n    }", "signature": "void loadRouteRelated()", "full_signature": "@Test public void loadRouteRelated()", "class_method_signature": "AccountServiceRedisImplTest.loadRouteRelated()", "testcase": true, "constructor": false, "invocations": ["loadRouteRelated", "info", "toJSONString", "sleep"]}, "focal_class": {"identifier": "AccountServiceRedisImpl", "superclass": "", "interfaces": "implements AccountService", "fields": [{"original_string": "private final static Logger LOGGER = LoggerFactory.getLogger(AccountServiceRedisImpl.class);", "modifier": "private final static", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(AccountServiceRedisImpl.class)", "var_name": "LOGGER"}, {"original_string": "@Autowired\n    private RedisTemplate<String, String> redisTemplate;", "modifier": "@Autowired\n    private", "type": "RedisTemplate<String, String>", "declarator": "redisTemplate", "var_name": "redisTemplate"}, {"original_string": "@Autowired\n    private UserInfoCacheService userInfoCacheService;", "modifier": "@Autowired\n    private", "type": "UserInfoCacheService", "declarator": "userInfoCacheService", "var_name": "userInfoCacheService"}, {"original_string": "@Autowired\n    private OkHttpClient okHttpClient;", "modifier": "@Autowired\n    private", "type": "OkHttpClient", "declarator": "okHttpClient", "var_name": "okHttpClient"}], "methods": [{"identifier": "register", "parameters": "(RegisterInfoResVO info)", "modifiers": "@Override public", "return": "RegisterInfoResVO", "signature": "RegisterInfoResVO register(RegisterInfoResVO info)", "full_signature": "@Override public RegisterInfoResVO register(RegisterInfoResVO info)", "class_method_signature": "AccountServiceRedisImpl.register(RegisterInfoResVO info)", "testcase": false, "constructor": false}, {"identifier": "login", "parameters": "(LoginReqVO loginReqVO)", "modifiers": "@Override public", "return": "StatusEnum", "signature": "StatusEnum login(LoginReqVO loginReqVO)", "full_signature": "@Override public StatusEnum login(LoginReqVO loginReqVO)", "class_method_signature": "AccountServiceRedisImpl.login(LoginReqVO loginReqVO)", "testcase": false, "constructor": false}, {"identifier": "saveRouteInfo", "parameters": "(LoginReqVO loginReqVO, String msg)", "modifiers": "@Override public", "return": "void", "signature": "void saveRouteInfo(LoginReqVO loginReqVO, String msg)", "full_signature": "@Override public void saveRouteInfo(LoginReqVO loginReqVO, String msg)", "class_method_signature": "AccountServiceRedisImpl.saveRouteInfo(LoginReqVO loginReqVO, String msg)", "testcase": false, "constructor": false}, {"identifier": "loadRouteRelated", "parameters": "()", "modifiers": "@Override public", "return": "Map<Long, CIMServerResVO>", "signature": "Map<Long, CIMServerResVO> loadRouteRelated()", "full_signature": "@Override public Map<Long, CIMServerResVO> loadRouteRelated()", "class_method_signature": "AccountServiceRedisImpl.loadRouteRelated()", "testcase": false, "constructor": false}, {"identifier": "loadRouteRelatedByUserId", "parameters": "(Long userId)", "modifiers": "@Override public", "return": "CIMServerResVO", "signature": "CIMServerResVO loadRouteRelatedByUserId(Long userId)", "full_signature": "@Override public CIMServerResVO loadRouteRelatedByUserId(Long userId)", "class_method_signature": "AccountServiceRedisImpl.loadRouteRelatedByUserId(Long userId)", "testcase": false, "constructor": false}, {"identifier": "parseServerInfo", "parameters": "(Map<Long, CIMServerResVO> routes, String key)", "modifiers": "private", "return": "void", "signature": "void parseServerInfo(Map<Long, CIMServerResVO> routes, String key)", "full_signature": "private void parseServerInfo(Map<Long, CIMServerResVO> routes, String key)", "class_method_signature": "AccountServiceRedisImpl.parseServerInfo(Map<Long, CIMServerResVO> routes, String key)", "testcase": false, "constructor": false}, {"identifier": "pushMsg", "parameters": "(CIMServerResVO cimServerResVO, long sendUserId, ChatReqVO groupReqVO)", "modifiers": "@Override public", "return": "void", "signature": "void pushMsg(CIMServerResVO cimServerResVO, long sendUserId, ChatReqVO groupReqVO)", "full_signature": "@Override public void pushMsg(CIMServerResVO cimServerResVO, long sendUserId, ChatReqVO groupReqVO)", "class_method_signature": "AccountServiceRedisImpl.pushMsg(CIMServerResVO cimServerResVO, long sendUserId, ChatReqVO groupReqVO)", "testcase": false, "constructor": false}, {"identifier": "offLine", "parameters": "(Long userId)", "modifiers": "@Override public", "return": "void", "signature": "void offLine(Long userId)", "full_signature": "@Override public void offLine(Long userId)", "class_method_signature": "AccountServiceRedisImpl.offLine(Long userId)", "testcase": false, "constructor": false}], "file": "cim-forward-route/src/main/java/com/crossoverjie/cim/route/service/impl/AccountServiceRedisImpl.java"}, "focal_method": {"identifier": "loadRouteRelated", "parameters": "()", "modifiers": "@Override public", "return": "Map<Long, CIMServerResVO>", "body": "@Override\n    public Map<Long, CIMServerResVO> loadRouteRelated() {\n\n        Map<Long, CIMServerResVO> routes = new HashMap<>(64);\n\n\n        RedisConnection connection = redisTemplate.getConnectionFactory().getConnection();\n        ScanOptions options = ScanOptions.scanOptions()\n                .match(ROUTE_PREFIX + \"*\")\n                .build();\n        Cursor<byte[]> scan = connection.scan(options);\n\n        while (scan.hasNext()) {\n            byte[] next = scan.next();\n            String key = new String(next, StandardCharsets.UTF_8);\n            LOGGER.info(\"key={}\", key);\n            parseServerInfo(routes, key);\n\n        }\n        try {\n            scan.close();\n        } catch (IOException e) {\n            LOGGER.error(\"IOException\", e);\n        }\n\n        return routes;\n    }", "signature": "Map<Long, CIMServerResVO> loadRouteRelated()", "full_signature": "@Override public Map<Long, CIMServerResVO> loadRouteRelated()", "class_method_signature": "AccountServiceRedisImpl.loadRouteRelated()", "testcase": false, "constructor": false, "invocations": ["getConnection", "getConnectionFactory", "build", "match", "scanOptions", "scan", "hasNext", "next", "info", "parseServerInfo", "close", "error"]}, "repository": {"repo_id": 134164777, "url": "https://github.com/crossoverJie/cim", "stars": 4518, "created": "5/20/2018 3:55:56 PM +00:00", "updates": "2020-01-27T13:30:30+00:00", "fork": "False", "license": "licensed"}}