{"test_class": {"identifier": "TestMRApps", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static File testWorkDir = null;", "modifier": "private static", "type": "File", "declarator": "testWorkDir = null", "var_name": "testWorkDir"}, {"original_string": "private static final Log LOG =\n      LogFactory.getLog(TestMRApps.class);", "modifier": "private static final", "type": "Log", "declarator": "LOG =\n      LogFactory.getLog(TestMRApps.class)", "var_name": "LOG"}, {"original_string": "private static final String[] SYS_CLASSES = new String[] {\n      \"/java/fake/Klass\",\n      \"/javax/management/fake/Klass\",\n      \"/org/apache/commons/logging/fake/Klass\",\n      \"/org/apache/log4j/fake/Klass\",\n      \"/org/apache/hadoop/fake/Klass\"\n  };", "modifier": "private static final", "type": "String[]", "declarator": "SYS_CLASSES = new String[] {\n      \"/java/fake/Klass\",\n      \"/javax/management/fake/Klass\",\n      \"/org/apache/commons/logging/fake/Klass\",\n      \"/org/apache/log4j/fake/Klass\",\n      \"/org/apache/hadoop/fake/Klass\"\n  }", "var_name": "SYS_CLASSES"}, {"original_string": "private static final String[] DEFAULT_XMLS = new String[] {\n        \"core-default.xml\",\n      \"mapred-default.xml\",\n        \"hdfs-default.xml\",\n        \"yarn-default.xml\"\n  };", "modifier": "private static final", "type": "String[]", "declarator": "DEFAULT_XMLS = new String[] {\n        \"core-default.xml\",\n      \"mapred-default.xml\",\n        \"hdfs-default.xml\",\n        \"yarn-default.xml\"\n  }", "var_name": "DEFAULT_XMLS"}], "file": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/test/java/org/apache/hadoop/mapreduce/v2/util/TestMRApps.java"}, "test_case": {"identifier": "testSetClasspathWithNoUserPrecendence", "parameters": "()", "modifiers": "@Test (timeout = 120000) public", "return": "void", "body": "@Test (timeout = 120000)\n  public void testSetClasspathWithNoUserPrecendence() {\n    Configuration conf = new Configuration();\n    conf.setBoolean(MRConfig.MAPREDUCE_APP_SUBMISSION_CROSS_PLATFORM, true);\n    conf.setBoolean(MRJobConfig.MAPREDUCE_JOB_USER_CLASSPATH_FIRST, false);\n    Map<String, String> env = new HashMap<String, String>();\n    try {\n      MRApps.setClasspath(env, conf);\n    } catch (Exception e) {\n      fail(\"Got exception while setting classpath\");\n    }\n    String env_str = env.get(ApplicationConstants.Environment.CLASSPATH.name());\n    String expectedClasspath = StringUtils.join(ApplicationConstants.CLASS_PATH_SEPARATOR,\n      Arrays.asList(\"job.jar/job.jar\", \"job.jar/classes/\", \"job.jar/lib/*\",\n        ApplicationConstants.Environment.PWD.$$() + \"/*\"));\n    assertTrue(\"MAPREDUCE_JOB_USER_CLASSPATH_FIRST false, and job.jar is not in\"\n      + \" the classpath!\", env_str.contains(expectedClasspath));\n    assertFalse(\"MAPREDUCE_JOB_USER_CLASSPATH_FIRST false, but taking effect!\",\n      env_str.startsWith(expectedClasspath));\n  }", "signature": "void testSetClasspathWithNoUserPrecendence()", "full_signature": "@Test (timeout = 120000) public void testSetClasspathWithNoUserPrecendence()", "class_method_signature": "TestMRApps.testSetClasspathWithNoUserPrecendence()", "testcase": true, "constructor": false, "invocations": ["setBoolean", "setBoolean", "setClasspath", "fail", "get", "name", "join", "asList", "assertTrue", "contains", "assertFalse", "startsWith"]}, "focal_class": {"identifier": "MRApps", "superclass": "extends Apps", "interfaces": "", "fields": [{"original_string": "public static final Log LOG = LogFactory.getLog(MRApps.class);", "modifier": "public static final", "type": "Log", "declarator": "LOG = LogFactory.getLog(MRApps.class)", "var_name": "LOG"}, {"original_string": "private static final String STAGING_CONSTANT = \".staging\";", "modifier": "private static final", "type": "String", "declarator": "STAGING_CONSTANT = \".staging\"", "var_name": "STAGING_CONSTANT"}], "methods": [{"identifier": "toString", "parameters": "(JobId jid)", "modifiers": "public static", "return": "String", "signature": "String toString(JobId jid)", "full_signature": "public static String toString(JobId jid)", "class_method_signature": "MRApps.toString(JobId jid)", "testcase": false, "constructor": false}, {"identifier": "toJobID", "parameters": "(String jid)", "modifiers": "public static", "return": "JobId", "signature": "JobId toJobID(String jid)", "full_signature": "public static JobId toJobID(String jid)", "class_method_signature": "MRApps.toJobID(String jid)", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "(TaskId tid)", "modifiers": "public static", "return": "String", "signature": "String toString(TaskId tid)", "full_signature": "public static String toString(TaskId tid)", "class_method_signature": "MRApps.toString(TaskId tid)", "testcase": false, "constructor": false}, {"identifier": "toTaskID", "parameters": "(String tid)", "modifiers": "public static", "return": "TaskId", "signature": "TaskId toTaskID(String tid)", "full_signature": "public static TaskId toTaskID(String tid)", "class_method_signature": "MRApps.toTaskID(String tid)", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "(TaskAttemptId taid)", "modifiers": "public static", "return": "String", "signature": "String toString(TaskAttemptId taid)", "full_signature": "public static String toString(TaskAttemptId taid)", "class_method_signature": "MRApps.toString(TaskAttemptId taid)", "testcase": false, "constructor": false}, {"identifier": "toTaskAttemptID", "parameters": "(String taid)", "modifiers": "public static", "return": "TaskAttemptId", "signature": "TaskAttemptId toTaskAttemptID(String taid)", "full_signature": "public static TaskAttemptId toTaskAttemptID(String taid)", "class_method_signature": "MRApps.toTaskAttemptID(String taid)", "testcase": false, "constructor": false}, {"identifier": "taskSymbol", "parameters": "(TaskType type)", "modifiers": "public static", "return": "String", "signature": "String taskSymbol(TaskType type)", "full_signature": "public static String taskSymbol(TaskType type)", "class_method_signature": "MRApps.taskSymbol(TaskType type)", "testcase": false, "constructor": false}, {"identifier": "taskType", "parameters": "(String symbol)", "modifiers": "public static", "return": "TaskType", "signature": "TaskType taskType(String symbol)", "full_signature": "public static TaskType taskType(String symbol)", "class_method_signature": "MRApps.taskType(String symbol)", "testcase": false, "constructor": false}, {"identifier": "taskAttemptState", "parameters": "(String attemptStateStr)", "modifiers": "public static", "return": "TaskAttemptStateUI", "signature": "TaskAttemptStateUI taskAttemptState(String attemptStateStr)", "full_signature": "public static TaskAttemptStateUI taskAttemptState(String attemptStateStr)", "class_method_signature": "MRApps.taskAttemptState(String attemptStateStr)", "testcase": false, "constructor": false}, {"identifier": "taskState", "parameters": "(String taskStateStr)", "modifiers": "public static", "return": "TaskStateUI", "signature": "TaskStateUI taskState(String taskStateStr)", "full_signature": "public static TaskStateUI taskState(String taskStateStr)", "class_method_signature": "MRApps.taskState(String taskStateStr)", "testcase": false, "constructor": false}, {"identifier": "getMRFrameworkName", "parameters": "(Configuration conf)", "modifiers": "private static", "return": "String", "signature": "String getMRFrameworkName(Configuration conf)", "full_signature": "private static String getMRFrameworkName(Configuration conf)", "class_method_signature": "MRApps.getMRFrameworkName(Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "setMRFrameworkClasspath", "parameters": "(\n      Map<String, String> environment, Configuration conf)", "modifiers": "private static", "return": "void", "signature": "void setMRFrameworkClasspath(\n      Map<String, String> environment, Configuration conf)", "full_signature": "private static void setMRFrameworkClasspath(\n      Map<String, String> environment, Configuration conf)", "class_method_signature": "MRApps.setMRFrameworkClasspath(\n      Map<String, String> environment, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "setClasspath", "parameters": "(Map<String, String> environment,\n      Configuration conf)", "modifiers": "@SuppressWarnings(\"deprecation\") public static", "return": "void", "signature": "void setClasspath(Map<String, String> environment,\n      Configuration conf)", "full_signature": "@SuppressWarnings(\"deprecation\") public static void setClasspath(Map<String, String> environment,\n      Configuration conf)", "class_method_signature": "MRApps.setClasspath(Map<String, String> environment,\n      Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "addClasspathToEnv", "parameters": "(Map<String, String> environment,\n      String classpathEnvVar, Configuration conf)", "modifiers": "@SuppressWarnings(\"deprecation\") public static", "return": "void", "signature": "void addClasspathToEnv(Map<String, String> environment,\n      String classpathEnvVar, Configuration conf)", "full_signature": "@SuppressWarnings(\"deprecation\") public static void addClasspathToEnv(Map<String, String> environment,\n      String classpathEnvVar, Configuration conf)", "class_method_signature": "MRApps.addClasspathToEnv(Map<String, String> environment,\n      String classpathEnvVar, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "addToClasspathIfNotJar", "parameters": "(Path[] paths,\n      URI[] withLinks, Configuration conf,\n      Map<String, String> environment,\n      String classpathEnvVar)", "modifiers": "private static", "return": "void", "signature": "void addToClasspathIfNotJar(Path[] paths,\n      URI[] withLinks, Configuration conf,\n      Map<String, String> environment,\n      String classpathEnvVar)", "full_signature": "private static void addToClasspathIfNotJar(Path[] paths,\n      URI[] withLinks, Configuration conf,\n      Map<String, String> environment,\n      String classpathEnvVar)", "class_method_signature": "MRApps.addToClasspathIfNotJar(Path[] paths,\n      URI[] withLinks, Configuration conf,\n      Map<String, String> environment,\n      String classpathEnvVar)", "testcase": false, "constructor": false}, {"identifier": "setJobClassLoader", "parameters": "(Configuration conf)", "modifiers": "public static", "return": "void", "signature": "void setJobClassLoader(Configuration conf)", "full_signature": "public static void setJobClassLoader(Configuration conf)", "class_method_signature": "MRApps.setJobClassLoader(Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "createJobClassLoader", "parameters": "(Configuration conf)", "modifiers": "public static", "return": "ClassLoader", "signature": "ClassLoader createJobClassLoader(Configuration conf)", "full_signature": "public static ClassLoader createJobClassLoader(Configuration conf)", "class_method_signature": "MRApps.createJobClassLoader(Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "setClassLoader", "parameters": "(ClassLoader classLoader,\n      Configuration conf)", "modifiers": "public static", "return": "void", "signature": "void setClassLoader(ClassLoader classLoader,\n      Configuration conf)", "full_signature": "public static void setClassLoader(ClassLoader classLoader,\n      Configuration conf)", "class_method_signature": "MRApps.setClassLoader(ClassLoader classLoader,\n      Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "getSystemClasses", "parameters": "(Configuration conf)", "modifiers": "@VisibleForTesting static", "return": "String[]", "signature": "String[] getSystemClasses(Configuration conf)", "full_signature": "@VisibleForTesting static String[] getSystemClasses(Configuration conf)", "class_method_signature": "MRApps.getSystemClasses(Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "createJobClassLoader", "parameters": "(final String appClasspath,\n      final String[] systemClasses)", "modifiers": "private static", "return": "ClassLoader", "signature": "ClassLoader createJobClassLoader(final String appClasspath,\n      final String[] systemClasses)", "full_signature": "private static ClassLoader createJobClassLoader(final String appClasspath,\n      final String[] systemClasses)", "class_method_signature": "MRApps.createJobClassLoader(final String appClasspath,\n      final String[] systemClasses)", "testcase": false, "constructor": false}, {"identifier": "getStagingAreaDir", "parameters": "(Configuration conf, String user)", "modifiers": "public static", "return": "Path", "signature": "Path getStagingAreaDir(Configuration conf, String user)", "full_signature": "public static Path getStagingAreaDir(Configuration conf, String user)", "class_method_signature": "MRApps.getStagingAreaDir(Configuration conf, String user)", "testcase": false, "constructor": false}, {"identifier": "getJobFile", "parameters": "(Configuration conf, String user, \n      org.apache.hadoop.mapreduce.JobID jobId)", "modifiers": "public static", "return": "String", "signature": "String getJobFile(Configuration conf, String user, \n      org.apache.hadoop.mapreduce.JobID jobId)", "full_signature": "public static String getJobFile(Configuration conf, String user, \n      org.apache.hadoop.mapreduce.JobID jobId)", "class_method_signature": "MRApps.getJobFile(Configuration conf, String user, \n      org.apache.hadoop.mapreduce.JobID jobId)", "testcase": false, "constructor": false}, {"identifier": "getEndJobCommitSuccessFile", "parameters": "(Configuration conf, String user,\n      JobId jobId)", "modifiers": "public static", "return": "Path", "signature": "Path getEndJobCommitSuccessFile(Configuration conf, String user,\n      JobId jobId)", "full_signature": "public static Path getEndJobCommitSuccessFile(Configuration conf, String user,\n      JobId jobId)", "class_method_signature": "MRApps.getEndJobCommitSuccessFile(Configuration conf, String user,\n      JobId jobId)", "testcase": false, "constructor": false}, {"identifier": "getEndJobCommitFailureFile", "parameters": "(Configuration conf, String user,\n      JobId jobId)", "modifiers": "public static", "return": "Path", "signature": "Path getEndJobCommitFailureFile(Configuration conf, String user,\n      JobId jobId)", "full_signature": "public static Path getEndJobCommitFailureFile(Configuration conf, String user,\n      JobId jobId)", "class_method_signature": "MRApps.getEndJobCommitFailureFile(Configuration conf, String user,\n      JobId jobId)", "testcase": false, "constructor": false}, {"identifier": "getStartJobCommitFile", "parameters": "(Configuration conf, String user,\n      JobId jobId)", "modifiers": "public static", "return": "Path", "signature": "Path getStartJobCommitFile(Configuration conf, String user,\n      JobId jobId)", "full_signature": "public static Path getStartJobCommitFile(Configuration conf, String user,\n      JobId jobId)", "class_method_signature": "MRApps.getStartJobCommitFile(Configuration conf, String user,\n      JobId jobId)", "testcase": false, "constructor": false}, {"identifier": "setupDistributedCache", "parameters": "( \n      Configuration conf, \n      Map<String, LocalResource> localResources)", "modifiers": "@SuppressWarnings(\"deprecation\") public static", "return": "void", "signature": "void setupDistributedCache( \n      Configuration conf, \n      Map<String, LocalResource> localResources)", "full_signature": "@SuppressWarnings(\"deprecation\") public static void setupDistributedCache( \n      Configuration conf, \n      Map<String, LocalResource> localResources)", "class_method_signature": "MRApps.setupDistributedCache( \n      Configuration conf, \n      Map<String, LocalResource> localResources)", "testcase": false, "constructor": false}, {"identifier": "setupDistributedCacheLocal", "parameters": "(Configuration conf)", "modifiers": "@SuppressWarnings(\"deprecation\") public static", "return": "void", "signature": "void setupDistributedCacheLocal(Configuration conf)", "full_signature": "@SuppressWarnings(\"deprecation\") public static void setupDistributedCacheLocal(Configuration conf)", "class_method_signature": "MRApps.setupDistributedCacheLocal(Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "getResourceDescription", "parameters": "(LocalResourceType type)", "modifiers": "private static", "return": "String", "signature": "String getResourceDescription(LocalResourceType type)", "full_signature": "private static String getResourceDescription(LocalResourceType type)", "class_method_signature": "MRApps.getResourceDescription(LocalResourceType type)", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "(org.apache.hadoop.yarn.api.records.URL url)", "modifiers": "private static", "return": "String", "signature": "String toString(org.apache.hadoop.yarn.api.records.URL url)", "full_signature": "private static String toString(org.apache.hadoop.yarn.api.records.URL url)", "class_method_signature": "MRApps.toString(org.apache.hadoop.yarn.api.records.URL url)", "testcase": false, "constructor": false}, {"identifier": "parseDistributedCacheArtifacts", "parameters": "(\n      Configuration conf,\n      Map<String, LocalResource> localResources,\n      LocalResourceType type,\n      URI[] uris, long[] timestamps, long[] sizes, boolean visibilities[])", "modifiers": "@SuppressWarnings(\"deprecation\") private static", "return": "void", "signature": "void parseDistributedCacheArtifacts(\n      Configuration conf,\n      Map<String, LocalResource> localResources,\n      LocalResourceType type,\n      URI[] uris, long[] timestamps, long[] sizes, boolean visibilities[])", "full_signature": "@SuppressWarnings(\"deprecation\") private static void parseDistributedCacheArtifacts(\n      Configuration conf,\n      Map<String, LocalResource> localResources,\n      LocalResourceType type,\n      URI[] uris, long[] timestamps, long[] sizes, boolean visibilities[])", "class_method_signature": "MRApps.parseDistributedCacheArtifacts(\n      Configuration conf,\n      Map<String, LocalResource> localResources,\n      LocalResourceType type,\n      URI[] uris, long[] timestamps, long[] sizes, boolean visibilities[])", "testcase": false, "constructor": false}, {"identifier": "getFileSizes", "parameters": "(Configuration conf, String key)", "modifiers": "private static", "return": "long[]", "signature": "long[] getFileSizes(Configuration conf, String key)", "full_signature": "private static long[] getFileSizes(Configuration conf, String key)", "class_method_signature": "MRApps.getFileSizes(Configuration conf, String key)", "testcase": false, "constructor": false}, {"identifier": "getChildLogLevel", "parameters": "(Configuration conf, boolean isMap)", "modifiers": "public static", "return": "String", "signature": "String getChildLogLevel(Configuration conf, boolean isMap)", "full_signature": "public static String getChildLogLevel(Configuration conf, boolean isMap)", "class_method_signature": "MRApps.getChildLogLevel(Configuration conf, boolean isMap)", "testcase": false, "constructor": false}, {"identifier": "addLog4jSystemProperties", "parameters": "(Task task,\n      List<String> vargs, Configuration conf)", "modifiers": "public static", "return": "void", "signature": "void addLog4jSystemProperties(Task task,\n      List<String> vargs, Configuration conf)", "full_signature": "public static void addLog4jSystemProperties(Task task,\n      List<String> vargs, Configuration conf)", "class_method_signature": "MRApps.addLog4jSystemProperties(Task task,\n      List<String> vargs, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "setEnvFromInputString", "parameters": "(Map<String, String> env,\n      String envString, Configuration conf)", "modifiers": "public static", "return": "void", "signature": "void setEnvFromInputString(Map<String, String> env,\n      String envString, Configuration conf)", "full_signature": "public static void setEnvFromInputString(Map<String, String> env,\n      String envString, Configuration conf)", "class_method_signature": "MRApps.setEnvFromInputString(Map<String, String> env,\n      String envString, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "addToEnvironment", "parameters": "(Map<String, String> environment,\n      String variable, String value, Configuration conf)", "modifiers": "@Public @Unstable public static", "return": "void", "signature": "void addToEnvironment(Map<String, String> environment,\n      String variable, String value, Configuration conf)", "full_signature": "@Public @Unstable public static void addToEnvironment(Map<String, String> environment,\n      String variable, String value, Configuration conf)", "class_method_signature": "MRApps.addToEnvironment(Map<String, String> environment,\n      String variable, String value, Configuration conf)", "testcase": false, "constructor": false}, {"identifier": "crossPlatformifyMREnv", "parameters": "(Configuration conf, Environment env)", "modifiers": "public static", "return": "String", "signature": "String crossPlatformifyMREnv(Configuration conf, Environment env)", "full_signature": "public static String crossPlatformifyMREnv(Configuration conf, Environment env)", "class_method_signature": "MRApps.crossPlatformifyMREnv(Configuration conf, Environment env)", "testcase": false, "constructor": false}], "file": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/src/main/java/org/apache/hadoop/mapreduce/v2/util/MRApps.java"}, "focal_method": {"identifier": "setClasspath", "parameters": "(Map<String, String> environment,\n      Configuration conf)", "modifiers": "@SuppressWarnings(\"deprecation\") public static", "return": "void", "body": "@SuppressWarnings(\"deprecation\")\n  public static void setClasspath(Map<String, String> environment,\n      Configuration conf) throws IOException {\n    boolean userClassesTakesPrecedence = \n      conf.getBoolean(MRJobConfig.MAPREDUCE_JOB_USER_CLASSPATH_FIRST, false);\n\n    String classpathEnvVar =\n      conf.getBoolean(MRJobConfig.MAPREDUCE_JOB_CLASSLOADER, false)\n        ? Environment.APP_CLASSPATH.name() : Environment.CLASSPATH.name();\n\n    String hadoopClasspathEnvVar = Environment.HADOOP_CLASSPATH.name();\n\n    MRApps.addToEnvironment(environment,\n      classpathEnvVar, crossPlatformifyMREnv(conf, Environment.PWD), conf);\n\n    MRApps.addToEnvironment(environment,\n        hadoopClasspathEnvVar, crossPlatformifyMREnv(conf, Environment.PWD),\n        conf);\n\n    if (!userClassesTakesPrecedence) {\n      MRApps.setMRFrameworkClasspath(environment, conf);\n    }\n\n    addClasspathToEnv(environment, classpathEnvVar, conf);\n    addClasspathToEnv(environment, hadoopClasspathEnvVar, conf);\n\n    if (userClassesTakesPrecedence) {\n      MRApps.setMRFrameworkClasspath(environment, conf);\n    }\n  }", "signature": "void setClasspath(Map<String, String> environment,\n      Configuration conf)", "full_signature": "@SuppressWarnings(\"deprecation\") public static void setClasspath(Map<String, String> environment,\n      Configuration conf)", "class_method_signature": "MRApps.setClasspath(Map<String, String> environment,\n      Configuration conf)", "testcase": false, "constructor": false, "invocations": ["getBoolean", "getBoolean", "name", "name", "name", "addToEnvironment", "crossPlatformifyMREnv", "addToEnvironment", "crossPlatformifyMREnv", "setMRFrameworkClasspath", "addClasspathToEnv", "addClasspathToEnv", "setMRFrameworkClasspath"]}, "repository": {"repo_id": 195808004, "url": "https://github.com/mouzwang/hadoop-2.7.2", "language": "Java", "is_fork": false, "fork_count": 0, "stargazer_count": 5, "size": 24927, "license": "licensed"}}