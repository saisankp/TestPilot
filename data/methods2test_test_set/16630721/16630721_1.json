{"test_class": {"identifier": "SampleDaoTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Mock\n  private DatabaseMock db;", "modifier": "@Mock\n  private", "type": "DatabaseMock", "declarator": "db", "var_name": "db"}, {"original_string": "private Date now = new Date();", "modifier": "private", "type": "Date", "declarator": "now = new Date()", "var_name": "now"}, {"original_string": "private SampleDao sampleDao;", "modifier": "private", "type": "SampleDao", "declarator": "sampleDao", "var_name": "sampleDao"}], "file": "demo/src/test/java/SampleDaoTest.java"}, "test_case": {"identifier": "testFind", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testFind() throws Exception {\n    // Configure the mock because our class under test expects values to be returned from the db\n    when(db.query(anyString(), anyString())).thenReturn(new RowStub()\n        .withColumnNames(\"sample_name\", \"update_sequence\", \"update_time\")\n        .addRow(\"Foo\", 3, now));\n\n    // The test scenario\n    Sample sample = sampleDao.findSampleById(15L, false);\n\n    // Verify object in memory is updated properly\n    assertEquals(new Long(15L), sample.getSampleId());\n    assertEquals(\"Foo\", sample.getName());\n    assertEquals(new Integer(3), sample.getUpdateSequence());\n    assertEquals(now, sample.getUpdateTime());\n\n    // Verify database queries against golden copies\n    verify(db).query(anyString(), eq(\"select sample_name, update_sequence, update_time from sample where sample_id=15\"));\n    verifyNoMoreInteractions(db);\n  }", "signature": "void testFind()", "full_signature": "@Test public void testFind()", "class_method_signature": "SampleDaoTest.testFind()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "query", "anyString", "anyString", "addRow", "withColumnNames", "findSampleById", "assertEquals", "getSampleId", "assertEquals", "getName", "assertEquals", "getUpdateSequence", "assertEquals", "getUpdateTime", "query", "verify", "anyString", "eq", "verifyNoMoreInteractions"]}, "focal_class": {"identifier": "SampleDao", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final Supplier<Database> dbp;", "modifier": "private final", "type": "Supplier<Database>", "declarator": "dbp", "var_name": "dbp"}], "methods": [{"identifier": "SampleDao", "parameters": "(Supplier<Database> dbp)", "modifiers": "public", "return": "", "signature": " SampleDao(Supplier<Database> dbp)", "full_signature": "public  SampleDao(Supplier<Database> dbp)", "class_method_signature": "SampleDao.SampleDao(Supplier<Database> dbp)", "testcase": false, "constructor": true}, {"identifier": "createSample", "parameters": "(final Sample sample, Long userIdMakingChange)", "modifiers": "public", "return": "void", "signature": "void createSample(final Sample sample, Long userIdMakingChange)", "full_signature": "public void createSample(final Sample sample, Long userIdMakingChange)", "class_method_signature": "SampleDao.createSample(final Sample sample, Long userIdMakingChange)", "testcase": false, "constructor": false}, {"identifier": "findSampleById", "parameters": "(final Long sampleId, boolean lockRow)", "modifiers": "public", "return": "Sample", "signature": "Sample findSampleById(final Long sampleId, boolean lockRow)", "full_signature": "public Sample findSampleById(final Long sampleId, boolean lockRow)", "class_method_signature": "SampleDao.findSampleById(final Long sampleId, boolean lockRow)", "testcase": false, "constructor": false}, {"identifier": "updateSample", "parameters": "(Sample sample, Long userIdMakingChange)", "modifiers": "public", "return": "void", "signature": "void updateSample(Sample sample, Long userIdMakingChange)", "full_signature": "public void updateSample(Sample sample, Long userIdMakingChange)", "class_method_signature": "SampleDao.updateSample(Sample sample, Long userIdMakingChange)", "testcase": false, "constructor": false}, {"identifier": "deleteSample", "parameters": "(Sample sample, Long userIdMakingChange)", "modifiers": "public", "return": "void", "signature": "void deleteSample(Sample sample, Long userIdMakingChange)", "full_signature": "public void deleteSample(Sample sample, Long userIdMakingChange)", "class_method_signature": "SampleDao.deleteSample(Sample sample, Long userIdMakingChange)", "testcase": false, "constructor": false}], "file": "demo/src/main/java/SampleDao.java"}, "focal_method": {"identifier": "findSampleById", "parameters": "(final Long sampleId, boolean lockRow)", "modifiers": "public", "return": "Sample", "body": "public Sample findSampleById(final Long sampleId, boolean lockRow) {\n    return dbp.get().toSelect(\"select sample_name, update_sequence, update_time from sample where sample_id=?\"\n        + (lockRow ? \" for update\" : \"\"))\n        .argLong(sampleId).queryOneOrNull(r -> {\n          Sample result = new Sample();\n          result.setSampleId(sampleId);\n          result.setName(r.getStringOrNull());\n          result.setUpdateSequence(r.getIntegerOrNull());\n          result.setUpdateTime(r.getDateOrNull());\n          return result;\n        });\n  }", "signature": "Sample findSampleById(final Long sampleId, boolean lockRow)", "full_signature": "public Sample findSampleById(final Long sampleId, boolean lockRow)", "class_method_signature": "SampleDao.findSampleById(final Long sampleId, boolean lockRow)", "testcase": false, "constructor": false, "invocations": ["queryOneOrNull", "argLong", "toSelect", "get", "setSampleId", "setName", "getStringOrNull", "setUpdateSequence", "getIntegerOrNull", "setUpdateTime", "getDateOrNull"]}, "repository": {"repo_id": 16630721, "url": "https://github.com/susom/database", "stars": 32, "created": "2/7/2014 11:25:13 PM +00:00", "updates": "2019-12-26T21:46:30+00:00", "fork": "False", "license": "licensed"}}