{"test_class": {"identifier": "UserUpdaterTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Mock\n    private HierarchyTreeNodeRepository hierarchyTreeNodeRepoMock;", "modifier": "@Mock\n    private", "type": "HierarchyTreeNodeRepository", "declarator": "hierarchyTreeNodeRepoMock", "var_name": "hierarchyTreeNodeRepoMock"}, {"original_string": "@Mock\n    private LdapAdapter ldapAdapterMock;", "modifier": "@Mock\n    private", "type": "LdapAdapter", "declarator": "ldapAdapterMock", "var_name": "ldapAdapterMock"}, {"original_string": "@Mock\n    private RepositoryUserService repoUserServiceMock;", "modifier": "@Mock\n    private", "type": "RepositoryUserService", "declarator": "repoUserServiceMock", "var_name": "repoUserServiceMock"}, {"original_string": "@Mock\n    private UserDataRepository userDataRepoMock;", "modifier": "@Mock\n    private", "type": "UserDataRepository", "declarator": "userDataRepoMock", "var_name": "userDataRepoMock"}, {"original_string": "@Mock\n    private Normalizer<UserData> normalizerMock;", "modifier": "@Mock\n    private", "type": "Normalizer<UserData>", "declarator": "normalizerMock", "var_name": "normalizerMock"}, {"original_string": "@Captor\n    private ArgumentCaptor<Collection<UserData>> userDataCaptor;", "modifier": "@Captor\n    private", "type": "ArgumentCaptor<Collection<UserData>>", "declarator": "userDataCaptor", "var_name": "userDataCaptor"}, {"original_string": "private UserUpdater userUpdater;", "modifier": "private", "type": "UserUpdater", "declarator": "userUpdater", "var_name": "userUpdater"}], "file": "backend/project-board/src/test/java/de/adesso/projectboard/ad/updater/UserUpdaterTest.java"}, "test_case": {"identifier": "buildHierarchyNodesReturnsExpectedNodes", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void buildHierarchyNodesReturnsExpectedNodes() {\n        // given\n        var firstRootUserId = \"first-root-user\";\n        var secondRootUserId = \"second-root-user\";\n        var firstRootChildUserId = \"first-root-child-user\";\n        var secondRootChildUserId = \"second-root-child-user\";\n\n        var firstRootUser = new User(firstRootUserId);\n        var secondRootUser = new User(secondRootUserId);\n        var firstRootChildUser = new User(firstRootChildUserId);\n        var secondRootChildUser = new User(secondRootChildUserId);\n\n        var firstRootDn = \"first-root-dn\";\n        var secondRootDn = \"second-root-dn\";\n        var firstRootChildDn = \"first-root-child-dn\";\n        var secondRootChildDn = \"second-root-child-dn\";\n\n        var firstRootNode = new LdapUserNode()\n                .setId(firstRootUserId)\n                .setDn(firstRootDn)\n                .setManagerDn(firstRootDn)\n                .setDirectReportsDn(List.of(firstRootChildDn));\n        var firstRootChildNode = new LdapUserNode()\n                .setId(firstRootChildUserId)\n                .setDn(firstRootChildDn)\n                .setManagerDn(firstRootDn);\n\n        var secondRootNode = new LdapUserNode()\n                .setId(secondRootUserId)\n                .setDn(secondRootDn)\n                .setManagerDn(secondRootDn)\n                .setDirectReportsDn(List.of(secondRootChildDn));\n        var secondRootChildNode = new LdapUserNode()\n                .setId(secondRootChildUserId)\n                .setDn(secondRootChildDn)\n                .setManagerDn(secondRootDn);\n\n        var firstRootChildHierarchyNode = new HierarchyTreeNode(firstRootChildUser);\n        var expectedFirstRootHierarchyNode = new HierarchyTreeNode(firstRootUser);\n        expectedFirstRootHierarchyNode.addDirectStaffMember(firstRootChildHierarchyNode);\n\n        var secondRootChildHierarchyNode = new HierarchyTreeNode(secondRootChildUser);\n        var expectedSecondRootHierarchyNode = new HierarchyTreeNode(secondRootUser);\n        expectedSecondRootHierarchyNode.addDirectStaffMember(secondRootChildHierarchyNode);\n\n        given(repoUserServiceMock.getOrCreateUserById(firstRootUserId)).willReturn(firstRootUser);\n        given(repoUserServiceMock.getOrCreateUserById(firstRootChildUserId)).willReturn(firstRootChildUser);\n        given(repoUserServiceMock.getOrCreateUserById(secondRootUserId)).willReturn(secondRootUser);\n        given(repoUserServiceMock.getOrCreateUserById(secondRootChildUserId)).willReturn(secondRootChildUser);\n\n        // when\n        var actualRootHierarchyNodes = userUpdater.buildHierarchyTrees(List.of(firstRootNode, secondRootNode),\n                List.of(firstRootNode, secondRootNode, firstRootChildNode, secondRootChildNode));\n\n        // then\n        assertThat(actualRootHierarchyNodes).containsExactly(expectedFirstRootHierarchyNode, expectedSecondRootHierarchyNode);\n    }", "signature": "void buildHierarchyNodesReturnsExpectedNodes()", "full_signature": "@Test public void buildHierarchyNodesReturnsExpectedNodes()", "class_method_signature": "UserUpdaterTest.buildHierarchyNodesReturnsExpectedNodes()", "testcase": true, "constructor": false, "invocations": ["setDirectReportsDn", "setManagerDn", "setDn", "setId", "of", "setManagerDn", "setDn", "setId", "setDirectReportsDn", "setManagerDn", "setDn", "setId", "of", "setManagerDn", "setDn", "setId", "addDirectStaffMember", "addDirectStaffMember", "willReturn", "given", "getOrCreateUserById", "willReturn", "given", "getOrCreateUserById", "willReturn", "given", "getOrCreateUserById", "willReturn", "given", "getOrCreateUserById", "buildHierarchyTrees", "of", "of", "containsExactly", "assertThat"]}, "focal_class": {"identifier": "UserUpdater", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final HierarchyTreeNodeRepository hierarchyTreeNodeRepo;", "modifier": "private final", "type": "HierarchyTreeNodeRepository", "declarator": "hierarchyTreeNodeRepo", "var_name": "hierarchyTreeNodeRepo"}, {"original_string": "private final RepositoryUserService repoUserService;", "modifier": "private final", "type": "RepositoryUserService", "declarator": "repoUserService", "var_name": "repoUserService"}, {"original_string": "private final UserDataRepository userDataRepo;", "modifier": "private final", "type": "UserDataRepository", "declarator": "userDataRepo", "var_name": "userDataRepo"}, {"original_string": "private final LdapAdapter ldapAdapter;", "modifier": "private final", "type": "LdapAdapter", "declarator": "ldapAdapter", "var_name": "ldapAdapter"}, {"original_string": "private final List<Normalizer<UserData>> normalizers;", "modifier": "private final", "type": "List<Normalizer<UserData>>", "declarator": "normalizers", "var_name": "normalizers"}], "methods": [{"identifier": "UserUpdater", "parameters": "(HierarchyTreeNodeRepository hierarchyTreeNodeRepo,\n                       RepositoryUserService repoUserService,\n                       UserDataRepository userDataRepo,\n                       LdapAdapter ldapAdapter,\n                       List<Normalizer<UserData>> normalizers)", "modifiers": "public", "return": "", "signature": " UserUpdater(HierarchyTreeNodeRepository hierarchyTreeNodeRepo,\n                       RepositoryUserService repoUserService,\n                       UserDataRepository userDataRepo,\n                       LdapAdapter ldapAdapter,\n                       List<Normalizer<UserData>> normalizers)", "full_signature": "public  UserUpdater(HierarchyTreeNodeRepository hierarchyTreeNodeRepo,\n                       RepositoryUserService repoUserService,\n                       UserDataRepository userDataRepo,\n                       LdapAdapter ldapAdapter,\n                       List<Normalizer<UserData>> normalizers)", "class_method_signature": "UserUpdater.UserUpdater(HierarchyTreeNodeRepository hierarchyTreeNodeRepo,\n                       RepositoryUserService repoUserService,\n                       UserDataRepository userDataRepo,\n                       LdapAdapter ldapAdapter,\n                       List<Normalizer<UserData>> normalizers)", "testcase": false, "constructor": true}, {"identifier": "updateHierarchyAndUserData", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void updateHierarchyAndUserData()", "full_signature": "public void updateHierarchyAndUserData()", "class_method_signature": "UserUpdater.updateHierarchyAndUserData()", "testcase": false, "constructor": false}, {"identifier": "updateHierarchy", "parameters": "(@NonNull Collection<LdapUserNode> nodes)", "modifiers": "", "return": "void", "signature": "void updateHierarchy(@NonNull Collection<LdapUserNode> nodes)", "full_signature": " void updateHierarchy(@NonNull Collection<LdapUserNode> nodes)", "class_method_signature": "UserUpdater.updateHierarchy(@NonNull Collection<LdapUserNode> nodes)", "testcase": false, "constructor": false}, {"identifier": "updateUserData", "parameters": "(@NonNull Collection<LdapUserNode> nodes)", "modifiers": "", "return": "void", "signature": "void updateUserData(@NonNull Collection<LdapUserNode> nodes)", "full_signature": " void updateUserData(@NonNull Collection<LdapUserNode> nodes)", "class_method_signature": "UserUpdater.updateUserData(@NonNull Collection<LdapUserNode> nodes)", "testcase": false, "constructor": false}, {"identifier": "normalizeAndSaveUserData", "parameters": "(List<UserData> userData)", "modifiers": "", "return": "void", "signature": "void normalizeAndSaveUserData(List<UserData> userData)", "full_signature": " void normalizeAndSaveUserData(List<UserData> userData)", "class_method_signature": "UserUpdater.normalizeAndSaveUserData(List<UserData> userData)", "testcase": false, "constructor": false}, {"identifier": "getRootNodes", "parameters": "(@NonNull Collection<LdapUserNode> nodes)", "modifiers": "", "return": "Set<LdapUserNode>", "signature": "Set<LdapUserNode> getRootNodes(@NonNull Collection<LdapUserNode> nodes)", "full_signature": " Set<LdapUserNode> getRootNodes(@NonNull Collection<LdapUserNode> nodes)", "class_method_signature": "UserUpdater.getRootNodes(@NonNull Collection<LdapUserNode> nodes)", "testcase": false, "constructor": false}, {"identifier": "buildHierarchyTrees", "parameters": "(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "modifiers": "", "return": "Collection<HierarchyTreeNode>", "signature": "Collection<HierarchyTreeNode> buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "full_signature": " Collection<HierarchyTreeNode> buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "class_method_signature": "UserUpdater.buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "testcase": false, "constructor": false}, {"identifier": "buildHierarchyNode", "parameters": "(@NonNull LdapUserNode rootNode, @NonNull List<LdapUserNode> childNodes)", "modifiers": "", "return": "HierarchyTreeNode", "signature": "HierarchyTreeNode buildHierarchyNode(@NonNull LdapUserNode rootNode, @NonNull List<LdapUserNode> childNodes)", "full_signature": " HierarchyTreeNode buildHierarchyNode(@NonNull LdapUserNode rootNode, @NonNull List<LdapUserNode> childNodes)", "class_method_signature": "UserUpdater.buildHierarchyNode(@NonNull LdapUserNode rootNode, @NonNull List<LdapUserNode> childNodes)", "testcase": false, "constructor": false}, {"identifier": "getChildNodesInLevelOrder", "parameters": "(@NonNull LdapUserNode node, @NonNull Map<String, LdapUserNode> dnNodeMap)", "modifiers": "", "return": "List<LdapUserNode>", "signature": "List<LdapUserNode> getChildNodesInLevelOrder(@NonNull LdapUserNode node, @NonNull Map<String, LdapUserNode> dnNodeMap)", "full_signature": " List<LdapUserNode> getChildNodesInLevelOrder(@NonNull LdapUserNode node, @NonNull Map<String, LdapUserNode> dnNodeMap)", "class_method_signature": "UserUpdater.getChildNodesInLevelOrder(@NonNull LdapUserNode node, @NonNull Map<String, LdapUserNode> dnNodeMap)", "testcase": false, "constructor": false}, {"identifier": "filterNodesWithMissingManager", "parameters": "(@NonNull Collection<LdapUserNode> nodes)", "modifiers": "", "return": "Set<LdapUserNode>", "signature": "Set<LdapUserNode> filterNodesWithMissingManager(@NonNull Collection<LdapUserNode> nodes)", "full_signature": " Set<LdapUserNode> filterNodesWithMissingManager(@NonNull Collection<LdapUserNode> nodes)", "class_method_signature": "UserUpdater.filterNodesWithMissingManager(@NonNull Collection<LdapUserNode> nodes)", "testcase": false, "constructor": false}, {"identifier": "cleanDirectReports", "parameters": "(@NonNull Collection<LdapUserNode> nodes)", "modifiers": "", "return": "Set<LdapUserNode>", "signature": "Set<LdapUserNode> cleanDirectReports(@NonNull Collection<LdapUserNode> nodes)", "full_signature": " Set<LdapUserNode> cleanDirectReports(@NonNull Collection<LdapUserNode> nodes)", "class_method_signature": "UserUpdater.cleanDirectReports(@NonNull Collection<LdapUserNode> nodes)", "testcase": false, "constructor": false}], "file": "backend/project-board/src/main/java/de/adesso/projectboard/ad/updater/UserUpdater.java"}, "focal_method": {"identifier": "buildHierarchyTrees", "parameters": "(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "modifiers": "", "return": "Collection<HierarchyTreeNode>", "body": "Collection<HierarchyTreeNode> buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes) {\n        var dnNodeMap = allNodes.stream()\n                .collect(Collectors.toMap(LdapUserNode::getDn, Function.identity()));\n\n        return rootNodes.stream()\n                .map(rootNode -> {\n                    var childNodesInLevelOrder = getChildNodesInLevelOrder(rootNode, dnNodeMap);\n\n                    return buildHierarchyNode(rootNode, childNodesInLevelOrder);\n                })\n                .collect(Collectors.toList());\n    }", "signature": "Collection<HierarchyTreeNode> buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "full_signature": " Collection<HierarchyTreeNode> buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "class_method_signature": "UserUpdater.buildHierarchyTrees(@NonNull Collection<LdapUserNode> rootNodes, @NonNull Collection<LdapUserNode> allNodes)", "testcase": false, "constructor": false, "invocations": ["collect", "stream", "toMap", "identity", "collect", "map", "stream", "getChildNodesInLevelOrder", "buildHierarchyNode", "toList"]}, "repository": {"repo_id": 144251992, "url": "https://github.com/adessoAG/project-board", "language": "Java", "is_fork": false, "fork_count": 1, "stargazer_count": 8, "size": 2608, "license": "licensed"}}