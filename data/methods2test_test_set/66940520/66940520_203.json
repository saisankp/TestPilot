{"test_class": {"identifier": "DashboardItemDeletionHandlerTest", "superclass": "extends DhisSpringTest", "interfaces": "", "fields": [{"original_string": "@Autowired\n    private DashboardService dashboardService;", "modifier": "@Autowired\n    private", "type": "DashboardService", "declarator": "dashboardService", "var_name": "dashboardService"}, {"original_string": "@Autowired\n    private VisualizationService visualizationService;", "modifier": "@Autowired\n    private", "type": "VisualizationService", "declarator": "visualizationService", "var_name": "visualizationService"}, {"original_string": "@Autowired\n    private MappingService mappingService;", "modifier": "@Autowired\n    private", "type": "MappingService", "declarator": "mappingService", "var_name": "mappingService"}, {"original_string": "@Autowired\n    private EventReportService eventReportService;", "modifier": "@Autowired\n    private", "type": "EventReportService", "declarator": "eventReportService", "var_name": "eventReportService"}, {"original_string": "@Autowired\n    private EventChartService eventChartService;", "modifier": "@Autowired\n    private", "type": "EventChartService", "declarator": "eventChartService", "var_name": "eventChartService"}, {"original_string": "@Autowired\n    private UserService _userService;", "modifier": "@Autowired\n    private", "type": "UserService", "declarator": "_userService", "var_name": "_userService"}, {"original_string": "@Autowired\n    private ReportService reportService;", "modifier": "@Autowired\n    private", "type": "ReportService", "declarator": "reportService", "var_name": "reportService"}, {"original_string": "@Autowired\n    private ProgramService programService;", "modifier": "@Autowired\n    private", "type": "ProgramService", "declarator": "programService", "var_name": "programService"}, {"original_string": "@Autowired\n    private DocumentService documentService;", "modifier": "@Autowired\n    private", "type": "DocumentService", "declarator": "documentService", "var_name": "documentService"}, {"original_string": "private Dashboard dashboard;", "modifier": "private", "type": "Dashboard", "declarator": "dashboard", "var_name": "dashboard"}, {"original_string": "private DashboardItem dashboardItem;", "modifier": "private", "type": "DashboardItem", "declarator": "dashboardItem", "var_name": "dashboardItem"}, {"original_string": "private Program program;", "modifier": "private", "type": "Program", "declarator": "program", "var_name": "program"}], "file": "dhis-2/dhis-services/dhis-service-reporting/src/test/java/org/hisp/dhis/dashboard/DashboardItemDeletionHandlerTest.java"}, "test_case": {"identifier": "testDeleteUser", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testDeleteUser()\n    {\n        User userA = createUser( 'A' );\n        User userB = createUser( 'B' );\n        userService.addUser( userA );\n        userService.addUser( userB );\n\n        dashboardItem.getUsers().add ( userA );\n        dashboardItem.getUsers().add ( userA ); // Test removing duplicates\n        dashboardItem.getUsers().add ( userB );\n        dashboardService.saveDashboard( dashboard );\n\n        assertEquals(1, dashboardService.getUserDashboardItems( userA ).size() );\n        assertEquals(1, dashboardService.getUserDashboardItems( userB ).size() );\n        assertEquals( 1, dashboard.getItemCount() );\n\n        userService.deleteUser( userA );\n\n        assertEquals(0, dashboardService.getUserDashboardItems( userA ).size() );\n        assertEquals(1, dashboardService.getUserDashboardItems( userB ).size() );\n        assertEquals( 1, dashboard.getItemCount() );\n\n        userService.deleteUser( userB );\n\n        assertEquals(0, dashboardService.getUserDashboardItems( userA ).size() );\n        assertEquals(0, dashboardService.getUserDashboardItems( userB ).size() );\n        assertEquals( 0, dashboard.getItemCount() );\n    }", "signature": "void testDeleteUser()", "full_signature": "@Test public void testDeleteUser()", "class_method_signature": "DashboardItemDeletionHandlerTest.testDeleteUser()", "testcase": true, "constructor": false, "invocations": ["createUser", "createUser", "addUser", "addUser", "add", "getUsers", "add", "getUsers", "add", "getUsers", "saveDashboard", "assertEquals", "size", "getUserDashboardItems", "assertEquals", "size", "getUserDashboardItems", "assertEquals", "getItemCount", "deleteUser", "assertEquals", "size", "getUserDashboardItems", "assertEquals", "size", "getUserDashboardItems", "assertEquals", "getItemCount", "deleteUser", "assertEquals", "size", "getUserDashboardItems", "assertEquals", "size", "getUserDashboardItems", "assertEquals", "getItemCount"]}, "focal_class": {"identifier": "DashboardItemDeletionHandler", "superclass": "extends DeletionHandler", "interfaces": "", "fields": [{"original_string": "private final DashboardService dashboardService;", "modifier": "private final", "type": "DashboardService", "declarator": "dashboardService", "var_name": "dashboardService"}], "methods": [{"identifier": "DashboardItemDeletionHandler", "parameters": "( DashboardService dashboardService )", "modifiers": "public", "return": "", "signature": " DashboardItemDeletionHandler( DashboardService dashboardService )", "full_signature": "public  DashboardItemDeletionHandler( DashboardService dashboardService )", "class_method_signature": "DashboardItemDeletionHandler.DashboardItemDeletionHandler( DashboardService dashboardService )", "testcase": false, "constructor": true}, {"identifier": "getClassName", "parameters": "()", "modifiers": "@Override protected", "return": "String", "signature": "String getClassName()", "full_signature": "@Override protected String getClassName()", "class_method_signature": "DashboardItemDeletionHandler.getClassName()", "testcase": false, "constructor": false}, {"identifier": "deleteVisualization", "parameters": "( Visualization visualization )", "modifiers": "@Override public", "return": "void", "signature": "void deleteVisualization( Visualization visualization )", "full_signature": "@Override public void deleteVisualization( Visualization visualization )", "class_method_signature": "DashboardItemDeletionHandler.deleteVisualization( Visualization visualization )", "testcase": false, "constructor": false}, {"identifier": "deleteReportTable", "parameters": "( ReportTable reportTable )", "modifiers": "@Override public", "return": "void", "signature": "void deleteReportTable( ReportTable reportTable )", "full_signature": "@Override public void deleteReportTable( ReportTable reportTable )", "class_method_signature": "DashboardItemDeletionHandler.deleteReportTable( ReportTable reportTable )", "testcase": false, "constructor": false}, {"identifier": "deleteChart", "parameters": "( Chart chart )", "modifiers": "@Override public", "return": "void", "signature": "void deleteChart( Chart chart )", "full_signature": "@Override public void deleteChart( Chart chart )", "class_method_signature": "DashboardItemDeletionHandler.deleteChart( Chart chart )", "testcase": false, "constructor": false}, {"identifier": "deleteEventChart", "parameters": "( EventChart eventChart )", "modifiers": "@Override public", "return": "void", "signature": "void deleteEventChart( EventChart eventChart )", "full_signature": "@Override public void deleteEventChart( EventChart eventChart )", "class_method_signature": "DashboardItemDeletionHandler.deleteEventChart( EventChart eventChart )", "testcase": false, "constructor": false}, {"identifier": "deleteMap", "parameters": "( Map map )", "modifiers": "@Override public", "return": "void", "signature": "void deleteMap( Map map )", "full_signature": "@Override public void deleteMap( Map map )", "class_method_signature": "DashboardItemDeletionHandler.deleteMap( Map map )", "testcase": false, "constructor": false}, {"identifier": "deleteEventReport", "parameters": "( EventReport eventReport )", "modifiers": "@Override public", "return": "void", "signature": "void deleteEventReport( EventReport eventReport )", "full_signature": "@Override public void deleteEventReport( EventReport eventReport )", "class_method_signature": "DashboardItemDeletionHandler.deleteEventReport( EventReport eventReport )", "testcase": false, "constructor": false}, {"identifier": "deleteUser", "parameters": "( User user )", "modifiers": "@Override public", "return": "void", "signature": "void deleteUser( User user )", "full_signature": "@Override public void deleteUser( User user )", "class_method_signature": "DashboardItemDeletionHandler.deleteUser( User user )", "testcase": false, "constructor": false}, {"identifier": "deleteReport", "parameters": "( Report report )", "modifiers": "@Override public", "return": "void", "signature": "void deleteReport( Report report )", "full_signature": "@Override public void deleteReport( Report report )", "class_method_signature": "DashboardItemDeletionHandler.deleteReport( Report report )", "testcase": false, "constructor": false}, {"identifier": "deleteDocument", "parameters": "( Document document )", "modifiers": "@Override public", "return": "void", "signature": "void deleteDocument( Document document )", "full_signature": "@Override public void deleteDocument( Document document )", "class_method_signature": "DashboardItemDeletionHandler.deleteDocument( Document document )", "testcase": false, "constructor": false}], "file": "dhis-2/dhis-services/dhis-service-reporting/src/main/java/org/hisp/dhis/dashboard/DashboardItemDeletionHandler.java"}, "focal_method": {"identifier": "deleteUser", "parameters": "( User user )", "modifiers": "@Override public", "return": "void", "body": "@Override\n    public void deleteUser( User user )\n    {\n        for ( DashboardItem item : dashboardService.getUserDashboardItems( user ) )\n        {\n            while ( item.getUsers().contains( user ) ) // In case of duplicates\n            {\n                item.getUsers().remove( user );\n            }\n\n            if ( item.getUsers().isEmpty() )\n            {\n                dashboardService.deleteDashboardItem( item );\n            }\n        }\n    }", "signature": "void deleteUser( User user )", "full_signature": "@Override public void deleteUser( User user )", "class_method_signature": "DashboardItemDeletionHandler.deleteUser( User user )", "testcase": false, "constructor": false, "invocations": ["getUserDashboardItems", "contains", "getUsers", "remove", "getUsers", "isEmpty", "getUsers", "deleteDashboardItem"]}, "repository": {"repo_id": 66940520, "url": "https://github.com/dhis2/dhis2-core", "stars": 151, "created": "8/30/2016 12:57:05 PM +00:00", "updates": "2020-01-24T18:06:36+00:00", "fork": "False", "license": "licensed"}}