{"test_class": {"identifier": "DelegateFactoryTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private DelegateFactory delegateFactory;", "modifier": "private", "type": "DelegateFactory", "declarator": "delegateFactory", "var_name": "delegateFactory"}, {"original_string": "@Rule\n    public ExpectedException thrown= ExpectedException.none();", "modifier": "@Rule\n    public", "type": "ExpectedException", "declarator": "thrown= ExpectedException.none()", "var_name": "thrown"}, {"original_string": "private String delegatesSchema = ResourcesUtils.loadResource(\"gateleen_delegate_schema_delegates\", true);", "modifier": "private", "type": "String", "declarator": "delegatesSchema = ResourcesUtils.loadResource(\"gateleen_delegate_schema_delegates\", true)", "var_name": "delegatesSchema"}, {"original_string": "private final String INVALID_JSON = ResourcesUtils.loadResource(\"testresource_invalid_json\", true);", "modifier": "private final", "type": "String", "declarator": "INVALID_JSON = ResourcesUtils.loadResource(\"testresource_invalid_json\", true)", "var_name": "INVALID_JSON"}, {"original_string": "private final String VALID_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_valid_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "VALID_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_valid_delegate_resource\", true)", "var_name": "VALID_DELEGATE_RESOURCE"}, {"original_string": "private final String MISSING_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_missing_property_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "MISSING_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_missing_property_delegate_resource\", true)", "var_name": "MISSING_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String UNWANTED_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_unwanted_property_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "UNWANTED_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_unwanted_property_delegate_resource\", true)", "var_name": "UNWANTED_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String PAYLOAD_TRANSFORM_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_payload_and_transform_property_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "PAYLOAD_TRANSFORM_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_payload_and_transform_property_delegate_resource\", true)", "var_name": "PAYLOAD_TRANSFORM_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String TRANSFORM_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_transform_and_transform_with_metadata_property_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "TRANSFORM_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_transform_and_transform_with_metadata_property_delegate_resource\", true)", "var_name": "TRANSFORM_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String TRANSFORM_PROPERTY_NOT_OBJECT_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_transform_property_not_object_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "TRANSFORM_PROPERTY_NOT_OBJECT_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_transform_property_not_object_delegate_resource\", true)", "var_name": "TRANSFORM_PROPERTY_NOT_OBJECT_DELEGATE_RESOURCE"}, {"original_string": "private final String TRANSFORM_WITH_METADATA_PROPERTY_NOT_OBJECT_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_transform_with_metadata_property_not_object_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "TRANSFORM_WITH_METADATA_PROPERTY_NOT_OBJECT_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_transform_with_metadata_property_not_object_delegate_resource\", true)", "var_name": "TRANSFORM_WITH_METADATA_PROPERTY_NOT_OBJECT_DELEGATE_RESOURCE"}, {"original_string": "private final String VALID_TRANSFORM_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_valid_transform_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "VALID_TRANSFORM_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_valid_transform_delegate_resource\", true)", "var_name": "VALID_TRANSFORM_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String VALID_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_valid_transform_with_metadata_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "VALID_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_valid_transform_with_metadata_delegate_resource\", true)", "var_name": "VALID_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String INVALID_TRANSFORM_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_invalid_transform_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "INVALID_TRANSFORM_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_invalid_transform_delegate_resource\", true)", "var_name": "INVALID_TRANSFORM_PROPERTY_DELEGATE_RESOURCE"}, {"original_string": "private final String INVALID_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_invalid_transform_with_metadata_delegate_resource\", true);", "modifier": "private final", "type": "String", "declarator": "INVALID_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE = ResourcesUtils.loadResource(\"testresource_invalid_transform_with_metadata_delegate_resource\", true)", "var_name": "INVALID_TRANSFORM_WITH_METADATA_PROPERTY_DELEGATE_RESOURCE"}], "file": "gateleen-delegate/src/test/java/org/swisspush/gateleen/delegate/DelegateFactoryTest.java"}, "test_case": {"identifier": "testMissingProperty", "parameters": "(TestContext context)", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testMissingProperty(TestContext context) throws ValidationException {\n        try {\n            delegateFactory.parseDelegate(\"someDelegate\", Buffer.buffer(MISSING_PROPERTY_DELEGATE_RESOURCE));\n            context.fail(\"Should have thrown a ValidationException since 'pattern' property is missing\");\n        } catch(ValidationException ex){\n            context.assertNotNull(ex.getValidationDetails());\n            context.assertEquals(1, ex.getValidationDetails().size());\n            for(Object obj : ex.getValidationDetails()){\n                JsonObject jsonObject = (JsonObject) obj;\n                context.assertEquals(\"required\", jsonObject.getString(\"type\"));\n                context.assertEquals(\"pattern\", jsonObject.getJsonArray(\"arguments\").getString(0));\n            }\n        }\n    }", "signature": "void testMissingProperty(TestContext context)", "full_signature": "@Test public void testMissingProperty(TestContext context)", "class_method_signature": "DelegateFactoryTest.testMissingProperty(TestContext context)", "testcase": true, "constructor": false, "invocations": ["parseDelegate", "buffer", "fail", "assertNotNull", "getValidationDetails", "assertEquals", "size", "getValidationDetails", "getValidationDetails", "assertEquals", "getString", "assertEquals", "getString", "getJsonArray"]}, "focal_class": {"identifier": "DelegateFactory", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(DelegateFactory.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(DelegateFactory.class)", "var_name": "LOG"}, {"original_string": "private static final String REQUESTS = \"requests\";", "modifier": "private static final", "type": "String", "declarator": "REQUESTS = \"requests\"", "var_name": "REQUESTS"}, {"original_string": "private static final String METHODS = \"methods\";", "modifier": "private static final", "type": "String", "declarator": "METHODS = \"methods\"", "var_name": "METHODS"}, {"original_string": "private static final String PATTERN = \"pattern\";", "modifier": "private static final", "type": "String", "declarator": "PATTERN = \"pattern\"", "var_name": "PATTERN"}, {"original_string": "private static final String TRANSFORM = \"transform\";", "modifier": "private static final", "type": "String", "declarator": "TRANSFORM = \"transform\"", "var_name": "TRANSFORM"}, {"original_string": "private static final String TRANSFORM_WITH_METADATA = \"transformWithMetadata\";", "modifier": "private static final", "type": "String", "declarator": "TRANSFORM_WITH_METADATA = \"transformWithMetadata\"", "var_name": "TRANSFORM_WITH_METADATA"}, {"original_string": "private final MonitoringHandler monitoringHandler;", "modifier": "private final", "type": "MonitoringHandler", "declarator": "monitoringHandler", "var_name": "monitoringHandler"}, {"original_string": "private final HttpClient selfClient;", "modifier": "private final", "type": "HttpClient", "declarator": "selfClient", "var_name": "selfClient"}, {"original_string": "private final Map<String, Object> properties;", "modifier": "private final", "type": "Map<String, Object>", "declarator": "properties", "var_name": "properties"}, {"original_string": "private final String delegatesSchema;", "modifier": "private final", "type": "String", "declarator": "delegatesSchema", "var_name": "delegatesSchema"}], "methods": [{"identifier": "DelegateFactory", "parameters": "(final MonitoringHandler monitoringHandler, final HttpClient selfClient, final Map<String, Object> properties, final String delegatesSchema)", "modifiers": "public", "return": "", "signature": " DelegateFactory(final MonitoringHandler monitoringHandler, final HttpClient selfClient, final Map<String, Object> properties, final String delegatesSchema)", "full_signature": "public  DelegateFactory(final MonitoringHandler monitoringHandler, final HttpClient selfClient, final Map<String, Object> properties, final String delegatesSchema)", "class_method_signature": "DelegateFactory.DelegateFactory(final MonitoringHandler monitoringHandler, final HttpClient selfClient, final Map<String, Object> properties, final String delegatesSchema)", "testcase": false, "constructor": true}, {"identifier": "parseDelegate", "parameters": "(final String delegateName, final Buffer buffer)", "modifiers": "public", "return": "Delegate", "signature": "Delegate parseDelegate(final String delegateName, final Buffer buffer)", "full_signature": "public Delegate parseDelegate(final String delegateName, final Buffer buffer)", "class_method_signature": "DelegateFactory.parseDelegate(final String delegateName, final Buffer buffer)", "testcase": false, "constructor": false}, {"identifier": "createDelegate", "parameters": "(final String delegateName, final String configString)", "modifiers": "private", "return": "Delegate", "signature": "Delegate createDelegate(final String delegateName, final String configString)", "full_signature": "private Delegate createDelegate(final String delegateName, final String configString)", "class_method_signature": "DelegateFactory.createDelegate(final String delegateName, final String configString)", "testcase": false, "constructor": false}, {"identifier": "parsePayloadTransformSpec", "parameters": "(JsonObject requestJsonObject, String delegateName)", "modifiers": "private", "return": "JoltSpec", "signature": "JoltSpec parsePayloadTransformSpec(JsonObject requestJsonObject, String delegateName)", "full_signature": "private JoltSpec parsePayloadTransformSpec(JsonObject requestJsonObject, String delegateName)", "class_method_signature": "DelegateFactory.parsePayloadTransformSpec(JsonObject requestJsonObject, String delegateName)", "testcase": false, "constructor": false}, {"identifier": "buildTransformSpec", "parameters": "(String delegateName, JsonArray transformSpecArray, boolean withMetadata)", "modifiers": "private", "return": "JoltSpec", "signature": "JoltSpec buildTransformSpec(String delegateName, JsonArray transformSpecArray, boolean withMetadata)", "full_signature": "private JoltSpec buildTransformSpec(String delegateName, JsonArray transformSpecArray, boolean withMetadata)", "class_method_signature": "DelegateFactory.buildTransformSpec(String delegateName, JsonArray transformSpecArray, boolean withMetadata)", "testcase": false, "constructor": false}], "file": "gateleen-delegate/src/main/java/org/swisspush/gateleen/delegate/DelegateFactory.java"}, "focal_method": {"identifier": "parseDelegate", "parameters": "(final String delegateName, final Buffer buffer)", "modifiers": "public", "return": "Delegate", "body": "public Delegate parseDelegate(final String delegateName, final Buffer buffer) throws ValidationException {\n        final String configString;\n\n        // replace wildcard configs\n        try {\n            configString = StringUtils.replaceWildcardConfigs(buffer.toString(\"UTF-8\"), properties);\n        } catch(Exception e){\n            throw new ValidationException(e);\n        }\n\n        // validate json\n        ValidationResult validationResult = Validator.validateStatic(Buffer.buffer(configString), delegatesSchema, LOG);\n        if(!validationResult.isSuccess()){\n            throw new ValidationException(validationResult);\n        }\n\n        // everything is fine, create Delegate\n        return createDelegate(delegateName, configString);\n    }", "signature": "Delegate parseDelegate(final String delegateName, final Buffer buffer)", "full_signature": "public Delegate parseDelegate(final String delegateName, final Buffer buffer)", "class_method_signature": "DelegateFactory.parseDelegate(final String delegateName, final Buffer buffer)", "testcase": false, "constructor": false, "invocations": ["replaceWildcardConfigs", "toString", "validateStatic", "buffer", "isSuccess", "createDelegate"]}, "repository": {"repo_id": 52609528, "url": "https://github.com/swisspush/gateleen", "language": "Java", "is_fork": false, "fork_count": 28, "stargazer_count": 63, "size": 2919, "license": "licensed"}}