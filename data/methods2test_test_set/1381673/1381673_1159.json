{"test_class": {"identifier": "KiePMMLRegressionModelFactoryTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String PACKAGE_NAME = \"packagename\";", "modifier": "private static final", "type": "String", "declarator": "PACKAGE_NAME = \"packagename\"", "var_name": "PACKAGE_NAME"}, {"original_string": "private static CompilationUnit COMPILATION_UNIT;", "modifier": "private static", "type": "CompilationUnit", "declarator": "COMPILATION_UNIT", "var_name": "COMPILATION_UNIT"}, {"original_string": "private static ClassOrInterfaceDeclaration MODEL_TEMPLATE;", "modifier": "private static", "type": "ClassOrInterfaceDeclaration", "declarator": "MODEL_TEMPLATE", "var_name": "MODEL_TEMPLATE"}, {"original_string": "private static final String modelName = \"firstModel\";", "modifier": "private static final", "type": "String", "declarator": "modelName = \"firstModel\"", "var_name": "modelName"}, {"original_string": "private static final double tableIntercept =  3.5;", "modifier": "private static final", "type": "double", "declarator": "tableIntercept =  3.5", "var_name": "tableIntercept"}, {"original_string": "private static final Object tableTargetCategory = \"professional\";", "modifier": "private static final", "type": "Object", "declarator": "tableTargetCategory = \"professional\"", "var_name": "tableTargetCategory"}, {"original_string": "private static List<RegressionTable> regressionTables;", "modifier": "private static", "type": "List<RegressionTable>", "declarator": "regressionTables", "var_name": "regressionTables"}, {"original_string": "private static List<DataField> dataFields;", "modifier": "private static", "type": "List<DataField>", "declarator": "dataFields", "var_name": "dataFields"}, {"original_string": "private static List<MiningField> miningFields;", "modifier": "private static", "type": "List<MiningField>", "declarator": "miningFields", "var_name": "miningFields"}, {"original_string": "private static MiningField targetMiningField;", "modifier": "private static", "type": "MiningField", "declarator": "targetMiningField", "var_name": "targetMiningField"}, {"original_string": "private static DataDictionary dataDictionary;", "modifier": "private static", "type": "DataDictionary", "declarator": "dataDictionary", "var_name": "dataDictionary"}, {"original_string": "private static TransformationDictionary transformationDictionary;", "modifier": "private static", "type": "TransformationDictionary", "declarator": "transformationDictionary", "var_name": "transformationDictionary"}, {"original_string": "private static MiningSchema miningSchema;", "modifier": "private static", "type": "MiningSchema", "declarator": "miningSchema", "var_name": "miningSchema"}, {"original_string": "private static RegressionModel regressionModel;", "modifier": "private static", "type": "RegressionModel", "declarator": "regressionModel", "var_name": "regressionModel"}], "file": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-regression/kie-pmml-models-regression-compiler/src/test/java/org/kie/pmml/models/regression/compiler/factories/KiePMMLRegressionModelFactoryTest.java"}, "test_case": {"identifier": "getKiePMMLRegressionModelSourcesMap", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getKiePMMLRegressionModelSourcesMap() throws IOException {\n        Map<String, String> retrieved = KiePMMLRegressionModelFactory.getKiePMMLRegressionModelSourcesMap(dataDictionary, transformationDictionary, regressionModel, PACKAGE_NAME);\n        assertNotNull(retrieved);\n        int expectedSize = regressionTables.size() + 2; // One for classification and one for the whole model\n        assertEquals(expectedSize, retrieved.size());\n    }", "signature": "void getKiePMMLRegressionModelSourcesMap()", "full_signature": "@Test public void getKiePMMLRegressionModelSourcesMap()", "class_method_signature": "KiePMMLRegressionModelFactoryTest.getKiePMMLRegressionModelSourcesMap()", "testcase": true, "constructor": false, "invocations": ["getKiePMMLRegressionModelSourcesMap", "assertNotNull", "size", "assertEquals", "size"]}, "focal_class": {"identifier": "KiePMMLRegressionModelFactory", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(KiePMMLRegressionModelFactory.class.getName());", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(KiePMMLRegressionModelFactory.class.getName())", "var_name": "logger"}, {"original_string": "static final String KIE_PMML_REGRESSION_MODEL_TEMPLATE_JAVA = \"KiePMMLRegressionModelTemplate.tmpl\";", "modifier": "static final", "type": "String", "declarator": "KIE_PMML_REGRESSION_MODEL_TEMPLATE_JAVA = \"KiePMMLRegressionModelTemplate.tmpl\"", "var_name": "KIE_PMML_REGRESSION_MODEL_TEMPLATE_JAVA"}, {"original_string": "static final String KIE_PMML_REGRESSION_MODEL_TEMPLATE = \"KiePMMLRegressionModelTemplate\";", "modifier": "static final", "type": "String", "declarator": "KIE_PMML_REGRESSION_MODEL_TEMPLATE = \"KiePMMLRegressionModelTemplate\"", "var_name": "KIE_PMML_REGRESSION_MODEL_TEMPLATE"}], "methods": [{"identifier": "KiePMMLRegressionModelFactory", "parameters": "()", "modifiers": "private", "return": "", "signature": " KiePMMLRegressionModelFactory()", "full_signature": "private  KiePMMLRegressionModelFactory()", "class_method_signature": "KiePMMLRegressionModelFactory.KiePMMLRegressionModelFactory()", "testcase": false, "constructor": true}, {"identifier": "getKiePMMLRegressionModelClasses", "parameters": "(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model)", "modifiers": "public static", "return": "KiePMMLRegressionModel", "signature": "KiePMMLRegressionModel getKiePMMLRegressionModelClasses(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model)", "full_signature": "public static KiePMMLRegressionModel getKiePMMLRegressionModelClasses(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model)", "class_method_signature": "KiePMMLRegressionModelFactory.getKiePMMLRegressionModelClasses(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model)", "testcase": false, "constructor": false}, {"identifier": "getKiePMMLRegressionModelSourcesMap", "parameters": "(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "modifiers": "public static", "return": "Map<String, String>", "signature": "Map<String, String> getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "full_signature": "public static Map<String, String> getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "class_method_signature": "KiePMMLRegressionModelFactory.getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "testcase": false, "constructor": false}, {"identifier": "getRegressionTablesMap", "parameters": "(final DataDictionary dataDictionary,\n                                                                                  final RegressionModel model,\n                                                                                  final String targetFieldName,\n                                                                                  final List<KiePMMLOutputField> outputFields,\n                                                                                  final String packageName)", "modifiers": "static", "return": "Map<String, KiePMMLTableSourceCategory>", "signature": "Map<String, KiePMMLTableSourceCategory> getRegressionTablesMap(final DataDictionary dataDictionary,\n                                                                                  final RegressionModel model,\n                                                                                  final String targetFieldName,\n                                                                                  final List<KiePMMLOutputField> outputFields,\n                                                                                  final String packageName)", "full_signature": "static Map<String, KiePMMLTableSourceCategory> getRegressionTablesMap(final DataDictionary dataDictionary,\n                                                                                  final RegressionModel model,\n                                                                                  final String targetFieldName,\n                                                                                  final List<KiePMMLOutputField> outputFields,\n                                                                                  final String packageName)", "class_method_signature": "KiePMMLRegressionModelFactory.getRegressionTablesMap(final DataDictionary dataDictionary,\n                                                                                  final RegressionModel model,\n                                                                                  final String targetFieldName,\n                                                                                  final List<KiePMMLOutputField> outputFields,\n                                                                                  final String packageName)", "testcase": false, "constructor": false}, {"identifier": "setConstructor", "parameters": "(final String generatedClassName,\n                               final String nestedTable,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName)", "modifiers": "static", "return": "void", "signature": "void setConstructor(final String generatedClassName,\n                               final String nestedTable,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName)", "full_signature": "static void setConstructor(final String generatedClassName,\n                               final String nestedTable,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName)", "class_method_signature": "KiePMMLRegressionModelFactory.setConstructor(final String generatedClassName,\n                               final String nestedTable,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName)", "testcase": false, "constructor": false}, {"identifier": "isRegression", "parameters": "(final MiningFunction miningFunction, final String targetField, final OpType targetOpType)", "modifiers": "static", "return": "boolean", "signature": "boolean isRegression(final MiningFunction miningFunction, final String targetField, final OpType targetOpType)", "full_signature": "static boolean isRegression(final MiningFunction miningFunction, final String targetField, final OpType targetOpType)", "class_method_signature": "KiePMMLRegressionModelFactory.isRegression(final MiningFunction miningFunction, final String targetField, final OpType targetOpType)", "testcase": false, "constructor": false}], "file": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-regression/kie-pmml-models-regression-compiler/src/main/java/org/kie/pmml/models/regression/compiler/factories/KiePMMLRegressionModelFactory.java"}, "focal_method": {"identifier": "getKiePMMLRegressionModelSourcesMap", "parameters": "(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "modifiers": "public static", "return": "Map<String, String>", "body": "public static Map<String, String> getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName) throws IOException {\n        logger.trace(\"getKiePMMLRegressionModelSourcesMap {} {} {}\", dataDictionary, model, packageName);\n\n\n        String className = getSanitizedClassName(model.getModelName());\n        CompilationUnit cloneCU = JavaParserUtils.getKiePMMLModelCompilationUnit(className, packageName, KIE_PMML_REGRESSION_MODEL_TEMPLATE_JAVA, KIE_PMML_REGRESSION_MODEL_TEMPLATE);\n        ClassOrInterfaceDeclaration modelTemplate = cloneCU.getClassByName(className)\n                .orElseThrow(() -> new KiePMMLException(MAIN_CLASS_NOT_FOUND + \": \" + className));\n        String modelName = model.getModelName();\n        String targetFieldName = getTargetFieldName(dataDictionary, model).orElse(null);\n        List<KiePMMLOutputField> outputFields = getOutputFields(model);\n        Map<String, KiePMMLTableSourceCategory> tablesSourceMap = getRegressionTablesMap(dataDictionary, model, targetFieldName, outputFields, packageName);\n        String nestedTable = tablesSourceMap.size() == 1 ? tablesSourceMap.keySet().iterator().next() :\n                tablesSourceMap\n                        .keySet()\n                        .stream()\n                        .filter(tableName -> tableName.startsWith(packageName + \".KiePMMLRegressionTableClassification\"))\n                        .findFirst()\n                        .orElseThrow(() -> new KiePMMLException(\"Failed to find expected KiePMMLRegressionTableClassification\"));\n        final ConstructorDeclaration constructorDeclaration = modelTemplate.getDefaultConstructor().orElseThrow(() -> new KiePMMLInternalException(String.format(MISSING_DEFAULT_CONSTRUCTOR, modelTemplate.getName())));\n        setConstructor(className, nestedTable, constructorDeclaration, targetFieldName, MINING_FUNCTION.byName(model.getMiningFunction().value()), modelName);\n        addTransformationsInClassOrInterfaceDeclaration(modelTemplate, transformationDictionary, model.getLocalTransformations());\n        Map<String, String> toReturn = tablesSourceMap.entrySet()\n                .stream()\n                .collect(Collectors.toMap(Map.Entry::getKey, entry -> entry.getValue().getSource()));\n        toReturn.put(getFullClassName(cloneCU), cloneCU.toString());\n        return toReturn;\n    }", "signature": "Map<String, String> getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "full_signature": "public static Map<String, String> getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "class_method_signature": "KiePMMLRegressionModelFactory.getKiePMMLRegressionModelSourcesMap(final DataDictionary dataDictionary,\n                                                                          final TransformationDictionary transformationDictionary,\n                                                                          final RegressionModel model,\n                                                                          final String packageName)", "testcase": false, "constructor": false, "invocations": ["trace", "getSanitizedClassName", "getModelName", "getKiePMMLModelCompilationUnit", "orElseThrow", "getClassByName", "getModelName", "orElse", "getTargetFieldName", "getOutputFields", "getRegressionTablesMap", "size", "next", "iterator", "keySet", "orElseThrow", "findFirst", "filter", "stream", "keySet", "startsWith", "orElseThrow", "getDefaultConstructor", "format", "getName", "setConstructor", "byName", "value", "getMiningFunction", "addTransformationsInClassOrInterfaceDeclaration", "getLocalTransformations", "collect", "stream", "entrySet", "toMap", "getSource", "getValue", "put", "getFullClassName", "toString"]}, "repository": {"repo_id": 1381673, "url": "https://github.com/kiegroup/drools", "stars": 2733, "created": "2/18/2011 8:37:05 AM +00:00", "updates": "2020-01-27T13:12:15+00:00", "fork": "False", "license": "licensed"}}