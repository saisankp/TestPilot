{"test_class": {"identifier": "PaullEndpointTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Autowired\n    private ApplicationContext applicationContext;", "modifier": "@Autowired\n    private", "type": "ApplicationContext", "declarator": "applicationContext", "var_name": "applicationContext"}, {"original_string": "private MockWebServiceClient mockClient;", "modifier": "private", "type": "MockWebServiceClient", "declarator": "mockClient", "var_name": "mockClient"}, {"original_string": "@SpyBean\n    private PaullEndpoint paullEndpoint;", "modifier": "@SpyBean\n    private", "type": "PaullEndpoint", "declarator": "paullEndpoint", "var_name": "paullEndpoint"}, {"original_string": "@MockBean\n    private PesAllerService pesAllerService;", "modifier": "@MockBean\n    private", "type": "PesAllerService", "declarator": "pesAllerService", "var_name": "pesAllerService"}, {"original_string": "@MockBean\n    private PesRetourService pesRetourService;", "modifier": "@MockBean\n    private", "type": "PesRetourService", "declarator": "pesRetourService", "var_name": "pesRetourService"}, {"original_string": "@MockBean\n    private LocalAuthorityService localAuthorityService;", "modifier": "@MockBean\n    private", "type": "LocalAuthorityService", "declarator": "localAuthorityService", "var_name": "localAuthorityService"}, {"original_string": "@MockBean\n    private ExternalRestService externalRestService;", "modifier": "@MockBean\n    private", "type": "ExternalRestService", "declarator": "externalRestService", "var_name": "externalRestService"}, {"original_string": "@MockBean\n    private SesileService sesileService;", "modifier": "@MockBean\n    private", "type": "SesileService", "declarator": "sesileService", "var_name": "sesileService"}, {"original_string": "private DateTimeFormatter dateFormatterWithSeconds = DateTimeFormatter.ofPattern(\"dd/MM/yyyy HH:mm:ss\");", "modifier": "private", "type": "DateTimeFormatter", "declarator": "dateFormatterWithSeconds = DateTimeFormatter.ofPattern(\"dd/MM/yyyy HH:mm:ss\")", "var_name": "dateFormatterWithSeconds"}, {"original_string": "private DateTimeFormatter dateFormatterWithMinutes = DateTimeFormatter.ofPattern(\"dd/MM/yyyy HH:mm\");", "modifier": "private", "type": "DateTimeFormatter", "declarator": "dateFormatterWithMinutes = DateTimeFormatter.ofPattern(\"dd/MM/yyyy HH:mm\")", "var_name": "dateFormatterWithMinutes"}, {"original_string": "private DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern(\"dd/MM/yyyy\");", "modifier": "private", "type": "DateTimeFormatter", "declarator": "dateFormatter = DateTimeFormatter.ofPattern(\"dd/MM/yyyy\")", "var_name": "dateFormatter"}], "file": "pes-service/src/test/java/fr/sictiam/stela/pesservice/soap/endpoints/PaullEndpointTest.java"}, "test_case": {"identifier": "getDetailsPesAllerNoToken", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getDetailsPesAllerNoToken() {\n        String detailsPesAllerRequest =\n            \"<getDetailsPESAllerRequest xmlns='http://www.processmaker.com'>\" +\n                \"<sessionId>sessionid</sessionId>\" +\n                \"<IdPesAller>aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</IdPesAller>\" +\n            \"</getDetailsPESAllerRequest>\";\n\n        String detailsPesAllerResponseNoToken =\n            \"<ns2:getDetailsPESAllerResponse xmlns:ns2='http://www.processmaker.com'>\" +\n                \"<ns2:statusCode>NOK</ns2:statusCode>\" +\n                \"<ns2:retour><ns2:message>SESSION_INVALID_OR_EXPIRED</ns2:message></ns2:retour>\" +\n            \"</ns2:getDetailsPESAllerResponse>\";\n\n        given(paullEndpoint.getToken(any()))\n                .willReturn(null);\n\n        mockClient.sendRequest(withPayload(new StringSource(detailsPesAllerRequest)))\n            .andExpect(payload(new StringSource(detailsPesAllerResponseNoToken)));\n    }", "signature": "void getDetailsPesAllerNoToken()", "full_signature": "@Test public void getDetailsPesAllerNoToken()", "class_method_signature": "PaullEndpointTest.getDetailsPesAllerNoToken()", "testcase": true, "constructor": false, "invocations": ["willReturn", "given", "getToken", "any", "andExpect", "sendRequest", "withPayload", "payload"]}, "focal_class": {"identifier": "PaullEndpoint", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(PaullEndpoint.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(PaullEndpoint.class)", "var_name": "LOGGER"}, {"original_string": "private static final String NAMESPACE_URI = \"http://www.processmaker.com\";", "modifier": "private static final", "type": "String", "declarator": "NAMESPACE_URI = \"http://www.processmaker.com\"", "var_name": "NAMESPACE_URI"}, {"original_string": "private DateTimeFormatter dateFormatterWithMinutes = DateTimeFormatter.ofPattern(\"dd/MM/yyyy HH:mm\");", "modifier": "private", "type": "DateTimeFormatter", "declarator": "dateFormatterWithMinutes = DateTimeFormatter.ofPattern(\"dd/MM/yyyy HH:mm\")", "var_name": "dateFormatterWithMinutes"}, {"original_string": "private DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern(\"dd/MM/yyyy\");", "modifier": "private", "type": "DateTimeFormatter", "declarator": "dateFormatter = DateTimeFormatter.ofPattern(\"dd/MM/yyyy\")", "var_name": "dateFormatter"}, {"original_string": "@Value(\"${application.jwt.secret}\")\n    String SECRET;", "modifier": "@Value(\"${application.jwt.secret}\")", "type": "String", "declarator": "SECRET", "var_name": "SECRET"}, {"original_string": "private final PesAllerService pesAllerService;", "modifier": "private final", "type": "PesAllerService", "declarator": "pesAllerService", "var_name": "pesAllerService"}, {"original_string": "private final PesRetourService pesRetourService;", "modifier": "private final", "type": "PesRetourService", "declarator": "pesRetourService", "var_name": "pesRetourService"}, {"original_string": "private final LocalAuthorityService localAuthorityService;", "modifier": "private final", "type": "LocalAuthorityService", "declarator": "localAuthorityService", "var_name": "localAuthorityService"}, {"original_string": "private final ExternalRestService externalRestService;", "modifier": "private final", "type": "ExternalRestService", "declarator": "externalRestService", "var_name": "externalRestService"}, {"original_string": "private final SesileService sesileService;", "modifier": "private final", "type": "SesileService", "declarator": "sesileService", "var_name": "sesileService"}], "methods": [{"identifier": "PaullEndpoint", "parameters": "(PesAllerService pesAllerService, LocalAuthorityService localAuthorityService,\n            ExternalRestService externalRestService, PesRetourService pesRetourService, SesileService sesileService)", "modifiers": "public", "return": "", "signature": " PaullEndpoint(PesAllerService pesAllerService, LocalAuthorityService localAuthorityService,\n            ExternalRestService externalRestService, PesRetourService pesRetourService, SesileService sesileService)", "full_signature": "public  PaullEndpoint(PesAllerService pesAllerService, LocalAuthorityService localAuthorityService,\n            ExternalRestService externalRestService, PesRetourService pesRetourService, SesileService sesileService)", "class_method_signature": "PaullEndpoint.PaullEndpoint(PesAllerService pesAllerService, LocalAuthorityService localAuthorityService,\n            ExternalRestService externalRestService, PesRetourService pesRetourService, SesileService sesileService)", "testcase": false, "constructor": true}, {"identifier": "getToken", "parameters": "(String sessionID)", "modifiers": "", "return": "PaullSoapToken", "signature": "PaullSoapToken getToken(String sessionID)", "full_signature": " PaullSoapToken getToken(String sessionID)", "class_method_signature": "PaullEndpoint.getToken(String sessionID)", "testcase": false, "constructor": false}, {"identifier": "depotPESAller", "parameters": "(@RequestPayload DepotPESAllerRequest depotPesAller)", "modifiers": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"depotPESAllerRequest\") public @ResponsePayload", "return": "DepotPESAllerResponse", "signature": "DepotPESAllerResponse depotPESAller(@RequestPayload DepotPESAllerRequest depotPesAller)", "full_signature": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"depotPESAllerRequest\") public @ResponsePayload DepotPESAllerResponse depotPESAller(@RequestPayload DepotPESAllerRequest depotPesAller)", "class_method_signature": "PaullEndpoint.depotPESAller(@RequestPayload DepotPESAllerRequest depotPesAller)", "testcase": false, "constructor": false}, {"identifier": "getDetailsPESAller", "parameters": "(\n            @RequestPayload GetDetailsPESAllerRequest getDetailsPESAllerRequest)", "modifiers": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"getDetailsPESAllerRequest\") public @ResponsePayload", "return": "GetDetailsPESAllerResponse", "signature": "GetDetailsPESAllerResponse getDetailsPESAller(\n            @RequestPayload GetDetailsPESAllerRequest getDetailsPESAllerRequest)", "full_signature": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"getDetailsPESAllerRequest\") public @ResponsePayload GetDetailsPESAllerResponse getDetailsPESAller(\n            @RequestPayload GetDetailsPESAllerRequest getDetailsPESAllerRequest)", "class_method_signature": "PaullEndpoint.getDetailsPESAller(\n            @RequestPayload GetDetailsPESAllerRequest getDetailsPESAllerRequest)", "testcase": false, "constructor": false}, {"identifier": "getDetailsPESAllerResponseError", "parameters": "(String errorMessage)", "modifiers": "private", "return": "GetDetailsPESAllerResponse", "signature": "GetDetailsPESAllerResponse getDetailsPESAllerResponseError(String errorMessage)", "full_signature": "private GetDetailsPESAllerResponse getDetailsPESAllerResponseError(String errorMessage)", "class_method_signature": "PaullEndpoint.getDetailsPESAllerResponseError(String errorMessage)", "testcase": false, "constructor": false}, {"identifier": "getPESAller", "parameters": "(@RequestPayload GetPESAllerRequest getPESAllerRequest)", "modifiers": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"getPESAllerRequest\") public @ResponsePayload", "return": "GetPESAllerResponse", "signature": "GetPESAllerResponse getPESAller(@RequestPayload GetPESAllerRequest getPESAllerRequest)", "full_signature": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"getPESAllerRequest\") public @ResponsePayload GetPESAllerResponse getPESAller(@RequestPayload GetPESAllerRequest getPESAllerRequest)", "class_method_signature": "PaullEndpoint.getPESAller(@RequestPayload GetPESAllerRequest getPESAllerRequest)", "testcase": false, "constructor": false}, {"identifier": "getPESRetour", "parameters": "(@RequestPayload GetPESRetourRequest getPESRetourRequest)", "modifiers": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"getPESRetourRequest\") public @ResponsePayload", "return": "GetPESRetourResponse", "signature": "GetPESRetourResponse getPESRetour(@RequestPayload GetPESRetourRequest getPESRetourRequest)", "full_signature": "@PayloadRoot(namespace = NAMESPACE_URI, localPart = \"getPESRetourRequest\") public @ResponsePayload GetPESRetourResponse getPESRetour(@RequestPayload GetPESRetourRequest getPESRetourRequest)", "class_method_signature": "PaullEndpoint.getPESRetour(@RequestPayload GetPESRetourRequest getPESRetourRequest)", "testcase": false, "constructor": false}], "file": "pes-service/src/main/java/fr/sictiam/stela/pesservice/soap/endpoints/PaullEndpoint.java"}, "focal_method": {"identifier": "getToken", "parameters": "(String sessionID)", "modifiers": "", "return": "PaullSoapToken", "body": "PaullSoapToken getToken(String sessionID) {\n\n        if (sessionID != null) {\n\n            try {\n                String token = externalRestService.getPaullConnection(sessionID).get(\"token\").asText();\n                Claims tokenClaim = Jwts.parser().setSigningKey(SECRET).parseClaimsJws(token).getBody();\n                if (tokenClaim.getExpiration().before(new Date())) {\n                    return null;\n                }\n                String tokenParsed = tokenClaim.getSubject();\n\n                ObjectMapper objectMapper = new ObjectMapper();\n                return objectMapper.readValue(tokenParsed, PaullSoapToken.class);\n            } catch (IOException e) {\n                LOGGER.error(e.getMessage());\n                return null;\n            }\n\n        }\n        return null;\n    }", "signature": "PaullSoapToken getToken(String sessionID)", "full_signature": " PaullSoapToken getToken(String sessionID)", "class_method_signature": "PaullEndpoint.getToken(String sessionID)", "testcase": false, "constructor": false, "invocations": ["asText", "get", "getPaullConnection", "getBody", "parseClaimsJws", "setSigningKey", "parser", "before", "getExpiration", "getSubject", "readValue", "error", "getMessage"]}, "repository": {"repo_id": 180337008, "url": "https://github.com/SICTIAM/stela", "language": "Java", "is_fork": false, "fork_count": 0, "stargazer_count": 5, "size": 7714, "license": "licensed"}}