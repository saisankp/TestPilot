{"test_class": {"identifier": "JobTransactionLoggerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(JobTransactionLoggerTest.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(JobTransactionLoggerTest.class)", "var_name": "logger"}], "file": "titus-server-master/src/test/java/com/netflix/titus/master/jobmanager/service/JobTransactionLoggerTest.java"}, "test_case": {"identifier": "testLogFormatting", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testLogFormatting() throws Exception {\n        Job previousJob = createJob();\n        Job currentJob = previousJob.toBuilder().withStatus(JobStatus.newBuilder().withState(JobState.Finished).build()).build();\n\n        ModelActionHolder modelActionHolder = ModelActionHolder.reference(\n                TitusModelAction.newModelUpdate(\"testModelAction\")\n                        .job(previousJob)\n                        .trigger(Trigger.API)\n                        .summary(\"Job model update\")\n                        .jobUpdate(jobHolder -> jobHolder.setEntity(currentJob))\n        );\n\n        TitusChangeAction changeAction = TitusChangeAction.newAction(\"testChangeAction\")\n                .job(previousJob)\n                .trigger(Trigger.API)\n                .summary(\"Job update\")\n                .applyModelUpdate(self -> modelActionHolder);\n\n        JobManagerReconcilerEvent jobReconcilerEvent = new JobModelUpdateReconcilerEvent(\n                previousJob,\n                changeAction,\n                modelActionHolder,\n                EntityHolder.newRoot(currentJob.getId(), currentJob),\n                Optional.of(EntityHolder.newRoot(previousJob.getId(), previousJob)),\n                \"1\",\n                CallMetadata.newBuilder().withCallerId(\"LoggerTest\").withCallReason(\"Testing logger transaction\").build()\n        );\n        String logLine = JobTransactionLogger.doFormat(jobReconcilerEvent);\n        assertThat(logLine).isNotEmpty();\n\n        logger.info(\"Job event: {}\", logLine);\n    }", "signature": "void testLogFormatting()", "full_signature": "@Test public void testLogFormatting()", "class_method_signature": "JobTransactionLoggerTest.testLogFormatting()", "testcase": true, "constructor": false, "invocations": ["createJob", "build", "withStatus", "toBuilder", "build", "withState", "newBuilder", "reference", "jobUpdate", "summary", "trigger", "job", "newModelUpdate", "setEntity", "applyModelUpdate", "summary", "trigger", "job", "newAction", "newRoot", "getId", "of", "newRoot", "getId", "build", "withCallReason", "withCallerId", "newBuilder", "doFormat", "isNotEmpty", "assertThat", "info"]}, "focal_class": {"identifier": "JobTransactionLogger", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(\"JobTransactionLogger\");", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(\"JobTransactionLogger\")", "var_name": "logger"}, {"original_string": "private static final long BUFFER_SIZE = 5000;", "modifier": "private static final", "type": "long", "declarator": "BUFFER_SIZE = 5000", "var_name": "BUFFER_SIZE"}], "methods": [{"identifier": "logEvents", "parameters": "(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "modifiers": "static", "return": "Subscription", "signature": "Subscription logEvents(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "full_signature": "static Subscription logEvents(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "class_method_signature": "JobTransactionLogger.logEvents(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "testcase": false, "constructor": false}, {"identifier": "doFormat", "parameters": "(JobManagerReconcilerEvent event)", "modifiers": "static", "return": "String", "signature": "String doFormat(JobManagerReconcilerEvent event)", "full_signature": "static String doFormat(JobManagerReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.doFormat(JobManagerReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "eventStreamWithBackpressure", "parameters": "(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "modifiers": "private static", "return": "Observable<JobManagerReconcilerEvent>", "signature": "Observable<JobManagerReconcilerEvent> eventStreamWithBackpressure(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "full_signature": "private static Observable<JobManagerReconcilerEvent> eventStreamWithBackpressure(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "class_method_signature": "JobTransactionLogger.eventStreamWithBackpressure(ReconciliationFramework<JobManagerReconcilerEvent> reconciliationFramework)", "testcase": false, "constructor": false}, {"identifier": "logJobBeforeChangeReconcilerEvent", "parameters": "(JobChangeReconcilerEvent.JobBeforeChangeReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String logJobBeforeChangeReconcilerEvent(JobChangeReconcilerEvent.JobBeforeChangeReconcilerEvent event)", "full_signature": "private static String logJobBeforeChangeReconcilerEvent(JobChangeReconcilerEvent.JobBeforeChangeReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.logJobBeforeChangeReconcilerEvent(JobChangeReconcilerEvent.JobBeforeChangeReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "logJobAfterChangeReconcilerEvent", "parameters": "(JobChangeReconcilerEvent.JobAfterChangeReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String logJobAfterChangeReconcilerEvent(JobChangeReconcilerEvent.JobAfterChangeReconcilerEvent event)", "full_signature": "private static String logJobAfterChangeReconcilerEvent(JobChangeReconcilerEvent.JobAfterChangeReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.logJobAfterChangeReconcilerEvent(JobChangeReconcilerEvent.JobAfterChangeReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "logJobChangeErrorReconcilerEvent", "parameters": "(JobChangeReconcilerEvent.JobChangeErrorReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String logJobChangeErrorReconcilerEvent(JobChangeReconcilerEvent.JobChangeErrorReconcilerEvent event)", "full_signature": "private static String logJobChangeErrorReconcilerEvent(JobChangeReconcilerEvent.JobChangeErrorReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.logJobChangeErrorReconcilerEvent(JobChangeReconcilerEvent.JobChangeErrorReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "logJobNewModelReconcilerEvent", "parameters": "(JobModelReconcilerEvent.JobNewModelReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String logJobNewModelReconcilerEvent(JobModelReconcilerEvent.JobNewModelReconcilerEvent event)", "full_signature": "private static String logJobNewModelReconcilerEvent(JobModelReconcilerEvent.JobNewModelReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.logJobNewModelReconcilerEvent(JobModelReconcilerEvent.JobNewModelReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "logJobModelUpdateReconcilerEvent", "parameters": "(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String logJobModelUpdateReconcilerEvent(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "full_signature": "private static String logJobModelUpdateReconcilerEvent(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.logJobModelUpdateReconcilerEvent(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "taskChangeSummary", "parameters": "(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String taskChangeSummary(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "full_signature": "private static String taskChangeSummary(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.taskChangeSummary(JobModelReconcilerEvent.JobModelUpdateReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "logJobModelUpdateErrorReconcilerEvent", "parameters": "(JobModelReconcilerEvent.JobModelUpdateErrorReconcilerEvent event)", "modifiers": "private static", "return": "String", "signature": "String logJobModelUpdateErrorReconcilerEvent(JobModelReconcilerEvent.JobModelUpdateErrorReconcilerEvent event)", "full_signature": "private static String logJobModelUpdateErrorReconcilerEvent(JobModelReconcilerEvent.JobModelUpdateErrorReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.logJobModelUpdateErrorReconcilerEvent(JobModelReconcilerEvent.JobModelUpdateErrorReconcilerEvent event)", "testcase": false, "constructor": false}, {"identifier": "doFormat", "parameters": "(String jobId,\n                                   String transactionId,\n                                   String status,\n                                   String type,\n                                   String action,\n                                   V3JobOperations.Trigger trigger,\n                                   String targetName,\n                                   String entityId,\n                                   long waitTimeMs,\n                                   long executionTime,\n                                   String callerID,\n                                   String callReason,\n                                   String summary)", "modifiers": "private static", "return": "String", "signature": "String doFormat(String jobId,\n                                   String transactionId,\n                                   String status,\n                                   String type,\n                                   String action,\n                                   V3JobOperations.Trigger trigger,\n                                   String targetName,\n                                   String entityId,\n                                   long waitTimeMs,\n                                   long executionTime,\n                                   String callerID,\n                                   String callReason,\n                                   String summary)", "full_signature": "private static String doFormat(String jobId,\n                                   String transactionId,\n                                   String status,\n                                   String type,\n                                   String action,\n                                   V3JobOperations.Trigger trigger,\n                                   String targetName,\n                                   String entityId,\n                                   long waitTimeMs,\n                                   long executionTime,\n                                   String callerID,\n                                   String callReason,\n                                   String summary)", "class_method_signature": "JobTransactionLogger.doFormat(String jobId,\n                                   String transactionId,\n                                   String status,\n                                   String type,\n                                   String action,\n                                   V3JobOperations.Trigger trigger,\n                                   String targetName,\n                                   String entityId,\n                                   long waitTimeMs,\n                                   long executionTime,\n                                   String callerID,\n                                   String callReason,\n                                   String summary)", "testcase": false, "constructor": false}, {"identifier": "toTargetName", "parameters": "(String jobId, String entityId)", "modifiers": "private static", "return": "String", "signature": "String toTargetName(String jobId, String entityId)", "full_signature": "private static String toTargetName(String jobId, String entityId)", "class_method_signature": "JobTransactionLogger.toTargetName(String jobId, String entityId)", "testcase": false, "constructor": false}], "file": "titus-server-master/src/main/java/com/netflix/titus/master/jobmanager/service/JobTransactionLogger.java"}, "focal_method": {"identifier": "doFormat", "parameters": "(JobManagerReconcilerEvent event)", "modifiers": "static", "return": "String", "body": "static String doFormat(JobManagerReconcilerEvent event) {\n        if (event instanceof JobChangeReconcilerEvent.JobBeforeChangeReconcilerEvent) {\n            return logJobBeforeChangeReconcilerEvent((JobChangeReconcilerEvent.JobBeforeChangeReconcilerEvent) event);\n        }\n        if (event instanceof JobChangeReconcilerEvent.JobAfterChangeReconcilerEvent) {\n            return logJobAfterChangeReconcilerEvent((JobChangeReconcilerEvent.JobAfterChangeReconcilerEvent) event);\n        }\n        if (event instanceof JobChangeReconcilerEvent.JobChangeErrorReconcilerEvent) {\n            return logJobChangeErrorReconcilerEvent((JobChangeReconcilerEvent.JobChangeErrorReconcilerEvent) event);\n        }\n        if (event instanceof JobModelReconcilerEvent.JobNewModelReconcilerEvent) {\n            return logJobNewModelReconcilerEvent((JobModelReconcilerEvent.JobNewModelReconcilerEvent) event);\n        }\n        if (event instanceof JobModelReconcilerEvent.JobModelUpdateReconcilerEvent) {\n            return logJobModelUpdateReconcilerEvent((JobModelReconcilerEvent.JobModelUpdateReconcilerEvent) event);\n        }\n        if (event instanceof JobModelReconcilerEvent.JobModelUpdateErrorReconcilerEvent) {\n            return logJobModelUpdateErrorReconcilerEvent((JobModelReconcilerEvent.JobModelUpdateErrorReconcilerEvent) event);\n        }\n        return \"Unknown event type: \" + event.getClass();\n    }", "signature": "String doFormat(JobManagerReconcilerEvent event)", "full_signature": "static String doFormat(JobManagerReconcilerEvent event)", "class_method_signature": "JobTransactionLogger.doFormat(JobManagerReconcilerEvent event)", "testcase": false, "constructor": false, "invocations": ["logJobBeforeChangeReconcilerEvent", "logJobAfterChangeReconcilerEvent", "logJobChangeErrorReconcilerEvent", "logJobNewModelReconcilerEvent", "logJobModelUpdateReconcilerEvent", "logJobModelUpdateErrorReconcilerEvent", "getClass"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}