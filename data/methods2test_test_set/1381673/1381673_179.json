{"test_class": {"identifier": "MVELSafeHelperTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static TestSecurityManager tsm;", "modifier": "private static", "type": "TestSecurityManager", "declarator": "tsm", "var_name": "tsm"}], "file": "drools-mvel/src/test/java/org/drools/mvel/MVELSafeHelperTest.java"}, "test_case": {"identifier": "testUntrustedJavaConsequence", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testUntrustedJavaConsequence() throws Exception {\n        try {\n            MVELSafeHelper.getEvaluator().eval(\"System.exit(0);\");\n            Assert.fail(\"Should have raised an exception...\");\n        } catch (ShouldHavePrevented e) {\n            Assert.fail(\"The security policy for the rule should have prevented this from executing...\");\n        } catch (PropertyAccessException e) {\n            // test succeeded. the policy in place prevented the rule from executing the System.exit().\n        }\n    }", "signature": "void testUntrustedJavaConsequence()", "full_signature": "@Test public void testUntrustedJavaConsequence()", "class_method_signature": "MVELSafeHelperTest.testUntrustedJavaConsequence()", "testcase": true, "constructor": false, "invocations": ["eval", "getEvaluator", "fail", "fail"]}, "focal_class": {"identifier": "MVELSafeHelper", "superclass": "", "interfaces": "", "fields": [], "methods": [{"identifier": "MVELSafeHelper", "parameters": "()", "modifiers": "private", "return": "", "signature": " MVELSafeHelper()", "full_signature": "private  MVELSafeHelper()", "class_method_signature": "MVELSafeHelper.MVELSafeHelper()", "testcase": false, "constructor": true}, {"identifier": "getEvaluator", "parameters": "()", "modifiers": "public static", "return": "MVELEvaluator", "signature": "MVELEvaluator getEvaluator()", "full_signature": "public static MVELEvaluator getEvaluator()", "class_method_signature": "MVELSafeHelper.getEvaluator()", "testcase": false, "constructor": false}], "file": "drools-mvel/src/main/java/org/drools/mvel/MVELSafeHelper.java"}, "focal_method": {"identifier": "getEvaluator", "parameters": "()", "modifiers": "public static", "return": "MVELEvaluator", "body": "public static MVELEvaluator getEvaluator() {\n        return MVELEvaluatorHolder.evaluator;\n    }", "signature": "MVELEvaluator getEvaluator()", "full_signature": "public static MVELEvaluator getEvaluator()", "class_method_signature": "MVELSafeHelper.getEvaluator()", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 1381673, "url": "https://github.com/kiegroup/drools", "stars": 2733, "created": "2/18/2011 8:37:05 AM +00:00", "updates": "2020-01-27T13:12:15+00:00", "fork": "False", "license": "licensed"}}