{"test_class": {"identifier": "BoltCollectorTest", "superclass": "extends AbstractTest", "interfaces": "", "fields": [], "file": "flink-contrib/flink-storm/src/test/java/org/apache/flink/storm/wrappers/BoltCollectorTest.java"}, "test_case": {"identifier": "testBoltStormCollector", "parameters": "()", "modifiers": "@SuppressWarnings({ \"rawtypes\", \"unchecked\" }) @Test public", "return": "void", "body": "@SuppressWarnings({ \"rawtypes\", \"unchecked\" })\n\t@Test\n\tpublic void testBoltStormCollector() throws InstantiationException, IllegalAccessException {\n\t\tfor (int numberOfAttributes = -1; numberOfAttributes < 26; ++numberOfAttributes) {\n\t\t\tfinal Output flinkCollector = mock(Output.class);\n\t\t\tTuple flinkTuple = null;\n\t\t\tfinal Values tuple = new Values();\n\n\t\t\tBoltCollector<?> collector;\n\n\t\t\tfinal String streamId = \"streamId\";\n\t\t\tHashMap<String, Integer> attributes = new HashMap<String, Integer>();\n\t\t\tattributes.put(streamId, numberOfAttributes);\n\n\t\t\tif (numberOfAttributes == -1) {\n\t\t\t\tcollector = new BoltCollector(attributes, -1, flinkCollector);\n\t\t\t\ttuple.add(new Integer(this.r.nextInt()));\n\n\t\t\t} else {\n\t\t\t\tcollector = new BoltCollector(attributes, -1, flinkCollector);\n\t\t\t\tflinkTuple = Tuple.getTupleClass(numberOfAttributes).newInstance();\n\n\t\t\t\tfor (int i = 0; i < numberOfAttributes; ++i) {\n\t\t\t\t\ttuple.add(new Integer(this.r.nextInt()));\n\t\t\t\t\tflinkTuple.setField(tuple.get(i), i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfinal Collection anchors = mock(Collection.class);\n\t\t\tfinal List<Integer> taskIds;\n\t\t\ttaskIds = collector.emit(streamId, anchors, tuple);\n\n\t\t\tAssert.assertNull(taskIds);\n\n\t\t\tif (numberOfAttributes == -1) {\n\t\t\t\tverify(flinkCollector).collect(tuple.get(0));\n\t\t\t} else {\n\t\t\t\tverify(flinkCollector).collect(flinkTuple);\n\t\t\t}\n\t\t}\n\t}", "signature": "void testBoltStormCollector()", "full_signature": "@SuppressWarnings({ \"rawtypes\", \"unchecked\" }) @Test public void testBoltStormCollector()", "class_method_signature": "BoltCollectorTest.testBoltStormCollector()", "testcase": true, "constructor": false, "invocations": ["mock", "put", "add", "nextInt", "newInstance", "getTupleClass", "add", "nextInt", "setField", "get", "mock", "emit", "assertNull", "collect", "verify", "get", "collect", "verify"]}, "focal_class": {"identifier": "BoltCollector", "superclass": "extends AbstractStormCollector<OUT>", "interfaces": "implements IOutputCollector", "fields": [{"original_string": "private final Collector<OUT> flinkOutput;", "modifier": "private final", "type": "Collector<OUT>", "declarator": "flinkOutput", "var_name": "flinkOutput"}], "methods": [{"identifier": "BoltCollector", "parameters": "(final HashMap<String, Integer> numberOfAttributes, final int taskId,\n\t\t\tfinal Collector<OUT> flinkOutput)", "modifiers": "", "return": "", "signature": " BoltCollector(final HashMap<String, Integer> numberOfAttributes, final int taskId,\n\t\t\tfinal Collector<OUT> flinkOutput)", "full_signature": "  BoltCollector(final HashMap<String, Integer> numberOfAttributes, final int taskId,\n\t\t\tfinal Collector<OUT> flinkOutput)", "class_method_signature": "BoltCollector.BoltCollector(final HashMap<String, Integer> numberOfAttributes, final int taskId,\n\t\t\tfinal Collector<OUT> flinkOutput)", "testcase": false, "constructor": true}, {"identifier": "doEmit", "parameters": "(final OUT flinkTuple)", "modifiers": "@Override protected", "return": "List<Integer>", "signature": "List<Integer> doEmit(final OUT flinkTuple)", "full_signature": "@Override protected List<Integer> doEmit(final OUT flinkTuple)", "class_method_signature": "BoltCollector.doEmit(final OUT flinkTuple)", "testcase": false, "constructor": false}, {"identifier": "reportError", "parameters": "(final Throwable error)", "modifiers": "@Override public", "return": "void", "signature": "void reportError(final Throwable error)", "full_signature": "@Override public void reportError(final Throwable error)", "class_method_signature": "BoltCollector.reportError(final Throwable error)", "testcase": false, "constructor": false}, {"identifier": "emit", "parameters": "(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "modifiers": "@Override public", "return": "List<Integer>", "signature": "List<Integer> emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "full_signature": "@Override public List<Integer> emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "class_method_signature": "BoltCollector.emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "testcase": false, "constructor": false}, {"identifier": "emitDirect", "parameters": "(final int taskId, final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "modifiers": "@Override public", "return": "void", "signature": "void emitDirect(final int taskId, final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "full_signature": "@Override public void emitDirect(final int taskId, final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "class_method_signature": "BoltCollector.emitDirect(final int taskId, final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "testcase": false, "constructor": false}, {"identifier": "ack", "parameters": "(final Tuple input)", "modifiers": "@Override public", "return": "void", "signature": "void ack(final Tuple input)", "full_signature": "@Override public void ack(final Tuple input)", "class_method_signature": "BoltCollector.ack(final Tuple input)", "testcase": false, "constructor": false}, {"identifier": "fail", "parameters": "(final Tuple input)", "modifiers": "@Override public", "return": "void", "signature": "void fail(final Tuple input)", "full_signature": "@Override public void fail(final Tuple input)", "class_method_signature": "BoltCollector.fail(final Tuple input)", "testcase": false, "constructor": false}], "file": "flink-contrib/flink-storm/src/main/java/org/apache/flink/storm/wrappers/BoltCollector.java"}, "focal_method": {"identifier": "emit", "parameters": "(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "modifiers": "@Override public", "return": "List<Integer>", "body": "@Override\n\tpublic List<Integer> emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple) {\n\t\treturn this.tansformAndEmit(streamId, tuple);\n\t}", "signature": "List<Integer> emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "full_signature": "@Override public List<Integer> emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "class_method_signature": "BoltCollector.emit(final String streamId, final Collection<Tuple> anchors, final List<Object> tuple)", "testcase": false, "constructor": false, "invocations": ["tansformAndEmit"]}, "repository": {"repo_id": 47972099, "url": "https://github.com/streamline-eu/ML-Pipelines", "language": "Java", "is_fork": false, "fork_count": 7, "stargazer_count": 7, "size": 85537, "license": "licensed"}}