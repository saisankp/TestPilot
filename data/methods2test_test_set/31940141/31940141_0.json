{"test_class": {"identifier": "MainInstrumentMojoTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private MavenProject mavenProject;", "modifier": "private", "type": "MavenProject", "declarator": "mavenProject", "var_name": "mavenProject"}, {"original_string": "private MainInstrumentMojo fixture;", "modifier": "private", "type": "MainInstrumentMojo", "declarator": "fixture", "var_name": "fixture"}], "file": "maven-plugin/src/test/java/com/offbynull/coroutines/mavenplugin/MainInstrumentMojoTest.java"}, "test_case": {"identifier": "mustInstrumentClasses", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void mustInstrumentClasses() throws Exception {\n        byte[] classContent = readZipFromResource(\"NormalInvokeTest.zip\").get(\"NormalInvokeTest.class\");\n        \n        File mainDir = null;\n        try {\n            // write out\n            mainDir = Files.createTempDirectory(getClass().getSimpleName()).toFile();\n            File mainClass = new File(mainDir, \"NormalInvokeTest.class\");\n            FileUtils.writeByteArrayToFile(mainClass, classContent);\n            \n            // mock\n            Mockito.when(mavenProject.getCompileClasspathElements()).thenReturn(Collections.emptyList());\n            Build build = Mockito.mock(Build.class);\n            Mockito.when(mavenProject.getBuild()).thenReturn(build);\n            Mockito.when(build.getOutputDirectory()).thenReturn(mainDir.getAbsolutePath());\n            \n            // execute plugin\n            fixture.execute();\n            \n            // read back in\n            byte[] modifiedMainClassContent = FileUtils.readFileToByteArray(mainClass);\n            \n            // test\n            assertTrue(modifiedMainClassContent.length > classContent.length);\n        } finally {\n            if (mainDir != null) {\n                FileUtils.deleteDirectory(mainDir);\n            }\n        }\n    }", "signature": "void mustInstrumentClasses()", "full_signature": "@Test public void mustInstrumentClasses()", "class_method_signature": "MainInstrumentMojoTest.mustInstrumentClasses()", "testcase": true, "constructor": false, "invocations": ["get", "readZipFromResource", "toFile", "createTempDirectory", "getSimpleName", "getClass", "writeByteArrayToFile", "thenReturn", "when", "getCompileClasspathElements", "emptyList", "mock", "thenReturn", "when", "getBuild", "thenReturn", "when", "getOutputDirectory", "getAbsolutePath", "execute", "readFileToByteArray", "assertTrue", "deleteDirectory"]}, "focal_class": {"identifier": "MainInstrumentMojo", "superclass": "extends AbstractInstrumentMojo", "interfaces": "", "fields": [], "methods": [{"identifier": "execute", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void execute()", "full_signature": "@Override public void execute()", "class_method_signature": "MainInstrumentMojo.execute()", "testcase": false, "constructor": false}], "file": "maven-plugin/src/main/java/com/offbynull/coroutines/mavenplugin/MainInstrumentMojo.java"}, "focal_method": {"identifier": "execute", "parameters": "()", "modifiers": "@Override public", "return": "void", "body": "@Override\n    public void execute() throws MojoExecutionException, MojoFailureException {\n        Log log = getLog();\n\n        File mainOutputFolder = new File(getProject().getBuild().getOutputDirectory());\n        if (!mainOutputFolder.isDirectory()) {\n            log.warn(\"Main folder doesn't exist -- nothing to instrument\");\n            return;\n        }\n        \n        List<String> classpath;\n        try {\n            classpath = getProject().getCompileClasspathElements();\n        } catch (DependencyResolutionRequiredException ex) {\n            throw new MojoExecutionException(\"Dependency resolution problem\", ex);\n        }\n\n        log.debug(\"Processing main output folder ... \");\n        instrumentPath(log, classpath, mainOutputFolder);\n    }", "signature": "void execute()", "full_signature": "@Override public void execute()", "class_method_signature": "MainInstrumentMojo.execute()", "testcase": false, "constructor": false, "invocations": ["getLog", "getOutputDirectory", "getBuild", "getProject", "isDirectory", "warn", "getCompileClasspathElements", "getProject", "debug", "instrumentPath"]}, "repository": {"repo_id": 31940141, "url": "https://github.com/offbynull/coroutines", "language": "Java", "is_fork": false, "fork_count": 45, "stargazer_count": 287, "size": 841, "license": "licensed"}}