{"test_class": {"identifier": "PreferenceSaverTest", "superclass": "", "interfaces": "", "fields": [], "file": "collect_app/src/test/java/org/odk/collect/android/preferences/PreferenceSaverTest.java"}, "test_case": {"identifier": "fromJSON_whenPreferencesAreInvalid_DoesNotSaveOrResetGeneralKeys", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void fromJSON_whenPreferencesAreInvalid_DoesNotSaveOrResetGeneralKeys() throws Exception {\n        JSONObject content = new JSONObject();\n        JSONObject general = new JSONObject();\n        content.put(\"general\", general);\n        content.put(\"admin\", new JSONObject());\n        general.put(KEY_PASSWORD, false);\n\n        GeneralSharedPreferences generalSharedPreferences = mock(GeneralSharedPreferences.class);\n        new PreferenceSaver(generalSharedPreferences, AdminSharedPreferences.getInstance()).fromJSON(content.toString(), mock(ActionListener.class));\n\n        verify(generalSharedPreferences, never()).save(any(), any());\n        verify(generalSharedPreferences, never()).reset(any());\n    }", "signature": "void fromJSON_whenPreferencesAreInvalid_DoesNotSaveOrResetGeneralKeys()", "full_signature": "@Test public void fromJSON_whenPreferencesAreInvalid_DoesNotSaveOrResetGeneralKeys()", "class_method_signature": "PreferenceSaverTest.fromJSON_whenPreferencesAreInvalid_DoesNotSaveOrResetGeneralKeys()", "testcase": true, "constructor": false, "invocations": ["put", "put", "put", "mock", "fromJSON", "getInstance", "toString", "mock", "save", "verify", "never", "any", "any", "reset", "verify", "never", "any"]}, "focal_class": {"identifier": "PreferenceSaver", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final GeneralSharedPreferences generalSharedPreferences;", "modifier": "private final", "type": "GeneralSharedPreferences", "declarator": "generalSharedPreferences", "var_name": "generalSharedPreferences"}, {"original_string": "private final AdminSharedPreferences adminSharedPreferences;", "modifier": "private final", "type": "AdminSharedPreferences", "declarator": "adminSharedPreferences", "var_name": "adminSharedPreferences"}], "methods": [{"identifier": "PreferenceSaver", "parameters": "(GeneralSharedPreferences generalSharedPreferences, AdminSharedPreferences adminSharedPreferences)", "modifiers": "public", "return": "", "signature": " PreferenceSaver(GeneralSharedPreferences generalSharedPreferences, AdminSharedPreferences adminSharedPreferences)", "full_signature": "public  PreferenceSaver(GeneralSharedPreferences generalSharedPreferences, AdminSharedPreferences adminSharedPreferences)", "class_method_signature": "PreferenceSaver.PreferenceSaver(GeneralSharedPreferences generalSharedPreferences, AdminSharedPreferences adminSharedPreferences)", "testcase": false, "constructor": true}, {"identifier": "fromJSON", "parameters": "(String content, @Nullable ActionListener listener)", "modifiers": "public", "return": "void", "signature": "void fromJSON(String content, @Nullable ActionListener listener)", "full_signature": "public void fromJSON(String content, @Nullable ActionListener listener)", "class_method_signature": "PreferenceSaver.fromJSON(String content, @Nullable ActionListener listener)", "testcase": false, "constructor": false}, {"identifier": "saveGeneralPrefs", "parameters": "(GeneralSharedPreferences generalSharedPreferences, Map<String, Object> generalPrefs)", "modifiers": "public static", "return": "void", "signature": "void saveGeneralPrefs(GeneralSharedPreferences generalSharedPreferences, Map<String, Object> generalPrefs)", "full_signature": "public static void saveGeneralPrefs(GeneralSharedPreferences generalSharedPreferences, Map<String, Object> generalPrefs)", "class_method_signature": "PreferenceSaver.saveGeneralPrefs(GeneralSharedPreferences generalSharedPreferences, Map<String, Object> generalPrefs)", "testcase": false, "constructor": false}, {"identifier": "saveAdminPrefs", "parameters": "(AdminSharedPreferences adminSharedPreferences, Map<String, Object> adminPrefsJson)", "modifiers": "public static", "return": "void", "signature": "void saveAdminPrefs(AdminSharedPreferences adminSharedPreferences, Map<String, Object> adminPrefsJson)", "full_signature": "public static void saveAdminPrefs(AdminSharedPreferences adminSharedPreferences, Map<String, Object> adminPrefsJson)", "class_method_signature": "PreferenceSaver.saveAdminPrefs(AdminSharedPreferences adminSharedPreferences, Map<String, Object> adminPrefsJson)", "testcase": false, "constructor": false}, {"identifier": "convertJSONToMap", "parameters": "(JSONObject json)", "modifiers": "private static", "return": "Map<String, Object>", "signature": "Map<String, Object> convertJSONToMap(JSONObject json)", "full_signature": "private static Map<String, Object> convertJSONToMap(JSONObject json)", "class_method_signature": "PreferenceSaver.convertJSONToMap(JSONObject json)", "testcase": false, "constructor": false}, {"identifier": "getAllGeneralKeys", "parameters": "()", "modifiers": "private static", "return": "Collection<String>", "signature": "Collection<String> getAllGeneralKeys()", "full_signature": "private static Collection<String> getAllGeneralKeys()", "class_method_signature": "PreferenceSaver.getAllGeneralKeys()", "testcase": false, "constructor": false}, {"identifier": "getAllAdminKeys", "parameters": "()", "modifiers": "private static", "return": "Collection<String>", "signature": "Collection<String> getAllAdminKeys()", "full_signature": "private static Collection<String> getAllAdminKeys()", "class_method_signature": "PreferenceSaver.getAllAdminKeys()", "testcase": false, "constructor": false}], "file": "collect_app/src/main/java/org/odk/collect/android/preferences/PreferenceSaver.java"}, "focal_method": {"identifier": "fromJSON", "parameters": "(String content, @Nullable ActionListener listener)", "modifiers": "public", "return": "void", "body": "public void fromJSON(String content, @Nullable ActionListener listener) {\n        try {\n            JSONObject settingsJson = new JSONObject(content);\n            Map<String, Object> generalPrefs = convertJSONToMap(settingsJson.getJSONObject(\"general\"));\n            Map<String, Object> adminPrefsJson = convertJSONToMap(settingsJson.getJSONObject(\"admin\"));\n\n            if (!(new PreferenceValidator(GENERAL_KEYS).isValid(generalPrefs))) {\n                if (listener != null) {\n                    listener.onFailure(new GeneralSharedPreferences.ValidationException());\n                }\n\n                return;\n            }\n\n            saveGeneralPrefs(generalSharedPreferences, generalPrefs);\n            saveAdminPrefs(adminSharedPreferences, adminPrefsJson);\n\n            AutoSendPreferenceMigrator.migrate(settingsJson.getJSONObject(\"general\"));\n\n            if (listener != null) {\n                listener.onSuccess();\n            }\n        } catch (JSONException exception) {\n            if (listener != null) {\n                listener.onFailure(exception);\n            }\n        }\n    }", "signature": "void fromJSON(String content, @Nullable ActionListener listener)", "full_signature": "public void fromJSON(String content, @Nullable ActionListener listener)", "class_method_signature": "PreferenceSaver.fromJSON(String content, @Nullable ActionListener listener)", "testcase": false, "constructor": false, "invocations": ["convertJSONToMap", "getJSONObject", "convertJSONToMap", "getJSONObject", "isValid", "onFailure", "saveGeneralPrefs", "saveAdminPrefs", "migrate", "getJSONObject", "onSuccess", "onFailure"]}, "repository": {"repo_id": 166636413, "url": "https://github.com/fieldsight/fieldsight-mobile", "language": "Java", "is_fork": false, "fork_count": 4, "stargazer_count": 14, "size": 41030, "license": "licensed"}}