{"test_class": {"identifier": "HttpServletRequestWrapperTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "HttpServletRequest request = mock(HttpServletRequest.class);", "modifier": "", "type": "HttpServletRequest", "declarator": "request = mock(HttpServletRequest.class)", "var_name": "request"}, {"original_string": "HttpServletRequestWrapper wrapper =\n    (HttpServletRequestWrapper) HttpServletRequestWrapper.create(request);", "modifier": "", "type": "HttpServletRequestWrapper", "declarator": "wrapper =\n    (HttpServletRequestWrapper) HttpServletRequestWrapper.create(request)", "var_name": "wrapper"}, {"original_string": "Span span = mock(Span.class);", "modifier": "", "type": "Span", "declarator": "span = mock(Span.class)", "var_name": "span"}], "file": "instrumentation/servlet/src/test/java/brave/servlet/HttpServletRequestWrapperTest.java"}, "test_case": {"identifier": "parseClientIpAndPort_prefersXForwardedFor", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test public void parseClientIpAndPort_prefersXForwardedFor() {\n    when(span.remoteIpAndPort(\"1.2.3.4\", 0)).thenReturn(true);\n    when(request.getHeader(\"X-Forwarded-For\")).thenReturn(\"1.2.3.4\");\n\n    wrapper.parseClientIpAndPort(span);\n\n    verify(span).remoteIpAndPort(\"1.2.3.4\", 0);\n    verifyNoMoreInteractions(span);\n  }", "signature": "void parseClientIpAndPort_prefersXForwardedFor()", "full_signature": "@Test public void parseClientIpAndPort_prefersXForwardedFor()", "class_method_signature": "HttpServletRequestWrapperTest.parseClientIpAndPort_prefersXForwardedFor()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "remoteIpAndPort", "thenReturn", "when", "getHeader", "parseClientIpAndPort", "remoteIpAndPort", "verify", "verifyNoMoreInteractions"]}, "focal_class": {"identifier": "HttpServletRequestWrapper", "superclass": "extends HttpServerRequest", "interfaces": "", "fields": [{"original_string": "final HttpServletRequest delegate;", "modifier": "final", "type": "HttpServletRequest", "declarator": "delegate", "var_name": "delegate"}], "methods": [{"identifier": "create", "parameters": "(HttpServletRequest request)", "modifiers": "public static", "return": "HttpServerRequest", "signature": "HttpServerRequest create(HttpServletRequest request)", "full_signature": "public static HttpServerRequest create(HttpServletRequest request)", "class_method_signature": "HttpServletRequestWrapper.create(HttpServletRequest request)", "testcase": false, "constructor": false}, {"identifier": "HttpServletRequestWrapper", "parameters": "(HttpServletRequest delegate)", "modifiers": "", "return": "", "signature": " HttpServletRequestWrapper(HttpServletRequest delegate)", "full_signature": "  HttpServletRequestWrapper(HttpServletRequest delegate)", "class_method_signature": "HttpServletRequestWrapper.HttpServletRequestWrapper(HttpServletRequest delegate)", "testcase": false, "constructor": true}, {"identifier": "unwrap", "parameters": "()", "modifiers": "@Override public final", "return": "Object", "signature": "Object unwrap()", "full_signature": "@Override public final Object unwrap()", "class_method_signature": "HttpServletRequestWrapper.unwrap()", "testcase": false, "constructor": false}, {"identifier": "parseClientIpAndPort", "parameters": "(Span span)", "modifiers": "@Override public", "return": "boolean", "signature": "boolean parseClientIpAndPort(Span span)", "full_signature": "@Override public boolean parseClientIpAndPort(Span span)", "class_method_signature": "HttpServletRequestWrapper.parseClientIpAndPort(Span span)", "testcase": false, "constructor": false}, {"identifier": "method", "parameters": "()", "modifiers": "@Override public final", "return": "String", "signature": "String method()", "full_signature": "@Override public final String method()", "class_method_signature": "HttpServletRequestWrapper.method()", "testcase": false, "constructor": false}, {"identifier": "route", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String route()", "full_signature": "@Override public String route()", "class_method_signature": "HttpServletRequestWrapper.route()", "testcase": false, "constructor": false}, {"identifier": "path", "parameters": "()", "modifiers": "@Override public final", "return": "String", "signature": "String path()", "full_signature": "@Override public final String path()", "class_method_signature": "HttpServletRequestWrapper.path()", "testcase": false, "constructor": false}, {"identifier": "url", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String url()", "full_signature": "@Override public String url()", "class_method_signature": "HttpServletRequestWrapper.url()", "testcase": false, "constructor": false}, {"identifier": "header", "parameters": "(String name)", "modifiers": "@Override public final", "return": "String", "signature": "String header(String name)", "full_signature": "@Override public final String header(String name)", "class_method_signature": "HttpServletRequestWrapper.header(String name)", "testcase": false, "constructor": false}, {"identifier": "maybeError", "parameters": "()", "modifiers": "@Nullable", "return": "Throwable", "signature": "Throwable maybeError()", "full_signature": "@Nullable Throwable maybeError()", "class_method_signature": "HttpServletRequestWrapper.maybeError()", "testcase": false, "constructor": false}], "file": "instrumentation/servlet/src/main/java/brave/servlet/HttpServletRequestWrapper.java"}, "focal_method": {"identifier": "parseClientIpAndPort", "parameters": "(Span span)", "modifiers": "@Override public", "return": "boolean", "body": "@Override public boolean parseClientIpAndPort(Span span) {\n    if (parseClientIpFromXForwardedFor(span)) return true;\n    return span.remoteIpAndPort(delegate.getRemoteAddr(), delegate.getRemotePort());\n  }", "signature": "boolean parseClientIpAndPort(Span span)", "full_signature": "@Override public boolean parseClientIpAndPort(Span span)", "class_method_signature": "HttpServletRequestWrapper.parseClientIpAndPort(Span span)", "testcase": false, "constructor": false, "invocations": ["parseClientIpFromXForwardedFor", "remoteIpAndPort", "getRemoteAddr", "getRemotePort"]}, "repository": {"repo_id": 9278888, "url": "https://github.com/openzipkin/brave", "stars": 1754, "created": "4/7/2013 3:48:18 PM +00:00", "updates": "2020-01-26T11:52:41+00:00", "fork": "False", "license": "licensed"}}