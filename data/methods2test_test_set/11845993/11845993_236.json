{"test_class": {"identifier": "ElasticsearchClientTest", "superclass": "extends AbstractElasticsearchTest", "interfaces": "", "fields": [{"original_string": "private ListAppender<ILoggingEvent> testAppender;", "modifier": "private", "type": "ListAppender<ILoggingEvent>", "declarator": "testAppender", "var_name": "testAppender"}], "file": "stagemonitor-core/src/test/java/org/stagemonitor/core/elasticsearch/ElasticsearchClientTest.java"}, "test_case": {"identifier": "testSuccessfulBulkRequest", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testSuccessfulBulkRequest() {\n\t\telasticsearchClient.sendBulk(os ->\n\t\t\t\tos.write((\"{ \\\"index\\\" : { \\\"_index\\\" : \\\"test\\\", \\\"_type\\\" : \\\"type1\\\", \\\"_id\\\" : \\\"1\\\" } }\\n\" +\n\t\t\t\t\t\t\"{ \\\"field1\\\" : \\\"value1\\\" }\\n\").getBytes(\"UTF-8\")));\n\t\tassertThat(testAppender.list).hasSize(0);\n\t}", "signature": "void testSuccessfulBulkRequest()", "full_signature": "@Test public void testSuccessfulBulkRequest()", "class_method_signature": "ElasticsearchClientTest.testSuccessfulBulkRequest()", "testcase": true, "constructor": false, "invocations": ["sendBulk", "write", "getBytes", "hasSize", "assertThat"]}, "focal_class": {"identifier": "ElasticsearchClient", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final Map<String, String> CONTENT_TYPE_NDJSON = Collections.singletonMap(\"Content-Type\", \"application/x-ndjson\");", "modifier": "public static final", "type": "Map<String, String>", "declarator": "CONTENT_TYPE_NDJSON = Collections.singletonMap(\"Content-Type\", \"application/x-ndjson\")", "var_name": "CONTENT_TYPE_NDJSON"}, {"original_string": "private static final String BULK = \"/_bulk\";", "modifier": "private static final", "type": "String", "declarator": "BULK = \"/_bulk\"", "var_name": "BULK"}, {"original_string": "private final Logger logger = LoggerFactory.getLogger(ElasticsearchClient.class);", "modifier": "private final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(ElasticsearchClient.class)", "var_name": "logger"}, {"original_string": "private final String TITLE = \"title\";", "modifier": "private final", "type": "String", "declarator": "TITLE = \"title\"", "var_name": "TITLE"}, {"original_string": "private final HttpClient httpClient;", "modifier": "private final", "type": "HttpClient", "declarator": "httpClient", "var_name": "httpClient"}, {"original_string": "private final CorePlugin corePlugin;", "modifier": "private final", "type": "CorePlugin", "declarator": "corePlugin", "var_name": "corePlugin"}, {"original_string": "private final AtomicBoolean elasticsearchAvailable = new AtomicBoolean(false);", "modifier": "private final", "type": "AtomicBoolean", "declarator": "elasticsearchAvailable = new AtomicBoolean(false)", "var_name": "elasticsearchAvailable"}, {"original_string": "private final CheckEsAvailability checkEsAvailability;", "modifier": "private final", "type": "CheckEsAvailability", "declarator": "checkEsAvailability", "var_name": "checkEsAvailability"}, {"original_string": "private Integer esMajorVersion;", "modifier": "private", "type": "Integer", "declarator": "esMajorVersion", "var_name": "esMajorVersion"}, {"original_string": "private final ThreadPoolExecutor asyncESPool;", "modifier": "private final", "type": "ThreadPoolExecutor", "declarator": "asyncESPool", "var_name": "asyncESPool"}, {"original_string": "private Timer timer;", "modifier": "private", "type": "Timer", "declarator": "timer", "var_name": "timer"}], "methods": [{"identifier": "ElasticsearchClient", "parameters": "(final CorePlugin corePlugin, final HttpClient httpClient, int esAvailabilityCheckIntervalSec, List<ElasticsearchAvailabilityObserver> elasticsearchAvailabilityObservers)", "modifiers": "public", "return": "", "signature": " ElasticsearchClient(final CorePlugin corePlugin, final HttpClient httpClient, int esAvailabilityCheckIntervalSec, List<ElasticsearchAvailabilityObserver> elasticsearchAvailabilityObservers)", "full_signature": "public  ElasticsearchClient(final CorePlugin corePlugin, final HttpClient httpClient, int esAvailabilityCheckIntervalSec, List<ElasticsearchAvailabilityObserver> elasticsearchAvailabilityObservers)", "class_method_signature": "ElasticsearchClient.ElasticsearchClient(final CorePlugin corePlugin, final HttpClient httpClient, int esAvailabilityCheckIntervalSec, List<ElasticsearchAvailabilityObserver> elasticsearchAvailabilityObservers)", "testcase": false, "constructor": true}, {"identifier": "isElasticsearch7Compatible", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isElasticsearch7Compatible()", "full_signature": "public boolean isElasticsearch7Compatible()", "class_method_signature": "ElasticsearchClient.isElasticsearch7Compatible()", "testcase": false, "constructor": false}, {"identifier": "isElasticsearch6Compatible", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isElasticsearch6Compatible()", "full_signature": "public boolean isElasticsearch6Compatible()", "class_method_signature": "ElasticsearchClient.isElasticsearch6Compatible()", "testcase": false, "constructor": false}, {"identifier": "getElasticSearchTemplateResourcePath", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getElasticSearchTemplateResourcePath()", "full_signature": "public String getElasticSearchTemplateResourcePath()", "class_method_signature": "ElasticsearchClient.getElasticSearchTemplateResourcePath()", "testcase": false, "constructor": false}, {"identifier": "getKibanaResourcePath", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getKibanaResourcePath()", "full_signature": "public String getKibanaResourcePath()", "class_method_signature": "ElasticsearchClient.getKibanaResourcePath()", "testcase": false, "constructor": false}, {"identifier": "getJson", "parameters": "(final String path)", "modifiers": "public", "return": "JsonNode", "signature": "JsonNode getJson(final String path)", "full_signature": "public JsonNode getJson(final String path)", "class_method_signature": "ElasticsearchClient.getJson(final String path)", "testcase": false, "constructor": false}, {"identifier": "getJson", "parameters": "(final String path, final boolean suppressWarning)", "modifiers": "public", "return": "JsonNode", "signature": "JsonNode getJson(final String path, final boolean suppressWarning)", "full_signature": "public JsonNode getJson(final String path, final boolean suppressWarning)", "class_method_signature": "ElasticsearchClient.getJson(final String path, final boolean suppressWarning)", "testcase": false, "constructor": false}, {"identifier": "getObject", "parameters": "(final String path, Class<T> type)", "modifiers": "public", "return": "T", "signature": "T getObject(final String path, Class<T> type)", "full_signature": "public T getObject(final String path, Class<T> type)", "class_method_signature": "ElasticsearchClient.getObject(final String path, Class<T> type)", "testcase": false, "constructor": false}, {"identifier": "getAll", "parameters": "(String path, int limit, Class<T> clazz)", "modifiers": "public", "return": "Collection<T>", "signature": "Collection<T> getAll(String path, int limit, Class<T> clazz)", "full_signature": "public Collection<T> getAll(String path, int limit, Class<T> clazz)", "class_method_signature": "ElasticsearchClient.getAll(String path, int limit, Class<T> clazz)", "testcase": false, "constructor": false}, {"identifier": "delete", "parameters": "(final String path)", "modifiers": "public", "return": "int", "signature": "int delete(final String path)", "full_signature": "public int delete(final String path)", "class_method_signature": "ElasticsearchClient.delete(final String path)", "testcase": false, "constructor": false}, {"identifier": "sendAsJson", "parameters": "(final String method, final String path, final Object requestBody)", "modifiers": "public", "return": "int", "signature": "int sendAsJson(final String method, final String path, final Object requestBody)", "full_signature": "public int sendAsJson(final String method, final String path, final Object requestBody)", "class_method_signature": "ElasticsearchClient.sendAsJson(final String method, final String path, final Object requestBody)", "testcase": false, "constructor": false}, {"identifier": "updateKibanaIndexPattern", "parameters": "(final String indexName, final String indexPatternLocation)", "modifiers": "public", "return": "void", "signature": "void updateKibanaIndexPattern(final String indexName, final String indexPatternLocation)", "full_signature": "public void updateKibanaIndexPattern(final String indexName, final String indexPatternLocation)", "class_method_signature": "ElasticsearchClient.updateKibanaIndexPattern(final String indexName, final String indexPatternLocation)", "testcase": false, "constructor": false}, {"identifier": "fetchCurrentKibanaIndexPatternConfiguration", "parameters": "(String elasticsearchKibanaIndexPatternPath)", "modifiers": "private", "return": "JsonNode", "signature": "JsonNode fetchCurrentKibanaIndexPatternConfiguration(String elasticsearchKibanaIndexPatternPath)", "full_signature": "private JsonNode fetchCurrentKibanaIndexPatternConfiguration(String elasticsearchKibanaIndexPatternPath)", "class_method_signature": "ElasticsearchClient.fetchCurrentKibanaIndexPatternConfiguration(String elasticsearchKibanaIndexPatternPath)", "testcase": false, "constructor": false}, {"identifier": "getFields", "parameters": "(String fieldsJsonPath)", "modifiers": "private", "return": "String", "signature": "String getFields(String fieldsJsonPath)", "full_signature": "private String getFields(String fieldsJsonPath)", "class_method_signature": "ElasticsearchClient.getFields(String fieldsJsonPath)", "testcase": false, "constructor": false}, {"identifier": "sendMappingTemplate", "parameters": "(String mappingJson, String templateName)", "modifiers": "public", "return": "void", "signature": "void sendMappingTemplate(String mappingJson, String templateName)", "full_signature": "public void sendMappingTemplate(String mappingJson, String templateName)", "class_method_signature": "ElasticsearchClient.sendMappingTemplate(String mappingJson, String templateName)", "testcase": false, "constructor": false}, {"identifier": "modifyIndexTemplate", "parameters": "(String templatePath, int moveToColdNodesAfterDays, Integer numberOfReplicas, Integer numberOfShards)", "modifiers": "public static", "return": "String", "signature": "String modifyIndexTemplate(String templatePath, int moveToColdNodesAfterDays, Integer numberOfReplicas, Integer numberOfShards)", "full_signature": "public static String modifyIndexTemplate(String templatePath, int moveToColdNodesAfterDays, Integer numberOfReplicas, Integer numberOfShards)", "class_method_signature": "ElasticsearchClient.modifyIndexTemplate(String templatePath, int moveToColdNodesAfterDays, Integer numberOfReplicas, Integer numberOfShards)", "testcase": false, "constructor": false}, {"identifier": "sendMetricDashboardBulkAsync", "parameters": "(final String resource)", "modifiers": "public", "return": "void", "signature": "void sendMetricDashboardBulkAsync(final String resource)", "full_signature": "public void sendMetricDashboardBulkAsync(final String resource)", "class_method_signature": "ElasticsearchClient.sendMetricDashboardBulkAsync(final String resource)", "testcase": false, "constructor": false}, {"identifier": "sendSpanDashboardBulkAsync", "parameters": "(final String resource, boolean logBulkErrors)", "modifiers": "public", "return": "void", "signature": "void sendSpanDashboardBulkAsync(final String resource, boolean logBulkErrors)", "full_signature": "public void sendSpanDashboardBulkAsync(final String resource, boolean logBulkErrors)", "class_method_signature": "ElasticsearchClient.sendSpanDashboardBulkAsync(final String resource, boolean logBulkErrors)", "testcase": false, "constructor": false}, {"identifier": "sendClassPathRessourceBulkAsync", "parameters": "(final String resource, boolean logBulkErrors)", "modifiers": "private", "return": "void", "signature": "void sendClassPathRessourceBulkAsync(final String resource, boolean logBulkErrors)", "full_signature": "private void sendClassPathRessourceBulkAsync(final String resource, boolean logBulkErrors)", "class_method_signature": "ElasticsearchClient.sendClassPathRessourceBulkAsync(final String resource, boolean logBulkErrors)", "testcase": false, "constructor": false}, {"identifier": "sendBulkAsync", "parameters": "(final HttpClient.OutputStreamHandler outputStreamHandler, final boolean logBulkErrors)", "modifiers": "private", "return": "void", "signature": "void sendBulkAsync(final HttpClient.OutputStreamHandler outputStreamHandler, final boolean logBulkErrors)", "full_signature": "private void sendBulkAsync(final HttpClient.OutputStreamHandler outputStreamHandler, final boolean logBulkErrors)", "class_method_signature": "ElasticsearchClient.sendBulkAsync(final HttpClient.OutputStreamHandler outputStreamHandler, final boolean logBulkErrors)", "testcase": false, "constructor": false}, {"identifier": "sendBulk", "parameters": "(HttpClient.OutputStreamHandler outputStreamHandler)", "modifiers": "", "return": "void", "signature": "void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler)", "full_signature": " void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler)", "class_method_signature": "ElasticsearchClient.sendBulk(HttpClient.OutputStreamHandler outputStreamHandler)", "testcase": false, "constructor": false}, {"identifier": "sendBulk", "parameters": "(HttpClient.OutputStreamHandler outputStreamHandler, boolean logBulkErrors)", "modifiers": "private", "return": "void", "signature": "void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler, boolean logBulkErrors)", "full_signature": "private void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler, boolean logBulkErrors)", "class_method_signature": "ElasticsearchClient.sendBulk(HttpClient.OutputStreamHandler outputStreamHandler, boolean logBulkErrors)", "testcase": false, "constructor": false}, {"identifier": "deleteIndices", "parameters": "(String indexPattern)", "modifiers": "public", "return": "void", "signature": "void deleteIndices(String indexPattern)", "full_signature": "public void deleteIndices(String indexPattern)", "class_method_signature": "ElasticsearchClient.deleteIndices(String indexPattern)", "testcase": false, "constructor": false}, {"identifier": "forceMergeIndices", "parameters": "(String indexPattern)", "modifiers": "public", "return": "void", "signature": "void forceMergeIndices(String indexPattern)", "full_signature": "public void forceMergeIndices(String indexPattern)", "class_method_signature": "ElasticsearchClient.forceMergeIndices(String indexPattern)", "testcase": false, "constructor": false}, {"identifier": "updateIndexSettings", "parameters": "(String indexPattern, final Map<String, ?> settings)", "modifiers": "public", "return": "void", "signature": "void updateIndexSettings(String indexPattern, final Map<String, ?> settings)", "full_signature": "public void updateIndexSettings(String indexPattern, final Map<String, ?> settings)", "class_method_signature": "ElasticsearchClient.updateIndexSettings(String indexPattern, final Map<String, ?> settings)", "testcase": false, "constructor": false}, {"identifier": "execute", "parameters": "(String method, String path, String logMessage)", "modifiers": "private", "return": "void", "signature": "void execute(String method, String path, String logMessage)", "full_signature": "private void execute(String method, String path, String logMessage)", "class_method_signature": "ElasticsearchClient.execute(String method, String path, String logMessage)", "testcase": false, "constructor": false}, {"identifier": "getDashboardForElasticsearch", "parameters": "(String dashboardPath)", "modifiers": "", "return": "ObjectNode", "signature": "ObjectNode getDashboardForElasticsearch(String dashboardPath)", "full_signature": " ObjectNode getDashboardForElasticsearch(String dashboardPath)", "class_method_signature": "ElasticsearchClient.getDashboardForElasticsearch(String dashboardPath)", "testcase": false, "constructor": false}, {"identifier": "waitForCompletion", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void waitForCompletion()", "full_signature": "public void waitForCompletion()", "class_method_signature": "ElasticsearchClient.waitForCompletion()", "testcase": false, "constructor": false}, {"identifier": "close", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void close()", "full_signature": "public void close()", "class_method_signature": "ElasticsearchClient.close()", "testcase": false, "constructor": false}, {"identifier": "scheduleIndexManagement", "parameters": "(String indexPrefix, int optimizeAndMoveIndicesToColdNodesOlderThanDays, int deleteIndicesOlderThanDays)", "modifiers": "public", "return": "void", "signature": "void scheduleIndexManagement(String indexPrefix, int optimizeAndMoveIndicesToColdNodesOlderThanDays, int deleteIndicesOlderThanDays)", "full_signature": "public void scheduleIndexManagement(String indexPrefix, int optimizeAndMoveIndicesToColdNodesOlderThanDays, int deleteIndicesOlderThanDays)", "class_method_signature": "ElasticsearchClient.scheduleIndexManagement(String indexPrefix, int optimizeAndMoveIndicesToColdNodesOlderThanDays, int deleteIndicesOlderThanDays)", "testcase": false, "constructor": false}, {"identifier": "getBulkHeader", "parameters": "(String action, String index, String type)", "modifiers": "public static", "return": "String", "signature": "String getBulkHeader(String action, String index, String type)", "full_signature": "public static String getBulkHeader(String action, String index, String type)", "class_method_signature": "ElasticsearchClient.getBulkHeader(String action, String index, String type)", "testcase": false, "constructor": false}, {"identifier": "isElasticsearchAvailable", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean isElasticsearchAvailable()", "full_signature": "public boolean isElasticsearchAvailable()", "class_method_signature": "ElasticsearchClient.isElasticsearchAvailable()", "testcase": false, "constructor": false}, {"identifier": "getHttpClient", "parameters": "()", "modifiers": "public", "return": "HttpClient", "signature": "HttpClient getHttpClient()", "full_signature": "public HttpClient getHttpClient()", "class_method_signature": "ElasticsearchClient.getHttpClient()", "testcase": false, "constructor": false}, {"identifier": "getElasticsearchUrl", "parameters": "()", "modifiers": "public", "return": "URL", "signature": "URL getElasticsearchUrl()", "full_signature": "public URL getElasticsearchUrl()", "class_method_signature": "ElasticsearchClient.getElasticsearchUrl()", "testcase": false, "constructor": false}, {"identifier": "createIndexAndSendMapping", "parameters": "(final String index, final String type, final InputStream mapping)", "modifiers": "public", "return": "void", "signature": "void createIndexAndSendMapping(final String index, final String type, final InputStream mapping)", "full_signature": "public void createIndexAndSendMapping(final String index, final String type, final InputStream mapping)", "class_method_signature": "ElasticsearchClient.createIndexAndSendMapping(final String index, final String type, final InputStream mapping)", "testcase": false, "constructor": false}, {"identifier": "createIndexIfNotExists", "parameters": "(String indexName)", "modifiers": "private", "return": "void", "signature": "void createIndexIfNotExists(String indexName)", "full_signature": "private void createIndexIfNotExists(String indexName)", "class_method_signature": "ElasticsearchClient.createIndexIfNotExists(String indexName)", "testcase": false, "constructor": false}, {"identifier": "sendMapping", "parameters": "(String index, String type, InputStream mapping)", "modifiers": "private", "return": "void", "signature": "void sendMapping(String index, String type, InputStream mapping)", "full_signature": "private void sendMapping(String index, String type, InputStream mapping)", "class_method_signature": "ElasticsearchClient.sendMapping(String index, String type, InputStream mapping)", "testcase": false, "constructor": false}, {"identifier": "createEmptyIndex", "parameters": "(String indexName)", "modifiers": "public", "return": "void", "signature": "void createEmptyIndex(String indexName)", "full_signature": "public void createEmptyIndex(String indexName)", "class_method_signature": "ElasticsearchClient.createEmptyIndex(String indexName)", "testcase": false, "constructor": false}, {"identifier": "checkEsAvailability", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void checkEsAvailability()", "full_signature": "public void checkEsAvailability()", "class_method_signature": "ElasticsearchClient.checkEsAvailability()", "testcase": false, "constructor": false}], "file": "stagemonitor-core/src/main/java/org/stagemonitor/core/elasticsearch/ElasticsearchClient.java"}, "focal_method": {"identifier": "sendBulk", "parameters": "(HttpClient.OutputStreamHandler outputStreamHandler)", "modifiers": "", "return": "void", "body": "void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler) {\n\t\tsendBulk(outputStreamHandler, true);\n\t}", "signature": "void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler)", "full_signature": " void sendBulk(HttpClient.OutputStreamHandler outputStreamHandler)", "class_method_signature": "ElasticsearchClient.sendBulk(HttpClient.OutputStreamHandler outputStreamHandler)", "testcase": false, "constructor": false, "invocations": ["sendBulk"]}, "repository": {"repo_id": 11845993, "url": "https://github.com/stagemonitor/stagemonitor", "language": "Java", "is_fork": false, "fork_count": 268, "stargazer_count": 1585, "size": 10342, "license": "licensed"}}