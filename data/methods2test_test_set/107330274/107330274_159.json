{"test_class": {"identifier": "DefaultOneOffReconcilerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Duration QUICK_CYCLE = Duration.ofMillis(1);", "modifier": "private static final", "type": "Duration", "declarator": "QUICK_CYCLE = Duration.ofMillis(1)", "var_name": "QUICK_CYCLE"}, {"original_string": "private static final Duration LONG_CYCLE = Duration.ofMillis(2);", "modifier": "private static final", "type": "Duration", "declarator": "LONG_CYCLE = Duration.ofMillis(2)", "var_name": "LONG_CYCLE"}, {"original_string": "private static final Duration TIMEOUT = Duration.ofSeconds(30);", "modifier": "private static final", "type": "Duration", "declarator": "TIMEOUT = Duration.ofSeconds(30)", "var_name": "TIMEOUT"}, {"original_string": "private static final String INITIAL = \"initial\";", "modifier": "private static final", "type": "String", "declarator": "INITIAL = \"initial\"", "var_name": "INITIAL"}, {"original_string": "private static final String RECONCILED = \"Reconciled\";", "modifier": "private static final", "type": "String", "declarator": "RECONCILED = \"Reconciled\"", "var_name": "RECONCILED"}, {"original_string": "private final TitusRuntime titusRuntime = TitusRuntimes.internal();", "modifier": "private final", "type": "TitusRuntime", "declarator": "titusRuntime = TitusRuntimes.internal()", "var_name": "titusRuntime"}, {"original_string": "private DefaultOneOffReconciler<String> reconciler;", "modifier": "private", "type": "DefaultOneOffReconciler<String>", "declarator": "reconciler", "var_name": "reconciler"}, {"original_string": "private TitusRxSubscriber<String> changesSubscriber;", "modifier": "private", "type": "TitusRxSubscriber<String>", "declarator": "changesSubscriber", "var_name": "changesSubscriber"}], "file": "titus-common/src/test/java/com/netflix/titus/common/framework/simplereconciler/internal/DefaultOneOffReconcilerTest.java"}, "test_case": {"identifier": "testExternalAction", "parameters": "()", "modifiers": "@Test(timeout = 30_000) public", "return": "void", "body": "@Test(timeout = 30_000)\n    public void testExternalAction() {\n        newReconciler(current -> Collections.emptyList());\n\n        assertThat(reconciler.apply(c -> Mono.just(\"update\")).block()).isEqualTo(\"update\");\n        assertThat(changesSubscriber.takeNext()).isEqualTo(\"update\");\n        assertThat(changesSubscriber.takeNext()).isNull();\n    }", "signature": "void testExternalAction()", "full_signature": "@Test(timeout = 30_000) public void testExternalAction()", "class_method_signature": "DefaultOneOffReconcilerTest.testExternalAction()", "testcase": true, "constructor": false, "invocations": ["newReconciler", "emptyList", "isEqualTo", "assertThat", "block", "apply", "just", "isEqualTo", "assertThat", "takeNext", "isNull", "assertThat", "takeNext"]}, "focal_class": {"identifier": "DefaultOneOffReconciler", "superclass": "", "interfaces": "implements OneOffReconciler<DATA>", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(DefaultOneOffReconciler.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(DefaultOneOffReconciler.class)", "var_name": "logger"}, {"original_string": "private final long quickCycleMs;", "modifier": "private final", "type": "long", "declarator": "quickCycleMs", "var_name": "quickCycleMs"}, {"original_string": "private final long longCycleMs;", "modifier": "private final", "type": "long", "declarator": "longCycleMs", "var_name": "longCycleMs"}, {"original_string": "private final Clock clock;", "modifier": "private final", "type": "Clock", "declarator": "clock", "var_name": "clock"}, {"original_string": "private final TitusRuntime titusRuntime;", "modifier": "private final", "type": "TitusRuntime", "declarator": "titusRuntime", "var_name": "titusRuntime"}, {"original_string": "private final ReconcilerExecutorMetrics metrics;", "modifier": "private final", "type": "ReconcilerExecutorMetrics", "declarator": "metrics", "var_name": "metrics"}, {"original_string": "private final ReconcilerEngine<DATA> executor;", "modifier": "private final", "type": "ReconcilerEngine<DATA>", "declarator": "executor", "var_name": "executor"}, {"original_string": "private final Scheduler.Worker worker;", "modifier": "private final", "type": "Scheduler.Worker", "declarator": "worker", "var_name": "worker"}, {"original_string": "private volatile long lastLongCycleTimestamp;", "modifier": "private volatile", "type": "long", "declarator": "lastLongCycleTimestamp", "var_name": "lastLongCycleTimestamp"}, {"original_string": "private final ReplayProcessor<DATA> eventProcessor = ReplayProcessor.create(1);", "modifier": "private final", "type": "ReplayProcessor<DATA>", "declarator": "eventProcessor = ReplayProcessor.create(1)", "var_name": "eventProcessor"}, {"original_string": "private final Flux<DATA> eventStream = eventProcessor.compose(ReactorExt.badSubscriberHandler(logger));", "modifier": "private final", "type": "Flux<DATA>", "declarator": "eventStream = eventProcessor.compose(ReactorExt.badSubscriberHandler(logger))", "var_name": "eventStream"}], "methods": [{"identifier": "DefaultOneOffReconciler", "parameters": "(String id,\n                                   DATA initial,\n                                   Duration quickCycle,\n                                   Duration longCycle,\n                                   Function<DATA, List<Mono<Function<DATA, DATA>>>> reconcilerActionsProvider,\n                                   Scheduler scheduler,\n                                   TitusRuntime titusRuntime)", "modifiers": "public", "return": "", "signature": " DefaultOneOffReconciler(String id,\n                                   DATA initial,\n                                   Duration quickCycle,\n                                   Duration longCycle,\n                                   Function<DATA, List<Mono<Function<DATA, DATA>>>> reconcilerActionsProvider,\n                                   Scheduler scheduler,\n                                   TitusRuntime titusRuntime)", "full_signature": "public  DefaultOneOffReconciler(String id,\n                                   DATA initial,\n                                   Duration quickCycle,\n                                   Duration longCycle,\n                                   Function<DATA, List<Mono<Function<DATA, DATA>>>> reconcilerActionsProvider,\n                                   Scheduler scheduler,\n                                   TitusRuntime titusRuntime)", "class_method_signature": "DefaultOneOffReconciler.DefaultOneOffReconciler(String id,\n                                   DATA initial,\n                                   Duration quickCycle,\n                                   Duration longCycle,\n                                   Function<DATA, List<Mono<Function<DATA, DATA>>>> reconcilerActionsProvider,\n                                   Scheduler scheduler,\n                                   TitusRuntime titusRuntime)", "testcase": false, "constructor": true}, {"identifier": "close", "parameters": "()", "modifiers": "@Override public", "return": "Mono<Void>", "signature": "Mono<Void> close()", "full_signature": "@Override public Mono<Void> close()", "class_method_signature": "DefaultOneOffReconciler.close()", "testcase": false, "constructor": false}, {"identifier": "getCurrent", "parameters": "()", "modifiers": "@Override public", "return": "DATA", "signature": "DATA getCurrent()", "full_signature": "@Override public DATA getCurrent()", "class_method_signature": "DefaultOneOffReconciler.getCurrent()", "testcase": false, "constructor": false}, {"identifier": "apply", "parameters": "(Function<DATA, Mono<DATA>> action)", "modifiers": "@Override public", "return": "Mono<DATA>", "signature": "Mono<DATA> apply(Function<DATA, Mono<DATA>> action)", "full_signature": "@Override public Mono<DATA> apply(Function<DATA, Mono<DATA>> action)", "class_method_signature": "DefaultOneOffReconciler.apply(Function<DATA, Mono<DATA>> action)", "testcase": false, "constructor": false}, {"identifier": "changes", "parameters": "()", "modifiers": "@Override public", "return": "Flux<DATA>", "signature": "Flux<DATA> changes()", "full_signature": "@Override public Flux<DATA> changes()", "class_method_signature": "DefaultOneOffReconciler.changes()", "testcase": false, "constructor": false}, {"identifier": "doSchedule", "parameters": "(long delayMs)", "modifiers": "private", "return": "void", "signature": "void doSchedule(long delayMs)", "full_signature": "private void doSchedule(long delayMs)", "class_method_signature": "DefaultOneOffReconciler.doSchedule(long delayMs)", "testcase": false, "constructor": false}, {"identifier": "doLoop", "parameters": "(boolean fullReconciliationCycle)", "modifiers": "private", "return": "void", "signature": "void doLoop(boolean fullReconciliationCycle)", "full_signature": "private void doLoop(boolean fullReconciliationCycle)", "class_method_signature": "DefaultOneOffReconciler.doLoop(boolean fullReconciliationCycle)", "testcase": false, "constructor": false}], "file": "titus-common/src/main/java/com/netflix/titus/common/framework/simplereconciler/internal/DefaultOneOffReconciler.java"}, "focal_method": {"identifier": "apply", "parameters": "(Function<DATA, Mono<DATA>> action)", "modifiers": "@Override public", "return": "Mono<DATA>", "body": "@Override\n    public Mono<DATA> apply(Function<DATA, Mono<DATA>> action) {\n        return executor.apply(action);\n    }", "signature": "Mono<DATA> apply(Function<DATA, Mono<DATA>> action)", "full_signature": "@Override public Mono<DATA> apply(Function<DATA, Mono<DATA>> action)", "class_method_signature": "DefaultOneOffReconciler.apply(Function<DATA, Mono<DATA>> action)", "testcase": false, "constructor": false, "invocations": ["apply"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}