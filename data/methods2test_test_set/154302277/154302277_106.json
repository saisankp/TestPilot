{"test_class": {"identifier": "ScheduledTaskExecutorServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final DeviceMessageMetadata DEVICE_MESSAGE_DATA = new DeviceMessageMetadata(\"deviceId\",\n            \"organisationId\", \"correlationId\", \"messageType\", 4);", "modifier": "private static final", "type": "DeviceMessageMetadata", "declarator": "DEVICE_MESSAGE_DATA = new DeviceMessageMetadata(\"deviceId\",\n            \"organisationId\", \"correlationId\", \"messageType\", 4)", "var_name": "DEVICE_MESSAGE_DATA"}, {"original_string": "private static final String DOMAIN = \"Domain\";", "modifier": "private static final", "type": "String", "declarator": "DOMAIN = \"Domain\"", "var_name": "DOMAIN"}, {"original_string": "private static final String DATA_OBJECT = \"data object\";", "modifier": "private static final", "type": "String", "declarator": "DATA_OBJECT = \"data object\"", "var_name": "DATA_OBJECT"}, {"original_string": "private static final Timestamp SCHEDULED_TIME = new Timestamp(Calendar.getInstance().getTime().getTime());", "modifier": "private static final", "type": "Timestamp", "declarator": "SCHEDULED_TIME = new Timestamp(Calendar.getInstance().getTime().getTime())", "var_name": "SCHEDULED_TIME"}, {"original_string": "@Mock\n    private DeviceRequestMessageService deviceRequestMessageService;", "modifier": "@Mock\n    private", "type": "DeviceRequestMessageService", "declarator": "deviceRequestMessageService", "var_name": "deviceRequestMessageService"}, {"original_string": "@Mock\n    private ScheduledTaskRepository scheduledTaskRepository;", "modifier": "@Mock\n    private", "type": "ScheduledTaskRepository", "declarator": "scheduledTaskRepository", "var_name": "scheduledTaskRepository"}, {"original_string": "@Mock\n    private DeviceRepository deviceRepository;", "modifier": "@Mock\n    private", "type": "DeviceRepository", "declarator": "deviceRepository", "var_name": "deviceRepository"}, {"original_string": "@InjectMocks\n    private ScheduledTaskExecutorService scheduledTaskExecutorService;", "modifier": "@InjectMocks\n    private", "type": "ScheduledTaskExecutorService", "declarator": "scheduledTaskExecutorService", "var_name": "scheduledTaskExecutorService"}, {"original_string": "@Mock\n    private ScheduledTaskExecutorJobConfig scheduledTaskExecutorJobConfig;", "modifier": "@Mock\n    private", "type": "ScheduledTaskExecutorJobConfig", "declarator": "scheduledTaskExecutorJobConfig", "var_name": "scheduledTaskExecutorJobConfig"}], "file": "osgp/platform/osgp-core/src/test/java/org/opensmartgridplatform/core/application/tasks/ScheduledTaskExecutorServiceTest.java"}, "test_case": {"identifier": "testRunFunctionalException", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testRunFunctionalException() throws FunctionalException, UnknownHostException, JobExecutionException {\n        final List<ScheduledTask> scheduledTasks = new ArrayList<>();\n        final ScheduledTask scheduledTask = new ScheduledTask(DEVICE_MESSAGE_DATA, DOMAIN, DOMAIN, DATA_OBJECT,\n                SCHEDULED_TIME);\n        scheduledTasks.add(scheduledTask);\n\n        when(this.scheduledTaskRepository.findByStatusAndScheduledTimeLessThan(any(ScheduledTaskStatusType.class),\n                any(Timestamp.class), any(Pageable.class))).thenReturn(scheduledTasks)\n                        .thenReturn(new ArrayList<ScheduledTask>());\n\n        final Device device = new Device();\n        device.updateRegistrationData(InetAddress.getByName(\"127.0.0.1\"), \"deviceType\");\n        when(this.deviceRepository.findByDeviceIdentification(anyString())).thenReturn(device);\n        when(this.scheduledTaskRepository.save(any(ScheduledTask.class))).thenReturn(scheduledTask);\n        when(this.scheduledTaskExecutorJobConfig.scheduledTaskPageSize()).thenReturn(30);\n        doThrow(new FunctionalException(FunctionalExceptionType.ARGUMENT_NULL, ComponentType.OSGP_CORE))\n                .when(this.deviceRequestMessageService)\n                .processMessage(any(ProtocolRequestMessage.class));\n\n        this.scheduledTaskExecutorService.processScheduledTasks();\n\n        // check if task is deleted\n        verify(this.scheduledTaskRepository).delete(scheduledTask);\n    }", "signature": "void testRunFunctionalException()", "full_signature": "@Test public void testRunFunctionalException()", "class_method_signature": "ScheduledTaskExecutorServiceTest.testRunFunctionalException()", "testcase": true, "constructor": false, "invocations": ["add", "thenReturn", "thenReturn", "when", "findByStatusAndScheduledTimeLessThan", "any", "any", "any", "updateRegistrationData", "getByName", "thenReturn", "when", "findByDeviceIdentification", "anyString", "thenReturn", "when", "save", "any", "thenReturn", "when", "scheduledTaskPageSize", "processMessage", "when", "doThrow", "any", "processScheduledTasks", "delete", "verify"]}, "focal_class": {"identifier": "ScheduledTaskExecutorService", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(ScheduledTaskExecutorService.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(ScheduledTaskExecutorService.class)", "var_name": "LOGGER"}, {"original_string": "@Autowired\n    private DeviceRequestMessageService deviceRequestMessageService;", "modifier": "@Autowired\n    private", "type": "DeviceRequestMessageService", "declarator": "deviceRequestMessageService", "var_name": "deviceRequestMessageService"}, {"original_string": "@Autowired\n    private ScheduledTaskRepository scheduledTaskRepository;", "modifier": "@Autowired\n    private", "type": "ScheduledTaskRepository", "declarator": "scheduledTaskRepository", "var_name": "scheduledTaskRepository"}, {"original_string": "@Autowired\n    private DeviceRepository deviceRepository;", "modifier": "@Autowired\n    private", "type": "DeviceRepository", "declarator": "deviceRepository", "var_name": "deviceRepository"}, {"original_string": "@Autowired\n    private ScheduledTaskExecutorJobConfig scheduledTaskExecutorJobConfig;", "modifier": "@Autowired\n    private", "type": "ScheduledTaskExecutorJobConfig", "declarator": "scheduledTaskExecutorJobConfig", "var_name": "scheduledTaskExecutorJobConfig"}], "methods": [{"identifier": "processScheduledTasks", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void processScheduledTasks()", "full_signature": "public void processScheduledTasks()", "class_method_signature": "ScheduledTaskExecutorService.processScheduledTasks()", "testcase": false, "constructor": false}, {"identifier": "processScheduledTasks", "parameters": "(final ScheduledTaskStatusType type)", "modifiers": "private", "return": "void", "signature": "void processScheduledTasks(final ScheduledTaskStatusType type)", "full_signature": "private void processScheduledTasks(final ScheduledTaskStatusType type)", "class_method_signature": "ScheduledTaskExecutorService.processScheduledTasks(final ScheduledTaskStatusType type)", "testcase": false, "constructor": false}, {"identifier": "getScheduledTasks", "parameters": "(final ScheduledTaskStatusType type)", "modifiers": "private", "return": "List<ScheduledTask>", "signature": "List<ScheduledTask> getScheduledTasks(final ScheduledTaskStatusType type)", "full_signature": "private List<ScheduledTask> getScheduledTasks(final ScheduledTaskStatusType type)", "class_method_signature": "ScheduledTaskExecutorService.getScheduledTasks(final ScheduledTaskStatusType type)", "testcase": false, "constructor": false}, {"identifier": "createProtocolRequestMessage", "parameters": "(final ScheduledTask scheduledTask)", "modifiers": "private", "return": "ProtocolRequestMessage", "signature": "ProtocolRequestMessage createProtocolRequestMessage(final ScheduledTask scheduledTask)", "full_signature": "private ProtocolRequestMessage createProtocolRequestMessage(final ScheduledTask scheduledTask)", "class_method_signature": "ScheduledTaskExecutorService.createProtocolRequestMessage(final ScheduledTask scheduledTask)", "testcase": false, "constructor": false}], "file": "osgp/platform/osgp-core/src/main/java/org/opensmartgridplatform/core/application/tasks/ScheduledTaskExecutorService.java"}, "focal_method": {"identifier": "processScheduledTasks", "parameters": "()", "modifiers": "public", "return": "void", "body": "public void processScheduledTasks() {\n        this.processScheduledTasks(ScheduledTaskStatusType.NEW);\n        this.processScheduledTasks(ScheduledTaskStatusType.RETRY);\n    }", "signature": "void processScheduledTasks()", "full_signature": "public void processScheduledTasks()", "class_method_signature": "ScheduledTaskExecutorService.processScheduledTasks()", "testcase": false, "constructor": false, "invocations": ["processScheduledTasks", "processScheduledTasks"]}, "repository": {"repo_id": 154302277, "url": "https://github.com/OSGP/open-smart-grid-platform", "stars": 30, "created": "10/23/2018 9:41:12 AM +00:00", "updates": "2020-01-26T20:15:09+00:00", "fork": "False", "license": "licensed"}}