{"test_class": {"identifier": "KmsHelperTest", "superclass": "extends AbstractDaoTest", "interfaces": "", "fields": [{"original_string": "@Autowired\n    private KmsHelper kmsHelper;", "modifier": "@Autowired\n    private", "type": "KmsHelper", "declarator": "kmsHelper", "var_name": "kmsHelper"}], "file": "herd-code/herd-dao/src/test/java/org/finra/herd/dao/helper/KmsHelperTest.java"}, "test_case": {"identifier": "testGetDecryptedConfigurationValueDecryptionError", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetDecryptedConfigurationValueDecryptionError() throws Exception\n    {\n        Map<String, Object> overrideMap = new HashMap<>();\n        overrideMap.put(ConfigurationValue.ACTIVITI_JOB_DEFINITION_ID_TEMPLATE.getKey(), MockKmsOperationsImpl.MOCK_CIPHER_TEXT_INVALID);\n        modifyPropertySourceInEnvironment(overrideMap);\n\n        try\n        {\n            kmsHelper.getDecryptedConfigurationValue(ConfigurationValue.ACTIVITI_JOB_DEFINITION_ID_TEMPLATE);\n            fail(\"Suppose to throw an IllegalStateException when encrypted value is invalid.\");\n        }\n        catch (IllegalStateException e)\n        {\n            assertEquals(String.format(\"Error decrypting configuration value \\\"%s\\\".\", ConfigurationValue.ACTIVITI_JOB_DEFINITION_ID_TEMPLATE.getKey()),\n                e.getMessage());\n        }\n        finally\n        {\n            restorePropertySourceInEnvironment();\n        }\n    }", "signature": "void testGetDecryptedConfigurationValueDecryptionError()", "full_signature": "@Test public void testGetDecryptedConfigurationValueDecryptionError()", "class_method_signature": "KmsHelperTest.testGetDecryptedConfigurationValueDecryptionError()", "testcase": true, "constructor": false, "invocations": ["put", "getKey", "modifyPropertySourceInEnvironment", "getDecryptedConfigurationValue", "fail", "assertEquals", "format", "getKey", "getMessage", "restorePropertySourceInEnvironment"]}, "focal_class": {"identifier": "KmsHelper", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Autowired\n    private ConfigurationHelper configurationHelper;", "modifier": "@Autowired\n    private", "type": "ConfigurationHelper", "declarator": "configurationHelper", "var_name": "configurationHelper"}, {"original_string": "@Autowired\n    private AwsHelper awsHelper;", "modifier": "@Autowired\n    private", "type": "AwsHelper", "declarator": "awsHelper", "var_name": "awsHelper"}, {"original_string": "@Autowired\n    private KmsDao kmsDao;", "modifier": "@Autowired\n    private", "type": "KmsDao", "declarator": "kmsDao", "var_name": "kmsDao"}], "methods": [{"identifier": "getDecryptedConfigurationValue", "parameters": "(ConfigurationValue configurationValue)", "modifiers": "public", "return": "String", "signature": "String getDecryptedConfigurationValue(ConfigurationValue configurationValue)", "full_signature": "public String getDecryptedConfigurationValue(ConfigurationValue configurationValue)", "class_method_signature": "KmsHelper.getDecryptedConfigurationValue(ConfigurationValue configurationValue)", "testcase": false, "constructor": false}], "file": "herd-code/herd-dao/src/main/java/org/finra/herd/dao/helper/KmsHelper.java"}, "focal_method": {"identifier": "getDecryptedConfigurationValue", "parameters": "(ConfigurationValue configurationValue)", "modifiers": "public", "return": "String", "body": "public String getDecryptedConfigurationValue(ConfigurationValue configurationValue)\n    {\n        String encryptedValue = configurationHelper.getProperty(configurationValue);\n\n        if (StringUtils.isBlank(encryptedValue))\n        {\n            throw new IllegalStateException(\"Unable to decrypt configuration value \\\"\" + configurationValue.getKey() + \"\\\" since it is not configured.\");\n        }\n\n        try\n        {\n            return kmsDao.decrypt(awsHelper.getAwsParamsDto(), encryptedValue);\n        }\n        catch (Exception e)\n        {\n            throw new IllegalStateException(\"Error decrypting configuration value \\\"\" + configurationValue.getKey() + \"\\\".\", e);\n        }\n    }", "signature": "String getDecryptedConfigurationValue(ConfigurationValue configurationValue)", "full_signature": "public String getDecryptedConfigurationValue(ConfigurationValue configurationValue)", "class_method_signature": "KmsHelper.getDecryptedConfigurationValue(ConfigurationValue configurationValue)", "testcase": false, "constructor": false, "invocations": ["getProperty", "isBlank", "getKey", "decrypt", "getAwsParamsDto", "getKey"]}, "repository": {"repo_id": 42949039, "url": "https://github.com/FINRAOS/herd", "language": "Java", "is_fork": false, "fork_count": 36, "stargazer_count": 120, "size": 205797, "license": "licensed"}}