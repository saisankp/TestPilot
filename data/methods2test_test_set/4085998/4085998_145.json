{"test_class": {"identifier": "urn_perun_user_attribute_def_def_IPAddressesTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static urn_perun_user_attribute_def_def_IPAddresses classInstance;", "modifier": "private static", "type": "urn_perun_user_attribute_def_def_IPAddresses", "declarator": "classInstance", "var_name": "classInstance"}, {"original_string": "private static PerunSessionImpl session;", "modifier": "private static", "type": "PerunSessionImpl", "declarator": "session", "var_name": "session"}, {"original_string": "private static User user;", "modifier": "private static", "type": "User", "declarator": "user", "var_name": "user"}], "file": "perun-core/src/test/java/cz/metacentrum/perun/core/impl/modules/attributes/urn_perun_user_attribute_def_def_IPAddressesTest.java"}, "test_case": {"identifier": "testCheckAttributeSyntax", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testCheckAttributeSyntax() throws Exception {\n\t\tSystem.out.println(\"testCheckAttributeSyntax()\");\n\n\t\tAttribute attributeToCheck = new Attribute();\n\t\tList<String> ipAddresses = new ArrayList<>();\n\t\tipAddresses.add(\"255.255.255.255\");\n\t\tipAddresses.add(\"192.168.1.0\");\n\t\tipAddresses.add(\"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\");\n\t\tipAddresses.add(\"2001:db8:85a3:8d3:1319:8a2e:370:7348\");\n\t\tipAddresses.add(\"2001:db8::2:1\");\n\n\t\tattributeToCheck.setValue(ipAddresses);\n\t\tclassInstance.checkAttributeSyntax(session, user, attributeToCheck);\n\t}", "signature": "void testCheckAttributeSyntax()", "full_signature": "@Test public void testCheckAttributeSyntax()", "class_method_signature": "urn_perun_user_attribute_def_def_IPAddressesTest.testCheckAttributeSyntax()", "testcase": true, "constructor": false, "invocations": ["println", "add", "add", "add", "add", "add", "setValue", "checkAttributeSyntax"]}, "focal_class": {"identifier": "urn_perun_user_attribute_def_def_IPAddresses", "superclass": "extends UserAttributesModuleAbstract", "interfaces": "implements UserAttributesModuleImplApi", "fields": [{"original_string": "private static final Pattern IPv4_PATTERN = Pattern.compile(\"^(25[0-5]|2[0-4]\\\\d|[0-1]?\\\\d?\\\\d)(\\\\.(25[0-5]|2[0-4]\\\\d|[0-1]?\\\\d?\\\\d)){3}$\");", "modifier": "private static final", "type": "Pattern", "declarator": "IPv4_PATTERN = Pattern.compile(\"^(25[0-5]|2[0-4]\\\\d|[0-1]?\\\\d?\\\\d)(\\\\.(25[0-5]|2[0-4]\\\\d|[0-1]?\\\\d?\\\\d)){3}$\")", "var_name": "IPv4_PATTERN"}, {"original_string": "private static final Pattern IPv6_PATTERN = Pattern.compile(\"^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$\");", "modifier": "private static final", "type": "Pattern", "declarator": "IPv6_PATTERN = Pattern.compile(\"^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$\")", "var_name": "IPv6_PATTERN"}, {"original_string": "private static final Pattern IPv6_PATTERN_SHORT = Pattern.compile(\"^((?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)::((?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)$\");", "modifier": "private static final", "type": "Pattern", "declarator": "IPv6_PATTERN_SHORT = Pattern.compile(\"^((?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)::((?:[0-9A-Fa-f]{1,4}(?::[0-9A-Fa-f]{1,4})*)?)$\")", "var_name": "IPv6_PATTERN_SHORT"}], "methods": [{"identifier": "checkAttributeSyntax", "parameters": "(PerunSessionImpl perunSession, User user, Attribute attribute)", "modifiers": "@Override public", "return": "void", "signature": "void checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute)", "full_signature": "@Override public void checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute)", "class_method_signature": "urn_perun_user_attribute_def_def_IPAddresses.checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute)", "testcase": false, "constructor": false}, {"identifier": "getAttributeDefinition", "parameters": "()", "modifiers": "@Override public", "return": "AttributeDefinition", "signature": "AttributeDefinition getAttributeDefinition()", "full_signature": "@Override public AttributeDefinition getAttributeDefinition()", "class_method_signature": "urn_perun_user_attribute_def_def_IPAddresses.getAttributeDefinition()", "testcase": false, "constructor": false}], "file": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/modules/attributes/urn_perun_user_attribute_def_def_IPAddresses.java"}, "focal_method": {"identifier": "checkAttributeSyntax", "parameters": "(PerunSessionImpl perunSession, User user, Attribute attribute)", "modifiers": "@Override public", "return": "void", "body": "@Override\n\tpublic void checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute) throws WrongAttributeValueException {\n\t\tList<String> value = attribute.valueAsList();\n\t\tif (value != null) {\n\t\t\tfor (String address : value) {\n\t\t\t\tMatcher matcherIPv4 = IPv4_PATTERN.matcher(address);\n\t\t\t\tMatcher matcherIPv6 = IPv6_PATTERN.matcher(address);\n\t\t\t\tMatcher matcherIPv6Short = IPv6_PATTERN_SHORT.matcher(address);\n\t\t\t\tif (!matcherIPv4.matches() && !matcherIPv6.matches() && !matcherIPv6Short.matches())\n\t\t\t\t\tthrow new WrongAttributeValueException(attribute, \"IP address is not in the correct format.\");\n\t\t\t}\n\t\t}\n\t}", "signature": "void checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute)", "full_signature": "@Override public void checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute)", "class_method_signature": "urn_perun_user_attribute_def_def_IPAddresses.checkAttributeSyntax(PerunSessionImpl perunSession, User user, Attribute attribute)", "testcase": false, "constructor": false, "invocations": ["valueAsList", "matcher", "matcher", "matcher", "matches", "matches", "matches"]}, "repository": {"repo_id": 4085998, "url": "https://github.com/CESNET/perun", "stars": 38, "created": "4/20/2012 11:55:38 AM +00:00", "updates": "2020-01-27T09:51:13+00:00", "fork": "False", "license": "licensed"}}