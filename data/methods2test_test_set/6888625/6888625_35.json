{"test_class": {"identifier": "CacheResourceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String CACHE_NAME = \"proxyCache\";", "modifier": "private static final", "type": "String", "declarator": "CACHE_NAME = \"proxyCache\"", "var_name": "CACHE_NAME"}, {"original_string": "private static final String CACHE_LOCATION = \"${java.io.tmpdir}/ehcache\";", "modifier": "private static final", "type": "String", "declarator": "CACHE_LOCATION = \"${java.io.tmpdir}/ehcache\"", "var_name": "CACHE_LOCATION"}], "file": "coastal-hazards-portal/src/test/java/gov/usgs/cida/coastalhazards/rest/data/CacheResourceTest.java"}, "test_case": {"identifier": "testClearCache", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testClearCache() {\n\t\tCacheConfiguration ehConfig = new CacheConfiguration()\n\t\t\t\t.name(CACHE_NAME)\n\t\t\t\t.memoryStoreEvictionPolicy(MemoryStoreEvictionPolicy.LRU)\n\t\t\t\t.persistence(new PersistenceConfiguration()\n\t\t\t\t\t\t.strategy(PersistenceConfiguration.Strategy.LOCALTEMPSWAP))\n\t\t\t\t.timeToLiveSeconds(1000)\n\t\t\t\t.timeToIdleSeconds(1000)\n\t\t\t\t.clearOnFlush(true);\n\t\tConfiguration managerConfig = new Configuration()\n\t\t\t\t.diskStore(new DiskStoreConfiguration().path(CACHE_LOCATION))\n\t\t\t\t.maxBytesLocalHeap(1, MemoryUnit.MEGABYTES)\n\t\t\t\t.maxBytesLocalDisk(100, MemoryUnit.MEGABYTES)\n\t\t\t\t.dynamicConfig(false)\n\t\t\t\t.cache(ehConfig);\n\t\tCacheManager cacheManager = CacheManager.create(managerConfig);\n\t\tEhcache ehcache = cacheManager.getEhcache(CACHE_NAME);\n\n\t\tfor (int i = 0; i < 100; i++) {\n\t\t\tElement e = new Element(i, \"value\" + i);\n\t\t\tehcache.put(e);\n\t\t}\n\t\tassertThat(ehcache.getSize(), is(equalTo(100)));\n\n\t\tCacheResource instance = new CacheResource();\n\t\tboolean cleared = instance.clearCache();\n\t\tassertThat(cleared, is(equalTo(true)));\n\n\t\tassertThat(ehcache.getSize(), is(equalTo(0)));\n\t}", "signature": "void testClearCache()", "full_signature": "@Test public void testClearCache()", "class_method_signature": "CacheResourceTest.testClearCache()", "testcase": true, "constructor": false, "invocations": ["clearOnFlush", "timeToIdleSeconds", "timeToLiveSeconds", "persistence", "memoryStoreEvictionPolicy", "name", "strategy", "cache", "dynamicConfig", "maxBytesLocalDisk", "maxBytesLocalHeap", "diskStore", "path", "create", "getEhcache", "put", "assertThat", "getSize", "is", "equalTo", "clearCache", "assertThat", "is", "equalTo", "assertThat", "getSize", "is", "equalTo"]}, "focal_class": {"identifier": "CacheResource", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger log = LoggerFactory.getLogger(CacheResource.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(CacheResource.class)", "var_name": "log"}, {"original_string": "private static final String CACHE_NAME_PROP = \"coastal-hazards.portal.geoserver.cache.name\";", "modifier": "private static final", "type": "String", "declarator": "CACHE_NAME_PROP = \"coastal-hazards.portal.geoserver.cache.name\"", "var_name": "CACHE_NAME_PROP"}, {"original_string": "private static final String CACHE_NAME = \"proxyCache\";", "modifier": "private static final", "type": "String", "declarator": "CACHE_NAME = \"proxyCache\"", "var_name": "CACHE_NAME"}, {"original_string": "private static final String CACHE_LOCATION_PROP = \"coastal-hazards.portal.geoserver.cache.location\";", "modifier": "private static final", "type": "String", "declarator": "CACHE_LOCATION_PROP = \"coastal-hazards.portal.geoserver.cache.location\"", "var_name": "CACHE_LOCATION_PROP"}, {"original_string": "private static final String CACHE_LOCATION = \"${java.io.tmpdir}/ehcache\";", "modifier": "private static final", "type": "String", "declarator": "CACHE_LOCATION = \"${java.io.tmpdir}/ehcache\"", "var_name": "CACHE_LOCATION"}, {"original_string": "private static final String cacheLocation;", "modifier": "private static final", "type": "String", "declarator": "cacheLocation", "var_name": "cacheLocation"}, {"original_string": "private static final String cacheName;", "modifier": "private static final", "type": "String", "declarator": "cacheName", "var_name": "cacheName"}], "methods": [{"identifier": "deleteCache", "parameters": "()", "modifiers": "@DELETE @ConfiguredRolesAllowed(ConfiguredRolesAllowedDynamicFeature.CCH_ADMIN_USER_PROP) public", "return": "Response", "signature": "Response deleteCache()", "full_signature": "@DELETE @ConfiguredRolesAllowed(ConfiguredRolesAllowedDynamicFeature.CCH_ADMIN_USER_PROP) public Response deleteCache()", "class_method_signature": "CacheResource.deleteCache()", "testcase": false, "constructor": false}, {"identifier": "clearCache", "parameters": "()", "modifiers": "", "return": "boolean", "signature": "boolean clearCache()", "full_signature": " boolean clearCache()", "class_method_signature": "CacheResource.clearCache()", "testcase": false, "constructor": false}], "file": "coastal-hazards-portal/src/main/java/gov/usgs/cida/coastalhazards/rest/data/CacheResource.java"}, "focal_method": {"identifier": "clearCache", "parameters": "()", "modifiers": "", "return": "boolean", "body": "boolean clearCache() {\n\t\tboolean cleared = false;\n\t\t\n\t\ttry {\n\t\t\tCacheConfiguration ehConfig = new CacheConfiguration()\n\t\t\t\t.name(cacheName)\n\t\t\t\t.memoryStoreEvictionPolicy(MemoryStoreEvictionPolicy.LRU)\n\t\t\t\t.persistence(new PersistenceConfiguration()\n\t\t\t\t\t.strategy(PersistenceConfiguration.Strategy.LOCALTEMPSWAP))\n\t\t\t\t.maxBytesLocalDisk(10, MemoryUnit.MEGABYTES)\n\t\t\t\t.maxBytesLocalHeap(1, MemoryUnit.MEGABYTES)\n\t\t\t\t.clearOnFlush(true);\n\t\t\tConfiguration managerConfig = new Configuration()\n\t\t\t\t.diskStore(new DiskStoreConfiguration().path(cacheLocation))\n\t\t\t\t.dynamicConfig(false)\n\t\t\t\t.cache(ehConfig);\n\t\t\tCacheManager cacheManager = CacheManager.create(managerConfig);\n\t\t\tEhcache ehcache = cacheManager.getEhcache(cacheName);\n\t\t\tif (ehcache != null) {\n\t\t\t\tehcache.flush();\n\t\t\t\tehcache.removeAll();\n\t\t\t\tcleared = true;\n\t\t\t} else {\n\t\t\t\tcleared = false;\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\tlog.debug(\"Unable to clear cache\", e);\n\t\t\tcleared = false;\n\t\t}\n\t\t\n\t\treturn cleared;\n\t}", "signature": "boolean clearCache()", "full_signature": " boolean clearCache()", "class_method_signature": "CacheResource.clearCache()", "testcase": false, "constructor": false, "invocations": ["clearOnFlush", "maxBytesLocalHeap", "maxBytesLocalDisk", "persistence", "memoryStoreEvictionPolicy", "name", "strategy", "cache", "dynamicConfig", "diskStore", "path", "create", "getEhcache", "flush", "removeAll", "debug"]}, "repository": {"repo_id": 6888625, "url": "https://github.com/USGS-CIDA/coastal-hazards", "language": "Java", "is_fork": false, "fork_count": 28, "stargazer_count": 5, "size": 37212, "license": "licensed"}}