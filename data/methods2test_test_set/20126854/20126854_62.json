{"test_class": {"identifier": "DefaultDeflateCompressionDivinerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private DefaultDeflateCompressionDiviner diviner = null;", "modifier": "private", "type": "DefaultDeflateCompressionDiviner", "declarator": "diviner = null", "var_name": "diviner"}, {"original_string": "private byte[] testData = null;", "modifier": "private", "type": "byte[]", "declarator": "testData = null", "var_name": "testData"}], "file": "feya/libraries/archive_diff/diff.generator/src/test/java/com/google/archivepatcher/generator/DefaultDeflateCompressionDivinerTest.java"}, "test_case": {"identifier": "testDivineDeflateParameters_AllValidSettings", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testDivineDeflateParameters_AllValidSettings() throws IOException {\n    for (boolean nowrap : new boolean[] {true, false}) {\n      for (int strategy : new int[] {0, 1, 2}) {\n        for (int level : new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9}) {\n          JreDeflateParameters trueParameters = JreDeflateParameters.of(level, strategy, nowrap);\n          final byte[] buffer = deflate(trueParameters);\n          ByteArrayInputStreamFactory factory =\n              new ByteArrayInputStreamFactory(buffer, true, false);\n          JreDeflateParameters divinedParameters = diviner.divineDeflateParameters(factory);\n          Assert.assertNotNull(divinedParameters);\n          // TODO(andrewhayden) make *CERTAIN 100%( that strategy doesn't matter for level < 4.\n          if (strategy == 1 && level <= 3) {\n            // Strategy 1 produces identical output at levels 1, 2 and 3.\n            Assert.assertEquals(JreDeflateParameters.of(level, 0, nowrap), divinedParameters);\n          } else if (strategy == 2) {\n            // All levels are the same with strategy 2.\n            // TODO: Assert only one test gets done for this, should be the first level always.\n            Assert.assertEquals(nowrap, divinedParameters.nowrap);\n            Assert.assertEquals(strategy, divinedParameters.strategy);\n          } else {\n            Assert.assertEquals(trueParameters, divinedParameters);\n          }\n        } // End of iteration on level\n      } // End of iteration on strategy\n    } // End of iteration on nowrap\n  }", "signature": "void testDivineDeflateParameters_AllValidSettings()", "full_signature": "@Test public void testDivineDeflateParameters_AllValidSettings()", "class_method_signature": "DefaultDeflateCompressionDivinerTest.testDivineDeflateParameters_AllValidSettings()", "testcase": true, "constructor": false, "invocations": ["of", "deflate", "divineDeflateParameters", "assertNotNull", "assertEquals", "of", "assertEquals", "assertEquals", "assertEquals"]}, "focal_class": {"identifier": "DefaultDeflateCompressionDiviner", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final Map<Integer, List<Integer>> levelsByStrategy = getLevelsByStrategy();", "modifier": "private final", "type": "Map<Integer, List<Integer>>", "declarator": "levelsByStrategy = getLevelsByStrategy()", "var_name": "levelsByStrategy"}], "methods": [{"identifier": "divineDeflateParameters", "parameters": "(File archiveFile)", "modifiers": "public", "return": "List<DivinationResult>", "signature": "List<DivinationResult> divineDeflateParameters(File archiveFile)", "full_signature": "public List<DivinationResult> divineDeflateParameters(File archiveFile)", "class_method_signature": "DefaultDeflateCompressionDiviner.divineDeflateParameters(File archiveFile)", "testcase": false, "constructor": false}, {"identifier": "getLevelsByStrategy", "parameters": "()", "modifiers": "protected", "return": "Map<Integer, List<Integer>>", "signature": "Map<Integer, List<Integer>> getLevelsByStrategy()", "full_signature": "protected Map<Integer, List<Integer>> getLevelsByStrategy()", "class_method_signature": "DefaultDeflateCompressionDiviner.getLevelsByStrategy()", "testcase": false, "constructor": false}, {"identifier": "divineDeflateParameters", "parameters": "(\n      MultiViewInputStreamFactory<?> compressedDataInputStreamFactory)", "modifiers": "public", "return": "JreDeflateParameters", "signature": "JreDeflateParameters divineDeflateParameters(\n      MultiViewInputStreamFactory<?> compressedDataInputStreamFactory)", "full_signature": "public JreDeflateParameters divineDeflateParameters(\n      MultiViewInputStreamFactory<?> compressedDataInputStreamFactory)", "class_method_signature": "DefaultDeflateCompressionDiviner.divineDeflateParameters(\n      MultiViewInputStreamFactory<?> compressedDataInputStreamFactory)", "testcase": false, "constructor": false}, {"identifier": "matches", "parameters": "(\n      InputStream compressedDataIn,\n      Inflater inflater,\n      Deflater deflater,\n      InputStream matchingStreamInput,\n      byte[] copyBuffer)", "modifiers": "private", "return": "boolean", "signature": "boolean matches(\n      InputStream compressedDataIn,\n      Inflater inflater,\n      Deflater deflater,\n      InputStream matchingStreamInput,\n      byte[] copyBuffer)", "full_signature": "private boolean matches(\n      InputStream compressedDataIn,\n      Inflater inflater,\n      Deflater deflater,\n      InputStream matchingStreamInput,\n      byte[] copyBuffer)", "class_method_signature": "DefaultDeflateCompressionDiviner.matches(\n      InputStream compressedDataIn,\n      Inflater inflater,\n      Deflater deflater,\n      InputStream matchingStreamInput,\n      byte[] copyBuffer)", "testcase": false, "constructor": false}], "file": "feya/libraries/archive_diff/diff.generator/src/main/java/com/google/archivepatcher/generator/DefaultDeflateCompressionDiviner.java"}, "focal_method": {"identifier": "divineDeflateParameters", "parameters": "(File archiveFile)", "modifiers": "public", "return": "List<DivinationResult>", "body": "public List<DivinationResult> divineDeflateParameters(File archiveFile) throws IOException {\n    List<DivinationResult> results = new ArrayList<DivinationResult>();\n    for (MinimalZipEntry minimalZipEntry : MinimalZipArchive.listEntries(archiveFile)) {\n      JreDeflateParameters divinedParameters = null;\n      if (minimalZipEntry.isDeflateCompressed()) {\n        // TODO(andrewhayden): Reuse streams to avoid churning file descriptors\n        RandomAccessFileInputStreamFactory rafisFactory =\n            new RandomAccessFileInputStreamFactory(\n                archiveFile,\n                minimalZipEntry.getFileOffsetOfCompressedData(),\n                minimalZipEntry.getCompressedSize());\n        divinedParameters = divineDeflateParameters(rafisFactory);\n      }\n      results.add(new DivinationResult(minimalZipEntry, divinedParameters));\n    }\n    return results;\n  }", "signature": "List<DivinationResult> divineDeflateParameters(File archiveFile)", "full_signature": "public List<DivinationResult> divineDeflateParameters(File archiveFile)", "class_method_signature": "DefaultDeflateCompressionDiviner.divineDeflateParameters(File archiveFile)", "testcase": false, "constructor": false, "invocations": ["listEntries", "isDeflateCompressed", "getFileOffsetOfCompressedData", "getCompressedSize", "divineDeflateParameters", "add"]}, "repository": {"repo_id": 20126854, "url": "https://github.com/kaedea/Feya", "language": "Java", "is_fork": false, "fork_count": 1, "stargazer_count": 12, "size": 7798, "license": "licensed"}}