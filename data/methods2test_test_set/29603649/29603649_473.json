{"test_class": {"identifier": "LocalhostRequestProcessorTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Mock\n    private LocalhostRequestChecker localhostRequestChecker;", "modifier": "@Mock\n    private", "type": "LocalhostRequestChecker", "declarator": "localhostRequestChecker", "var_name": "localhostRequestChecker"}, {"original_string": "@Mock\n    private LocalhostRequestRouter localhostRequestRouter;", "modifier": "@Mock\n    private", "type": "LocalhostRequestRouter", "declarator": "localhostRequestRouter", "var_name": "localhostRequestRouter"}, {"original_string": "@InjectMocks\n    private LocalhostRequestProcessor underTest;", "modifier": "@InjectMocks\n    private", "type": "LocalhostRequestProcessor", "declarator": "underTest", "var_name": "underTest"}, {"original_string": "@Mock\n    private WilmaHttpRequest request;", "modifier": "@Mock\n    private", "type": "WilmaHttpRequest", "declarator": "request", "var_name": "request"}], "file": "wilma-application/modules/wilma-core/src/test/java/com/epam/wilma/core/processor/entity/LocalhostRequestProcessorTest.java"}, "test_case": {"identifier": "testIfEnabledShouldNotRerouteNonLocalhostRequest", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testIfEnabledShouldNotRerouteNonLocalhostRequest() throws ApplicationException {\n        //GIVEN\n        underTest.setEnabled(true);\n        given(localhostRequestChecker.checkIfRequestTargetsLocalhost(Mockito.any(WilmaHttpRequest.class))).willReturn(false);\n        //WHEN\n        underTest.process(request);\n        //THEN\n        verify(localhostRequestRouter, never()).reroute(request);\n        verify(request, never()).setRerouted(true);\n    }", "signature": "void testIfEnabledShouldNotRerouteNonLocalhostRequest()", "full_signature": "@Test public void testIfEnabledShouldNotRerouteNonLocalhostRequest()", "class_method_signature": "LocalhostRequestProcessorTest.testIfEnabledShouldNotRerouteNonLocalhostRequest()", "testcase": true, "constructor": false, "invocations": ["setEnabled", "willReturn", "given", "checkIfRequestTargetsLocalhost", "any", "process", "reroute", "verify", "never", "setRerouted", "verify", "never"]}, "focal_class": {"identifier": "LocalhostRequestProcessor", "superclass": "extends ProcessorBase", "interfaces": "", "fields": [{"original_string": "@Autowired\n    private LocalhostRequestChecker localhostRequestChecker;", "modifier": "@Autowired\n    private", "type": "LocalhostRequestChecker", "declarator": "localhostRequestChecker", "var_name": "localhostRequestChecker"}, {"original_string": "@Autowired\n    private LocalhostRequestRouter localhostRequestRouter;", "modifier": "@Autowired\n    private", "type": "LocalhostRequestRouter", "declarator": "localhostRequestRouter", "var_name": "localhostRequestRouter"}], "methods": [{"identifier": "process", "parameters": "(final WilmaHttpEntity entity)", "modifiers": "@Override public", "return": "void", "signature": "void process(final WilmaHttpEntity entity)", "full_signature": "@Override public void process(final WilmaHttpEntity entity)", "class_method_signature": "LocalhostRequestProcessor.process(final WilmaHttpEntity entity)", "testcase": false, "constructor": false}], "file": "wilma-application/modules/wilma-core/src/main/java/com/epam/wilma/core/processor/entity/LocalhostRequestProcessor.java"}, "focal_method": {"identifier": "process", "parameters": "(final WilmaHttpEntity entity)", "modifiers": "@Override public", "return": "void", "body": "@Override\n    public void process(final WilmaHttpEntity entity) throws ApplicationException {\n        WilmaHttpRequest request = (WilmaHttpRequest) entity;\n        /**\n         * If this method was called then localhost blocking is turned on,\n         * so we only need to check if the request targets localhost in order to determine if it needs to be rerouted.\n         */\n        boolean requestNeedsRerouting = localhostRequestChecker.checkIfRequestTargetsLocalhost(request);\n        if (requestNeedsRerouting) {\n            localhostRequestRouter.reroute(request);\n            request.setRerouted(true);\n        }\n    }", "signature": "void process(final WilmaHttpEntity entity)", "full_signature": "@Override public void process(final WilmaHttpEntity entity)", "class_method_signature": "LocalhostRequestProcessor.process(final WilmaHttpEntity entity)", "testcase": false, "constructor": false, "invocations": ["checkIfRequestTargetsLocalhost", "reroute", "setRerouted"]}, "repository": {"repo_id": 29603649, "url": "https://github.com/epam/Wilma", "language": "Java", "is_fork": false, "fork_count": 8, "stargazer_count": 35, "size": 5732, "license": "licensed"}}