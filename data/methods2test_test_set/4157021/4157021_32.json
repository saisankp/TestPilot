{"test_class": {"identifier": "CustomAttributesLdapUserDetailsMapperTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String SAMPLE_USERNAME = \"username\";", "modifier": "private static final", "type": "String", "declarator": "SAMPLE_USERNAME = \"username\"", "var_name": "SAMPLE_USERNAME"}, {"original_string": "private CustomAttributesLdapUserDetailsMapper mapper;", "modifier": "private", "type": "CustomAttributesLdapUserDetailsMapper", "declarator": "mapper", "var_name": "mapper"}, {"original_string": "private Map<String, String> attributeMappings;", "modifier": "private", "type": "Map<String, String>", "declarator": "attributeMappings", "var_name": "attributeMappings"}, {"original_string": "private Collection<GrantedAuthority> authorities;", "modifier": "private", "type": "Collection<GrantedAuthority>", "declarator": "authorities", "var_name": "authorities"}, {"original_string": "MockDirContextOperations ctx;", "modifier": "", "type": "MockDirContextOperations", "declarator": "ctx", "var_name": "ctx"}], "file": "src/core/security/src/test/java/it/geosolutions/geostore/core/security/ldap/CustomAttributesLdapUserDetailsMapperTest.java"}, "test_case": {"identifier": "testMappings", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testMappings() {\n        ctx.getLdapAttributes().put(\"cn\", \"mock\");\n        attributeMappings.put(\"FullName\", \"cn\");\n        UserDetails details = mapper.mapUserFromContext(ctx, SAMPLE_USERNAME, authorities);\n        assertTrue(details instanceof UserDetailsWithAttributes);\n        UserDetailsWithAttributes detailsWithAttribute = (UserDetailsWithAttributes) details;\n        assertEquals(\"mock\", detailsWithAttribute.getAttribute(\"FullName\"));\n    }", "signature": "void testMappings()", "full_signature": "@Test public void testMappings()", "class_method_signature": "CustomAttributesLdapUserDetailsMapperTest.testMappings()", "testcase": true, "constructor": false, "invocations": ["put", "getLdapAttributes", "put", "mapUserFromContext", "assertTrue", "assertEquals", "getAttribute"]}, "focal_class": {"identifier": "CustomAttributesLdapUserDetailsMapper", "superclass": "extends LdapUserDetailsMapper", "interfaces": "", "fields": [{"original_string": "Map<String, String> attributeMappings;", "modifier": "", "type": "Map<String, String>", "declarator": "attributeMappings", "var_name": "attributeMappings"}], "methods": [{"identifier": "CustomAttributesLdapUserDetailsMapper", "parameters": "(Map<String, String> attributeMappings)", "modifiers": "public", "return": "", "signature": " CustomAttributesLdapUserDetailsMapper(Map<String, String> attributeMappings)", "full_signature": "public  CustomAttributesLdapUserDetailsMapper(Map<String, String> attributeMappings)", "class_method_signature": "CustomAttributesLdapUserDetailsMapper.CustomAttributesLdapUserDetailsMapper(Map<String, String> attributeMappings)", "testcase": false, "constructor": true}, {"identifier": "mapUserFromContext", "parameters": "(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "modifiers": "@Override public", "return": "UserDetails", "signature": "UserDetails mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "full_signature": "@Override public UserDetails mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "class_method_signature": "CustomAttributesLdapUserDetailsMapper.mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "testcase": false, "constructor": false}], "file": "src/core/security/src/main/java/it/geosolutions/geostore/core/security/ldap/CustomAttributesLdapUserDetailsMapper.java"}, "focal_method": {"identifier": "mapUserFromContext", "parameters": "(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "modifiers": "@Override public", "return": "UserDetails", "body": "@Override\n    public UserDetails mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities) {\n        LdapUserDetails details =  (LdapUserDetails)super.mapUserFromContext(ctx, username, authorities);\n        LdapUserDetailsWithAttributes detailsWithAttributes = new LdapUserDetailsWithAttributes(details);\n        for(String attributeName : attributeMappings.keySet()) {\n            detailsWithAttributes.setAttribute(attributeName, ctx.getStringAttribute(attributeMappings.get(attributeName)));\n        }\n        return detailsWithAttributes;\n    }", "signature": "UserDetails mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "full_signature": "@Override public UserDetails mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "class_method_signature": "CustomAttributesLdapUserDetailsMapper.mapUserFromContext(DirContextOperations ctx, String username,\n            Collection<GrantedAuthority> authorities)", "testcase": false, "constructor": false, "invocations": ["mapUserFromContext", "keySet", "setAttribute", "getStringAttribute", "get"]}, "repository": {"repo_id": 4157021, "url": "https://github.com/geosolutions-it/geostore", "language": "Java", "is_fork": false, "fork_count": 35, "stargazer_count": 19, "size": 1798, "license": "licensed"}}