{"test_class": {"identifier": "OozieFeedMapperTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private EmbeddedCluster srcMiniDFS;", "modifier": "private", "type": "EmbeddedCluster", "declarator": "srcMiniDFS", "var_name": "srcMiniDFS"}, {"original_string": "private EmbeddedCluster trgMiniDFS;", "modifier": "private", "type": "EmbeddedCluster", "declarator": "trgMiniDFS", "var_name": "trgMiniDFS"}, {"original_string": "ConfigurationStore store = ConfigurationStore.get();", "modifier": "", "type": "ConfigurationStore", "declarator": "store = ConfigurationStore.get()", "var_name": "store"}, {"original_string": "Cluster srcCluster;", "modifier": "", "type": "Cluster", "declarator": "srcCluster", "var_name": "srcCluster"}, {"original_string": "Cluster trgCluster;", "modifier": "", "type": "Cluster", "declarator": "trgCluster", "var_name": "trgCluster"}, {"original_string": "Feed feed;", "modifier": "", "type": "Feed", "declarator": "feed", "var_name": "feed"}, {"original_string": "private static final String SRC_CLUSTER_PATH = \"/src-cluster.xml\";", "modifier": "private static final", "type": "String", "declarator": "SRC_CLUSTER_PATH = \"/src-cluster.xml\"", "var_name": "SRC_CLUSTER_PATH"}, {"original_string": "private static final String TRG_CLUSTER_PATH = \"/trg-cluster.xml\";", "modifier": "private static final", "type": "String", "declarator": "TRG_CLUSTER_PATH = \"/trg-cluster.xml\"", "var_name": "TRG_CLUSTER_PATH"}, {"original_string": "private static final String FEED = \"/feed.xml\";", "modifier": "private static final", "type": "String", "declarator": "FEED = \"/feed.xml\"", "var_name": "FEED"}], "file": "feed/src/test/java/org/apache/ivory/converter/OozieFeedMapperTest.java"}, "test_case": {"identifier": "testReplicationCoords", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testReplicationCoords() throws IvoryException {\n\t\tOozieFeedMapper feedMapper = new OozieFeedMapper(feed);\n\t\tList<COORDINATORAPP> coords = feedMapper.getCoordinators(trgCluster,\n\t\t\t\tnew Path(\"/projects/ivory/\"));\n\t\tCOORDINATORAPP coord = coords.get(0);\n\t\tAssert.assertEquals(\"2010-01-01T00:40Z\", coord.getStart());\t\t\n\t\tAssert.assertEquals(\"${nameNode}/projects/ivory/REPLICATION\", coord\n\t\t\t\t.getAction().getWorkflow().getAppPath());\n\t\tAssert.assertEquals(\"IVORY_FEED_REPLICATION_\" + feed.getName() + \"_\"\n\t\t\t\t+ srcCluster.getName(), coord.getName());\n\t\tAssert.assertEquals(\"${coord:minutes(20)}\", coord.getFrequency());\n\t\tSYNCDATASET inputDataset = (SYNCDATASET) coord.getDatasets()\n\t\t\t\t.getDatasetOrAsyncDataset().get(0);\n\t\tSYNCDATASET outputDataset = (SYNCDATASET) coord.getDatasets()\n\t\t\t\t.getDatasetOrAsyncDataset().get(1);\n\n\t\tAssert.assertEquals(\"${coord:minutes(20)}\", inputDataset.getFrequency());\n\t\tAssert.assertEquals(\"input-dataset\", inputDataset.getName());\n\t\tAssert.assertEquals(\n\t\t\t\tClusterHelper.getStorageUrl(srcCluster)\n\t\t\t\t\t\t+ \"/examples/input-data/rawLogs/${YEAR}/${MONTH}/${DAY}/${HOUR}/${MINUTE}\",\n\t\t\t\tinputDataset.getUriTemplate());\n\n\t\tAssert.assertEquals(\"${coord:minutes(20)}\",\n\t\t\t\toutputDataset.getFrequency());\n\t\tAssert.assertEquals(\"output-dataset\", outputDataset.getName());\n\t\tAssert.assertEquals(\n\t\t\t\t\"${nameNode}\"\n\t\t\t\t\t\t+ \"/examples/input-data/rawLogs/${YEAR}/${MONTH}/${DAY}/${HOUR}/${MINUTE}\",\n\t\t\t\toutputDataset.getUriTemplate());\n\t\t\n\t\tString inEventName =coord.getInputEvents().getDataIn().get(0).getName();\n\t\tString inEventDataset =coord.getInputEvents().getDataIn().get(0).getDataset();\n\t\tString inEventInstance = coord.getInputEvents().getDataIn().get(0).getInstance().get(0);\n\t\tAssert.assertEquals(\"input\", inEventName);\n\t\tAssert.assertEquals(\"input-dataset\", inEventDataset);\n\t\tAssert.assertEquals(\"${now(0,-40)}\", inEventInstance);\n\n\t\tString outEventInstance = coord.getOutputEvents().getDataOut().get(0).getInstance();\n\t\tAssert.assertEquals(\"${now(0,-40)}\", outEventInstance);\n\t\t\n        for(Property prop:coord.getAction().getWorkflow().getConfiguration().getProperty()){\n        \tif(prop.getName().equals(\"mapred.job.priority\")){\n        \t\tassertEquals(prop.getValue(), \"NORMAL\");\n        \t\tbreak;\n        \t}\n        }\n\n\t}", "signature": "void testReplicationCoords()", "full_signature": "@Test public void testReplicationCoords()", "class_method_signature": "OozieFeedMapperTest.testReplicationCoords()", "testcase": true, "constructor": false, "invocations": ["getCoordinators", "get", "assertEquals", "getStart", "assertEquals", "getAppPath", "getWorkflow", "getAction", "assertEquals", "getName", "getName", "getName", "assertEquals", "getFrequency", "get", "getDatasetOrAsyncDataset", "getDatasets", "get", "getDatasetOrAsyncDataset", "getDatasets", "assertEquals", "getFrequency", "assertEquals", "getName", "assertEquals", "getStorageUrl", "getUriTemplate", "assertEquals", "getFrequency", "assertEquals", "getName", "assertEquals", "getUriTemplate", "getName", "get", "getDataIn", "getInputEvents", "getDataset", "get", "getDataIn", "getInputEvents", "get", "getInstance", "get", "getDataIn", "getInputEvents", "assertEquals", "assertEquals", "assertEquals", "getInstance", "get", "getDataOut", "getOutputEvents", "assertEquals", "getProperty", "getConfiguration", "getWorkflow", "getAction", "equals", "getName", "assertEquals", "getValue"]}, "focal_class": {"identifier": "OozieFeedMapper", "superclass": "extends AbstractOozieEntityMapper<Feed>", "interfaces": "", "fields": [{"original_string": "private static Logger LOG = Logger.getLogger(OozieFeedMapper.class);", "modifier": "private static", "type": "Logger", "declarator": "LOG = Logger.getLogger(OozieFeedMapper.class)", "var_name": "LOG"}, {"original_string": "private static final int THIRTY_MINUTES = 30 * 60 * 1000;", "modifier": "private static final", "type": "int", "declarator": "THIRTY_MINUTES = 30 * 60 * 1000", "var_name": "THIRTY_MINUTES"}, {"original_string": "private static final String RETENTION_WF_TEMPLATE = \"/config/workflow/retention-workflow.xml\";", "modifier": "private static final", "type": "String", "declarator": "RETENTION_WF_TEMPLATE = \"/config/workflow/retention-workflow.xml\"", "var_name": "RETENTION_WF_TEMPLATE"}, {"original_string": "private static final String REPLICATION_COORD_TEMPLATE = \"/config/coordinator/replication-coordinator.xml\";", "modifier": "private static final", "type": "String", "declarator": "REPLICATION_COORD_TEMPLATE = \"/config/coordinator/replication-coordinator.xml\"", "var_name": "REPLICATION_COORD_TEMPLATE"}, {"original_string": "private static final String REPLICATION_WF_TEMPLATE = \"/config/workflow/replication-workflow.xml\";", "modifier": "private static final", "type": "String", "declarator": "REPLICATION_WF_TEMPLATE = \"/config/workflow/replication-workflow.xml\"", "var_name": "REPLICATION_WF_TEMPLATE"}, {"original_string": "private static final String FEED_PATH_SEP=\"#\";", "modifier": "private static final", "type": "String", "declarator": "FEED_PATH_SEP=\"#\"", "var_name": "FEED_PATH_SEP"}, {"original_string": "private static final String TIMEOUT = \"timeout\";", "modifier": "private static final", "type": "String", "declarator": "TIMEOUT = \"timeout\"", "var_name": "TIMEOUT"}, {"original_string": "private static final String PARALLEL = \"parallel\";", "modifier": "private static final", "type": "String", "declarator": "PARALLEL = \"parallel\"", "var_name": "PARALLEL"}], "methods": [{"identifier": "OozieFeedMapper", "parameters": "(Feed feed)", "modifiers": "public", "return": "", "signature": " OozieFeedMapper(Feed feed)", "full_signature": "public  OozieFeedMapper(Feed feed)", "class_method_signature": "OozieFeedMapper.OozieFeedMapper(Feed feed)", "testcase": false, "constructor": true}, {"identifier": "getCoordinators", "parameters": "(Cluster cluster, Path bundlePath)", "modifiers": "@Override protected", "return": "List<COORDINATORAPP>", "signature": "List<COORDINATORAPP> getCoordinators(Cluster cluster, Path bundlePath)", "full_signature": "@Override protected List<COORDINATORAPP> getCoordinators(Cluster cluster, Path bundlePath)", "class_method_signature": "OozieFeedMapper.getCoordinators(Cluster cluster, Path bundlePath)", "testcase": false, "constructor": false}, {"identifier": "getRetentionCoordinator", "parameters": "(Cluster cluster, Path bundlePath)", "modifiers": "private", "return": "COORDINATORAPP", "signature": "COORDINATORAPP getRetentionCoordinator(Cluster cluster, Path bundlePath)", "full_signature": "private COORDINATORAPP getRetentionCoordinator(Cluster cluster, Path bundlePath)", "class_method_signature": "OozieFeedMapper.getRetentionCoordinator(Cluster cluster, Path bundlePath)", "testcase": false, "constructor": false}, {"identifier": "getRetentionWorkflowAction", "parameters": "(Cluster cluster, Path wfPath, String wfName)", "modifiers": "private", "return": "ACTION", "signature": "ACTION getRetentionWorkflowAction(Cluster cluster, Path wfPath, String wfName)", "full_signature": "private ACTION getRetentionWorkflowAction(Cluster cluster, Path wfPath, String wfName)", "class_method_signature": "OozieFeedMapper.getRetentionWorkflowAction(Cluster cluster, Path wfPath, String wfName)", "testcase": false, "constructor": false}, {"identifier": "getReplicationCoordinators", "parameters": "(Cluster targetCluster, Path bundlePath)", "modifiers": "private", "return": "List<COORDINATORAPP>", "signature": "List<COORDINATORAPP> getReplicationCoordinators(Cluster targetCluster, Path bundlePath)", "full_signature": "private List<COORDINATORAPP> getReplicationCoordinators(Cluster targetCluster, Path bundlePath)", "class_method_signature": "OozieFeedMapper.getReplicationCoordinators(Cluster targetCluster, Path bundlePath)", "testcase": false, "constructor": false}, {"identifier": "createAndGetCoord", "parameters": "(Feed feed, Cluster srcCluster, Cluster trgCluster, Path bundlePath)", "modifiers": "private", "return": "COORDINATORAPP", "signature": "COORDINATORAPP createAndGetCoord(Feed feed, Cluster srcCluster, Cluster trgCluster, Path bundlePath)", "full_signature": "private COORDINATORAPP createAndGetCoord(Feed feed, Cluster srcCluster, Cluster trgCluster, Path bundlePath)", "class_method_signature": "OozieFeedMapper.createAndGetCoord(Feed feed, Cluster srcCluster, Cluster trgCluster, Path bundlePath)", "testcase": false, "constructor": false}, {"identifier": "setDatasetValues", "parameters": "(SYNCDATASET dataset, Feed feed, Cluster cluster)", "modifiers": "private", "return": "void", "signature": "void setDatasetValues(SYNCDATASET dataset, Feed feed, Cluster cluster)", "full_signature": "private void setDatasetValues(SYNCDATASET dataset, Feed feed, Cluster cluster)", "class_method_signature": "OozieFeedMapper.setDatasetValues(SYNCDATASET dataset, Feed feed, Cluster cluster)", "testcase": false, "constructor": false}, {"identifier": "getReplicationWorkflowAction", "parameters": "(Cluster srcCluster, Cluster trgCluster, Path wfPath, String wfName)", "modifiers": "private", "return": "ACTION", "signature": "ACTION getReplicationWorkflowAction(Cluster srcCluster, Cluster trgCluster, Path wfPath, String wfName)", "full_signature": "private ACTION getReplicationWorkflowAction(Cluster srcCluster, Cluster trgCluster, Path wfPath, String wfName)", "class_method_signature": "OozieFeedMapper.getReplicationWorkflowAction(Cluster srcCluster, Cluster trgCluster, Path wfPath, String wfName)", "testcase": false, "constructor": false}, {"identifier": "createReplicatonWorkflow", "parameters": "(Cluster cluster, Path wfPath, String wfName)", "modifiers": "private", "return": "void", "signature": "void createReplicatonWorkflow(Cluster cluster, Path wfPath, String wfName)", "full_signature": "private void createReplicatonWorkflow(Cluster cluster, Path wfPath, String wfName)", "class_method_signature": "OozieFeedMapper.createReplicatonWorkflow(Cluster cluster, Path wfPath, String wfName)", "testcase": false, "constructor": false}, {"identifier": "createRetentionWorkflow", "parameters": "(Cluster cluster)", "modifiers": "private", "return": "WORKFLOWAPP", "signature": "WORKFLOWAPP createRetentionWorkflow(Cluster cluster)", "full_signature": "private WORKFLOWAPP createRetentionWorkflow(Cluster cluster)", "class_method_signature": "OozieFeedMapper.createRetentionWorkflow(Cluster cluster)", "testcase": false, "constructor": false}, {"identifier": "getEntityProperties", "parameters": "()", "modifiers": "@Override protected", "return": "Map<String, String>", "signature": "Map<String, String> getEntityProperties()", "full_signature": "@Override protected Map<String, String> getEntityProperties()", "class_method_signature": "OozieFeedMapper.getEntityProperties()", "testcase": false, "constructor": false}, {"identifier": "getLocationURI", "parameters": "(Cluster cluster, Feed feed, LocationType type)", "modifiers": "private", "return": "String", "signature": "String getLocationURI(Cluster cluster, Feed feed, LocationType type)", "full_signature": "private String getLocationURI(Cluster cluster, Feed feed, LocationType type)", "class_method_signature": "OozieFeedMapper.getLocationURI(Cluster cluster, Feed feed, LocationType type)", "testcase": false, "constructor": false}], "file": "feed/src/main/java/org/apache/ivory/converter/OozieFeedMapper.java"}, "focal_method": {"identifier": "getCoordinators", "parameters": "(Cluster cluster, Path bundlePath)", "modifiers": "@Override protected", "return": "List<COORDINATORAPP>", "body": "@Override\n    protected List<COORDINATORAPP> getCoordinators(Cluster cluster, Path bundlePath) throws IvoryException {\n        List<COORDINATORAPP> coords = new ArrayList<COORDINATORAPP>();\n        COORDINATORAPP retentionCoord = getRetentionCoordinator(cluster, bundlePath);\n        if (retentionCoord != null) {\n            coords.add(retentionCoord);\n        }\n        List<COORDINATORAPP> replicationCoords = getReplicationCoordinators(cluster, bundlePath);\n        coords.addAll(replicationCoords);\n        return coords;\n    }", "signature": "List<COORDINATORAPP> getCoordinators(Cluster cluster, Path bundlePath)", "full_signature": "@Override protected List<COORDINATORAPP> getCoordinators(Cluster cluster, Path bundlePath)", "class_method_signature": "OozieFeedMapper.getCoordinators(Cluster cluster, Path bundlePath)", "testcase": false, "constructor": false, "invocations": ["getRetentionCoordinator", "add", "getReplicationCoordinators", "addAll"]}, "repository": {"repo_id": 2836228, "url": "https://github.com/sriksun/Ivory", "language": "Java", "is_fork": false, "fork_count": 12, "stargazer_count": 28, "size": 11708, "license": "licensed"}}