{"test_class": {"identifier": "DefaultSysRoleSystemAttributeServiceTest", "superclass": "extends AbstractIntegrationTest", "interfaces": "", "fields": [{"original_string": "@Autowired\n\tprivate TestHelper helper;", "modifier": "@Autowired\n\tprivate", "type": "TestHelper", "declarator": "helper", "var_name": "helper"}, {"original_string": "@Autowired\n\tprivate IdmRoleService roleService;", "modifier": "@Autowired\n\tprivate", "type": "IdmRoleService", "declarator": "roleService", "var_name": "roleService"}, {"original_string": "@Autowired\n\tprivate IdmIdentityRoleService identityRoleService;", "modifier": "@Autowired\n\tprivate", "type": "IdmIdentityRoleService", "declarator": "identityRoleService", "var_name": "identityRoleService"}, {"original_string": "@Autowired\n\tprivate SysRoleSystemService roleSystemService;", "modifier": "@Autowired\n\tprivate", "type": "SysRoleSystemService", "declarator": "roleSystemService", "var_name": "roleSystemService"}, {"original_string": "@Autowired\n\tprivate SysRoleSystemAttributeService roleSystemAttributeService;", "modifier": "@Autowired\n\tprivate", "type": "SysRoleSystemAttributeService", "declarator": "roleSystemAttributeService", "var_name": "roleSystemAttributeService"}, {"original_string": "@Autowired\n\tprivate SysSystemService systemService;", "modifier": "@Autowired\n\tprivate", "type": "SysSystemService", "declarator": "systemService", "var_name": "systemService"}, {"original_string": "@Autowired \n\tprivate SysSchemaAttributeService schemaAttributeService;", "modifier": "@Autowired \n\tprivate", "type": "SysSchemaAttributeService", "declarator": "schemaAttributeService", "var_name": "schemaAttributeService"}, {"original_string": "@Autowired \n\tprivate SysSystemAttributeMappingService systemAttributeMappingService;", "modifier": "@Autowired \n\tprivate", "type": "SysSystemAttributeMappingService", "declarator": "systemAttributeMappingService", "var_name": "systemAttributeMappingService"}, {"original_string": "@Autowired \n\tprivate AccAccountService accountService;", "modifier": "@Autowired \n\tprivate", "type": "AccAccountService", "declarator": "accountService", "var_name": "accountService"}, {"original_string": "@Autowired\n\tprivate SysAttributeControlledValueService attributeControlledValueService;", "modifier": "@Autowired\n\tprivate", "type": "SysAttributeControlledValueService", "declarator": "attributeControlledValueService", "var_name": "attributeControlledValueService"}, {"original_string": "@Autowired\n\tprivate IdmIdentityService identityService;", "modifier": "@Autowired\n\tprivate", "type": "IdmIdentityService", "declarator": "identityService", "var_name": "identityService"}], "file": "Realization/backend/acc/src/test/java/eu/bcvsolutions/idm/acc/service/impl/DefaultSysRoleSystemAttributeServiceTest.java"}, "test_case": {"identifier": "testAddRoleMappingAttribute", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testAddRoleMappingAttribute() {\n\t\tIdmRoleDto role = helper.createRole();\n\t\tSysSystemDto system = helper.createTestResourceSystem(true);\n\n\t\tSysRoleSystemAttributeDto attribute = roleSystemAttributeService.addRoleMappingAttribute(system.getId(),\n\t\t\t\trole.getId(), helper.getSchemaColumnName(TestHelper.ATTRIBUTE_MAPPING_FIRSTNAME), null, IcObjectClassInfo.ACCOUNT);\n\t\tAssert.assertNotNull(attribute);\n\n\t\tSysRoleSystemFilter roleSystemFilter = new SysRoleSystemFilter();\n\t\troleSystemFilter.setRoleId(role.getId());\n\t\troleSystemFilter.setSystemId(system.getId());\n\n\t\tList<SysRoleSystemDto> roleSystems = roleSystemService.find(roleSystemFilter, null).getContent();\n\t\tAssert.assertEquals(1, roleSystems.size());\n\t\tSysRoleSystemDto roleSystem = roleSystems.get(0);\n\t\tSysSystemMappingDto systemMapping = roleSystemAttributeService.getSystemMapping(system.getId(),\n\t\t\t\tIcObjectClassInfo.ACCOUNT, SystemOperationType.PROVISIONING);\n\t\tAssert.assertNotNull(systemMapping);\n\t\tAssert.assertEquals(systemMapping.getId(), roleSystem.getSystemMapping());\n\t}", "signature": "void testAddRoleMappingAttribute()", "full_signature": "@Test public void testAddRoleMappingAttribute()", "class_method_signature": "DefaultSysRoleSystemAttributeServiceTest.testAddRoleMappingAttribute()", "testcase": true, "constructor": false, "invocations": ["createRole", "createTestResourceSystem", "addRoleMappingAttribute", "getId", "getId", "getSchemaColumnName", "assertNotNull", "setRoleId", "getId", "setSystemId", "getId", "getContent", "find", "assertEquals", "size", "get", "getSystemMapping", "getId", "assertNotNull", "assertEquals", "getId", "getSystemMapping"]}, "focal_class": {"identifier": "DefaultSysRoleSystemAttributeService", "superclass": "extends\n\t\tAbstractReadWriteDtoService<SysRoleSystemAttributeDto, SysRoleSystemAttribute, SysRoleSystemAttributeFilter>", "interfaces": "implements SysRoleSystemAttributeService", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(DefaultSysRoleSystemAttributeService.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(DefaultSysRoleSystemAttributeService.class)", "var_name": "LOG"}, {"original_string": "@Autowired\n\tprivate GroovyScriptService groovyScriptService;", "modifier": "@Autowired\n\tprivate", "type": "GroovyScriptService", "declarator": "groovyScriptService", "var_name": "groovyScriptService"}, {"original_string": "@Autowired\n\tprivate FormService formService;", "modifier": "@Autowired\n\tprivate", "type": "FormService", "declarator": "formService", "var_name": "formService"}, {"original_string": "@Autowired\n\tprivate SysRoleSystemService roleSystemService;", "modifier": "@Autowired\n\tprivate", "type": "SysRoleSystemService", "declarator": "roleSystemService", "var_name": "roleSystemService"}, {"original_string": "@Autowired\n\tprivate SysSystemAttributeMappingService systemAttributeMappingService;", "modifier": "@Autowired\n\tprivate", "type": "SysSystemAttributeMappingService", "declarator": "systemAttributeMappingService", "var_name": "systemAttributeMappingService"}, {"original_string": "@Autowired\n\tprivate SysSystemMappingService systemMappingService;", "modifier": "@Autowired\n\tprivate", "type": "SysSystemMappingService", "declarator": "systemMappingService", "var_name": "systemMappingService"}, {"original_string": "@Autowired\n\tprivate IdmRoleService roleService;", "modifier": "@Autowired\n\tprivate", "type": "IdmRoleService", "declarator": "roleService", "var_name": "roleService"}, {"original_string": "@Autowired\n\tprivate SysSchemaObjectClassService schemaObjectClassService;", "modifier": "@Autowired\n\tprivate", "type": "SysSchemaObjectClassService", "declarator": "schemaObjectClassService", "var_name": "schemaObjectClassService"}, {"original_string": "@Autowired\n\tprivate SysSchemaAttributeService schemaAttributeService;", "modifier": "@Autowired\n\tprivate", "type": "SysSchemaAttributeService", "declarator": "schemaAttributeService", "var_name": "schemaAttributeService"}, {"original_string": "@Autowired\n\tprivate RequestManager requestManager;", "modifier": "@Autowired\n\tprivate", "type": "RequestManager", "declarator": "requestManager", "var_name": "requestManager"}, {"original_string": "@Autowired\n\tprivate SysAttributeControlledValueService attributeControlledValueService;", "modifier": "@Autowired\n\tprivate", "type": "SysAttributeControlledValueService", "declarator": "attributeControlledValueService", "var_name": "attributeControlledValueService"}], "methods": [{"identifier": "DefaultSysRoleSystemAttributeService", "parameters": "(SysRoleSystemAttributeRepository repository)", "modifiers": "@Autowired public", "return": "", "signature": " DefaultSysRoleSystemAttributeService(SysRoleSystemAttributeRepository repository)", "full_signature": "@Autowired public  DefaultSysRoleSystemAttributeService(SysRoleSystemAttributeRepository repository)", "class_method_signature": "DefaultSysRoleSystemAttributeService.DefaultSysRoleSystemAttributeService(SysRoleSystemAttributeRepository repository)", "testcase": false, "constructor": true}, {"identifier": "save", "parameters": "(SysRoleSystemAttributeDto dto, BasePermission... permission)", "modifiers": "@Override @Transactional public", "return": "SysRoleSystemAttributeDto", "signature": "SysRoleSystemAttributeDto save(SysRoleSystemAttributeDto dto, BasePermission... permission)", "full_signature": "@Override @Transactional public SysRoleSystemAttributeDto save(SysRoleSystemAttributeDto dto, BasePermission... permission)", "class_method_signature": "DefaultSysRoleSystemAttributeService.save(SysRoleSystemAttributeDto dto, BasePermission... permission)", "testcase": false, "constructor": false}, {"identifier": "saveInternal", "parameters": "(SysRoleSystemAttributeDto dto)", "modifiers": "@Override public", "return": "SysRoleSystemAttributeDto", "signature": "SysRoleSystemAttributeDto saveInternal(SysRoleSystemAttributeDto dto)", "full_signature": "@Override public SysRoleSystemAttributeDto saveInternal(SysRoleSystemAttributeDto dto)", "class_method_signature": "DefaultSysRoleSystemAttributeService.saveInternal(SysRoleSystemAttributeDto dto)", "testcase": false, "constructor": false}, {"identifier": "delete", "parameters": "(SysRoleSystemAttributeDto roleSystemAttribute, BasePermission... permission)", "modifiers": "@Override @Transactional public", "return": "void", "signature": "void delete(SysRoleSystemAttributeDto roleSystemAttribute, BasePermission... permission)", "full_signature": "@Override @Transactional public void delete(SysRoleSystemAttributeDto roleSystemAttribute, BasePermission... permission)", "class_method_signature": "DefaultSysRoleSystemAttributeService.delete(SysRoleSystemAttributeDto roleSystemAttribute, BasePermission... permission)", "testcase": false, "constructor": false}, {"identifier": "addRoleMappingAttribute", "parameters": "(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "modifiers": "@Transactional @Override public", "return": "SysRoleSystemAttributeDto", "signature": "SysRoleSystemAttributeDto addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "full_signature": "@Transactional @Override public SysRoleSystemAttributeDto addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "testcase": false, "constructor": false}, {"identifier": "getSystemMapping", "parameters": "(UUID systemId, String objectClassName,\n\t\t\tSystemOperationType operationType)", "modifiers": "@Transactional @Override public", "return": "SysSystemMappingDto", "signature": "SysSystemMappingDto getSystemMapping(UUID systemId, String objectClassName,\n\t\t\tSystemOperationType operationType)", "full_signature": "@Transactional @Override public SysSystemMappingDto getSystemMapping(UUID systemId, String objectClassName,\n\t\t\tSystemOperationType operationType)", "class_method_signature": "DefaultSysRoleSystemAttributeService.getSystemMapping(UUID systemId, String objectClassName,\n\t\t\tSystemOperationType operationType)", "testcase": false, "constructor": false}, {"identifier": "toPredicates", "parameters": "(Root<SysRoleSystemAttribute> root, CriteriaQuery<?> query, CriteriaBuilder builder,\n\t\t\tSysRoleSystemAttributeFilter filter)", "modifiers": "@Override protected", "return": "List<Predicate>", "signature": "List<Predicate> toPredicates(Root<SysRoleSystemAttribute> root, CriteriaQuery<?> query, CriteriaBuilder builder,\n\t\t\tSysRoleSystemAttributeFilter filter)", "full_signature": "@Override protected List<Predicate> toPredicates(Root<SysRoleSystemAttribute> root, CriteriaQuery<?> query, CriteriaBuilder builder,\n\t\t\tSysRoleSystemAttributeFilter filter)", "class_method_signature": "DefaultSysRoleSystemAttributeService.toPredicates(Root<SysRoleSystemAttribute> root, CriteriaQuery<?> query, CriteriaBuilder builder,\n\t\t\tSysRoleSystemAttributeFilter filter)", "testcase": false, "constructor": false}, {"identifier": "getSysRoleSystem", "parameters": "(UUID systemId, UUID roleId, String objectClassName)", "modifiers": "private", "return": "UUID", "signature": "UUID getSysRoleSystem(UUID systemId, UUID roleId, String objectClassName)", "full_signature": "private UUID getSysRoleSystem(UUID systemId, UUID roleId, String objectClassName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.getSysRoleSystem(UUID systemId, UUID roleId, String objectClassName)", "testcase": false, "constructor": false}, {"identifier": "getObjectClassId", "parameters": "(UUID systemId, String objectClassName)", "modifiers": "private", "return": "UUID", "signature": "UUID getObjectClassId(UUID systemId, String objectClassName)", "full_signature": "private UUID getObjectClassId(UUID systemId, String objectClassName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.getObjectClassId(UUID systemId, String objectClassName)", "testcase": false, "constructor": false}, {"identifier": "getSystemAttributeMapping", "parameters": "(UUID systemId, String attributeName,\n\t\t\tString objectClassName)", "modifiers": "private", "return": "SysSystemAttributeMappingDto", "signature": "SysSystemAttributeMappingDto getSystemAttributeMapping(UUID systemId, String attributeName,\n\t\t\tString objectClassName)", "full_signature": "private SysSystemAttributeMappingDto getSystemAttributeMapping(UUID systemId, String attributeName,\n\t\t\tString objectClassName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.getSystemAttributeMapping(UUID systemId, String attributeName,\n\t\t\tString objectClassName)", "testcase": false, "constructor": false}, {"identifier": "getSchemaAttr", "parameters": "(UUID systemId, String attributeName, String objectClassName)", "modifiers": "private", "return": "SysSchemaAttributeDto", "signature": "SysSchemaAttributeDto getSchemaAttr(UUID systemId, String attributeName, String objectClassName)", "full_signature": "private SysSchemaAttributeDto getSchemaAttr(UUID systemId, String attributeName, String objectClassName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.getSchemaAttr(UUID systemId, String attributeName, String objectClassName)", "testcase": false, "constructor": false}, {"identifier": "getSystemAttribute", "parameters": "(UUID roleSystem, String attributeName)", "modifiers": "private", "return": "SysRoleSystemAttributeDto", "signature": "SysRoleSystemAttributeDto getSystemAttribute(UUID roleSystem, String attributeName)", "full_signature": "private SysRoleSystemAttributeDto getSystemAttribute(UUID roleSystem, String attributeName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.getSystemAttribute(UUID roleSystem, String attributeName)", "testcase": false, "constructor": false}, {"identifier": "recalculationOfControlledValues", "parameters": "(SysSystemAttributeMappingDto attributeMappingDto)", "modifiers": "private", "return": "void", "signature": "void recalculationOfControlledValues(SysSystemAttributeMappingDto attributeMappingDto)", "full_signature": "private void recalculationOfControlledValues(SysSystemAttributeMappingDto attributeMappingDto)", "class_method_signature": "DefaultSysRoleSystemAttributeService.recalculationOfControlledValues(SysSystemAttributeMappingDto attributeMappingDto)", "testcase": false, "constructor": false}], "file": "Realization/backend/acc/src/main/java/eu/bcvsolutions/idm/acc/service/impl/DefaultSysRoleSystemAttributeService.java"}, "focal_method": {"identifier": "addRoleMappingAttribute", "parameters": "(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "modifiers": "@Transactional @Override public", "return": "SysRoleSystemAttributeDto", "body": "@Transactional\n\t@Override\n\tpublic SysRoleSystemAttributeDto addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName) { // ObjectClassName \"__ACCOUNT__\"\n\t\tAssert.notNull(systemId, \"SystemId cannot be null!\");\n\t\tAssert.notNull(roleId, \"RoleId cannot be null!\");\n\t\tAssert.notNull(attributeName, \"Attribute name cannot be null\");\n\t\tAssert.hasLength(attributeName, \"Attribute name cannot be blank\");\n\n\t\tUUID roleSystemId = getSysRoleSystem(systemId, roleId, objectClassName);\n\t\tSysRoleSystemAttributeDto systemAttribute = getSystemAttribute(roleSystemId, attributeName);\n\t\tif (systemAttribute == null) {\n\t\t\tsystemAttribute = new SysRoleSystemAttributeDto();\n\t\t}\n\n\t\tsystemAttribute.setEntityAttribute(false);\n\t\tsystemAttribute.setStrategyType(AttributeMappingStrategyType.MERGE);\n\n\t\tUUID systemAttributeMappingId = getSystemAttributeMapping(systemId, attributeName, objectClassName).getId();\n\n\t\tsystemAttribute.setName(attributeName);\n\t\tsystemAttribute.setRoleSystem(roleSystemId);\n\t\tsystemAttribute.setSystemAttributeMapping(systemAttributeMappingId);\n\t\t//\n\t\tif (transformationScript != null) {\n\t\t\tsystemAttribute.setTransformScript(transformationScript);\n\t\t}\n\n\t\treturn this.save(systemAttribute);\n\t}", "signature": "SysRoleSystemAttributeDto addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "full_signature": "@Transactional @Override public SysRoleSystemAttributeDto addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "class_method_signature": "DefaultSysRoleSystemAttributeService.addRoleMappingAttribute(UUID systemId, UUID roleId, String attributeName,\n\t\t\tString transformationScript, String objectClassName)", "testcase": false, "constructor": false, "invocations": ["notNull", "notNull", "notNull", "hasLength", "getSysRoleSystem", "getSystemAttribute", "setEntityAttribute", "setStrategyType", "getId", "getSystemAttributeMapping", "setName", "setRoleSystem", "setSystemAttributeMapping", "setTransformScript", "save"]}, "repository": {"repo_id": 61879415, "url": "https://github.com/bcvsolutions/CzechIdMng", "stars": 25, "created": "6/24/2016 11:18:23 AM +00:00", "updates": "2020-01-27T15:14:40+00:00", "fork": "False", "license": "licensed"}}