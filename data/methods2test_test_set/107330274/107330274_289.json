{"test_class": {"identifier": "DefaultResourceConsumptionServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String NOT_DEFINED_CAPACITY_GROUP = \"not_defined_capacity_group\";", "modifier": "private static final", "type": "String", "declarator": "NOT_DEFINED_CAPACITY_GROUP = \"not_defined_capacity_group\"", "var_name": "NOT_DEFINED_CAPACITY_GROUP"}, {"original_string": "private final TestScheduler testScheduler = Schedulers.test();", "modifier": "private final", "type": "TestScheduler", "declarator": "testScheduler = Schedulers.test()", "var_name": "testScheduler"}, {"original_string": "private final AtomicReference<DefaultResourceConsumptionService.ConsumptionEvaluationResult> lastEvaluation = new AtomicReference<>();", "modifier": "private final", "type": "AtomicReference<DefaultResourceConsumptionService.ConsumptionEvaluationResult>", "declarator": "lastEvaluation = new AtomicReference<>()", "var_name": "lastEvaluation"}, {"original_string": "private final Supplier<DefaultResourceConsumptionService.ConsumptionEvaluationResult> evaluator = lastEvaluation::get;", "modifier": "private final", "type": "Supplier<DefaultResourceConsumptionService.ConsumptionEvaluationResult>", "declarator": "evaluator = lastEvaluation::get", "var_name": "evaluator"}, {"original_string": "private final DefaultResourceConsumptionService resourceConsumptionService = new DefaultResourceConsumptionService(\n            evaluator, new DefaultRegistry(), testScheduler\n    );", "modifier": "private final", "type": "DefaultResourceConsumptionService", "declarator": "resourceConsumptionService = new DefaultResourceConsumptionService(\n            evaluator, new DefaultRegistry(), testScheduler\n    )", "var_name": "resourceConsumptionService"}, {"original_string": "private final ConsumptionModelGenerator generator = new ConsumptionModelGenerator();", "modifier": "private final", "type": "ConsumptionModelGenerator", "declarator": "generator = new ConsumptionModelGenerator()", "var_name": "generator"}, {"original_string": "private final ExtTestSubscriber<ResourceConsumptionEvent> testSubscriber = new ExtTestSubscriber<>();", "modifier": "private final", "type": "ExtTestSubscriber<ResourceConsumptionEvent>", "declarator": "testSubscriber = new ExtTestSubscriber<>()", "var_name": "testSubscriber"}], "file": "titus-server-master/src/test/java/com/netflix/titus/master/service/management/internal/DefaultResourceConsumptionServiceTest.java"}, "test_case": {"identifier": "testGetSystemConsumption", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetSystemConsumption() throws Exception {\n        lastEvaluation.set(generator.getEvaluation());\n        testScheduler.advanceTimeBy(DefaultResourceConsumptionService.UPDATE_INTERVAL_MS, TimeUnit.MILLISECONDS);\n\n        Optional<CompositeResourceConsumption> resultOpt = resourceConsumptionService.getSystemConsumption();\n        assertThat(resultOpt).isNotEmpty();\n    }", "signature": "void testGetSystemConsumption()", "full_signature": "@Test public void testGetSystemConsumption()", "class_method_signature": "DefaultResourceConsumptionServiceTest.testGetSystemConsumption()", "testcase": true, "constructor": false, "invocations": ["set", "getEvaluation", "advanceTimeBy", "getSystemConsumption", "isNotEmpty", "assertThat"]}, "focal_class": {"identifier": "DefaultResourceConsumptionService", "superclass": "", "interfaces": "implements ResourceConsumptionService", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(DefaultResourceConsumptionService.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(DefaultResourceConsumptionService.class)", "var_name": "logger"}, {"original_string": "private static final String METRIC_CONSUMPTION = MetricConstants.METRIC_CAPACITY_MANAGEMENT + \"consumption.\";", "modifier": "private static final", "type": "String", "declarator": "METRIC_CONSUMPTION = MetricConstants.METRIC_CAPACITY_MANAGEMENT + \"consumption.\"", "var_name": "METRIC_CONSUMPTION"}, {"original_string": "static final long UPDATE_INTERVAL_MS = 5000;", "modifier": "static final", "type": "long", "declarator": "UPDATE_INTERVAL_MS = 5000", "var_name": "UPDATE_INTERVAL_MS"}, {"original_string": "private final Supplier<ConsumptionEvaluationResult> evaluator;", "modifier": "private final", "type": "Supplier<ConsumptionEvaluationResult>", "declarator": "evaluator", "var_name": "evaluator"}, {"original_string": "private final Registry registry;", "modifier": "private final", "type": "Registry", "declarator": "registry", "var_name": "registry"}, {"original_string": "private final Scheduler.Worker worker;", "modifier": "private final", "type": "Scheduler.Worker", "declarator": "worker", "var_name": "worker"}, {"original_string": "private ResourceConsumptionServiceMetrics metrics;", "modifier": "private", "type": "ResourceConsumptionServiceMetrics", "declarator": "metrics", "var_name": "metrics"}, {"original_string": "private Subscription subscription;", "modifier": "private", "type": "Subscription", "declarator": "subscription", "var_name": "subscription"}, {"original_string": "private final PublishSubject<ResourceConsumptionEvent> eventsSubject = PublishSubject.create();", "modifier": "private final", "type": "PublishSubject<ResourceConsumptionEvent>", "declarator": "eventsSubject = PublishSubject.create()", "var_name": "eventsSubject"}, {"original_string": "private volatile ConsumptionEvaluationResult latestEvaluation;", "modifier": "private volatile", "type": "ConsumptionEvaluationResult", "declarator": "latestEvaluation", "var_name": "latestEvaluation"}], "methods": [{"identifier": "DefaultResourceConsumptionService", "parameters": "(ApplicationSlaManagementService applicationSlaManagementService,\n                                             V3JobOperations v3JobOperations,\n                                             Registry registry)", "modifiers": "@Inject public", "return": "", "signature": " DefaultResourceConsumptionService(ApplicationSlaManagementService applicationSlaManagementService,\n                                             V3JobOperations v3JobOperations,\n                                             Registry registry)", "full_signature": "@Inject public  DefaultResourceConsumptionService(ApplicationSlaManagementService applicationSlaManagementService,\n                                             V3JobOperations v3JobOperations,\n                                             Registry registry)", "class_method_signature": "DefaultResourceConsumptionService.DefaultResourceConsumptionService(ApplicationSlaManagementService applicationSlaManagementService,\n                                             V3JobOperations v3JobOperations,\n                                             Registry registry)", "testcase": false, "constructor": true}, {"identifier": "DefaultResourceConsumptionService", "parameters": "(Supplier<ConsumptionEvaluationResult> evaluator,\n                                      Registry registry,\n                                      Scheduler scheduler)", "modifiers": "@VisibleForTesting", "return": "", "signature": " DefaultResourceConsumptionService(Supplier<ConsumptionEvaluationResult> evaluator,\n                                      Registry registry,\n                                      Scheduler scheduler)", "full_signature": "@VisibleForTesting  DefaultResourceConsumptionService(Supplier<ConsumptionEvaluationResult> evaluator,\n                                      Registry registry,\n                                      Scheduler scheduler)", "class_method_signature": "DefaultResourceConsumptionService.DefaultResourceConsumptionService(Supplier<ConsumptionEvaluationResult> evaluator,\n                                      Registry registry,\n                                      Scheduler scheduler)", "testcase": false, "constructor": true}, {"identifier": "enterActiveMode", "parameters": "()", "modifiers": "@Activator public", "return": "Observable<Void>", "signature": "Observable<Void> enterActiveMode()", "full_signature": "@Activator public Observable<Void> enterActiveMode()", "class_method_signature": "DefaultResourceConsumptionService.enterActiveMode()", "testcase": false, "constructor": false}, {"identifier": "shutdown", "parameters": "()", "modifiers": "@PreDestroy public", "return": "void", "signature": "void shutdown()", "full_signature": "@PreDestroy public void shutdown()", "class_method_signature": "DefaultResourceConsumptionService.shutdown()", "testcase": false, "constructor": false}, {"identifier": "getSystemConsumption", "parameters": "()", "modifiers": "@Override public", "return": "Optional<CompositeResourceConsumption>", "signature": "Optional<CompositeResourceConsumption> getSystemConsumption()", "full_signature": "@Override public Optional<CompositeResourceConsumption> getSystemConsumption()", "class_method_signature": "DefaultResourceConsumptionService.getSystemConsumption()", "testcase": false, "constructor": false}, {"identifier": "resourceConsumptionEvents", "parameters": "()", "modifiers": "@Override public", "return": "Observable<ResourceConsumptionEvent>", "signature": "Observable<ResourceConsumptionEvent> resourceConsumptionEvents()", "full_signature": "@Override public Observable<ResourceConsumptionEvent> resourceConsumptionEvents()", "class_method_signature": "DefaultResourceConsumptionService.resourceConsumptionEvents()", "testcase": false, "constructor": false}, {"identifier": "updateInfo", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void updateInfo()", "full_signature": "private void updateInfo()", "class_method_signature": "DefaultResourceConsumptionService.updateInfo()", "testcase": false, "constructor": false}, {"identifier": "notifyAboutRemovedCapacityGroups", "parameters": "(ConsumptionEvaluationResult oldEvaluation)", "modifiers": "private", "return": "void", "signature": "void notifyAboutRemovedCapacityGroups(ConsumptionEvaluationResult oldEvaluation)", "full_signature": "private void notifyAboutRemovedCapacityGroups(ConsumptionEvaluationResult oldEvaluation)", "class_method_signature": "DefaultResourceConsumptionService.notifyAboutRemovedCapacityGroups(ConsumptionEvaluationResult oldEvaluation)", "testcase": false, "constructor": false}, {"identifier": "notifyAboutResourceConsumptionChange", "parameters": "(ConsumptionEvaluationResult oldEvaluation)", "modifiers": "private", "return": "void", "signature": "void notifyAboutResourceConsumptionChange(ConsumptionEvaluationResult oldEvaluation)", "full_signature": "private void notifyAboutResourceConsumptionChange(ConsumptionEvaluationResult oldEvaluation)", "class_method_signature": "DefaultResourceConsumptionService.notifyAboutResourceConsumptionChange(ConsumptionEvaluationResult oldEvaluation)", "testcase": false, "constructor": false}, {"identifier": "notifyAboutUndefinedCapacityGroups", "parameters": "(ConsumptionEvaluationResult oldEvaluation)", "modifiers": "private", "return": "void", "signature": "void notifyAboutUndefinedCapacityGroups(ConsumptionEvaluationResult oldEvaluation)", "full_signature": "private void notifyAboutUndefinedCapacityGroups(ConsumptionEvaluationResult oldEvaluation)", "class_method_signature": "DefaultResourceConsumptionService.notifyAboutUndefinedCapacityGroups(ConsumptionEvaluationResult oldEvaluation)", "testcase": false, "constructor": false}, {"identifier": "publishEvent", "parameters": "(ResourceConsumptionEvent event)", "modifiers": "private", "return": "void", "signature": "void publishEvent(ResourceConsumptionEvent event)", "full_signature": "private void publishEvent(ResourceConsumptionEvent event)", "class_method_signature": "DefaultResourceConsumptionService.publishEvent(ResourceConsumptionEvent event)", "testcase": false, "constructor": false}], "file": "titus-server-master/src/main/java/com/netflix/titus/master/service/management/internal/DefaultResourceConsumptionService.java"}, "focal_method": {"identifier": "getSystemConsumption", "parameters": "()", "modifiers": "@Override public", "return": "Optional<CompositeResourceConsumption>", "body": "@Override\n    public Optional<CompositeResourceConsumption> getSystemConsumption() {\n        return latestEvaluation == null ? Optional.empty() : Optional.of(latestEvaluation.getSystemConsumption());\n    }", "signature": "Optional<CompositeResourceConsumption> getSystemConsumption()", "full_signature": "@Override public Optional<CompositeResourceConsumption> getSystemConsumption()", "class_method_signature": "DefaultResourceConsumptionService.getSystemConsumption()", "testcase": false, "constructor": false, "invocations": ["empty", "of", "getSystemConsumption"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}