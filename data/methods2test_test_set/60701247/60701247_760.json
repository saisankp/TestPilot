{"test_class": {"identifier": "CpuProfilerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final int FAKE_PID = 1234;", "modifier": "private static final", "type": "int", "declarator": "FAKE_PID = 1234", "var_name": "FAKE_PID"}, {"original_string": "private static final Common.Session FAKE_SESSION = Common.Session.newBuilder().setSessionId(4321).setPid(FAKE_PID).build();", "modifier": "private static final", "type": "Common.Session", "declarator": "FAKE_SESSION = Common.Session.newBuilder().setSessionId(4321).setPid(FAKE_PID).build()", "var_name": "FAKE_SESSION"}, {"original_string": "private final FakeTimer myTimer = new FakeTimer();", "modifier": "private final", "type": "FakeTimer", "declarator": "myTimer = new FakeTimer()", "var_name": "myTimer"}, {"original_string": "private final FakeTransportService myTransportService = new FakeTransportService(myTimer);", "modifier": "private final", "type": "FakeTransportService", "declarator": "myTransportService = new FakeTransportService(myTimer)", "var_name": "myTransportService"}, {"original_string": "private final FakeProfilerService myProfilerService = new FakeProfilerService(myTimer);", "modifier": "private final", "type": "FakeProfilerService", "declarator": "myProfilerService = new FakeProfilerService(myTimer)", "var_name": "myProfilerService"}, {"original_string": "private final FakeCpuService myCpuService = new FakeCpuService();", "modifier": "private final", "type": "FakeCpuService", "declarator": "myCpuService = new FakeCpuService()", "var_name": "myCpuService"}, {"original_string": "@Rule\n  public FakeGrpcChannel myGrpcChannel =\n    new FakeGrpcChannel(\"CpuProfilerTest\", myTransportService, myProfilerService, new FakeMemoryService(), myCpuService,\n                        new FakeEventService(), new FakeNetworkService.Builder().build(), new FakeEnergyService());", "modifier": "@Rule\n  public", "type": "FakeGrpcChannel", "declarator": "myGrpcChannel =\n    new FakeGrpcChannel(\"CpuProfilerTest\", myTransportService, myProfilerService, new FakeMemoryService(), myCpuService,\n                        new FakeEventService(), new FakeNetworkService.Builder().build(), new FakeEnergyService())", "var_name": "myGrpcChannel"}, {"original_string": "@Rule public final ExpectedException myExpectedException = ExpectedException.none();", "modifier": "@Rule public final", "type": "ExpectedException", "declarator": "myExpectedException = ExpectedException.none()", "var_name": "myExpectedException"}, {"original_string": "private CpuProfiler myCpuProfiler;", "modifier": "private", "type": "CpuProfiler", "declarator": "myCpuProfiler", "var_name": "myCpuProfiler"}, {"original_string": "private FakeIdeProfilerServices myIdeServices;", "modifier": "private", "type": "FakeIdeProfilerServices", "declarator": "myIdeServices", "var_name": "myIdeServices"}, {"original_string": "private StudioProfilers myProfilers;", "modifier": "private", "type": "StudioProfilers", "declarator": "myProfilers", "var_name": "myProfilers"}, {"original_string": "private final boolean myUnifiedPipeline;", "modifier": "private final", "type": "boolean", "declarator": "myUnifiedPipeline", "var_name": "myUnifiedPipeline"}], "file": "profilers/testSrc/com/android/tools/profilers/cpu/CpuProfilerTest.java"}, "test_case": {"identifier": "testGetTraceStatusEventFromId", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testGetTraceStatusEventFromId() {\n    Assume.assumeTrue(myUnifiedPipeline);\n\n    Common.Session session = myProfilers.getSession();\n    int TRACE_ID = 123;\n\n    // Insert a start status.\n    Cpu.CpuTraceStatusData status1 = Cpu.CpuTraceStatusData.newBuilder()\n      .setTraceStartStatus(Cpu.TraceStartStatus.newBuilder().setStatus(Cpu.TraceStartStatus.Status.SUCCESS))\n      .build();\n    Common.Event event1 =\n      Common.Event.newBuilder().setGroupId(TRACE_ID).setPid(session.getPid()).setKind(Common.Event.Kind.CPU_TRACE_STATUS).setTimestamp(1)\n        .setCpuTraceStatus(status1).build();\n    myTransportService.addEventToStream(session.getStreamId(), event1);\n\n    Common.Event event = CpuProfiler.getTraceStatusEventFromId(myProfilers, TRACE_ID);\n    assertThat(event).isEqualTo(event1);\n\n    // Insert a stop status.\n    Cpu.CpuTraceStatusData status2 = Cpu.CpuTraceStatusData.newBuilder()\n      .setTraceStopStatus(Cpu.TraceStopStatus.newBuilder().setStatus(Cpu.TraceStopStatus.Status.WAIT_TIMEOUT).setErrorMessage(\"error\"))\n      .build();\n    Common.Event event2 =\n      Common.Event.newBuilder().setGroupId(TRACE_ID).setPid(session.getPid()).setKind(Common.Event.Kind.CPU_TRACE_STATUS).setTimestamp(5)\n        .setCpuTraceStatus(status2).build();\n    myTransportService.addEventToStream(session.getStreamId(), event2);\n    // Insert an event from another TRACE_ID.\n    Common.Event event3 = event2.toBuilder().setGroupId(TRACE_ID + 100).build();\n    myTransportService.addEventToStream(session.getStreamId(), event3);\n\n    event = CpuProfiler.getTraceStatusEventFromId(myProfilers, TRACE_ID);\n    assertThat(event).isEqualTo(event2);\n    assertThat(event).isNotEqualTo(event3);\n  }", "signature": "void testGetTraceStatusEventFromId()", "full_signature": "@Test public void testGetTraceStatusEventFromId()", "class_method_signature": "CpuProfilerTest.testGetTraceStatusEventFromId()", "testcase": true, "constructor": false, "invocations": ["assumeTrue", "getSession", "build", "setTraceStartStatus", "newBuilder", "setStatus", "newBuilder", "build", "setCpuTraceStatus", "setTimestamp", "setKind", "setPid", "setGroupId", "newBuilder", "getPid", "addEventToStream", "getStreamId", "getTraceStatusEventFromId", "isEqualTo", "assertThat", "build", "setTraceStopStatus", "newBuilder", "setErrorMessage", "setStatus", "newBuilder", "build", "setCpuTraceStatus", "setTimestamp", "setKind", "setPid", "setGroupId", "newBuilder", "getPid", "addEventToStream", "getStreamId", "build", "setGroupId", "toBuilder", "addEventToStream", "getStreamId", "getTraceStatusEventFromId", "isEqualTo", "assertThat", "isNotEqualTo", "assertThat"]}, "focal_class": {"identifier": "CpuProfiler", "superclass": "extends StudioProfiler", "interfaces": "", "fields": [{"original_string": "@NotNull\n  private final Map<Long, File> mySessionTraceFiles;", "modifier": "@NotNull\n  private final", "type": "Map<Long, File>", "declarator": "mySessionTraceFiles", "var_name": "mySessionTraceFiles"}], "methods": [{"identifier": "CpuProfiler", "parameters": "(@NotNull StudioProfilers profilers)", "modifiers": "public", "return": "", "signature": " CpuProfiler(@NotNull StudioProfilers profilers)", "full_signature": "public  CpuProfiler(@NotNull StudioProfilers profilers)", "class_method_signature": "CpuProfiler.CpuProfiler(@NotNull StudioProfilers profilers)", "testcase": false, "constructor": true}, {"identifier": "run", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void run()", "full_signature": "private void run()", "class_method_signature": "CpuProfiler.run()", "testcase": false, "constructor": false}, {"identifier": "getLogger", "parameters": "()", "modifiers": "private static", "return": "Logger", "signature": "Logger getLogger()", "full_signature": "private static Logger getLogger()", "class_method_signature": "CpuProfiler.getLogger()", "testcase": false, "constructor": false}, {"identifier": "registerImportedSessionListener", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void registerImportedSessionListener()", "full_signature": "private void registerImportedSessionListener()", "class_method_signature": "CpuProfiler.registerImportedSessionListener()", "testcase": false, "constructor": false}, {"identifier": "registerTraceImportHandler", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void registerTraceImportHandler()", "full_signature": "private void registerTraceImportHandler()", "class_method_signature": "CpuProfiler.registerTraceImportHandler()", "testcase": false, "constructor": false}, {"identifier": "getTraceFile", "parameters": "(Common.Session session)", "modifiers": "@Nullable public", "return": "File", "signature": "File getTraceFile(Common.Session session)", "full_signature": "@Nullable public File getTraceFile(Common.Session session)", "class_method_signature": "CpuProfiler.getTraceFile(Common.Session session)", "testcase": false, "constructor": false}, {"identifier": "newMonitor", "parameters": "()", "modifiers": "@Override public", "return": "ProfilerMonitor", "signature": "ProfilerMonitor newMonitor()", "full_signature": "@Override public ProfilerMonitor newMonitor()", "class_method_signature": "CpuProfiler.newMonitor()", "testcase": false, "constructor": false}, {"identifier": "startProfiling", "parameters": "(Common.Session session)", "modifiers": "@Override public", "return": "void", "signature": "void startProfiling(Common.Session session)", "full_signature": "@Override public void startProfiling(Common.Session session)", "class_method_signature": "CpuProfiler.startProfiling(Common.Session session)", "testcase": false, "constructor": false}, {"identifier": "stopProfiling", "parameters": "(Common.Session session)", "modifiers": "@Override public", "return": "void", "signature": "void stopProfiling(Common.Session session)", "full_signature": "@Override public void stopProfiling(Common.Session session)", "class_method_signature": "CpuProfiler.stopProfiling(Common.Session session)", "testcase": false, "constructor": false}, {"identifier": "saveCaptureToFile", "parameters": "(@NotNull StudioProfilers profilers, @NotNull CpuTraceInfo info, @NotNull OutputStream outputStream)", "modifiers": "static", "return": "void", "signature": "void saveCaptureToFile(@NotNull StudioProfilers profilers, @NotNull CpuTraceInfo info, @NotNull OutputStream outputStream)", "full_signature": "static void saveCaptureToFile(@NotNull StudioProfilers profilers, @NotNull CpuTraceInfo info, @NotNull OutputStream outputStream)", "class_method_signature": "CpuProfiler.saveCaptureToFile(@NotNull StudioProfilers profilers, @NotNull CpuTraceInfo info, @NotNull OutputStream outputStream)", "testcase": false, "constructor": false}, {"identifier": "generateCaptureFileName", "parameters": "(@NotNull CpuTraceType profilerType)", "modifiers": "@NotNull static", "return": "String", "signature": "String generateCaptureFileName(@NotNull CpuTraceType profilerType)", "full_signature": "@NotNull static String generateCaptureFileName(@NotNull CpuTraceType profilerType)", "class_method_signature": "CpuProfiler.generateCaptureFileName(@NotNull CpuTraceType profilerType)", "testcase": false, "constructor": false}, {"identifier": "getTraceInfoFromRange", "parameters": "(@NotNull ProfilerClient client,\n                                                         @NotNull Common.Session session,\n                                                         @NotNull Range rangeUs,\n                                                         boolean newPipeline)", "modifiers": "@NotNull public static", "return": "List<CpuTraceInfo>", "signature": "List<CpuTraceInfo> getTraceInfoFromRange(@NotNull ProfilerClient client,\n                                                         @NotNull Common.Session session,\n                                                         @NotNull Range rangeUs,\n                                                         boolean newPipeline)", "full_signature": "@NotNull public static List<CpuTraceInfo> getTraceInfoFromRange(@NotNull ProfilerClient client,\n                                                         @NotNull Common.Session session,\n                                                         @NotNull Range rangeUs,\n                                                         boolean newPipeline)", "class_method_signature": "CpuProfiler.getTraceInfoFromRange(@NotNull ProfilerClient client,\n                                                         @NotNull Common.Session session,\n                                                         @NotNull Range rangeUs,\n                                                         boolean newPipeline)", "testcase": false, "constructor": false}, {"identifier": "getTraceInfoFromId", "parameters": "(@NotNull StudioProfilers profilers, long traceId)", "modifiers": "@NotNull public static", "return": "CpuTraceInfo", "signature": "CpuTraceInfo getTraceInfoFromId(@NotNull StudioProfilers profilers, long traceId)", "full_signature": "@NotNull public static CpuTraceInfo getTraceInfoFromId(@NotNull StudioProfilers profilers, long traceId)", "class_method_signature": "CpuProfiler.getTraceInfoFromId(@NotNull StudioProfilers profilers, long traceId)", "testcase": false, "constructor": false}, {"identifier": "getTraceInfoFromSession", "parameters": "(@NotNull ProfilerClient client,\n                                                           @NotNull Common.Session session,\n                                                           boolean newPipeline)", "modifiers": "@NotNull public static", "return": "List<CpuTraceInfo>", "signature": "List<CpuTraceInfo> getTraceInfoFromSession(@NotNull ProfilerClient client,\n                                                           @NotNull Common.Session session,\n                                                           boolean newPipeline)", "full_signature": "@NotNull public static List<CpuTraceInfo> getTraceInfoFromSession(@NotNull ProfilerClient client,\n                                                           @NotNull Common.Session session,\n                                                           boolean newPipeline)", "class_method_signature": "CpuProfiler.getTraceInfoFromSession(@NotNull ProfilerClient client,\n                                                           @NotNull Common.Session session,\n                                                           boolean newPipeline)", "testcase": false, "constructor": false}, {"identifier": "getTraceStatusEventFromId", "parameters": "(@NotNull StudioProfilers profilers, long traceId)", "modifiers": "@NotNull public static", "return": "Common.Event", "signature": "Common.Event getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId)", "full_signature": "@NotNull public static Common.Event getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId)", "class_method_signature": "CpuProfiler.getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId)", "testcase": false, "constructor": false}, {"identifier": "stopTracing", "parameters": "(@NotNull StudioProfilers profilers,\n                                 @NotNull Common.Session session,\n                                 @NotNull Cpu.CpuTraceConfiguration configuration,\n                                 @Nullable Consumer<Cpu.TraceStopStatus> responseHandler)", "modifiers": "public static", "return": "void", "signature": "void stopTracing(@NotNull StudioProfilers profilers,\n                                 @NotNull Common.Session session,\n                                 @NotNull Cpu.CpuTraceConfiguration configuration,\n                                 @Nullable Consumer<Cpu.TraceStopStatus> responseHandler)", "full_signature": "public static void stopTracing(@NotNull StudioProfilers profilers,\n                                 @NotNull Common.Session session,\n                                 @NotNull Cpu.CpuTraceConfiguration configuration,\n                                 @Nullable Consumer<Cpu.TraceStopStatus> responseHandler)", "class_method_signature": "CpuProfiler.stopTracing(@NotNull StudioProfilers profilers,\n                                 @NotNull Common.Session session,\n                                 @NotNull Cpu.CpuTraceConfiguration configuration,\n                                 @Nullable Consumer<Cpu.TraceStopStatus> responseHandler)", "testcase": false, "constructor": false}], "file": "profilers/src/com/android/tools/profilers/cpu/CpuProfiler.java"}, "focal_method": {"identifier": "getTraceStatusEventFromId", "parameters": "(@NotNull StudioProfilers profilers, long traceId)", "modifiers": "@NotNull public static", "return": "Common.Event", "body": "@NotNull\n  public static Common.Event getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId) {\n    if (!profilers.getIdeServices().getFeatureConfig().isUnifiedPipelineEnabled()) {\n      return Common.Event.getDefaultInstance();\n    }\n\n    Transport.GetEventGroupsResponse response = profilers.getClient().getTransportClient().getEventGroups(\n      Transport.GetEventGroupsRequest.newBuilder()\n        .setStreamId(profilers.getSession().getStreamId())\n        .setKind(Common.Event.Kind.CPU_TRACE_STATUS)\n        .setGroupId(traceId)\n        .build());\n    if (response.getGroupsCount() == 0) {\n      return Common.Event.getDefaultInstance();\n    }\n    return response.getGroups(0).getEvents(response.getGroups(0).getEventsCount() - 1);\n  }", "signature": "Common.Event getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId)", "full_signature": "@NotNull public static Common.Event getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId)", "class_method_signature": "CpuProfiler.getTraceStatusEventFromId(@NotNull StudioProfilers profilers, long traceId)", "testcase": false, "constructor": false, "invocations": ["isUnifiedPipelineEnabled", "getFeatureConfig", "getIdeServices", "getDefaultInstance", "getEventGroups", "getTransportClient", "getClient", "build", "setGroupId", "setKind", "setStreamId", "newBuilder", "getStreamId", "getSession", "getGroupsCount", "getDefaultInstance", "getEvents", "getGroups", "getEventsCount", "getGroups"]}, "repository": {"repo_id": 60701247, "url": "https://github.com/JetBrains/android", "stars": 486, "created": "6/8/2016 1:46:48 PM +00:00", "updates": "2020-01-27T16:45:40+00:00", "fork": "False", "license": "licensed"}}