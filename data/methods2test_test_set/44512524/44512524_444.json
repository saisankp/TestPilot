{"test_class": {"identifier": "TrendingTopicsTest", "superclass": "", "interfaces": "", "fields": [], "file": "storm/trident-examples/src/test/java/storm/trident/topology/TrendingTopicsTest.java"}, "test_case": {"identifier": "testRunTopology", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testRunTopology() throws InterruptedException {\n        Configuration conf = new Configuration();\n        TrendingTopics topology = new TrendingTopics(\"tt\", conf);\n        \n        StormRunner.runTopologyLocally(topology.buildTopology(), \"tt\", conf, 100);\n    }", "signature": "void testRunTopology()", "full_signature": "@Test public void testRunTopology()", "class_method_signature": "TrendingTopicsTest.testRunTopology()", "testcase": true, "constructor": false, "invocations": ["runTopologyLocally", "buildTopology"]}, "focal_class": {"identifier": "TrendingTopics", "superclass": "extends AbstractTopology", "interfaces": "", "fields": [{"original_string": "private String spoutType;", "modifier": "private", "type": "String", "declarator": "spoutType", "var_name": "spoutType"}, {"original_string": "private String sinkType;", "modifier": "private", "type": "String", "declarator": "sinkType", "var_name": "sinkType"}, {"original_string": "private int spoutThreads;", "modifier": "private", "type": "int", "declarator": "spoutThreads", "var_name": "spoutThreads"}, {"original_string": "private int parserThreads;", "modifier": "private", "type": "int", "declarator": "parserThreads", "var_name": "parserThreads"}, {"original_string": "private int topicExtractorThreads;", "modifier": "private", "type": "int", "declarator": "topicExtractorThreads", "var_name": "topicExtractorThreads"}, {"original_string": "private int counterThreads;", "modifier": "private", "type": "int", "declarator": "counterThreads", "var_name": "counterThreads"}, {"original_string": "private int trendingThreads;", "modifier": "private", "type": "int", "declarator": "trendingThreads", "var_name": "trendingThreads"}, {"original_string": "private int sinkThreads;", "modifier": "private", "type": "int", "declarator": "sinkThreads", "var_name": "sinkThreads"}], "methods": [{"identifier": "TrendingTopics", "parameters": "(String topologyName, Configuration config)", "modifiers": "public", "return": "", "signature": " TrendingTopics(String topologyName, Configuration config)", "full_signature": "public  TrendingTopics(String topologyName, Configuration config)", "class_method_signature": "TrendingTopics.TrendingTopics(String topologyName, Configuration config)", "testcase": false, "constructor": true}, {"identifier": "initialize", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void initialize()", "full_signature": "@Override public void initialize()", "class_method_signature": "TrendingTopics.initialize()", "testcase": false, "constructor": false}, {"identifier": "buildTopology", "parameters": "()", "modifiers": "@Override public", "return": "StormTopology", "signature": "StormTopology buildTopology()", "full_signature": "@Override public StormTopology buildTopology()", "class_method_signature": "TrendingTopics.buildTopology()", "testcase": false, "constructor": false}], "file": "storm/trident-examples/src/main/java/storm/trident/topology/TrendingTopics.java"}, "focal_method": {"identifier": "buildTopology", "parameters": "()", "modifiers": "@Override public", "return": "StormTopology", "body": "@Override\n    public StormTopology buildTopology() {\n        TridentTopology topology = new TridentTopology();\n        Stream rawTweets = null;\n        \n        switch (spoutType) {\n            case BaseConstants.SourceType.FILE:\n                int maxBatchSize = config.getInt(Config.SPOUT_MAX_BATCH_SIZE, 100);\n                String spoutPath = config.getString(Config.SPOUT_PATH);\n                rawTweets = topology.newStream(\"spout\", new FileSpout(maxBatchSize, spoutPath));\n                break;\n            case BaseConstants.SourceType.KAFKA:\n                createKafkaSpout(spoutType, spoutType);\n                break;\n            default:\n                throw new IllegalArgumentException(\"Must inform a spout type\");\n        }\n        \n        rawTweets = rawTweets.parallelismHint(spoutThreads)\n                .shuffle();\n        \n        Stream tweets = rawTweets.each(new Fields(\"tweet_str\"), new JsonParser(), new Fields(\"tweet\"))\n                .parallelismHint(parserThreads)\n                .shuffle()\n                .project(new Fields(\"tweet\"));\n        \n        GroupedStream topics = tweets.each(new Fields(\"tweet\"), new TopicExtractor(), new Fields(\"topic\"))\n                .parallelismHint(topicExtractorThreads)\n                .groupBy(new Fields(\"topic\"));\n        \n        Stream counts = topics.persistentAggregate(new MemoryMapState.Factory(), new Count(), new Fields(\"count\"))\n                .parallelismHint(counterThreads)\n                .newValuesStream();\n        \n        Stream trending = counts.persistentAggregate(new MemoryMapState.Factory(), new Fields(\"topic\", \"count\"), new MaxCount(), new Fields(\"top\"))\n                .newValuesStream()\n                .parallelismHint(trendingThreads);\n        \n        //Stream trending = counts.batchGlobal().partitionAggregate(new Fields(\"topic\", \"count\"), new MaxCount2(), new Fields(\"topic\", \"count\"));\n        \n        if (sinkType.equals(SinkType.CONSOLE)) {\n            trending.each(new Fields(\"top\"), new Debug())\n                    .parallelismHint(sinkThreads);\n        }\n        \n        return topology.build();\n    }", "signature": "StormTopology buildTopology()", "full_signature": "@Override public StormTopology buildTopology()", "class_method_signature": "TrendingTopics.buildTopology()", "testcase": false, "constructor": false, "invocations": ["getInt", "getString", "newStream", "createKafkaSpout", "shuffle", "parallelismHint", "project", "shuffle", "parallelismHint", "each", "groupBy", "parallelismHint", "each", "newValuesStream", "parallelismHint", "persistentAggregate", "parallelismHint", "newValuesStream", "persistentAggregate", "equals", "parallelismHint", "each", "build"]}, "repository": {"repo_id": 44512524, "url": "https://github.com/zqhxuyuan/bigdata", "language": "Java", "is_fork": false, "fork_count": 6, "stargazer_count": 8, "size": 91550, "license": "licensed"}}