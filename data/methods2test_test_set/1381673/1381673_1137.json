{"test_class": {"identifier": "KiePMMLMiningModelFactoryTest", "superclass": "extends AbstractKiePMMLFactoryTest", "interfaces": "", "fields": [{"original_string": "private static final String TEMPLATE_SOURCE = \"Template.tmpl\";", "modifier": "private static final", "type": "String", "declarator": "TEMPLATE_SOURCE = \"Template.tmpl\"", "var_name": "TEMPLATE_SOURCE"}, {"original_string": "private static final String TEMPLATE_CLASS_NAME = \"Template\";", "modifier": "private static final", "type": "String", "declarator": "TEMPLATE_CLASS_NAME = \"Template\"", "var_name": "TEMPLATE_CLASS_NAME"}, {"original_string": "private static CompilationUnit COMPILATION_UNIT;", "modifier": "private static", "type": "CompilationUnit", "declarator": "COMPILATION_UNIT", "var_name": "COMPILATION_UNIT"}, {"original_string": "private static ClassOrInterfaceDeclaration MODEL_TEMPLATE;", "modifier": "private static", "type": "ClassOrInterfaceDeclaration", "declarator": "MODEL_TEMPLATE", "var_name": "MODEL_TEMPLATE"}], "file": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-mining/kie-pmml-models-mining-compiler/src/test/java/org/kie/pmml/models/mining/compiler/factories/KiePMMLMiningModelFactoryTest.java"}, "test_case": {"identifier": "getKiePMMLMiningModelSourcesMap", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getKiePMMLMiningModelSourcesMap() {\n        final String packageName = \"packagename\";\n        final List<KiePMMLModel> nestedModels = new ArrayList<>();\n        final Map<String, String> retrieved = KiePMMLMiningModelFactory.getKiePMMLMiningModelSourcesMap(DATA_DICTIONARY,\n                                                                                                        TRANSFORMATION_DICTIONARY,\n                                                                                                        MINING_MODEL,\n                                                                                                        packageName,\n                                                                                                       KNOWLEDGE_BUILDER,\n                                                                                                       nestedModels);\n        assertNotNull(retrieved);\n        int expectedNestedModels = MINING_MODEL.getSegmentation().getSegments().size();\n        assertEquals(expectedNestedModels, nestedModels.size());\n    }", "signature": "void getKiePMMLMiningModelSourcesMap()", "full_signature": "@Test public void getKiePMMLMiningModelSourcesMap()", "class_method_signature": "KiePMMLMiningModelFactoryTest.getKiePMMLMiningModelSourcesMap()", "testcase": true, "constructor": false, "invocations": ["getKiePMMLMiningModelSourcesMap", "assertNotNull", "size", "getSegments", "getSegmentation", "assertEquals", "size"]}, "focal_class": {"identifier": "KiePMMLMiningModelFactory", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final String SEGMENTATIONNAME_TEMPLATE = \"%s_Segmentation\";", "modifier": "static final", "type": "String", "declarator": "SEGMENTATIONNAME_TEMPLATE = \"%s_Segmentation\"", "var_name": "SEGMENTATIONNAME_TEMPLATE"}, {"original_string": "private static final Logger logger = LoggerFactory.getLogger(KiePMMLMiningModelFactory.class.getName());", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(KiePMMLMiningModelFactory.class.getName())", "var_name": "logger"}, {"original_string": "static final String KIE_PMML_MINING_MODEL_TEMPLATE_JAVA = \"KiePMMLMiningModelTemplate.tmpl\";", "modifier": "static final", "type": "String", "declarator": "KIE_PMML_MINING_MODEL_TEMPLATE_JAVA = \"KiePMMLMiningModelTemplate.tmpl\"", "var_name": "KIE_PMML_MINING_MODEL_TEMPLATE_JAVA"}, {"original_string": "static final String KIE_PMML_MINING_MODEL_TEMPLATE = \"KiePMMLMiningModelTemplate\";", "modifier": "static final", "type": "String", "declarator": "KIE_PMML_MINING_MODEL_TEMPLATE = \"KiePMMLMiningModelTemplate\"", "var_name": "KIE_PMML_MINING_MODEL_TEMPLATE"}], "methods": [{"identifier": "KiePMMLMiningModelFactory", "parameters": "()", "modifiers": "private", "return": "", "signature": " KiePMMLMiningModelFactory()", "full_signature": "private  KiePMMLMiningModelFactory()", "class_method_signature": "KiePMMLMiningModelFactory.KiePMMLMiningModelFactory()", "testcase": false, "constructor": true}, {"identifier": "getKiePMMLMiningModel", "parameters": "(final DataDictionary dataDictionary,\n                                                           final TransformationDictionary transformationDictionary,\n                                                           final MiningModel model,\n                                                           final KnowledgeBuilder kBuilder)", "modifiers": "public static", "return": "KiePMMLMiningModel", "signature": "KiePMMLMiningModel getKiePMMLMiningModel(final DataDictionary dataDictionary,\n                                                           final TransformationDictionary transformationDictionary,\n                                                           final MiningModel model,\n                                                           final KnowledgeBuilder kBuilder)", "full_signature": "public static KiePMMLMiningModel getKiePMMLMiningModel(final DataDictionary dataDictionary,\n                                                           final TransformationDictionary transformationDictionary,\n                                                           final MiningModel model,\n                                                           final KnowledgeBuilder kBuilder)", "class_method_signature": "KiePMMLMiningModelFactory.getKiePMMLMiningModel(final DataDictionary dataDictionary,\n                                                           final TransformationDictionary transformationDictionary,\n                                                           final MiningModel model,\n                                                           final KnowledgeBuilder kBuilder)", "testcase": false, "constructor": false}, {"identifier": "getKiePMMLMiningModelSourcesMap", "parameters": "(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "modifiers": "public static", "return": "Map<String, String>", "signature": "Map<String, String> getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "full_signature": "public static Map<String, String> getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "class_method_signature": "KiePMMLMiningModelFactory.getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "testcase": false, "constructor": false}, {"identifier": "setConstructor", "parameters": "(final String generatedClassName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName,\n                               final String segmentationClass)", "modifiers": "static", "return": "void", "signature": "void setConstructor(final String generatedClassName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName,\n                               final String segmentationClass)", "full_signature": "static void setConstructor(final String generatedClassName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName,\n                               final String segmentationClass)", "class_method_signature": "KiePMMLMiningModelFactory.setConstructor(final String generatedClassName,\n                               final ConstructorDeclaration constructorDeclaration,\n                               final String targetField,\n                               final MINING_FUNCTION miningFunction,\n                               final String modelName,\n                               final String segmentationClass)", "testcase": false, "constructor": false}], "file": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-mining/kie-pmml-models-mining-compiler/src/main/java/org/kie/pmml/models/mining/compiler/factories/KiePMMLMiningModelFactory.java"}, "focal_method": {"identifier": "getKiePMMLMiningModelSourcesMap", "parameters": "(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "modifiers": "public static", "return": "Map<String, String>", "body": "public static Map<String, String> getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels) {\n        logger.trace(\"getKiePMMLMiningModelSourcesMap {} {} {}\", dataDictionary, model, parentPackageName);\n        final String segmentationName = String.format(SEGMENTATIONNAME_TEMPLATE, model.getModelName());\n        final Map<String, String> toReturn = getSegmentationSourcesMap(parentPackageName,\n                                                                       dataDictionary,\n                                                                       transformationDictionary,\n                                                                       model.getSegmentation(),\n                                                                       segmentationName,\n                                                                       kBuilder,\n                                                                       nestedModels);\n        String segmentationClass = getSanitizedPackageName(parentPackageName + \".\" + segmentationName) + \".\" + getSanitizedClassName(segmentationName);\n        if (!toReturn.containsKey(segmentationClass)) {\n            throw new KiePMMLException(\"Expected generated class \" + segmentationClass + \" not found\");\n        }\n        String className = getSanitizedClassName(model.getModelName());\n        CompilationUnit cloneCU = JavaParserUtils.getKiePMMLModelCompilationUnit(className, parentPackageName, KIE_PMML_MINING_MODEL_TEMPLATE_JAVA, KIE_PMML_MINING_MODEL_TEMPLATE);\n        ClassOrInterfaceDeclaration modelTemplate = cloneCU.getClassByName(className)\n                .orElseThrow(() -> new KiePMMLException(MAIN_CLASS_NOT_FOUND + \": \" + className));\n        String modelName = model.getModelName();\n        String targetFieldName = getTargetFieldName(dataDictionary, model).orElse(null);\n        List<KiePMMLOutputField> outputFields = getOutputFields(model);\n        final ConstructorDeclaration constructorDeclaration = modelTemplate.getDefaultConstructor().orElseThrow(() -> new KiePMMLInternalException(String.format(MISSING_DEFAULT_CONSTRUCTOR, modelTemplate.getName())));\n        setConstructor(className,\n                       constructorDeclaration,\n                       targetFieldName,\n                       MINING_FUNCTION.byName(model.getMiningFunction().value()),\n                       modelName,\n                       segmentationClass);\n        addOutputFieldsPopulation(constructorDeclaration.getBody(), outputFields);\n        addTransformationsInClassOrInterfaceDeclaration(modelTemplate, transformationDictionary, model.getLocalTransformations());\n        toReturn.put(getFullClassName(cloneCU), cloneCU.toString());\n        return toReturn;\n    }", "signature": "Map<String, String> getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "full_signature": "public static Map<String, String> getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "class_method_signature": "KiePMMLMiningModelFactory.getKiePMMLMiningModelSourcesMap(final DataDictionary dataDictionary,\n                                                                      final TransformationDictionary transformationDictionary,\n                                                                      final MiningModel model,\n                                                                      final String parentPackageName,\n                                                                      final KnowledgeBuilder kBuilder,\n                                                                      final List<KiePMMLModel> nestedModels)", "testcase": false, "constructor": false, "invocations": ["trace", "format", "getModelName", "getSegmentationSourcesMap", "getSegmentation", "getSanitizedPackageName", "getSanitizedClassName", "containsKey", "getSanitizedClassName", "getModelName", "getKiePMMLModelCompilationUnit", "orElseThrow", "getClassByName", "getModelName", "orElse", "getTargetFieldName", "getOutputFields", "orElseThrow", "getDefaultConstructor", "format", "getName", "setConstructor", "byName", "value", "getMiningFunction", "addOutputFieldsPopulation", "getBody", "addTransformationsInClassOrInterfaceDeclaration", "getLocalTransformations", "put", "getFullClassName", "toString"]}, "repository": {"repo_id": 1381673, "url": "https://github.com/kiegroup/drools", "stars": 2733, "created": "2/18/2011 8:37:05 AM +00:00", "updates": "2020-01-27T13:12:15+00:00", "fork": "False", "license": "licensed"}}