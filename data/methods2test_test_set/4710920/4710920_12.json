{"test_class": {"identifier": "PortTelnetHandlerTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static TelnetHandler port = new PortTelnetHandler();", "modifier": "private static", "type": "TelnetHandler", "declarator": "port = new PortTelnetHandler()", "var_name": "port"}, {"original_string": "private static Invoker<DemoService> mockInvoker;", "modifier": "private static", "type": "Invoker<DemoService>", "declarator": "mockInvoker", "var_name": "mockInvoker"}, {"original_string": "private static int availablePort = NetUtils.getAvailablePort();", "modifier": "private static", "type": "int", "declarator": "availablePort = NetUtils.getAvailablePort()", "var_name": "availablePort"}], "file": "dubbo-plugin/dubbo-qos/src/test/java/org/apache/dubbo/qos/legacy/PortTelnetHandlerTest.java"}, "test_case": {"identifier": "testListDetail", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testListDetail() throws RemotingException {\n        String result = port.telnet(null, \"-l\");\n        assertEquals(\"dubbo://127.0.0.1:\" + availablePort + \"\", result);\n    }", "signature": "void testListDetail()", "full_signature": "@Test public void testListDetail()", "class_method_signature": "PortTelnetHandlerTest.testListDetail()", "testcase": true, "constructor": false, "invocations": ["telnet", "assertEquals"]}, "focal_class": {"identifier": "PortTelnetHandler", "superclass": "", "interfaces": "implements TelnetHandler", "fields": [], "methods": [{"identifier": "telnet", "parameters": "(Channel channel, String message)", "modifiers": "@Override public", "return": "String", "signature": "String telnet(Channel channel, String message)", "full_signature": "@Override public String telnet(Channel channel, String message)", "class_method_signature": "PortTelnetHandler.telnet(Channel channel, String message)", "testcase": false, "constructor": false}], "file": "dubbo-plugin/dubbo-qos/src/main/java/org/apache/dubbo/qos/legacy/PortTelnetHandler.java"}, "focal_method": {"identifier": "telnet", "parameters": "(Channel channel, String message)", "modifiers": "@Override public", "return": "String", "body": "@Override\n    public String telnet(Channel channel, String message) {\n        StringBuilder buf = new StringBuilder();\n        String port = null;\n        boolean detail = false;\n        if (message.length() > 0) {\n            String[] parts = message.split(\"\\\\s+\");\n            for (String part : parts) {\n                if (\"-l\".equals(part)) {\n                    detail = true;\n                } else {\n                    if (!StringUtils.isInteger(part)) {\n                        return \"Illegal port \" + part + \", must be integer.\";\n                    }\n                    port = part;\n                }\n            }\n        }\n        if (port == null || port.length() == 0) {\n            for (ProtocolServer server : DubboProtocol.getDubboProtocol().getServers()) {\n                if (buf.length() > 0) {\n                    buf.append(\"\\r\\n\");\n                }\n                if (detail) {\n                    buf.append(server.getUrl().getProtocol()).append(\"://\").append(server.getUrl().getAddress());\n                } else {\n                    buf.append(server.getUrl().getPort());\n                }\n            }\n        } else {\n            int p = Integer.parseInt(port);\n            ProtocolServer protocolServer = null;\n            for (ProtocolServer s : DubboProtocol.getDubboProtocol().getServers()) {\n                if (p == s.getUrl().getPort()) {\n                    protocolServer = s;\n                    break;\n                }\n            }\n            if (protocolServer != null) {\n                ExchangeServer server = (ExchangeServer) protocolServer.getRemotingServer();\n                Collection<ExchangeChannel> channels = server.getExchangeChannels();\n                for (ExchangeChannel c : channels) {\n                    if (buf.length() > 0) {\n                        buf.append(\"\\r\\n\");\n                    }\n                    if (detail) {\n                        buf.append(c.getRemoteAddress()).append(\" -> \").append(c.getLocalAddress());\n                    } else {\n                        buf.append(c.getRemoteAddress());\n                    }\n                }\n            } else {\n                buf.append(\"No such port \").append(port);\n            }\n        }\n        return buf.toString();\n    }", "signature": "String telnet(Channel channel, String message)", "full_signature": "@Override public String telnet(Channel channel, String message)", "class_method_signature": "PortTelnetHandler.telnet(Channel channel, String message)", "testcase": false, "constructor": false, "invocations": ["length", "split", "equals", "isInteger", "length", "getServers", "getDubboProtocol", "length", "append", "append", "append", "append", "getProtocol", "getUrl", "getAddress", "getUrl", "append", "getPort", "getUrl", "parseInt", "getServers", "getDubboProtocol", "getPort", "getUrl", "getRemotingServer", "getExchangeChannels", "length", "append", "append", "append", "append", "getRemoteAddress", "getLocalAddress", "append", "getRemoteAddress", "append", "append", "toString"]}, "repository": {"repo_id": 4710920, "url": "https://github.com/apache/dubbo", "stars": 30960, "created": "6/19/2012 7:56:02 AM +00:00", "updates": "2020-01-27T14:21:03+00:00", "fork": "False", "license": "licensed"}}