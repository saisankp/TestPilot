{"test_class": {"identifier": "TestRequestProxyAuthentication", "superclass": "", "interfaces": "", "fields": [], "file": "external_sources/httpclient-4.1.1/httpclient/src/test/java/org/apache/ogt/http/client/protocol/TestRequestProxyAuthentication.java"}, "test_case": {"identifier": "testAuthStateNotSet", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testAuthStateNotSet() throws Exception {\n        HttpRequest request = new BasicHttpRequest(\"GET\", \"/\");\n        HttpContext context = new BasicHttpContext();\n\n        HttpHost target = new HttpHost(\"localhost\", 80, \"http\");\n        HttpHost proxy = new HttpHost(\"localhost\", 8080);\n        HttpRoute route = new HttpRoute(target, null, proxy, false,\n                TunnelType.PLAIN, LayerType.PLAIN);\n\n        HttpRoutedConnection conn = Mockito.mock(HttpRoutedConnection.class);\n        Mockito.when(conn.getRoute()).thenReturn(route);\n\n        context.setAttribute(ExecutionContext.HTTP_CONNECTION, conn);\n        context.setAttribute(ClientContext.PROXY_AUTH_STATE, null);\n\n        HttpRequestInterceptor interceptor = new RequestProxyAuthentication();\n        interceptor.process(request, context);\n        Header header = request.getFirstHeader(AUTH.PROXY_AUTH_RESP);\n        Assert.assertNull(header);\n    }", "signature": "void testAuthStateNotSet()", "full_signature": "@Test public void testAuthStateNotSet()", "class_method_signature": "TestRequestProxyAuthentication.testAuthStateNotSet()", "testcase": true, "constructor": false, "invocations": ["mock", "thenReturn", "when", "getRoute", "setAttribute", "setAttribute", "process", "getFirstHeader", "assertNull"]}, "focal_class": {"identifier": "RequestProxyAuthentication", "superclass": "", "interfaces": "implements HttpRequestInterceptor", "fields": [{"original_string": "private final Log log = LogFactory.getLog(getClass());", "modifier": "private final", "type": "Log", "declarator": "log = LogFactory.getLog(getClass())", "var_name": "log"}], "methods": [{"identifier": "RequestProxyAuthentication", "parameters": "()", "modifiers": "public", "return": "", "signature": " RequestProxyAuthentication()", "full_signature": "public  RequestProxyAuthentication()", "class_method_signature": "RequestProxyAuthentication.RequestProxyAuthentication()", "testcase": false, "constructor": true}, {"identifier": "process", "parameters": "(final HttpRequest request, final HttpContext context)", "modifiers": "@SuppressWarnings(\"deprecation\") public", "return": "void", "signature": "void process(final HttpRequest request, final HttpContext context)", "full_signature": "@SuppressWarnings(\"deprecation\") public void process(final HttpRequest request, final HttpContext context)", "class_method_signature": "RequestProxyAuthentication.process(final HttpRequest request, final HttpContext context)", "testcase": false, "constructor": false}], "file": "external_sources/httpclient-4.1.1/httpclient/src/main/java/org/apache/ogt/http/client/protocol/RequestProxyAuthentication.java"}, "focal_method": {"identifier": "process", "parameters": "(final HttpRequest request, final HttpContext context)", "modifiers": "@SuppressWarnings(\"deprecation\") public", "return": "void", "body": "@SuppressWarnings(\"deprecation\")\n    public void process(final HttpRequest request, final HttpContext context)\n            throws HttpException, IOException {\n        if (request == null) {\n            throw new IllegalArgumentException(\"HTTP request may not be null\");\n        }\n        if (context == null) {\n            throw new IllegalArgumentException(\"HTTP context may not be null\");\n        }\n\n        if (request.containsHeader(AUTH.PROXY_AUTH_RESP)) {\n            return;\n        }\n\n        HttpRoutedConnection conn = (HttpRoutedConnection) context.getAttribute(\n                ExecutionContext.HTTP_CONNECTION);\n        if (conn == null) {\n            this.log.debug(\"HTTP connection not set in the context\");\n            return;\n        }\n        HttpRoute route = conn.getRoute();\n        if (route.isTunnelled()) {\n            return;\n        }\n\n        // Obtain authentication state\n        AuthState authState = (AuthState) context.getAttribute(\n                ClientContext.PROXY_AUTH_STATE);\n        if (authState == null) {\n            this.log.debug(\"Proxy auth state not set in the context\");\n            return;\n        }\n\n        AuthScheme authScheme = authState.getAuthScheme();\n        if (authScheme == null) {\n            return;\n        }\n\n        Credentials creds = authState.getCredentials();\n        if (creds == null) {\n            this.log.debug(\"User credentials not available\");\n            return;\n        }\n        if (authState.getAuthScope() != null || !authScheme.isConnectionBased()) {\n            try {\n                Header header;\n                if (authScheme instanceof ContextAwareAuthScheme) {\n                    header = ((ContextAwareAuthScheme) authScheme).authenticate(\n                            creds, request, context);\n                } else {\n                    header = authScheme.authenticate(creds, request);\n                }\n                request.addHeader(header);\n            } catch (AuthenticationException ex) {\n                if (this.log.isErrorEnabled()) {\n                    this.log.error(\"Proxy authentication error: \" + ex.getMessage());\n                }\n            }\n        }\n    }", "signature": "void process(final HttpRequest request, final HttpContext context)", "full_signature": "@SuppressWarnings(\"deprecation\") public void process(final HttpRequest request, final HttpContext context)", "class_method_signature": "RequestProxyAuthentication.process(final HttpRequest request, final HttpContext context)", "testcase": false, "constructor": false, "invocations": ["containsHeader", "getAttribute", "debug", "getRoute", "isTunnelled", "getAttribute", "debug", "getAuthScheme", "getCredentials", "debug", "getAuthScope", "isConnectionBased", "authenticate", "authenticate", "addHeader", "isErrorEnabled", "error", "getMessage"]}, "repository": {"repo_id": 3384018, "url": "https://github.com/f8full/open-bixi-gpstracker", "language": "Java", "is_fork": false, "fork_count": 3, "stargazer_count": 5, "size": 2028, "license": "licensed"}}