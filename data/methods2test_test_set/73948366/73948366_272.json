{"test_class": {"identifier": "PrincipalTokenTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final String svcVersion = \"S1\";", "modifier": "private final", "type": "String", "declarator": "svcVersion = \"S1\"", "var_name": "svcVersion"}, {"original_string": "private final String usrVersion = \"U1\";", "modifier": "private final", "type": "String", "declarator": "usrVersion = \"U1\"", "var_name": "usrVersion"}, {"original_string": "private final String svcDomain = \"sports\";", "modifier": "private final", "type": "String", "declarator": "svcDomain = \"sports\"", "var_name": "svcDomain"}, {"original_string": "private final String svcName = \"fantasy\";", "modifier": "private final", "type": "String", "declarator": "svcName = \"fantasy\"", "var_name": "svcName"}, {"original_string": "private final String usrDomain = \"user\";", "modifier": "private final", "type": "String", "declarator": "usrDomain = \"user\"", "var_name": "usrDomain"}, {"original_string": "private final String usrName = \"john\";", "modifier": "private final", "type": "String", "declarator": "usrName = \"john\"", "var_name": "usrName"}, {"original_string": "private final String host = \"somehost.somecompany.com\";", "modifier": "private final", "type": "String", "declarator": "host = \"somehost.somecompany.com\"", "var_name": "host"}, {"original_string": "private final String salt = \"saltvalue\";", "modifier": "private final", "type": "String", "declarator": "salt = \"saltvalue\"", "var_name": "salt"}, {"original_string": "private final long expirationTime = 10;", "modifier": "private final", "type": "long", "declarator": "expirationTime = 10", "var_name": "expirationTime"}, {"original_string": "private String servicePublicKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "servicePublicKeyStringK0 = null", "var_name": "servicePublicKeyStringK0"}, {"original_string": "private String servicePrivateKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "servicePrivateKeyStringK0 = null", "var_name": "servicePrivateKeyStringK0"}, {"original_string": "private String servicePublicKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "servicePublicKeyStringK1 = null", "var_name": "servicePublicKeyStringK1"}, {"original_string": "private String servicePrivateKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "servicePrivateKeyStringK1 = null", "var_name": "servicePrivateKeyStringK1"}], "file": "libs/java/auth_core/src/test/java/com/yahoo/athenz/auth/token/PrincipalTokenTest.java"}, "test_case": {"identifier": "testTokenInvalidVersionValue", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testTokenInvalidVersionValue() {\n\n        PrincipalToken token = new PrincipalToken(\"v=S1=S2;d=coretech;n=storage\");\n        assertEquals(token.getName(), \"storage\");\n        assertEquals(token.getDomain(), \"coretech\");\n        assertNull(token.getVersion());\n    }", "signature": "void testTokenInvalidVersionValue()", "full_signature": "@Test public void testTokenInvalidVersionValue()", "class_method_signature": "PrincipalTokenTest.testTokenInvalidVersionValue()", "testcase": true, "constructor": false, "invocations": ["assertEquals", "getName", "assertEquals", "getDomain", "assertNull", "getVersion"]}, "focal_class": {"identifier": "PrincipalToken", "superclass": "extends Token", "interfaces": "", "fields": [{"original_string": "private String name = null;", "modifier": "private", "type": "String", "declarator": "name = null", "var_name": "name"}, {"original_string": "private String originalRequestor = null;", "modifier": "private", "type": "String", "declarator": "originalRequestor = null", "var_name": "originalRequestor"}, {"original_string": "protected String keyService = null;", "modifier": "protected", "type": "String", "declarator": "keyService = null", "var_name": "keyService"}, {"original_string": "private List<String> authorizedServices = null;", "modifier": "private", "type": "List<String>", "declarator": "authorizedServices = null", "var_name": "authorizedServices"}, {"original_string": "private String authorizedServiceName = null;", "modifier": "private", "type": "String", "declarator": "authorizedServiceName = null", "var_name": "authorizedServiceName"}, {"original_string": "private String authorizedServiceKeyId = \"0\";", "modifier": "private", "type": "String", "declarator": "authorizedServiceKeyId = \"0\"", "var_name": "authorizedServiceKeyId"}, {"original_string": "private String authorizedServiceSignature = null;", "modifier": "private", "type": "String", "declarator": "authorizedServiceSignature = null", "var_name": "authorizedServiceSignature"}, {"original_string": "private static final Logger LOG = LoggerFactory.getLogger(PrincipalToken.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(PrincipalToken.class)", "var_name": "LOG"}], "methods": [{"identifier": "PrincipalToken", "parameters": "(Builder builder)", "modifiers": "private", "return": "", "signature": " PrincipalToken(Builder builder)", "full_signature": "private  PrincipalToken(Builder builder)", "class_method_signature": "PrincipalToken.PrincipalToken(Builder builder)", "testcase": false, "constructor": true}, {"identifier": "PrincipalToken", "parameters": "(String signedToken)", "modifiers": "public", "return": "", "signature": " PrincipalToken(String signedToken)", "full_signature": "public  PrincipalToken(String signedToken)", "class_method_signature": "PrincipalToken.PrincipalToken(String signedToken)", "testcase": false, "constructor": true}, {"identifier": "signForAuthorizedService", "parameters": "(String authorizedServiceName, String authorizedServiceKeyId,\n            String privKey)", "modifiers": "public", "return": "void", "signature": "void signForAuthorizedService(String authorizedServiceName, String authorizedServiceKeyId,\n            String privKey)", "full_signature": "public void signForAuthorizedService(String authorizedServiceName, String authorizedServiceKeyId,\n            String privKey)", "class_method_signature": "PrincipalToken.signForAuthorizedService(String authorizedServiceName, String authorizedServiceKeyId,\n            String privKey)", "testcase": false, "constructor": false}, {"identifier": "signForAuthorizedService", "parameters": "(String authorizedServiceName, String authorizedServiceKeyId,\n            PrivateKey key)", "modifiers": "public", "return": "void", "signature": "void signForAuthorizedService(String authorizedServiceName, String authorizedServiceKeyId,\n            PrivateKey key)", "full_signature": "public void signForAuthorizedService(String authorizedServiceName, String authorizedServiceKeyId,\n            PrivateKey key)", "class_method_signature": "PrincipalToken.signForAuthorizedService(String authorizedServiceName, String authorizedServiceKeyId,\n            PrivateKey key)", "testcase": false, "constructor": false}, {"identifier": "validateForAuthorizedService", "parameters": "(String pubKey, StringBuilder errMsg)", "modifiers": "public", "return": "boolean", "signature": "boolean validateForAuthorizedService(String pubKey, StringBuilder errMsg)", "full_signature": "public boolean validateForAuthorizedService(String pubKey, StringBuilder errMsg)", "class_method_signature": "PrincipalToken.validateForAuthorizedService(String pubKey, StringBuilder errMsg)", "testcase": false, "constructor": false}, {"identifier": "isValidAuthorizedServiceToken", "parameters": "(StringBuilder errMsg)", "modifiers": "public", "return": "boolean", "signature": "boolean isValidAuthorizedServiceToken(StringBuilder errMsg)", "full_signature": "public boolean isValidAuthorizedServiceToken(StringBuilder errMsg)", "class_method_signature": "PrincipalToken.isValidAuthorizedServiceToken(StringBuilder errMsg)", "testcase": false, "constructor": false}, {"identifier": "getName", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getName()", "full_signature": "public String getName()", "class_method_signature": "PrincipalToken.getName()", "testcase": false, "constructor": false}, {"identifier": "getKeyService", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getKeyService()", "full_signature": "public String getKeyService()", "class_method_signature": "PrincipalToken.getKeyService()", "testcase": false, "constructor": false}, {"identifier": "getOriginalRequestor", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getOriginalRequestor()", "full_signature": "public String getOriginalRequestor()", "class_method_signature": "PrincipalToken.getOriginalRequestor()", "testcase": false, "constructor": false}, {"identifier": "getAuthorizedServices", "parameters": "()", "modifiers": "public", "return": "List<String>", "signature": "List<String> getAuthorizedServices()", "full_signature": "public List<String> getAuthorizedServices()", "class_method_signature": "PrincipalToken.getAuthorizedServices()", "testcase": false, "constructor": false}, {"identifier": "getAuthorizedServiceName", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getAuthorizedServiceName()", "full_signature": "public String getAuthorizedServiceName()", "class_method_signature": "PrincipalToken.getAuthorizedServiceName()", "testcase": false, "constructor": false}, {"identifier": "getAuthorizedServiceKeyId", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getAuthorizedServiceKeyId()", "full_signature": "public String getAuthorizedServiceKeyId()", "class_method_signature": "PrincipalToken.getAuthorizedServiceKeyId()", "testcase": false, "constructor": false}, {"identifier": "getAuthorizedServiceSignature", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getAuthorizedServiceSignature()", "full_signature": "public String getAuthorizedServiceSignature()", "class_method_signature": "PrincipalToken.getAuthorizedServiceSignature()", "testcase": false, "constructor": false}], "file": "libs/java/auth_core/src/main/java/com/yahoo/athenz/auth/token/PrincipalToken.java"}, "focal_method": {"identifier": "getName", "parameters": "()", "modifiers": "public", "return": "String", "body": "public String getName() {\n        return name;\n    }", "signature": "String getName()", "full_signature": "public String getName()", "class_method_signature": "PrincipalToken.getName()", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}