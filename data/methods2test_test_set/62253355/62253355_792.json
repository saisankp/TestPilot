{"test_class": {"identifier": "SimpleProvenanceServiceTest", "superclass": "extends OrmEnabledTestCase", "interfaces": "", "fields": [{"original_string": "private Repository repo;", "modifier": "private", "type": "Repository", "declarator": "repo", "var_name": "repo"}, {"original_string": "private SimpleProvenanceService service;", "modifier": "private", "type": "SimpleProvenanceService", "declarator": "service", "var_name": "service"}, {"original_string": "private OrmFactory<User> userFactory = getRequiredOrmFactory(User.class);", "modifier": "private", "type": "OrmFactory<User>", "declarator": "userFactory = getRequiredOrmFactory(User.class)", "var_name": "userFactory"}, {"original_string": "private OrmFactory<Activity> activityFactory = getRequiredOrmFactory(Activity.class);", "modifier": "private", "type": "OrmFactory<Activity>", "declarator": "activityFactory = getRequiredOrmFactory(Activity.class)", "var_name": "activityFactory"}, {"original_string": "private OrmFactory<Entity> entityFactory = getRequiredOrmFactory(Entity.class);", "modifier": "private", "type": "OrmFactory<Entity>", "declarator": "entityFactory = getRequiredOrmFactory(Entity.class)", "var_name": "entityFactory"}, {"original_string": "private IRI activityIRI;", "modifier": "private", "type": "IRI", "declarator": "activityIRI", "var_name": "activityIRI"}, {"original_string": "@Mock\n    private OrmFactoryRegistry registry;", "modifier": "@Mock\n    private", "type": "OrmFactoryRegistry", "declarator": "registry", "var_name": "registry"}], "file": "com.mobi.prov.impl/src/test/java/com/mobi/prov/impl/SimpleProvenanceServiceTest.java"}, "test_case": {"identifier": "createActivityTest", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void createActivityTest() throws Exception {\n        // Setup:\n        User user = userFactory.createNew(VALUE_FACTORY.createIRI(\"http://test.com/user\"));\n        Entity generated = entityFactory.createNew(VALUE_FACTORY.createIRI(\"http://test.com/generated\"));\n        Entity invalidated = entityFactory.createNew(VALUE_FACTORY.createIRI(\"http://test.com/invalidated\"));\n        Entity used = entityFactory.createNew(VALUE_FACTORY.createIRI(\"http://test.com/used\"));\n        ActivityConfig config = new ActivityConfig.Builder(Collections.singleton(Activity.class), user)\n                .generatedEntity(generated)\n                .invalidatedEntity(invalidated)\n                .usedEntity(used)\n                .build();\n\n        Activity result = service.createActivity(config);\n        assertEquals(1, result.getWasAssociatedWith_resource().size());\n        TestCase.assertEquals(user.getResource(), result.getWasAssociatedWith_resource().iterator().next());\n        assertEquals(1, result.getGenerated().size());\n        assertTrue(result.getModel().containsAll(generated.getModel()));\n        assertEquals(1, result.getInvalidated().size());\n        assertTrue(result.getModel().containsAll(invalidated.getModel()));\n        assertEquals(1, result.getUsed().size());\n        assertTrue(result.getModel().containsAll(used.getModel()));\n    }", "signature": "void createActivityTest()", "full_signature": "@Test public void createActivityTest()", "class_method_signature": "SimpleProvenanceServiceTest.createActivityTest()", "testcase": true, "constructor": false, "invocations": ["createNew", "createIRI", "createNew", "createIRI", "createNew", "createIRI", "createNew", "createIRI", "build", "usedEntity", "invalidatedEntity", "generatedEntity", "singleton", "createActivity", "assertEquals", "size", "getWasAssociatedWith_resource", "assertEquals", "getResource", "next", "iterator", "getWasAssociatedWith_resource", "assertEquals", "size", "getGenerated", "assertTrue", "containsAll", "getModel", "getModel", "assertEquals", "size", "getInvalidated", "assertTrue", "containsAll", "getModel", "getModel", "assertEquals", "size", "getUsed", "assertTrue", "containsAll", "getModel", "getModel"]}, "focal_class": {"identifier": "SimpleProvenanceService", "superclass": "", "interfaces": "implements ProvenanceService", "fields": [{"original_string": "private Repository repo;", "modifier": "private", "type": "Repository", "declarator": "repo", "var_name": "repo"}, {"original_string": "private OrmFactoryRegistry factoryRegistry;", "modifier": "private", "type": "OrmFactoryRegistry", "declarator": "factoryRegistry", "var_name": "factoryRegistry"}, {"original_string": "private ValueFactory vf;", "modifier": "private", "type": "ValueFactory", "declarator": "vf", "var_name": "vf"}, {"original_string": "private ModelFactory mf;", "modifier": "private", "type": "ModelFactory", "declarator": "mf", "var_name": "mf"}, {"original_string": "private ActivityFactory activityFactory;", "modifier": "private", "type": "ActivityFactory", "declarator": "activityFactory", "var_name": "activityFactory"}, {"original_string": "private static String ACTIVITY_NAMESPACE = \"http://mobi.com/activities/\";", "modifier": "private static", "type": "String", "declarator": "ACTIVITY_NAMESPACE = \"http://mobi.com/activities/\"", "var_name": "ACTIVITY_NAMESPACE"}], "methods": [{"identifier": "setRepo", "parameters": "(Repository repo)", "modifiers": "@Reference(target = \"(id=prov)\")", "return": "void", "signature": "void setRepo(Repository repo)", "full_signature": "@Reference(target = \"(id=prov)\") void setRepo(Repository repo)", "class_method_signature": "SimpleProvenanceService.setRepo(Repository repo)", "testcase": false, "constructor": false}, {"identifier": "setFactoryRegistry", "parameters": "(OrmFactoryRegistry factoryRegistry)", "modifiers": "@Reference", "return": "void", "signature": "void setFactoryRegistry(OrmFactoryRegistry factoryRegistry)", "full_signature": "@Reference void setFactoryRegistry(OrmFactoryRegistry factoryRegistry)", "class_method_signature": "SimpleProvenanceService.setFactoryRegistry(OrmFactoryRegistry factoryRegistry)", "testcase": false, "constructor": false}, {"identifier": "setVf", "parameters": "(ValueFactory vf)", "modifiers": "@Reference", "return": "void", "signature": "void setVf(ValueFactory vf)", "full_signature": "@Reference void setVf(ValueFactory vf)", "class_method_signature": "SimpleProvenanceService.setVf(ValueFactory vf)", "testcase": false, "constructor": false}, {"identifier": "setMf", "parameters": "(ModelFactory mf)", "modifiers": "@Reference", "return": "void", "signature": "void setMf(ModelFactory mf)", "full_signature": "@Reference void setMf(ModelFactory mf)", "class_method_signature": "SimpleProvenanceService.setMf(ModelFactory mf)", "testcase": false, "constructor": false}, {"identifier": "setActivityFactory", "parameters": "(ActivityFactory activityFactory)", "modifiers": "@Reference", "return": "void", "signature": "void setActivityFactory(ActivityFactory activityFactory)", "full_signature": "@Reference void setActivityFactory(ActivityFactory activityFactory)", "class_method_signature": "SimpleProvenanceService.setActivityFactory(ActivityFactory activityFactory)", "testcase": false, "constructor": false}, {"identifier": "getConnection", "parameters": "()", "modifiers": "@Override public", "return": "RepositoryConnection", "signature": "RepositoryConnection getConnection()", "full_signature": "@Override public RepositoryConnection getConnection()", "class_method_signature": "SimpleProvenanceService.getConnection()", "testcase": false, "constructor": false}, {"identifier": "createActivity", "parameters": "(ActivityConfig config)", "modifiers": "@Override public", "return": "Activity", "signature": "Activity createActivity(ActivityConfig config)", "full_signature": "@Override public Activity createActivity(ActivityConfig config)", "class_method_signature": "SimpleProvenanceService.createActivity(ActivityConfig config)", "testcase": false, "constructor": false}, {"identifier": "addActivity", "parameters": "(Activity activity)", "modifiers": "@Override public", "return": "void", "signature": "void addActivity(Activity activity)", "full_signature": "@Override public void addActivity(Activity activity)", "class_method_signature": "SimpleProvenanceService.addActivity(Activity activity)", "testcase": false, "constructor": false}, {"identifier": "getActivity", "parameters": "(Resource activityIRI)", "modifiers": "@Override public", "return": "Optional<Activity>", "signature": "Optional<Activity> getActivity(Resource activityIRI)", "full_signature": "@Override public Optional<Activity> getActivity(Resource activityIRI)", "class_method_signature": "SimpleProvenanceService.getActivity(Resource activityIRI)", "testcase": false, "constructor": false}, {"identifier": "updateActivity", "parameters": "(Activity newActivity)", "modifiers": "@Override public", "return": "void", "signature": "void updateActivity(Activity newActivity)", "full_signature": "@Override public void updateActivity(Activity newActivity)", "class_method_signature": "SimpleProvenanceService.updateActivity(Activity newActivity)", "testcase": false, "constructor": false}, {"identifier": "deleteActivity", "parameters": "(Resource activityIRI)", "modifiers": "@Override public", "return": "void", "signature": "void deleteActivity(Resource activityIRI)", "full_signature": "@Override public void deleteActivity(Resource activityIRI)", "class_method_signature": "SimpleProvenanceService.deleteActivity(Resource activityIRI)", "testcase": false, "constructor": false}, {"identifier": "removeIfNotReferenced", "parameters": "(Resource iri, RepositoryConnection conn)", "modifiers": "private", "return": "void", "signature": "void removeIfNotReferenced(Resource iri, RepositoryConnection conn)", "full_signature": "private void removeIfNotReferenced(Resource iri, RepositoryConnection conn)", "class_method_signature": "SimpleProvenanceService.removeIfNotReferenced(Resource iri, RepositoryConnection conn)", "testcase": false, "constructor": false}, {"identifier": "getReferencedEntityIRIs", "parameters": "(Resource activityIRI, String propIRI, RepositoryConnection conn)", "modifiers": "private", "return": "List<Resource>", "signature": "List<Resource> getReferencedEntityIRIs(Resource activityIRI, String propIRI, RepositoryConnection conn)", "full_signature": "private List<Resource> getReferencedEntityIRIs(Resource activityIRI, String propIRI, RepositoryConnection conn)", "class_method_signature": "SimpleProvenanceService.getReferencedEntityIRIs(Resource activityIRI, String propIRI, RepositoryConnection conn)", "testcase": false, "constructor": false}, {"identifier": "getActivityFactories", "parameters": "()", "modifiers": "private", "return": "Map<Class<? extends Activity>, OrmFactory<? extends Activity>>", "signature": "Map<Class<? extends Activity>, OrmFactory<? extends Activity>> getActivityFactories()", "full_signature": "private Map<Class<? extends Activity>, OrmFactory<? extends Activity>> getActivityFactories()", "class_method_signature": "SimpleProvenanceService.getActivityFactories()", "testcase": false, "constructor": false}, {"identifier": "addEntitiesToModel", "parameters": "(Set<Resource> entityIRIs, Model model, RepositoryConnection conn)", "modifiers": "private", "return": "void", "signature": "void addEntitiesToModel(Set<Resource> entityIRIs, Model model, RepositoryConnection conn)", "full_signature": "private void addEntitiesToModel(Set<Resource> entityIRIs, Model model, RepositoryConnection conn)", "class_method_signature": "SimpleProvenanceService.addEntitiesToModel(Set<Resource> entityIRIs, Model model, RepositoryConnection conn)", "testcase": false, "constructor": false}, {"identifier": "addEntitiesToModel", "parameters": "(Set<Entity> entities, Model model)", "modifiers": "private", "return": "void", "signature": "void addEntitiesToModel(Set<Entity> entities, Model model)", "full_signature": "private void addEntitiesToModel(Set<Entity> entities, Model model)", "class_method_signature": "SimpleProvenanceService.addEntitiesToModel(Set<Entity> entities, Model model)", "testcase": false, "constructor": false}], "file": "com.mobi.prov.impl/src/main/java/com/mobi/prov/impl/SimpleProvenanceService.java"}, "focal_method": {"identifier": "createActivity", "parameters": "(ActivityConfig config)", "modifiers": "@Override public", "return": "Activity", "body": "@Override\n    public Activity createActivity(ActivityConfig config) {\n        Map<Class<? extends Activity>, OrmFactory<? extends Activity>> factoryMap = getActivityFactories();\n        Activity activity = activityFactory.createNew(vf.createIRI(ACTIVITY_NAMESPACE + UUID.randomUUID()));\n        for (Class<? extends Activity> type : config.getTypes()) {\n            if (!factoryMap.containsKey(type)) {\n                throw new IllegalStateException(\"No factory registered for type: \" + type);\n            }\n            activity = factoryMap.get(type).createNew(activity.getResource(), activity.getModel());\n        }\n        activity.setWasAssociatedWith(Collections.singleton(config.getUser()));\n        activity.setGenerated(config.getGeneratedEntities());\n        addEntitiesToModel(config.getInvalidatedEntities(), activity.getModel());\n        activity.setInvalidated(config.getInvalidatedEntities());\n        addEntitiesToModel(config.getGeneratedEntities(), activity.getModel());\n        activity.setUsed(config.getUsedEntities());\n        addEntitiesToModel(config.getUsedEntities(), activity.getModel());\n        return activity;\n    }", "signature": "Activity createActivity(ActivityConfig config)", "full_signature": "@Override public Activity createActivity(ActivityConfig config)", "class_method_signature": "SimpleProvenanceService.createActivity(ActivityConfig config)", "testcase": false, "constructor": false, "invocations": ["getActivityFactories", "createNew", "createIRI", "randomUUID", "getTypes", "containsKey", "createNew", "get", "getResource", "getModel", "setWasAssociatedWith", "singleton", "getUser", "setGenerated", "getGeneratedEntities", "addEntitiesToModel", "getInvalidatedEntities", "getModel", "setInvalidated", "getInvalidatedEntities", "addEntitiesToModel", "getGeneratedEntities", "getModel", "setUsed", "getUsedEntities", "addEntitiesToModel", "getUsedEntities", "getModel"]}, "repository": {"repo_id": 62253355, "url": "https://github.com/inovexcorp/mobi", "language": "Java", "is_fork": false, "fork_count": 7, "stargazer_count": 30, "size": 54070, "license": "licensed"}}