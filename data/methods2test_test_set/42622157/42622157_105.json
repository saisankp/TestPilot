{"test_class": {"identifier": "AuthorizationTreeTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private AuthorizationTree authorizationTree;", "modifier": "private", "type": "AuthorizationTree", "declarator": "authorizationTree", "var_name": "authorizationTree"}], "file": "org.eclipse.winery.accountability/src/test/java/org/eclipse/winery/accountability/model/authorization/AuthorizationTreeTest.java"}, "test_case": {"identifier": "getLineage", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getLineage() {\n        final Optional<List<AuthorizationNode>> lineage =\n            this.authorizationTree.getAuthorizationLineage(\"0x3333\");\n\n        assertTrue(lineage.isPresent());\n        assertEquals(3, lineage.get().size());\n        assertEquals(\"0x3333\", ((AuthorizationNode) lineage.get().toArray()[lineage.get().size() - 1]).getAddress());\n        assertEquals(\"0x2222\", ((AuthorizationNode) lineage.get().toArray()[lineage.get().size() - 2]).getAddress());\n        assertEquals(\"0x1111\", ((AuthorizationNode) lineage.get().toArray()[lineage.get().size() - 3]).getAddress());\n    }", "signature": "void getLineage()", "full_signature": "@Test public void getLineage()", "class_method_signature": "AuthorizationTreeTest.getLineage()", "testcase": true, "constructor": false, "invocations": ["getAuthorizationLineage", "assertTrue", "isPresent", "assertEquals", "size", "get", "assertEquals", "getAddress", "toArray", "get", "size", "get", "assertEquals", "getAddress", "toArray", "get", "size", "get", "assertEquals", "getAddress", "toArray", "get", "size", "get"]}, "focal_class": {"identifier": "AuthorizationTree", "superclass": "", "interfaces": "implements AuthorizationInfo", "fields": [{"original_string": "private static final String SERVICE_OWNER_IDENTITY = \"Service Owner\";", "modifier": "private static final", "type": "String", "declarator": "SERVICE_OWNER_IDENTITY = \"Service Owner\"", "var_name": "SERVICE_OWNER_IDENTITY"}, {"original_string": "private static final Logger log = LoggerFactory.getLogger(AuthorizationTree.class);", "modifier": "private static final", "type": "Logger", "declarator": "log = LoggerFactory.getLogger(AuthorizationTree.class)", "var_name": "log"}, {"original_string": "private Tree<AuthorizationNode> tree;", "modifier": "private", "type": "Tree<AuthorizationNode>", "declarator": "tree", "var_name": "tree"}], "methods": [{"identifier": "AuthorizationTree", "parameters": "(List<AuthorizationElement> allAuthorizationElements)", "modifiers": "public", "return": "", "signature": " AuthorizationTree(List<AuthorizationElement> allAuthorizationElements)", "full_signature": "public  AuthorizationTree(List<AuthorizationElement> allAuthorizationElements)", "class_method_signature": "AuthorizationTree.AuthorizationTree(List<AuthorizationElement> allAuthorizationElements)", "testcase": false, "constructor": true}, {"identifier": "isAuthorized", "parameters": "(String blockchainAddress)", "modifiers": "@Override public", "return": "boolean", "signature": "boolean isAuthorized(String blockchainAddress)", "full_signature": "@Override public boolean isAuthorized(String blockchainAddress)", "class_method_signature": "AuthorizationTree.isAuthorized(String blockchainAddress)", "testcase": false, "constructor": false}, {"identifier": "getServiceOwnerBlockchainAddress", "parameters": "()", "modifiers": "@Override public", "return": "Optional<String>", "signature": "Optional<String> getServiceOwnerBlockchainAddress()", "full_signature": "@Override public Optional<String> getServiceOwnerBlockchainAddress()", "class_method_signature": "AuthorizationTree.getServiceOwnerBlockchainAddress()", "testcase": false, "constructor": false}, {"identifier": "getRealWorldIdentity", "parameters": "(String blockchainAddress)", "modifiers": "@Override public", "return": "Optional<String>", "signature": "Optional<String> getRealWorldIdentity(String blockchainAddress)", "full_signature": "@Override public Optional<String> getRealWorldIdentity(String blockchainAddress)", "class_method_signature": "AuthorizationTree.getRealWorldIdentity(String blockchainAddress)", "testcase": false, "constructor": false}, {"identifier": "getAuthorizationLineage", "parameters": "(String blockchainAddress)", "modifiers": "@Override public", "return": "Optional<List<AuthorizationNode>>", "signature": "Optional<List<AuthorizationNode>> getAuthorizationLineage(String blockchainAddress)", "full_signature": "@Override public Optional<List<AuthorizationNode>> getAuthorizationLineage(String blockchainAddress)", "class_method_signature": "AuthorizationTree.getAuthorizationLineage(String blockchainAddress)", "testcase": false, "constructor": false}, {"identifier": "buildTree", "parameters": "(List<AuthorizationElement> elements)", "modifiers": "private", "return": "Tree<AuthorizationNode>", "signature": "Tree<AuthorizationNode> buildTree(List<AuthorizationElement> elements)", "full_signature": "private Tree<AuthorizationNode> buildTree(List<AuthorizationElement> elements)", "class_method_signature": "AuthorizationTree.buildTree(List<AuthorizationElement> elements)", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "AuthorizationTree.toString()", "testcase": false, "constructor": false}], "file": "org.eclipse.winery.accountability/src/main/java/org/eclipse/winery/accountability/model/authorization/AuthorizationTree.java"}, "focal_method": {"identifier": "getAuthorizationLineage", "parameters": "(String blockchainAddress)", "modifiers": "@Override public", "return": "Optional<List<AuthorizationNode>>", "body": "@Override\n    public Optional<List<AuthorizationNode>> getAuthorizationLineage(String blockchainAddress) {\n        // Find a strand that contains a node with the given blockchain address as authorized (each strand is ordered from\n        // root to leaf)\n        Optional<List<AuthorizationNode>> strandAsList =\n            tree.getStrands()\n                .map(strand -> strand.collect(Collectors.toList()))\n                .filter(strand -> strand.stream().anyMatch(node -> node.getAddress().equals(blockchainAddress)))\n                .findFirst();\n\n        // If we find the strand, build a path from node to root\n        if (strandAsList.isPresent()) {\n            final List<AuthorizationNode> result = new ArrayList<>();\n\n            for (AuthorizationNode node : strandAsList.get()) {\n                result.add(node);\n\n                // add nodes up until the one we need\n                if (node.getAddress().equals(blockchainAddress))\n                    break;\n            }\n\n            return Optional.of(result);\n        } else {\n            return Optional.empty();\n        }\n    }", "signature": "Optional<List<AuthorizationNode>> getAuthorizationLineage(String blockchainAddress)", "full_signature": "@Override public Optional<List<AuthorizationNode>> getAuthorizationLineage(String blockchainAddress)", "class_method_signature": "AuthorizationTree.getAuthorizationLineage(String blockchainAddress)", "testcase": false, "constructor": false, "invocations": ["findFirst", "filter", "map", "getStrands", "collect", "toList", "anyMatch", "stream", "equals", "getAddress", "isPresent", "get", "add", "equals", "getAddress", "of", "empty"]}, "repository": {"repo_id": 42622157, "url": "https://github.com/eclipse/winery", "stars": 34, "created": "9/17/2015 12:31:44 AM +00:00", "updates": "2020-01-22T09:32:00+00:00", "fork": "False", "license": "licensed"}}