{"test_class": {"identifier": "ThingCommandEnforcementTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Rule\n    public final TestName testName = new TestName();", "modifier": "@Rule\n    public final", "type": "TestName", "declarator": "testName = new TestName()", "var_name": "testName"}, {"original_string": "private ActorSystem system;", "modifier": "private", "type": "ActorSystem", "declarator": "system", "var_name": "system"}, {"original_string": "private MockEntitiesActor mockEntitiesActorInstance;", "modifier": "private", "type": "MockEntitiesActor", "declarator": "mockEntitiesActorInstance", "var_name": "mockEntitiesActorInstance"}, {"original_string": "private ActorRef mockEntitiesActor;", "modifier": "private", "type": "ActorRef", "declarator": "mockEntitiesActor", "var_name": "mockEntitiesActor"}], "file": "services/concierge/enforcement/src/test/java/org/eclipse/ditto/services/concierge/enforcement/ThingCommandEnforcementTest.java"}, "test_case": {"identifier": "transformModifyThingToCreateThing", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void transformModifyThingToCreateThing() {\n        final Thing thingInPayload = newThing().setId(THING_ID).build();\n\n        new TestKit(system) {{\n            final ActorRef underTest = TestSetup.newEnforcerActor(system, getRef(), getRef());\n            final ModifyThing modifyThing = ModifyThing.of(THING_ID, thingInPayload, null, headers(V_1));\n            underTest.tell(modifyThing, getRef());\n\n            fishForMsgClass(this, SudoRetrieveThing.class);\n            reply(ThingNotAccessibleException.newBuilder(THING_ID).build());\n\n            fishForMsgClass(this, CreateThing.class);\n        }};\n    }", "signature": "void transformModifyThingToCreateThing()", "full_signature": "@Test public void transformModifyThingToCreateThing()", "class_method_signature": "ThingCommandEnforcementTest.transformModifyThingToCreateThing()", "testcase": true, "constructor": false, "invocations": ["build", "setId", "newThing", "newEnforcerActor", "getRef", "getRef", "of", "headers", "tell", "getRef", "fishForMsgClass", "reply", "build", "newBuilder", "fishForMsgClass"]}, "focal_class": {"identifier": "ThingCommandEnforcement", "superclass": "extends AbstractEnforcement<ThingCommand<?>>", "interfaces": "", "fields": [{"original_string": "private static final ThreadSafeDittoLogger LOGGER =\n            DittoLoggerFactory.getThreadSafeLogger(ThingCommandEnforcement.class);", "modifier": "private static final", "type": "ThreadSafeDittoLogger", "declarator": "LOGGER =\n            DittoLoggerFactory.getThreadSafeLogger(ThingCommandEnforcement.class)", "var_name": "LOGGER"}, {"original_string": "private static final String DEFAULT_POLICY_ENTRY_LABEL = \"DEFAULT\";", "modifier": "private static final", "type": "String", "declarator": "DEFAULT_POLICY_ENTRY_LABEL = \"DEFAULT\"", "var_name": "DEFAULT_POLICY_ENTRY_LABEL"}, {"original_string": "private static final JsonFieldSelector THING_QUERY_COMMAND_RESPONSE_ALLOWLIST =\n            JsonFactory.newFieldSelector(Thing.JsonFields.ID);", "modifier": "private static final", "type": "JsonFieldSelector", "declarator": "THING_QUERY_COMMAND_RESPONSE_ALLOWLIST =\n            JsonFactory.newFieldSelector(Thing.JsonFields.ID)", "var_name": "THING_QUERY_COMMAND_RESPONSE_ALLOWLIST"}, {"original_string": "private final List<SubjectIssuer> subjectIssuersForPolicyMigration;", "modifier": "private final", "type": "List<SubjectIssuer>", "declarator": "subjectIssuersForPolicyMigration", "var_name": "subjectIssuersForPolicyMigration"}, {"original_string": "private final ActorRef thingsShardRegion;", "modifier": "private final", "type": "ActorRef", "declarator": "thingsShardRegion", "var_name": "thingsShardRegion"}, {"original_string": "private final ActorRef policiesShardRegion;", "modifier": "private final", "type": "ActorRef", "declarator": "policiesShardRegion", "var_name": "policiesShardRegion"}, {"original_string": "private final EnforcerRetriever thingEnforcerRetriever;", "modifier": "private final", "type": "EnforcerRetriever", "declarator": "thingEnforcerRetriever", "var_name": "thingEnforcerRetriever"}, {"original_string": "private final EnforcerRetriever policyEnforcerRetriever;", "modifier": "private final", "type": "EnforcerRetriever", "declarator": "policyEnforcerRetriever", "var_name": "policyEnforcerRetriever"}, {"original_string": "private final Cache<EntityIdWithResourceType, Entry<EntityIdWithResourceType>> thingIdCache;", "modifier": "private final", "type": "Cache<EntityIdWithResourceType, Entry<EntityIdWithResourceType>>", "declarator": "thingIdCache", "var_name": "thingIdCache"}, {"original_string": "private final Cache<EntityIdWithResourceType, Entry<Enforcer>> policyEnforcerCache;", "modifier": "private final", "type": "Cache<EntityIdWithResourceType, Entry<Enforcer>>", "declarator": "policyEnforcerCache", "var_name": "policyEnforcerCache"}, {"original_string": "private final PreEnforcer preEnforcer;", "modifier": "private final", "type": "PreEnforcer", "declarator": "preEnforcer", "var_name": "preEnforcer"}, {"original_string": "private final Cache<EntityIdWithResourceType, Entry<Enforcer>> aclEnforcerCache;", "modifier": "private final", "type": "Cache<EntityIdWithResourceType, Entry<Enforcer>>", "declarator": "aclEnforcerCache", "var_name": "aclEnforcerCache"}, {"original_string": "private final PolicyIdReferencePlaceholderResolver policyIdReferencePlaceholderResolver;", "modifier": "private final", "type": "PolicyIdReferencePlaceholderResolver", "declarator": "policyIdReferencePlaceholderResolver", "var_name": "policyIdReferencePlaceholderResolver"}], "methods": [{"identifier": "ThingCommandEnforcement", "parameters": "(final Contextual<ThingCommand<?>> data,\n            final ActorRef thingsShardRegion,\n            final ActorRef policiesShardRegion,\n            final Cache<EntityIdWithResourceType, Entry<EntityIdWithResourceType>> thingIdCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> policyEnforcerCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> aclEnforcerCache,\n            final PreEnforcer preEnforcer,\n            final List<SubjectIssuer> subjectIssuersForPolicyMigration)", "modifiers": "private", "return": "", "signature": " ThingCommandEnforcement(final Contextual<ThingCommand<?>> data,\n            final ActorRef thingsShardRegion,\n            final ActorRef policiesShardRegion,\n            final Cache<EntityIdWithResourceType, Entry<EntityIdWithResourceType>> thingIdCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> policyEnforcerCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> aclEnforcerCache,\n            final PreEnforcer preEnforcer,\n            final List<SubjectIssuer> subjectIssuersForPolicyMigration)", "full_signature": "private  ThingCommandEnforcement(final Contextual<ThingCommand<?>> data,\n            final ActorRef thingsShardRegion,\n            final ActorRef policiesShardRegion,\n            final Cache<EntityIdWithResourceType, Entry<EntityIdWithResourceType>> thingIdCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> policyEnforcerCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> aclEnforcerCache,\n            final PreEnforcer preEnforcer,\n            final List<SubjectIssuer> subjectIssuersForPolicyMigration)", "class_method_signature": "ThingCommandEnforcement.ThingCommandEnforcement(final Contextual<ThingCommand<?>> data,\n            final ActorRef thingsShardRegion,\n            final ActorRef policiesShardRegion,\n            final Cache<EntityIdWithResourceType, Entry<EntityIdWithResourceType>> thingIdCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> policyEnforcerCache,\n            final Cache<EntityIdWithResourceType, Entry<Enforcer>> aclEnforcerCache,\n            final PreEnforcer preEnforcer,\n            final List<SubjectIssuer> subjectIssuersForPolicyMigration)", "testcase": false, "constructor": true}, {"identifier": "enforce", "parameters": "()", "modifiers": "@Override public", "return": "CompletionStage<Contextual<WithDittoHeaders>>", "signature": "CompletionStage<Contextual<WithDittoHeaders>> enforce()", "full_signature": "@Override public CompletionStage<Contextual<WithDittoHeaders>> enforce()", "class_method_signature": "ThingCommandEnforcement.enforce()", "testcase": false, "constructor": false}, {"identifier": "doEnforce", "parameters": "(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry, final Entry<Enforcer> enforcerEntry)", "modifiers": "private", "return": "CompletionStage<Contextual<WithDittoHeaders>>", "signature": "CompletionStage<Contextual<WithDittoHeaders>> doEnforce(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry, final Entry<Enforcer> enforcerEntry)", "full_signature": "private CompletionStage<Contextual<WithDittoHeaders>> doEnforce(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry, final Entry<Enforcer> enforcerEntry)", "class_method_signature": "ThingCommandEnforcement.doEnforce(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry, final Entry<Enforcer> enforcerEntry)", "testcase": false, "constructor": false}, {"identifier": "enforceThingCommandByNonexistentEnforcer", "parameters": "(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "modifiers": "private", "return": "CompletionStage<Contextual<WithDittoHeaders>>", "signature": "CompletionStage<Contextual<WithDittoHeaders>> enforceThingCommandByNonexistentEnforcer(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "full_signature": "private CompletionStage<Contextual<WithDittoHeaders>> enforceThingCommandByNonexistentEnforcer(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "class_method_signature": "ThingCommandEnforcement.enforceThingCommandByNonexistentEnforcer(\n            final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "testcase": false, "constructor": false}, {"identifier": "enforceThingCommandByAclEnforcer", "parameters": "(final Enforcer enforcer)", "modifiers": "private", "return": "Contextual<WithDittoHeaders>", "signature": "Contextual<WithDittoHeaders> enforceThingCommandByAclEnforcer(final Enforcer enforcer)", "full_signature": "private Contextual<WithDittoHeaders> enforceThingCommandByAclEnforcer(final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.enforceThingCommandByAclEnforcer(final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "isResponseRequired", "parameters": "(final WithDittoHeaders<?> withDittoHeaders)", "modifiers": "private static", "return": "boolean", "signature": "boolean isResponseRequired(final WithDittoHeaders<?> withDittoHeaders)", "full_signature": "private static boolean isResponseRequired(final WithDittoHeaders<?> withDittoHeaders)", "class_method_signature": "ThingCommandEnforcement.isResponseRequired(final WithDittoHeaders<?> withDittoHeaders)", "testcase": false, "constructor": false}, {"identifier": "retrieveThingAclAndMigrateToPolicy", "parameters": "(final RetrieveThing retrieveThing,\n            final Enforcer enforcer)", "modifiers": "private", "return": "Contextual<WithDittoHeaders>", "signature": "Contextual<WithDittoHeaders> retrieveThingAclAndMigrateToPolicy(final RetrieveThing retrieveThing,\n            final Enforcer enforcer)", "full_signature": "private Contextual<WithDittoHeaders> retrieveThingAclAndMigrateToPolicy(final RetrieveThing retrieveThing,\n            final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.retrieveThingAclAndMigrateToPolicy(final RetrieveThing retrieveThing,\n            final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "enforceThingCommandByPolicyEnforcer", "parameters": "(\n            final ThingCommand<?> thingCommand, final PolicyId policyId, final Enforcer enforcer)", "modifiers": "private", "return": "Contextual<WithDittoHeaders>", "signature": "Contextual<WithDittoHeaders> enforceThingCommandByPolicyEnforcer(\n            final ThingCommand<?> thingCommand, final PolicyId policyId, final Enforcer enforcer)", "full_signature": "private Contextual<WithDittoHeaders> enforceThingCommandByPolicyEnforcer(\n            final ThingCommand<?> thingCommand, final PolicyId policyId, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.enforceThingCommandByPolicyEnforcer(\n            final ThingCommand<?> thingCommand, final PolicyId policyId, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "askThingsShardRegionAndBuildJsonView", "parameters": "(\n            final ThingQueryCommand commandWithReadSubjects, final Enforcer enforcer)", "modifiers": "private", "return": "CompletionStage<WithDittoHeaders>", "signature": "CompletionStage<WithDittoHeaders> askThingsShardRegionAndBuildJsonView(\n            final ThingQueryCommand commandWithReadSubjects, final Enforcer enforcer)", "full_signature": "private CompletionStage<WithDittoHeaders> askThingsShardRegionAndBuildJsonView(\n            final ThingQueryCommand commandWithReadSubjects, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.askThingsShardRegionAndBuildJsonView(\n            final ThingQueryCommand commandWithReadSubjects, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "retrieveThingAndPolicy", "parameters": "(final RetrieveThing retrieveThing,\n            final PolicyId policyId, final Enforcer enforcer)", "modifiers": "private", "return": "CompletionStage<WithDittoHeaders>", "signature": "CompletionStage<WithDittoHeaders> retrieveThingAndPolicy(final RetrieveThing retrieveThing,\n            final PolicyId policyId, final Enforcer enforcer)", "full_signature": "private CompletionStage<WithDittoHeaders> retrieveThingAndPolicy(final RetrieveThing retrieveThing,\n            final PolicyId policyId, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.retrieveThingAndPolicy(final RetrieveThing retrieveThing,\n            final PolicyId policyId, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "retrieveThingBeforePolicy", "parameters": "(final RetrieveThing command)", "modifiers": "private", "return": "CompletionStage<WithDittoHeaders>", "signature": "CompletionStage<WithDittoHeaders> retrieveThingBeforePolicy(final RetrieveThing command)", "full_signature": "private CompletionStage<WithDittoHeaders> retrieveThingBeforePolicy(final RetrieveThing command)", "class_method_signature": "ThingCommandEnforcement.retrieveThingBeforePolicy(final RetrieveThing command)", "testcase": false, "constructor": false}, {"identifier": "reportThingUnavailable", "parameters": "()", "modifiers": "private", "return": "ThingUnavailableException", "signature": "ThingUnavailableException reportThingUnavailable()", "full_signature": "private ThingUnavailableException reportThingUnavailable()", "class_method_signature": "ThingCommandEnforcement.reportThingUnavailable()", "testcase": false, "constructor": false}, {"identifier": "retrieveInlinedPolicyForThing", "parameters": "(\n            final RetrieveThing retrieveThing, final RetrievePolicy retrievePolicy)", "modifiers": "private", "return": "CompletionStage<Optional<RetrievePolicyResponse>>", "signature": "CompletionStage<Optional<RetrievePolicyResponse>> retrieveInlinedPolicyForThing(\n            final RetrieveThing retrieveThing, final RetrievePolicy retrievePolicy)", "full_signature": "private CompletionStage<Optional<RetrievePolicyResponse>> retrieveInlinedPolicyForThing(\n            final RetrieveThing retrieveThing, final RetrievePolicy retrievePolicy)", "class_method_signature": "ThingCommandEnforcement.retrieveInlinedPolicyForThing(\n            final RetrieveThing retrieveThing, final RetrievePolicy retrievePolicy)", "testcase": false, "constructor": false}, {"identifier": "getCorrelationIdOrNull", "parameters": "(final Object signal, final WithDittoHeaders<?> fallBackSignal)", "modifiers": "@Nullable private static", "return": "CharSequence", "signature": "CharSequence getCorrelationIdOrNull(final Object signal, final WithDittoHeaders<?> fallBackSignal)", "full_signature": "@Nullable private static CharSequence getCorrelationIdOrNull(final Object signal, final WithDittoHeaders<?> fallBackSignal)", "class_method_signature": "ThingCommandEnforcement.getCorrelationIdOrNull(final Object signal, final WithDittoHeaders<?> fallBackSignal)", "testcase": false, "constructor": false}, {"identifier": "isWithDittoHeaders", "parameters": "(final Object o)", "modifiers": "private static", "return": "boolean", "signature": "boolean isWithDittoHeaders(final Object o)", "full_signature": "private static boolean isWithDittoHeaders(final Object o)", "class_method_signature": "ThingCommandEnforcement.isWithDittoHeaders(final Object o)", "testcase": false, "constructor": false}, {"identifier": "reportAggregatedThingAndPolicyResponse", "parameters": "(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse thingResponse,\n            final RetrievePolicyResponse policyResponse,\n            final Enforcer enforcer)", "modifiers": "private static", "return": "RetrieveThingResponse", "signature": "RetrieveThingResponse reportAggregatedThingAndPolicyResponse(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse thingResponse,\n            final RetrievePolicyResponse policyResponse,\n            final Enforcer enforcer)", "full_signature": "private static RetrieveThingResponse reportAggregatedThingAndPolicyResponse(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse thingResponse,\n            final RetrievePolicyResponse policyResponse,\n            final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.reportAggregatedThingAndPolicyResponse(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse thingResponse,\n            final RetrievePolicyResponse policyResponse,\n            final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "reportAggregatedThingAndPolicy", "parameters": "(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse retrieveThingResponse,\n            final Policy policy,\n            final Enforcer enforcer)", "modifiers": "private static", "return": "RetrieveThingResponse", "signature": "RetrieveThingResponse reportAggregatedThingAndPolicy(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse retrieveThingResponse,\n            final Policy policy,\n            final Enforcer enforcer)", "full_signature": "private static RetrieveThingResponse reportAggregatedThingAndPolicy(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse retrieveThingResponse,\n            final Policy policy,\n            final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.reportAggregatedThingAndPolicy(final RetrieveThing retrieveThing,\n            final RetrieveThingResponse retrieveThingResponse,\n            final Policy policy,\n            final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "reportTimeoutForThingQuery", "parameters": "(final ThingQueryCommand command,\n            final AskTimeoutException askTimeoutException)", "modifiers": "private", "return": "ThingUnavailableException", "signature": "ThingUnavailableException reportTimeoutForThingQuery(final ThingQueryCommand command,\n            final AskTimeoutException askTimeoutException)", "full_signature": "private ThingUnavailableException reportTimeoutForThingQuery(final ThingQueryCommand command,\n            final AskTimeoutException askTimeoutException)", "class_method_signature": "ThingCommandEnforcement.reportTimeoutForThingQuery(final ThingQueryCommand command,\n            final AskTimeoutException askTimeoutException)", "testcase": false, "constructor": false}, {"identifier": "reportJsonViewForThingQuery", "parameters": "(\n            final ThingQueryCommandResponse<?> thingQueryCommandResponse, final Enforcer enforcer)", "modifiers": "private", "return": "ThingQueryCommandResponse", "signature": "ThingQueryCommandResponse reportJsonViewForThingQuery(\n            final ThingQueryCommandResponse<?> thingQueryCommandResponse, final Enforcer enforcer)", "full_signature": "private ThingQueryCommandResponse reportJsonViewForThingQuery(\n            final ThingQueryCommandResponse<?> thingQueryCommandResponse, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.reportJsonViewForThingQuery(\n            final ThingQueryCommandResponse<?> thingQueryCommandResponse, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "enforceCreateThingForNonexistentThingWithPolicyId", "parameters": "(\n            final CreateThing command, final PolicyId policyId)", "modifiers": "private", "return": "CompletionStage<Contextual<WithDittoHeaders>>", "signature": "CompletionStage<Contextual<WithDittoHeaders>> enforceCreateThingForNonexistentThingWithPolicyId(\n            final CreateThing command, final PolicyId policyId)", "full_signature": "private CompletionStage<Contextual<WithDittoHeaders>> enforceCreateThingForNonexistentThingWithPolicyId(\n            final CreateThing command, final PolicyId policyId)", "class_method_signature": "ThingCommandEnforcement.enforceCreateThingForNonexistentThingWithPolicyId(\n            final CreateThing command, final PolicyId policyId)", "testcase": false, "constructor": false}, {"identifier": "buildJsonViewForThingQueryCommandResponse", "parameters": "(\n            final ThingQueryCommandResponse<T> response, final Enforcer enforcer)", "modifiers": "private static", "return": "T", "signature": "T buildJsonViewForThingQueryCommandResponse(\n            final ThingQueryCommandResponse<T> response, final Enforcer enforcer)", "full_signature": "private static T buildJsonViewForThingQueryCommandResponse(\n            final ThingQueryCommandResponse<T> response, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.buildJsonViewForThingQueryCommandResponse(\n            final ThingQueryCommandResponse<T> response, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "forwardToThingsShardRegion", "parameters": "(final ThingCommand command)", "modifiers": "private", "return": "Contextual<WithDittoHeaders>", "signature": "Contextual<WithDittoHeaders> forwardToThingsShardRegion(final ThingCommand command)", "full_signature": "private Contextual<WithDittoHeaders> forwardToThingsShardRegion(final ThingCommand command)", "class_method_signature": "ThingCommandEnforcement.forwardToThingsShardRegion(final ThingCommand command)", "testcase": false, "constructor": false}, {"identifier": "invalidateThingCaches", "parameters": "(final ThingId thingId)", "modifiers": "private", "return": "void", "signature": "void invalidateThingCaches(final ThingId thingId)", "full_signature": "private void invalidateThingCaches(final ThingId thingId)", "class_method_signature": "ThingCommandEnforcement.invalidateThingCaches(final ThingId thingId)", "testcase": false, "constructor": false}, {"identifier": "invalidatePolicyCache", "parameters": "(final PolicyId policyId)", "modifiers": "private", "return": "void", "signature": "void invalidatePolicyCache(final PolicyId policyId)", "full_signature": "private void invalidatePolicyCache(final PolicyId policyId)", "class_method_signature": "ThingCommandEnforcement.invalidatePolicyCache(final PolicyId policyId)", "testcase": false, "constructor": false}, {"identifier": "getJsonViewForThingQueryCommandResponse", "parameters": "(final JsonObject responseEntity,\n            final ThingQueryCommandResponse response, final Enforcer enforcer)", "modifiers": "private static", "return": "JsonObject", "signature": "JsonObject getJsonViewForThingQueryCommandResponse(final JsonObject responseEntity,\n            final ThingQueryCommandResponse response, final Enforcer enforcer)", "full_signature": "private static JsonObject getJsonViewForThingQueryCommandResponse(final JsonObject responseEntity,\n            final ThingQueryCommandResponse response, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.getJsonViewForThingQueryCommandResponse(final JsonObject responseEntity,\n            final ThingQueryCommandResponse response, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "errorForExistingThingWithDeletedPolicy", "parameters": "(final ThingCommand thingCommand,\n            final ThingId thingId, final CharSequence policyId)", "modifiers": "private static", "return": "DittoRuntimeException", "signature": "DittoRuntimeException errorForExistingThingWithDeletedPolicy(final ThingCommand thingCommand,\n            final ThingId thingId, final CharSequence policyId)", "full_signature": "private static DittoRuntimeException errorForExistingThingWithDeletedPolicy(final ThingCommand thingCommand,\n            final ThingId thingId, final CharSequence policyId)", "class_method_signature": "ThingCommandEnforcement.errorForExistingThingWithDeletedPolicy(final ThingCommand thingCommand,\n            final ThingId thingId, final CharSequence policyId)", "testcase": false, "constructor": false}, {"identifier": "errorForThingCommand", "parameters": "(final ThingCommand thingCommand)", "modifiers": "static", "return": "DittoRuntimeException", "signature": "DittoRuntimeException errorForThingCommand(final ThingCommand thingCommand)", "full_signature": "static DittoRuntimeException errorForThingCommand(final ThingCommand thingCommand)", "class_method_signature": "ThingCommandEnforcement.errorForThingCommand(final ThingCommand thingCommand)", "testcase": false, "constructor": false}, {"identifier": "enforceCreateThingBySelf", "parameters": "()", "modifiers": "private", "return": "CompletionStage<CreateThingWithEnforcer>", "signature": "CompletionStage<CreateThingWithEnforcer> enforceCreateThingBySelf()", "full_signature": "private CompletionStage<CreateThingWithEnforcer> enforceCreateThingBySelf()", "class_method_signature": "ThingCommandEnforcement.enforceCreateThingBySelf()", "testcase": false, "constructor": false}, {"identifier": "replaceInitialPolicyWithCopiedPolicyIfPresent", "parameters": "(final CreateThing createThing)", "modifiers": "private", "return": "CompletionStage<CreateThing>", "signature": "CompletionStage<CreateThing> replaceInitialPolicyWithCopiedPolicyIfPresent(final CreateThing createThing)", "full_signature": "private CompletionStage<CreateThing> replaceInitialPolicyWithCopiedPolicyIfPresent(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.replaceInitialPolicyWithCopiedPolicyIfPresent(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "getInitialPolicyOrCopiedPolicy", "parameters": "(final CreateThing createThing)", "modifiers": "private", "return": "CompletionStage<JsonObject>", "signature": "CompletionStage<JsonObject> getInitialPolicyOrCopiedPolicy(final CreateThing createThing)", "full_signature": "private CompletionStage<JsonObject> getInitialPolicyOrCopiedPolicy(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.getInitialPolicyOrCopiedPolicy(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "retrievePolicyWithEnforcement", "parameters": "(final PolicyId policyId)", "modifiers": "private", "return": "CompletionStage<Policy>", "signature": "CompletionStage<Policy> retrievePolicyWithEnforcement(final PolicyId policyId)", "full_signature": "private CompletionStage<Policy> retrievePolicyWithEnforcement(final PolicyId policyId)", "class_method_signature": "ThingCommandEnforcement.retrievePolicyWithEnforcement(final PolicyId policyId)", "testcase": false, "constructor": false}, {"identifier": "enforceCreateThingByAuthorizationContext", "parameters": "(final CreateThing createThing)", "modifiers": "private static", "return": "CreateThingWithEnforcer", "signature": "CreateThingWithEnforcer enforceCreateThingByAuthorizationContext(final CreateThing createThing)", "full_signature": "private static CreateThingWithEnforcer enforceCreateThingByAuthorizationContext(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.enforceCreateThingByAuthorizationContext(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "enforceCreateThingByOwnInlinedPolicyOrThrow", "parameters": "(final CreateThing createThing,\n            final JsonObject inlinedPolicy)", "modifiers": "private", "return": "CreateThingWithEnforcer", "signature": "CreateThingWithEnforcer enforceCreateThingByOwnInlinedPolicyOrThrow(final CreateThing createThing,\n            final JsonObject inlinedPolicy)", "full_signature": "private CreateThingWithEnforcer enforceCreateThingByOwnInlinedPolicyOrThrow(final CreateThing createThing,\n            final JsonObject inlinedPolicy)", "class_method_signature": "ThingCommandEnforcement.enforceCreateThingByOwnInlinedPolicyOrThrow(final CreateThing createThing,\n            final JsonObject inlinedPolicy)", "testcase": false, "constructor": false}, {"identifier": "getInitialPolicy", "parameters": "(final CreateThing createThing, final JsonObject inlinedPolicy)", "modifiers": "@SuppressWarnings(\"java:S1193\") private", "return": "Policy", "signature": "Policy getInitialPolicy(final CreateThing createThing, final JsonObject inlinedPolicy)", "full_signature": "@SuppressWarnings(\"java:S1193\") private Policy getInitialPolicy(final CreateThing createThing, final JsonObject inlinedPolicy)", "class_method_signature": "ThingCommandEnforcement.getInitialPolicy(final CreateThing createThing, final JsonObject inlinedPolicy)", "testcase": false, "constructor": false}, {"identifier": "enforceCreateThingByOwnAclOrThrow", "parameters": "(final CreateThing command,\n            final AccessControlList acl)", "modifiers": "private static", "return": "CreateThingWithEnforcer", "signature": "CreateThingWithEnforcer enforceCreateThingByOwnAclOrThrow(final CreateThing command,\n            final AccessControlList acl)", "full_signature": "private static CreateThingWithEnforcer enforceCreateThingByOwnAclOrThrow(final CreateThing command,\n            final AccessControlList acl)", "class_method_signature": "ThingCommandEnforcement.enforceCreateThingByOwnAclOrThrow(final CreateThing command,\n            final AccessControlList acl)", "testcase": false, "constructor": false}, {"identifier": "attachEnforcerOrThrow", "parameters": "(final CreateThing command, final Enforcer enforcer,\n            final BiFunction<Enforcer, ThingCommand<CreateThing>, CreateThing> authorization)", "modifiers": "private static", "return": "CreateThingWithEnforcer", "signature": "CreateThingWithEnforcer attachEnforcerOrThrow(final CreateThing command, final Enforcer enforcer,\n            final BiFunction<Enforcer, ThingCommand<CreateThing>, CreateThing> authorization)", "full_signature": "private static CreateThingWithEnforcer attachEnforcerOrThrow(final CreateThing command, final Enforcer enforcer,\n            final BiFunction<Enforcer, ThingCommand<CreateThing>, CreateThing> authorization)", "class_method_signature": "ThingCommandEnforcement.attachEnforcerOrThrow(final CreateThing command, final Enforcer enforcer,\n            final BiFunction<Enforcer, ThingCommand<CreateThing>, CreateThing> authorization)", "testcase": false, "constructor": false}, {"identifier": "transformModifyThingToCreateThing", "parameters": "(final ThingCommand receivedCommand)", "modifiers": "private static", "return": "ThingCommand", "signature": "ThingCommand transformModifyThingToCreateThing(final ThingCommand receivedCommand)", "full_signature": "private static ThingCommand transformModifyThingToCreateThing(final ThingCommand receivedCommand)", "class_method_signature": "ThingCommandEnforcement.transformModifyThingToCreateThing(final ThingCommand receivedCommand)", "testcase": false, "constructor": false}, {"identifier": "authorizeByPolicyOrThrow", "parameters": "(final Enforcer policyEnforcer,\n            final ThingCommand<T> command)", "modifiers": "static", "return": "T", "signature": "T authorizeByPolicyOrThrow(final Enforcer policyEnforcer,\n            final ThingCommand<T> command)", "full_signature": "static T authorizeByPolicyOrThrow(final Enforcer policyEnforcer,\n            final ThingCommand<T> command)", "class_method_signature": "ThingCommandEnforcement.authorizeByPolicyOrThrow(final Enforcer policyEnforcer,\n            final ThingCommand<T> command)", "testcase": false, "constructor": false}, {"identifier": "authorizeByAclOrThrow", "parameters": "(final Enforcer aclEnforcer,\n            final ThingCommand<T> command)", "modifiers": "static", "return": "T", "signature": "T authorizeByAclOrThrow(final Enforcer aclEnforcer,\n            final ThingCommand<T> command)", "full_signature": "static T authorizeByAclOrThrow(final Enforcer aclEnforcer,\n            final ThingCommand<T> command)", "class_method_signature": "ThingCommandEnforcement.authorizeByAclOrThrow(final Enforcer aclEnforcer,\n            final ThingCommand<T> command)", "testcase": false, "constructor": false}, {"identifier": "computeAclPermissions", "parameters": "(final ThingModifyCommand<?> command)", "modifiers": "private static", "return": "Permissions", "signature": "Permissions computeAclPermissions(final ThingModifyCommand<?> command)", "full_signature": "private static Permissions computeAclPermissions(final ThingModifyCommand<?> command)", "class_method_signature": "ThingCommandEnforcement.computeAclPermissions(final ThingModifyCommand<?> command)", "testcase": false, "constructor": false}, {"identifier": "shouldRetrievePolicyWithThing", "parameters": "(final ThingCommand<?> command)", "modifiers": "private static", "return": "boolean", "signature": "boolean shouldRetrievePolicyWithThing(final ThingCommand<?> command)", "full_signature": "private static boolean shouldRetrievePolicyWithThing(final ThingCommand<?> command)", "class_method_signature": "ThingCommandEnforcement.shouldRetrievePolicyWithThing(final ThingCommand<?> command)", "testcase": false, "constructor": false}, {"identifier": "handleInitialCreateThing", "parameters": "(\n            final CreateThing createThing, final Enforcer enforcer)", "modifiers": "private", "return": "CompletionStage<Contextual<WithDittoHeaders>>", "signature": "CompletionStage<Contextual<WithDittoHeaders>> handleInitialCreateThing(\n            final CreateThing createThing, final Enforcer enforcer)", "full_signature": "private CompletionStage<Contextual<WithDittoHeaders>> handleInitialCreateThing(\n            final CreateThing createThing, final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.handleInitialCreateThing(\n            final CreateThing createThing, final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "shouldCreatePolicyForCreateThing", "parameters": "(final CreateThing createThing)", "modifiers": "private static", "return": "boolean", "signature": "boolean shouldCreatePolicyForCreateThing(final CreateThing createThing)", "full_signature": "private static boolean shouldCreatePolicyForCreateThing(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.shouldCreatePolicyForCreateThing(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "checkForErrorsInCreateThingWithPolicy", "parameters": "(final CreateThing command)", "modifiers": "private static", "return": "void", "signature": "void checkForErrorsInCreateThingWithPolicy(final CreateThing command)", "full_signature": "private static void checkForErrorsInCreateThingWithPolicy(final CreateThing command)", "class_method_signature": "ThingCommandEnforcement.checkForErrorsInCreateThingWithPolicy(final CreateThing command)", "testcase": false, "constructor": false}, {"identifier": "checkAclAbsenceInCreateThing", "parameters": "(final CreateThing createThing)", "modifiers": "private static", "return": "void", "signature": "void checkAclAbsenceInCreateThing(final CreateThing createThing)", "full_signature": "private static void checkAclAbsenceInCreateThing(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.checkAclAbsenceInCreateThing(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "validatePolicyIdForCreateThing", "parameters": "(final CreateThing createThing)", "modifiers": "private static", "return": "void", "signature": "void validatePolicyIdForCreateThing(final CreateThing createThing)", "full_signature": "private static void validatePolicyIdForCreateThing(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.validatePolicyIdForCreateThing(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "createThingWithInitialPolicy", "parameters": "(final CreateThing createThing,\n            final Enforcer enforcer)", "modifiers": "private", "return": "CompletionStage<CreateThing>", "signature": "CompletionStage<CreateThing> createThingWithInitialPolicy(final CreateThing createThing,\n            final Enforcer enforcer)", "full_signature": "private CompletionStage<CreateThing> createThingWithInitialPolicy(final CreateThing createThing,\n            final Enforcer enforcer)", "class_method_signature": "ThingCommandEnforcement.createThingWithInitialPolicy(final CreateThing createThing,\n            final Enforcer enforcer)", "testcase": false, "constructor": false}, {"identifier": "createPolicyAndThing", "parameters": "(final CreatePolicy createPolicy,\n            final CreateThing createThingWithoutPolicyId)", "modifiers": "private", "return": "CompletionStage<CreateThing>", "signature": "CompletionStage<CreateThing> createPolicyAndThing(final CreatePolicy createPolicy,\n            final CreateThing createThingWithoutPolicyId)", "full_signature": "private CompletionStage<CreateThing> createPolicyAndThing(final CreatePolicy createPolicy,\n            final CreateThing createThingWithoutPolicyId)", "class_method_signature": "ThingCommandEnforcement.createPolicyAndThing(final CreatePolicy createPolicy,\n            final CreateThing createThingWithoutPolicyId)", "testcase": false, "constructor": false}, {"identifier": "handlePolicyResponseForCreateThing", "parameters": "(final CreatePolicy createPolicy, final CreateThing createThing,\n            final Object policyResponse)", "modifiers": "private", "return": "void", "signature": "void handlePolicyResponseForCreateThing(final CreatePolicy createPolicy, final CreateThing createThing,\n            final Object policyResponse)", "full_signature": "private void handlePolicyResponseForCreateThing(final CreatePolicy createPolicy, final CreateThing createThing,\n            final Object policyResponse)", "class_method_signature": "ThingCommandEnforcement.handlePolicyResponseForCreateThing(final CreatePolicy createPolicy, final CreateThing createThing,\n            final Object policyResponse)", "testcase": false, "constructor": false}, {"identifier": "shouldReportInitialPolicyCreationFailure", "parameters": "(final Object policyResponse)", "modifiers": "private static", "return": "boolean", "signature": "boolean shouldReportInitialPolicyCreationFailure(final Object policyResponse)", "full_signature": "private static boolean shouldReportInitialPolicyCreationFailure(final Object policyResponse)", "class_method_signature": "ThingCommandEnforcement.shouldReportInitialPolicyCreationFailure(final Object policyResponse)", "testcase": false, "constructor": false}, {"identifier": "reportInitialPolicyCreationFailure", "parameters": "(final PolicyId policyId,\n            final CreateThing command)", "modifiers": "private static", "return": "ThingNotCreatableException", "signature": "ThingNotCreatableException reportInitialPolicyCreationFailure(final PolicyId policyId,\n            final CreateThing command)", "full_signature": "private static ThingNotCreatableException reportInitialPolicyCreationFailure(final PolicyId policyId,\n            final CreateThing command)", "class_method_signature": "ThingCommandEnforcement.reportInitialPolicyCreationFailure(final PolicyId policyId,\n            final CreateThing command)", "testcase": false, "constructor": false}, {"identifier": "getInlinedOrDefaultPolicyForCreateThing", "parameters": "(final CreateThing createThing)", "modifiers": "private static", "return": "Optional<Policy>", "signature": "Optional<Policy> getInlinedOrDefaultPolicyForCreateThing(final CreateThing createThing)", "full_signature": "private static Optional<Policy> getInlinedOrDefaultPolicyForCreateThing(final CreateThing createThing)", "class_method_signature": "ThingCommandEnforcement.getInlinedOrDefaultPolicyForCreateThing(final CreateThing createThing)", "testcase": false, "constructor": false}, {"identifier": "getDefaultPolicy", "parameters": "(final AuthorizationContext authorizationContext,\n            final ThingId thingId)", "modifiers": "private static", "return": "Optional<Policy>", "signature": "Optional<Policy> getDefaultPolicy(final AuthorizationContext authorizationContext,\n            final ThingId thingId)", "full_signature": "private static Optional<Policy> getDefaultPolicy(final AuthorizationContext authorizationContext,\n            final ThingId thingId)", "class_method_signature": "ThingCommandEnforcement.getDefaultPolicy(final AuthorizationContext authorizationContext,\n            final ThingId thingId)", "testcase": false, "constructor": false}, {"identifier": "isAclEnforcer", "parameters": "(final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "modifiers": "private static", "return": "boolean", "signature": "boolean isAclEnforcer(final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "full_signature": "private static boolean isAclEnforcer(final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "class_method_signature": "ThingCommandEnforcement.isAclEnforcer(final Entry<EntityIdWithResourceType> enforcerKeyEntry)", "testcase": false, "constructor": false}], "file": "services/concierge/enforcement/src/main/java/org/eclipse/ditto/services/concierge/enforcement/ThingCommandEnforcement.java"}, "focal_method": {"identifier": "transformModifyThingToCreateThing", "parameters": "(final ThingCommand receivedCommand)", "modifiers": "private static", "return": "ThingCommand", "body": "private static ThingCommand transformModifyThingToCreateThing(final ThingCommand receivedCommand) {\n        if (receivedCommand instanceof ModifyThing) {\n            final ModifyThing modifyThing = (ModifyThing) receivedCommand;\n            final JsonObject initialPolicy = modifyThing.getInitialPolicy().orElse(null);\n            final String policyIdOrPlaceholder = modifyThing.getPolicyIdOrPlaceholder().orElse(null);\n            final Thing newThing = modifyThing.getThing().toBuilder()\n                    .setId(modifyThing.getThingEntityId())\n                    .build();\n            return CreateThing.of(newThing, initialPolicy, policyIdOrPlaceholder, modifyThing.getDittoHeaders());\n        } else {\n            return receivedCommand;\n        }\n    }", "signature": "ThingCommand transformModifyThingToCreateThing(final ThingCommand receivedCommand)", "full_signature": "private static ThingCommand transformModifyThingToCreateThing(final ThingCommand receivedCommand)", "class_method_signature": "ThingCommandEnforcement.transformModifyThingToCreateThing(final ThingCommand receivedCommand)", "testcase": false, "constructor": false, "invocations": ["orElse", "getInitialPolicy", "orElse", "getPolicyIdOrPlaceholder", "build", "setId", "toBuilder", "getThing", "getThingEntityId", "of", "getDittoHeaders"]}, "repository": {"repo_id": 87849739, "url": "https://github.com/eclipse/ditto", "stars": 139, "created": "4/10/2017 7:29:57 PM +00:00", "updates": "2020-01-27T14:02:39+00:00", "fork": "False", "license": "licensed"}}