{"test_class": {"identifier": "TokenTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final String svcVersion = \"S1\";", "modifier": "private final", "type": "String", "declarator": "svcVersion = \"S1\"", "var_name": "svcVersion"}, {"original_string": "private final String svcDomain = \"sports\";", "modifier": "private final", "type": "String", "declarator": "svcDomain = \"sports\"", "var_name": "svcDomain"}, {"original_string": "private final String svcName = \"fantasy\";", "modifier": "private final", "type": "String", "declarator": "svcName = \"fantasy\"", "var_name": "svcName"}, {"original_string": "private final String host = \"somehost.somecompany.com\";", "modifier": "private final", "type": "String", "declarator": "host = \"somehost.somecompany.com\"", "var_name": "host"}, {"original_string": "private final String salt = \"saltstring\";", "modifier": "private final", "type": "String", "declarator": "salt = \"saltstring\"", "var_name": "salt"}, {"original_string": "private final long expirationTime = 10;", "modifier": "private final", "type": "long", "declarator": "expirationTime = 10", "var_name": "expirationTime"}, {"original_string": "private String servicePrivateKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "servicePrivateKeyStringK0 = null", "var_name": "servicePrivateKeyStringK0"}, {"original_string": "private String servicePrivateKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "servicePrivateKeyStringK1 = null", "var_name": "servicePrivateKeyStringK1"}, {"original_string": "private String servicePublicKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "servicePublicKeyStringK0 = null", "var_name": "servicePublicKeyStringK0"}, {"original_string": "private String servicePublicKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "servicePublicKeyStringK1 = null", "var_name": "servicePublicKeyStringK1"}], "file": "libs/java/auth_core/src/test/java/com/yahoo/athenz/auth/token/TokenTest.java"}, "test_case": {"identifier": "testTokenValidateNullData", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testTokenValidateNullData() throws CryptoException {\n        \n        Token token = new Token();\n        assertFalse(token.validate(servicePublicKeyStringK0, 3600, false));\n    }", "signature": "void testTokenValidateNullData()", "full_signature": "@Test public void testTokenValidateNullData()", "class_method_signature": "TokenTest.testTokenValidateNullData()", "testcase": true, "constructor": false, "invocations": ["assertFalse", "validate"]}, "focal_class": {"identifier": "Token", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(Token.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(Token.class)", "var_name": "LOG"}, {"original_string": "protected final int defaultBuilderBufSize = 512;", "modifier": "protected final", "type": "int", "declarator": "defaultBuilderBufSize = 512", "var_name": "defaultBuilderBufSize"}, {"original_string": "protected String unsignedToken = null;", "modifier": "protected", "type": "String", "declarator": "unsignedToken = null", "var_name": "unsignedToken"}, {"original_string": "protected String signedToken   = null;", "modifier": "protected", "type": "String", "declarator": "signedToken   = null", "var_name": "signedToken"}, {"original_string": "protected String version = null;", "modifier": "protected", "type": "String", "declarator": "version = null", "var_name": "version"}, {"original_string": "protected String salt = null;", "modifier": "protected", "type": "String", "declarator": "salt = null", "var_name": "salt"}, {"original_string": "protected String host = null;", "modifier": "protected", "type": "String", "declarator": "host = null", "var_name": "host"}, {"original_string": "protected String ip = null;", "modifier": "protected", "type": "String", "declarator": "ip = null", "var_name": "ip"}, {"original_string": "protected String domain = null;", "modifier": "protected", "type": "String", "declarator": "domain = null", "var_name": "domain"}, {"original_string": "protected String signature = null;", "modifier": "protected", "type": "String", "declarator": "signature = null", "var_name": "signature"}, {"original_string": "protected String keyId = \"0\";", "modifier": "protected", "type": "String", "declarator": "keyId = \"0\"", "var_name": "keyId"}, {"original_string": "protected long expiryTime = 0;", "modifier": "protected", "type": "long", "declarator": "expiryTime = 0", "var_name": "expiryTime"}, {"original_string": "protected long timestamp = 0;", "modifier": "protected", "type": "long", "declarator": "timestamp = 0", "var_name": "timestamp"}, {"original_string": "protected String digestAlgorithm = Crypto.SHA256;", "modifier": "protected", "type": "String", "declarator": "digestAlgorithm = Crypto.SHA256", "var_name": "digestAlgorithm"}, {"original_string": "private static final String ATHENZ_PROP_TOKEN_MAX_EXPIRY = \"athenz.token_max_expiry\";", "modifier": "private static final", "type": "String", "declarator": "ATHENZ_PROP_TOKEN_MAX_EXPIRY = \"athenz.token_max_expiry\"", "var_name": "ATHENZ_PROP_TOKEN_MAX_EXPIRY"}, {"original_string": "private static final long ATHENZ_TOKEN_MAX_EXPIRY = Long.parseLong(\n            System.getProperty(ATHENZ_PROP_TOKEN_MAX_EXPIRY, Long.toString(TimeUnit.SECONDS.convert(30, TimeUnit.DAYS))));", "modifier": "private static final", "type": "long", "declarator": "ATHENZ_TOKEN_MAX_EXPIRY = Long.parseLong(\n            System.getProperty(ATHENZ_PROP_TOKEN_MAX_EXPIRY, Long.toString(TimeUnit.SECONDS.convert(30, TimeUnit.DAYS))))", "var_name": "ATHENZ_TOKEN_MAX_EXPIRY"}, {"original_string": "private static final String ATHENZ_PROP_TOKEN_NO_EXPIRY = \"athenz.token_no_expiry\";", "modifier": "private static final", "type": "String", "declarator": "ATHENZ_PROP_TOKEN_NO_EXPIRY = \"athenz.token_no_expiry\"", "var_name": "ATHENZ_PROP_TOKEN_NO_EXPIRY"}, {"original_string": "static Boolean ATHENZ_TOKEN_NO_EXPIRY = Boolean.parseBoolean(\n            System.getProperty(ATHENZ_PROP_TOKEN_NO_EXPIRY, \"false\"));", "modifier": "static", "type": "Boolean", "declarator": "ATHENZ_TOKEN_NO_EXPIRY = Boolean.parseBoolean(\n            System.getProperty(ATHENZ_PROP_TOKEN_NO_EXPIRY, \"false\"))", "var_name": "ATHENZ_TOKEN_NO_EXPIRY"}], "methods": [{"identifier": "getDigestAlgorithm", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getDigestAlgorithm()", "full_signature": "public String getDigestAlgorithm()", "class_method_signature": "Token.getDigestAlgorithm()", "testcase": false, "constructor": false}, {"identifier": "sign", "parameters": "(String privKey)", "modifiers": "public", "return": "void", "signature": "void sign(String privKey)", "full_signature": "public void sign(String privKey)", "class_method_signature": "Token.sign(String privKey)", "testcase": false, "constructor": false}, {"identifier": "sign", "parameters": "(PrivateKey key)", "modifiers": "public", "return": "void", "signature": "void sign(PrivateKey key)", "full_signature": "public void sign(PrivateKey key)", "class_method_signature": "Token.sign(PrivateKey key)", "testcase": false, "constructor": false}, {"identifier": "setTimeStamp", "parameters": "(long issueTime, long expirationWindow)", "modifiers": "public", "return": "void", "signature": "void setTimeStamp(long issueTime, long expirationWindow)", "full_signature": "public void setTimeStamp(long issueTime, long expirationWindow)", "class_method_signature": "Token.setTimeStamp(long issueTime, long expirationWindow)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "(String pubKey, int allowedOffset)", "modifiers": "public", "return": "boolean", "signature": "boolean validate(String pubKey, int allowedOffset)", "full_signature": "public boolean validate(String pubKey, int allowedOffset)", "class_method_signature": "Token.validate(String pubKey, int allowedOffset)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "(String pubKey, int allowedOffset, boolean allowNoExpiry)", "modifiers": "public", "return": "boolean", "signature": "boolean validate(String pubKey, int allowedOffset, boolean allowNoExpiry)", "full_signature": "public boolean validate(String pubKey, int allowedOffset, boolean allowNoExpiry)", "class_method_signature": "Token.validate(String pubKey, int allowedOffset, boolean allowNoExpiry)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "(String pubKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "modifiers": "public", "return": "boolean", "signature": "boolean validate(String pubKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "full_signature": "public boolean validate(String pubKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "class_method_signature": "Token.validate(String pubKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "(PublicKey publicKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "modifiers": "public", "return": "boolean", "signature": "boolean validate(PublicKey publicKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "full_signature": "public boolean validate(PublicKey publicKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "class_method_signature": "Token.validate(PublicKey publicKey, int allowedOffset, boolean allowNoExpiry,\n            StringBuilder errMsg)", "testcase": false, "constructor": false}, {"identifier": "getVersion", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getVersion()", "full_signature": "public String getVersion()", "class_method_signature": "Token.getVersion()", "testcase": false, "constructor": false}, {"identifier": "getSalt", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getSalt()", "full_signature": "public String getSalt()", "class_method_signature": "Token.getSalt()", "testcase": false, "constructor": false}, {"identifier": "getHost", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getHost()", "full_signature": "public String getHost()", "class_method_signature": "Token.getHost()", "testcase": false, "constructor": false}, {"identifier": "getDomain", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getDomain()", "full_signature": "public String getDomain()", "class_method_signature": "Token.getDomain()", "testcase": false, "constructor": false}, {"identifier": "getSignature", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getSignature()", "full_signature": "public String getSignature()", "class_method_signature": "Token.getSignature()", "testcase": false, "constructor": false}, {"identifier": "getTimestamp", "parameters": "()", "modifiers": "public", "return": "long", "signature": "long getTimestamp()", "full_signature": "public long getTimestamp()", "class_method_signature": "Token.getTimestamp()", "testcase": false, "constructor": false}, {"identifier": "getExpiryTime", "parameters": "()", "modifiers": "public", "return": "long", "signature": "long getExpiryTime()", "full_signature": "public long getExpiryTime()", "class_method_signature": "Token.getExpiryTime()", "testcase": false, "constructor": false}, {"identifier": "getSignedToken", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getSignedToken()", "full_signature": "public String getSignedToken()", "class_method_signature": "Token.getSignedToken()", "testcase": false, "constructor": false}, {"identifier": "getKeyId", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getKeyId()", "full_signature": "public String getKeyId()", "class_method_signature": "Token.getKeyId()", "testcase": false, "constructor": false}, {"identifier": "getIP", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getIP()", "full_signature": "public String getIP()", "class_method_signature": "Token.getIP()", "testcase": false, "constructor": false}, {"identifier": "getUnsignedToken", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getUnsignedToken()", "full_signature": "public String getUnsignedToken()", "class_method_signature": "Token.getUnsignedToken()", "testcase": false, "constructor": false}, {"identifier": "getUnsignedToken", "parameters": "(String credential)", "modifiers": "public static", "return": "String", "signature": "String getUnsignedToken(String credential)", "full_signature": "public static String getUnsignedToken(String credential)", "class_method_signature": "Token.getUnsignedToken(String credential)", "testcase": false, "constructor": false}], "file": "libs/java/auth_core/src/main/java/com/yahoo/athenz/auth/token/Token.java"}, "focal_method": {"identifier": "validate", "parameters": "(String pubKey, int allowedOffset)", "modifiers": "public", "return": "boolean", "body": "public boolean validate(String pubKey, int allowedOffset) {\n        return validate(pubKey, allowedOffset, false, null);\n    }", "signature": "boolean validate(String pubKey, int allowedOffset)", "full_signature": "public boolean validate(String pubKey, int allowedOffset)", "class_method_signature": "Token.validate(String pubKey, int allowedOffset)", "testcase": false, "constructor": false, "invocations": ["validate"]}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}