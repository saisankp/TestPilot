{"test_class": {"identifier": "SerializeUtilsTest", "superclass": "", "interfaces": "", "fields": [], "file": "zookeeper-server/src/test/java/org/apache/zookeeper/server/util/SerializeUtilsTest.java"}, "test_case": {"identifier": "testSerializeRequestWithTxn", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testSerializeRequestWithTxn() throws IOException {\n        // Arrange\n        TxnHeader header = mock(TxnHeader.class);\n        doAnswer(new Answer() {\n            @Override\n            public Object answer(InvocationOnMock invocation) throws Throwable {\n                Object[] args = invocation.getArguments();\n                OutputArchive oa = (OutputArchive) args[0];\n                oa.writeString(\"header\", \"test\");\n                return null;\n            }\n        }).when(header).serialize(any(OutputArchive.class), anyString());\n        Record txn = mock(Record.class);\n        doAnswer(new Answer() {\n            @Override\n            public Object answer(InvocationOnMock invocation) throws Throwable {\n                Object[] args = invocation.getArguments();\n                OutputArchive oa = (OutputArchive) args[0];\n                oa.writeString(\"record\", \"test\");\n                return null;\n            }\n        }).when(txn).serialize(any(OutputArchive.class), anyString());\n        Request request = new Request(1, 2, 3, header, txn, 4);\n\n        // Act\n        byte[] data = SerializeUtils.serializeRequest(request);\n\n        // Assert\n        assertNotNull(data);\n        InOrder inOrder = inOrder(header, txn);\n        inOrder.verify(header).serialize(any(OutputArchive.class), eq(\"hdr\"));\n        inOrder.verify(txn).serialize(any(OutputArchive.class), eq(\"txn\"));\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        BinaryOutputArchive boa = BinaryOutputArchive.getArchive(baos);\n        boa.writeString(\"header\", \"test\");\n        boa.writeString(\"record\", \"test\");\n        baos.close();\n        assertArrayEquals(baos.toByteArray(), data);\n    }", "signature": "void testSerializeRequestWithTxn()", "full_signature": "@Test public void testSerializeRequestWithTxn()", "class_method_signature": "SerializeUtilsTest.testSerializeRequestWithTxn()", "testcase": true, "constructor": false, "invocations": ["mock", "serialize", "when", "doAnswer", "getArguments", "writeString", "any", "anyString", "mock", "serialize", "when", "doAnswer", "getArguments", "writeString", "any", "anyString", "serializeRequest", "assertNotNull", "inOrder", "serialize", "verify", "any", "eq", "serialize", "verify", "any", "eq", "getArchive", "writeString", "writeString", "close", "assertArrayEquals", "toByteArray"]}, "focal_class": {"identifier": "SerializeUtils", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(SerializeUtils.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(SerializeUtils.class)", "var_name": "LOG"}], "methods": [{"identifier": "deserializeTxn", "parameters": "(byte txnBytes[], TxnHeader hdr)", "modifiers": "public static", "return": "Record", "signature": "Record deserializeTxn(byte txnBytes[], TxnHeader hdr)", "full_signature": "public static Record deserializeTxn(byte txnBytes[], TxnHeader hdr)", "class_method_signature": "SerializeUtils.deserializeTxn(byte txnBytes[], TxnHeader hdr)", "testcase": false, "constructor": false}, {"identifier": "deserializeSnapshot", "parameters": "(DataTree dt,InputArchive ia,\n            Map<Long, Integer> sessions)", "modifiers": "public static", "return": "void", "signature": "void deserializeSnapshot(DataTree dt,InputArchive ia,\n            Map<Long, Integer> sessions)", "full_signature": "public static void deserializeSnapshot(DataTree dt,InputArchive ia,\n            Map<Long, Integer> sessions)", "class_method_signature": "SerializeUtils.deserializeSnapshot(DataTree dt,InputArchive ia,\n            Map<Long, Integer> sessions)", "testcase": false, "constructor": false}, {"identifier": "serializeSnapshot", "parameters": "(DataTree dt,OutputArchive oa,\n            Map<Long, Integer> sessions)", "modifiers": "public static", "return": "void", "signature": "void serializeSnapshot(DataTree dt,OutputArchive oa,\n            Map<Long, Integer> sessions)", "full_signature": "public static void serializeSnapshot(DataTree dt,OutputArchive oa,\n            Map<Long, Integer> sessions)", "class_method_signature": "SerializeUtils.serializeSnapshot(DataTree dt,OutputArchive oa,\n            Map<Long, Integer> sessions)", "testcase": false, "constructor": false}, {"identifier": "serializeRequest", "parameters": "(Request request)", "modifiers": "public static", "return": "byte[]", "signature": "byte[] serializeRequest(Request request)", "full_signature": "public static byte[] serializeRequest(Request request)", "class_method_signature": "SerializeUtils.serializeRequest(Request request)", "testcase": false, "constructor": false}], "file": "zookeeper-server/src/main/java/org/apache/zookeeper/server/util/SerializeUtils.java"}, "focal_method": {"identifier": "serializeRequest", "parameters": "(Request request)", "modifiers": "public static", "return": "byte[]", "body": "public static byte[] serializeRequest(Request request) {\n        if (request == null || request.getHdr() == null) return null;\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        BinaryOutputArchive boa = BinaryOutputArchive.getArchive(baos);\n        try {\n            request.getHdr().serialize(boa, \"hdr\");\n            if (request.getTxn() != null) {\n                request.getTxn().serialize(boa, \"txn\");\n            }\n        } catch (IOException e) {\n            LOG.error(\"This really should be impossible\", e);\n        } finally {\n            IOUtils.cleanup(LOG, baos);\n        }\n        return baos.toByteArray();\n    }", "signature": "byte[] serializeRequest(Request request)", "full_signature": "public static byte[] serializeRequest(Request request)", "class_method_signature": "SerializeUtils.serializeRequest(Request request)", "testcase": false, "constructor": false, "invocations": ["getHdr", "getArchive", "serialize", "getHdr", "getTxn", "serialize", "getTxn", "error", "cleanup", "toByteArray"]}, "repository": {"repo_id": 230430206, "url": "https://github.com/boomblog/zookeeper-vip2", "language": "Java", "is_fork": false, "fork_count": 29, "stargazer_count": 10, "size": 3105, "license": "licensed"}}