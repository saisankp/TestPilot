{"test_class": {"identifier": "LocalesServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@SpyBean\n    private LocalesService localesService;", "modifier": "@SpyBean\n    private", "type": "LocalesService", "declarator": "localesService", "var_name": "localesService"}, {"original_string": "@MockBean\n    private DiscoveryUtils discoveryUtils;", "modifier": "@MockBean\n    private", "type": "DiscoveryUtils", "declarator": "discoveryUtils", "var_name": "discoveryUtils"}, {"original_string": "@MockBean\n    private ModulesService modulesService;", "modifier": "@MockBean\n    private", "type": "ModulesService", "declarator": "modulesService", "var_name": "modulesService"}, {"original_string": "@ClassRule\n    static public WireMockRule wireMockRule = new WireMockRule(8089);", "modifier": "@ClassRule\n    static public", "type": "WireMockRule", "declarator": "wireMockRule = new WireMockRule(8089)", "var_name": "wireMockRule"}], "file": "api-gateway/src/test/java/fr/sictiam/stela/apigateway/service/LocalesServiceTest.java"}, "test_case": {"identifier": "getExternalModuleJsonTranslation", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void getExternalModuleJsonTranslation() {\n        stubFor(get(urlPathMatching(\"/api/pes/locales/fr/pes.json\"))\n                .willReturn(ok(\"{ \\\"field\\\": \\\"value\\\" }\")\n                        .withHeader(\"Content-Type\", \"application/json\")));\n\n        given(modulesService.moduleHaveInstance(matches(\"pes\"))).willReturn(true);\n\n        given(discoveryUtils.getServiceUrlByName(matches(\"pes\"))).willReturn(\"http://localhost:8089\");\n\n        String jsonTranslation = localesService.getJsonTranslation(\"pes\", \"fr\", \"pes\");\n\n        assertEquals(jsonTranslation, \"{ \\\"field\\\": \\\"value\\\" }\");\n    }", "signature": "void getExternalModuleJsonTranslation()", "full_signature": "@Test public void getExternalModuleJsonTranslation()", "class_method_signature": "LocalesServiceTest.getExternalModuleJsonTranslation()", "testcase": true, "constructor": false, "invocations": ["stubFor", "willReturn", "get", "urlPathMatching", "withHeader", "ok", "willReturn", "given", "moduleHaveInstance", "matches", "willReturn", "given", "getServiceUrlByName", "matches", "getJsonTranslation", "assertEquals"]}, "focal_class": {"identifier": "LocalesService", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(LocalesService.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(LocalesService.class)", "var_name": "LOGGER"}, {"original_string": "private final RestTemplate restTemplate;", "modifier": "private final", "type": "RestTemplate", "declarator": "restTemplate", "var_name": "restTemplate"}, {"original_string": "private final DiscoveryUtils discoveryUtils;", "modifier": "private final", "type": "DiscoveryUtils", "declarator": "discoveryUtils", "var_name": "discoveryUtils"}, {"original_string": "private final ModulesService modulesService;", "modifier": "private final", "type": "ModulesService", "declarator": "modulesService", "var_name": "modulesService"}], "methods": [{"identifier": "LocalesService", "parameters": "(RestTemplateBuilder builder, DiscoveryUtils discoveryUtils, ModulesService modulesService)", "modifiers": "public", "return": "", "signature": " LocalesService(RestTemplateBuilder builder, DiscoveryUtils discoveryUtils, ModulesService modulesService)", "full_signature": "public  LocalesService(RestTemplateBuilder builder, DiscoveryUtils discoveryUtils, ModulesService modulesService)", "class_method_signature": "LocalesService.LocalesService(RestTemplateBuilder builder, DiscoveryUtils discoveryUtils, ModulesService modulesService)", "testcase": false, "constructor": true}, {"identifier": "getJsonTranslation", "parameters": "(String module, String lng, String ns)", "modifiers": "public", "return": "String", "signature": "String getJsonTranslation(String module, String lng, String ns)", "full_signature": "public String getJsonTranslation(String module, String lng, String ns)", "class_method_signature": "LocalesService.getJsonTranslation(String module, String lng, String ns)", "testcase": false, "constructor": false}, {"identifier": "buildLocalesEndpointUrl", "parameters": "(String applicationName, String lng, String ns)", "modifiers": "private", "return": "String", "signature": "String buildLocalesEndpointUrl(String applicationName, String lng, String ns)", "full_signature": "private String buildLocalesEndpointUrl(String applicationName, String lng, String ns)", "class_method_signature": "LocalesService.buildLocalesEndpointUrl(String applicationName, String lng, String ns)", "testcase": false, "constructor": false}], "file": "api-gateway/src/main/java/fr/sictiam/stela/apigateway/service/LocalesService.java"}, "focal_method": {"identifier": "getJsonTranslation", "parameters": "(String module, String lng, String ns)", "modifiers": "public", "return": "String", "body": "public String getJsonTranslation(String module, String lng, String ns) {\n        if (module.equals(\"api-gateway\")) {\n            return LocalFileUtils.getLocalFile(String.join(\"/\",\"public/locales\",lng, ns.concat(\".json\")));\n        }\n\n        if(modulesService.moduleHaveInstance(module)) {\n            try {\n                return Objects.requireNonNull(restTemplate.getForObject(this.buildLocalesEndpointUrl(module, lng, ns), String.class));\n            } catch (RestClientException e) {\n                LOGGER.warn(\"[getJsonTranslation] An error occured in module {} : {}\", module, e.getMessage());\n            }\n        } else {\n            LOGGER.warn(\"Module {} not have instance\", module);\n        }\n        return \"\";\n    }", "signature": "String getJsonTranslation(String module, String lng, String ns)", "full_signature": "public String getJsonTranslation(String module, String lng, String ns)", "class_method_signature": "LocalesService.getJsonTranslation(String module, String lng, String ns)", "testcase": false, "constructor": false, "invocations": ["equals", "getLocalFile", "join", "concat", "moduleHaveInstance", "requireNonNull", "getForObject", "buildLocalesEndpointUrl", "warn", "getMessage", "warn"]}, "repository": {"repo_id": 180337008, "url": "https://github.com/SICTIAM/stela", "language": "Java", "is_fork": false, "fork_count": 0, "stargazer_count": 5, "size": 7714, "license": "licensed"}}