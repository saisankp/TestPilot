{"test_class": {"identifier": "VarDependenciesTest", "superclass": "extends BaseVarTests", "interfaces": "", "fields": [], "file": "cypher2sql/src/test/java/org/cytosm/cypher2sql/lowering/typeck/VarDependenciesTest.java"}, "test_case": {"identifier": "testReachableVariablesMatchMatchWithMatchReturn", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testReachableVariablesMatchMatchWithMatchReturn() {\n        String cypher = \"\" +\n                \"MATCH (a)--(b)\\n\" +     // match0\n                \"MATCH (b)\\n\" +          // match1\n                \"WITH (a)\\n\" +           // with2\n                \"MATCH (b)\\n\" +          // match3\n                \"RETURN a.firstName\";    // ret\n        Statement st = PassAvailables.parseCypher(cypher);\n        SingleQuery sq = (SingleQuery) st.query.part;\n        VarDependencies dependencies = new VarDependencies(st);\n        Iterator<Clause> iter = sq.clauses.iterator();\n        AvailableVariables match0 = dependencies.getReachableVars(this.genClauseForASTNode(this.getPatternPart(iter.next()).next()));\n        AvailableVariables match1 = dependencies.getReachableVars(this.genClauseForASTNode(this.getPatternPart(iter.next()).next()));\n        AvailableVariables with2 = dependencies.getReachableVars(this.genClauseForASTNode(iter.next()));\n        AvailableVariables match3 = dependencies.getReachableVars(this.genClauseForASTNode(this.getPatternPart(iter.next()).next()));\n        AvailableVariables ret = dependencies.getReachableVars(this.genClauseForASTNode(iter.next()));\n\n        Assert.assertTrue(match0.isEmpty());\n        Assert.assertTrue(match1.get(\"a\").isPresent());\n        Assert.assertTrue(match1.get(\"b\").isPresent());\n        Assert.assertTrue(with2.get(\"a\").isPresent());\n        Assert.assertTrue(with2.get(\"b\").isPresent());\n        Assert.assertTrue(match3.get(\"a\").isPresent());\n        Assert.assertFalse(match3.get(\"b\").isPresent());\n        Assert.assertTrue(ret.get(\"a\").isPresent());\n        Assert.assertTrue(ret.get(\"b\").isPresent());\n    }", "signature": "void testReachableVariablesMatchMatchWithMatchReturn()", "full_signature": "@Test public void testReachableVariablesMatchMatchWithMatchReturn()", "class_method_signature": "VarDependenciesTest.testReachableVariablesMatchMatchWithMatchReturn()", "testcase": true, "constructor": false, "invocations": ["parseCypher", "iterator", "getReachableVars", "genClauseForASTNode", "next", "getPatternPart", "next", "getReachableVars", "genClauseForASTNode", "next", "getPatternPart", "next", "getReachableVars", "genClauseForASTNode", "next", "getReachableVars", "genClauseForASTNode", "next", "getPatternPart", "next", "getReachableVars", "genClauseForASTNode", "next", "assertTrue", "isEmpty", "assertTrue", "isPresent", "get", "assertTrue", "isPresent", "get", "assertTrue", "isPresent", "get", "assertTrue", "isPresent", "get", "assertTrue", "isPresent", "get", "assertFalse", "isPresent", "get", "assertTrue", "isPresent", "get", "assertTrue", "isPresent", "get"]}, "focal_class": {"identifier": "VarDependencies", "superclass": "", "interfaces": "", "fields": [{"original_string": "private Map<ClauseId, List<Var>> usedVariablesInClause = new HashMap<>();", "modifier": "private", "type": "Map<ClauseId, List<Var>>", "declarator": "usedVariablesInClause = new HashMap<>()", "var_name": "usedVariablesInClause"}, {"original_string": "private Map<ClauseId, AvailableVariables> reachableVariables = new HashMap<>();", "modifier": "private", "type": "Map<ClauseId, AvailableVariables>", "declarator": "reachableVariables = new HashMap<>()", "var_name": "reachableVariables"}, {"original_string": "private Map<ClauseId, List<Relationship>> relationships = new HashMap<>();", "modifier": "private", "type": "Map<ClauseId, List<Relationship>>", "declarator": "relationships = new HashMap<>()", "var_name": "relationships"}, {"original_string": "private List<Expr> returnExprs = new ArrayList<>();", "modifier": "private", "type": "List<Expr>", "declarator": "returnExprs = new ArrayList<>()", "var_name": "returnExprs"}], "methods": [{"identifier": "VarDependencies", "parameters": "(final Statement statement)", "modifiers": "public", "return": "", "signature": " VarDependencies(final Statement statement)", "full_signature": "public  VarDependencies(final Statement statement)", "class_method_signature": "VarDependencies.VarDependencies(final Statement statement)", "testcase": false, "constructor": true}, {"identifier": "getUsedVars", "parameters": "(ClauseId clauseId)", "modifiers": "public", "return": "List<Var>", "signature": "List<Var> getUsedVars(ClauseId clauseId)", "full_signature": "public List<Var> getUsedVars(ClauseId clauseId)", "class_method_signature": "VarDependencies.getUsedVars(ClauseId clauseId)", "testcase": false, "constructor": false}, {"identifier": "getAllVariables", "parameters": "()", "modifiers": "public", "return": "Set<Var>", "signature": "Set<Var> getAllVariables()", "full_signature": "public Set<Var> getAllVariables()", "class_method_signature": "VarDependencies.getAllVariables()", "testcase": false, "constructor": false}, {"identifier": "getUsedAndIndirectUsedVars", "parameters": "(ClauseId clauseId)", "modifiers": "public", "return": "List<Var>", "signature": "List<Var> getUsedAndIndirectUsedVars(ClauseId clauseId)", "full_signature": "public List<Var> getUsedAndIndirectUsedVars(ClauseId clauseId)", "class_method_signature": "VarDependencies.getUsedAndIndirectUsedVars(ClauseId clauseId)", "testcase": false, "constructor": false}, {"identifier": "getReachableVars", "parameters": "(ClauseId clauseId)", "modifiers": "public", "return": "AvailableVariables", "signature": "AvailableVariables getReachableVars(ClauseId clauseId)", "full_signature": "public AvailableVariables getReachableVars(ClauseId clauseId)", "class_method_signature": "VarDependencies.getReachableVars(ClauseId clauseId)", "testcase": false, "constructor": false}, {"identifier": "getRelationships", "parameters": "(ClauseId clauseId)", "modifiers": "public", "return": "List<Relationship>", "signature": "List<Relationship> getRelationships(ClauseId clauseId)", "full_signature": "public List<Relationship> getRelationships(ClauseId clauseId)", "class_method_signature": "VarDependencies.getRelationships(ClauseId clauseId)", "testcase": false, "constructor": false}, {"identifier": "getReturnExprs", "parameters": "()", "modifiers": "public", "return": "List<Expr>", "signature": "List<Expr> getReturnExprs()", "full_signature": "public List<Expr> getReturnExprs()", "class_method_signature": "VarDependencies.getReturnExprs()", "testcase": false, "constructor": false}], "file": "cypher2sql/src/main/java/org/cytosm/cypher2sql/lowering/typeck/VarDependencies.java"}, "focal_method": {"identifier": "getReachableVars", "parameters": "(ClauseId clauseId)", "modifiers": "public", "return": "AvailableVariables", "body": "public AvailableVariables getReachableVars(ClauseId clauseId) {\n        return this.reachableVariables.get(clauseId);\n    }", "signature": "AvailableVariables getReachableVars(ClauseId clauseId)", "full_signature": "public AvailableVariables getReachableVars(ClauseId clauseId)", "class_method_signature": "VarDependencies.getReachableVars(ClauseId clauseId)", "testcase": false, "constructor": false, "invocations": ["get"]}, "repository": {"repo_id": 76279677, "url": "https://github.com/cytosm/cytosm", "language": "Java", "is_fork": false, "fork_count": 14, "stargazer_count": 41, "size": 1250, "license": "licensed"}}