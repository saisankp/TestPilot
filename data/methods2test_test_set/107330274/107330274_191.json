{"test_class": {"identifier": "InstanceCacheTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final TestScheduler testScheduler = Schedulers.test();", "modifier": "private final", "type": "TestScheduler", "declarator": "testScheduler = Schedulers.test()", "var_name": "testScheduler"}, {"original_string": "private final AgentManagementConfiguration configuration = mockedAgentManagementConfiguration();", "modifier": "private final", "type": "AgentManagementConfiguration", "declarator": "configuration = mockedAgentManagementConfiguration()", "var_name": "configuration"}, {"original_string": "private final TestableInstanceCloudConnector testConnector = new TestableInstanceCloudConnector();", "modifier": "private final", "type": "TestableInstanceCloudConnector", "declarator": "testConnector = new TestableInstanceCloudConnector()", "var_name": "testConnector"}, {"original_string": "private final Registry registry = new DefaultRegistry();", "modifier": "private final", "type": "Registry", "declarator": "registry = new DefaultRegistry()", "var_name": "registry"}, {"original_string": "private DataGenerator<InstanceGroup> instanceGroupsGenerator = InstanceGenerators.instanceGroups(5);", "modifier": "private", "type": "DataGenerator<InstanceGroup>", "declarator": "instanceGroupsGenerator = InstanceGenerators.instanceGroups(5)", "var_name": "instanceGroupsGenerator"}, {"original_string": "private DataGenerator<Instance> instanceGenerator1;", "modifier": "private", "type": "DataGenerator<Instance>", "declarator": "instanceGenerator1", "var_name": "instanceGenerator1"}, {"original_string": "private DataGenerator<Instance> instanceGenerator2;", "modifier": "private", "type": "DataGenerator<Instance>", "declarator": "instanceGenerator2", "var_name": "instanceGenerator2"}, {"original_string": "private InstanceCache cache;", "modifier": "private", "type": "InstanceCache", "declarator": "cache", "var_name": "cache"}, {"original_string": "private ExtTestSubscriber<InstanceCacheEvent> eventSubscriber = new ExtTestSubscriber<>();", "modifier": "private", "type": "ExtTestSubscriber<InstanceCacheEvent>", "declarator": "eventSubscriber = new ExtTestSubscriber<>()", "var_name": "eventSubscriber"}], "file": "titus-server-master/src/test/java/com/netflix/titus/master/agent/service/cache/InstanceCacheTest.java"}, "test_case": {"identifier": "testBootstrapWithKnownInstanceGroupsAndConnectorTimeout", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testBootstrapWithKnownInstanceGroupsAndConnectorTimeout() {\n        String id1 = testConnector.takeInstanceGroup(0).getId();\n        String id2 = testConnector.takeInstanceGroup(1).getId();\n        testConnector.addInterceptor(id1, id -> {\n            throw new RuntimeException(\"Simulated connector error\");\n        });\n        try {\n            cache = InstanceCache.newInstance(configuration, testConnector, asSet(id1, id2), registry, 1, 1, Schedulers.computation());\n        } catch (AgentManagementException e) {\n            assertThat(e.getErrorCode()).isEqualTo(ErrorCode.InitializationError);\n        }\n    }", "signature": "void testBootstrapWithKnownInstanceGroupsAndConnectorTimeout()", "full_signature": "@Test public void testBootstrapWithKnownInstanceGroupsAndConnectorTimeout()", "class_method_signature": "InstanceCacheTest.testBootstrapWithKnownInstanceGroupsAndConnectorTimeout()", "testcase": true, "constructor": false, "invocations": ["getId", "takeInstanceGroup", "getId", "takeInstanceGroup", "addInterceptor", "newInstance", "asSet", "computation", "isEqualTo", "assertThat", "getErrorCode"]}, "focal_class": {"identifier": "InstanceCache", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(InstanceCache.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(InstanceCache.class)", "var_name": "logger"}, {"original_string": "private static final long BOOT_TIMEOUT_MS = 60_000;", "modifier": "private static final", "type": "long", "declarator": "BOOT_TIMEOUT_MS = 60_000", "var_name": "BOOT_TIMEOUT_MS"}, {"original_string": "private static final int BOOT_RETRY_COUNT = 10;", "modifier": "private static final", "type": "int", "declarator": "BOOT_RETRY_COUNT = 10", "var_name": "BOOT_RETRY_COUNT"}, {"original_string": "private static final long BOOT_RETRY_DELAYS_MS = 1_000;", "modifier": "private static final", "type": "long", "declarator": "BOOT_RETRY_DELAYS_MS = 1_000", "var_name": "BOOT_RETRY_DELAYS_MS"}, {"original_string": "private static final long MAX_REFRESH_TIMEOUT = 600_000;", "modifier": "private static final", "type": "long", "declarator": "MAX_REFRESH_TIMEOUT = 600_000", "var_name": "MAX_REFRESH_TIMEOUT"}, {"original_string": "private final AgentManagementConfiguration configuration;", "modifier": "private final", "type": "AgentManagementConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final InstanceCloudConnector connector;", "modifier": "private final", "type": "InstanceCloudConnector", "declarator": "connector", "var_name": "connector"}, {"original_string": "private final Registry registry;", "modifier": "private final", "type": "Registry", "declarator": "registry", "var_name": "registry"}, {"original_string": "private final InstrumentedEventLoop eventLoop;", "modifier": "private final", "type": "InstrumentedEventLoop", "declarator": "eventLoop", "var_name": "eventLoop"}, {"original_string": "private volatile InstanceCacheDataSnapshot cacheSnapshot;", "modifier": "private volatile", "type": "InstanceCacheDataSnapshot", "declarator": "cacheSnapshot", "var_name": "cacheSnapshot"}, {"original_string": "private final Subscription findNewInstanceGroupSubscription;", "modifier": "private final", "type": "Subscription", "declarator": "findNewInstanceGroupSubscription", "var_name": "findNewInstanceGroupSubscription"}, {"original_string": "private final Subscription instanceGroupRefreshSubscription;", "modifier": "private final", "type": "Subscription", "declarator": "instanceGroupRefreshSubscription", "var_name": "instanceGroupRefreshSubscription"}, {"original_string": "private final PublishSubject<InstanceCacheEvent> eventSubject = PublishSubject.create();", "modifier": "private final", "type": "PublishSubject<InstanceCacheEvent>", "declarator": "eventSubject = PublishSubject.create()", "var_name": "eventSubject"}, {"original_string": "private ContinuousSubscriptionMetrics fullInstanceGroupRefreshMetricsTransformer;", "modifier": "private", "type": "ContinuousSubscriptionMetrics", "declarator": "fullInstanceGroupRefreshMetricsTransformer", "var_name": "fullInstanceGroupRefreshMetricsTransformer"}, {"original_string": "private Map<String, ContinuousSubscriptionMetrics> instanceGroupRefreshMetricsTransformers = new ConcurrentHashMap<>();", "modifier": "private", "type": "Map<String, ContinuousSubscriptionMetrics>", "declarator": "instanceGroupRefreshMetricsTransformers = new ConcurrentHashMap<>()", "var_name": "instanceGroupRefreshMetricsTransformers"}], "methods": [{"identifier": "InstanceCache", "parameters": "(AgentManagementConfiguration configuration,\n                          InstanceCloudConnector connector,\n                          Set<String> knownInstanceGroups,\n                          Registry registry,\n                          int bootRetryCount,\n                          long bootRetryDelayMs,\n                          Scheduler scheduler)", "modifiers": "private", "return": "", "signature": " InstanceCache(AgentManagementConfiguration configuration,\n                          InstanceCloudConnector connector,\n                          Set<String> knownInstanceGroups,\n                          Registry registry,\n                          int bootRetryCount,\n                          long bootRetryDelayMs,\n                          Scheduler scheduler)", "full_signature": "private  InstanceCache(AgentManagementConfiguration configuration,\n                          InstanceCloudConnector connector,\n                          Set<String> knownInstanceGroups,\n                          Registry registry,\n                          int bootRetryCount,\n                          long bootRetryDelayMs,\n                          Scheduler scheduler)", "class_method_signature": "InstanceCache.InstanceCache(AgentManagementConfiguration configuration,\n                          InstanceCloudConnector connector,\n                          Set<String> knownInstanceGroups,\n                          Registry registry,\n                          int bootRetryCount,\n                          long bootRetryDelayMs,\n                          Scheduler scheduler)", "testcase": false, "constructor": true}, {"identifier": "shutdown", "parameters": "()", "modifiers": "", "return": "void", "signature": "void shutdown()", "full_signature": " void shutdown()", "class_method_signature": "InstanceCache.shutdown()", "testcase": false, "constructor": false}, {"identifier": "getInstanceGroups", "parameters": "()", "modifiers": "", "return": "List<InstanceGroup>", "signature": "List<InstanceGroup> getInstanceGroups()", "full_signature": " List<InstanceGroup> getInstanceGroups()", "class_method_signature": "InstanceCache.getInstanceGroups()", "testcase": false, "constructor": false}, {"identifier": "getInstanceGroup", "parameters": "(String id)", "modifiers": "", "return": "InstanceGroup", "signature": "InstanceGroup getInstanceGroup(String id)", "full_signature": " InstanceGroup getInstanceGroup(String id)", "class_method_signature": "InstanceCache.getInstanceGroup(String id)", "testcase": false, "constructor": false}, {"identifier": "getAgentInstance", "parameters": "(String id)", "modifiers": "", "return": "Instance", "signature": "Instance getAgentInstance(String id)", "full_signature": " Instance getAgentInstance(String id)", "class_method_signature": "InstanceCache.getAgentInstance(String id)", "testcase": false, "constructor": false}, {"identifier": "refreshInstanceGroup", "parameters": "(String instanceGroupId)", "modifiers": "", "return": "void", "signature": "void refreshInstanceGroup(String instanceGroupId)", "full_signature": " void refreshInstanceGroup(String instanceGroupId)", "class_method_signature": "InstanceCache.refreshInstanceGroup(String instanceGroupId)", "testcase": false, "constructor": false}, {"identifier": "events", "parameters": "()", "modifiers": "", "return": "Observable<InstanceCacheEvent>", "signature": "Observable<InstanceCacheEvent> events()", "full_signature": " Observable<InstanceCacheEvent> events()", "class_method_signature": "InstanceCache.events()", "testcase": false, "constructor": false}, {"identifier": "doFindNewInstanceGroups", "parameters": "()", "modifiers": "", "return": "Completable", "signature": "Completable doFindNewInstanceGroups()", "full_signature": " Completable doFindNewInstanceGroups()", "class_method_signature": "InstanceCache.doFindNewInstanceGroups()", "testcase": false, "constructor": false}, {"identifier": "getInstanceGroupRefreshMetricsTransform", "parameters": "(String instanceGroupId)", "modifiers": "private", "return": "Observable.Transformer", "signature": "Observable.Transformer getInstanceGroupRefreshMetricsTransform(String instanceGroupId)", "full_signature": "private Observable.Transformer getInstanceGroupRefreshMetricsTransform(String instanceGroupId)", "class_method_signature": "InstanceCache.getInstanceGroupRefreshMetricsTransform(String instanceGroupId)", "testcase": false, "constructor": false}, {"identifier": "getInstanceGroupPattern", "parameters": "()", "modifiers": "private", "return": "Optional<Pattern>", "signature": "Optional<Pattern> getInstanceGroupPattern()", "full_signature": "private Optional<Pattern> getInstanceGroupPattern()", "class_method_signature": "InstanceCache.getInstanceGroupPattern()", "testcase": false, "constructor": false}, {"identifier": "findOurInstanceGroups", "parameters": "(Pattern pattern, List<InstanceGroup> unfiltered)", "modifiers": "private", "return": "List<InstanceGroup>", "signature": "List<InstanceGroup> findOurInstanceGroups(Pattern pattern, List<InstanceGroup> unfiltered)", "full_signature": "private List<InstanceGroup> findOurInstanceGroups(Pattern pattern, List<InstanceGroup> unfiltered)", "class_method_signature": "InstanceCache.findOurInstanceGroups(Pattern pattern, List<InstanceGroup> unfiltered)", "testcase": false, "constructor": false}, {"identifier": "doInstanceGroupRefresh", "parameters": "()", "modifiers": "private", "return": "Completable", "signature": "Completable doInstanceGroupRefresh()", "full_signature": "private Completable doInstanceGroupRefresh()", "class_method_signature": "InstanceCache.doInstanceGroupRefresh()", "testcase": false, "constructor": false}, {"identifier": "doInstanceGroupRefresh", "parameters": "(InstanceGroup instanceGroup)", "modifiers": "private", "return": "Completable", "signature": "Completable doInstanceGroupRefresh(InstanceGroup instanceGroup)", "full_signature": "private Completable doInstanceGroupRefresh(InstanceGroup instanceGroup)", "class_method_signature": "InstanceCache.doInstanceGroupRefresh(InstanceGroup instanceGroup)", "testcase": false, "constructor": false}, {"identifier": "doInstanceGroupRefresh", "parameters": "(String instanceGroupId)", "modifiers": "private", "return": "Completable", "signature": "Completable doInstanceGroupRefresh(String instanceGroupId)", "full_signature": "private Completable doInstanceGroupRefresh(String instanceGroupId)", "class_method_signature": "InstanceCache.doInstanceGroupRefresh(String instanceGroupId)", "testcase": false, "constructor": false}, {"identifier": "updateCache", "parameters": "(InstanceGroup updatedInstanceGroup, List<Instance> updatedInstances)", "modifiers": "private", "return": "void", "signature": "void updateCache(InstanceGroup updatedInstanceGroup, List<Instance> updatedInstances)", "full_signature": "private void updateCache(InstanceGroup updatedInstanceGroup, List<Instance> updatedInstances)", "class_method_signature": "InstanceCache.updateCache(InstanceGroup updatedInstanceGroup, List<Instance> updatedInstances)", "testcase": false, "constructor": false}, {"identifier": "updateAttributes", "parameters": "(InstanceGroup instanceGroup, InstanceLaunchConfiguration launchConfiguration)", "modifiers": "private", "return": "InstanceGroup", "signature": "InstanceGroup updateAttributes(InstanceGroup instanceGroup, InstanceLaunchConfiguration launchConfiguration)", "full_signature": "private InstanceGroup updateAttributes(InstanceGroup instanceGroup, InstanceLaunchConfiguration launchConfiguration)", "class_method_signature": "InstanceCache.updateAttributes(InstanceGroup instanceGroup, InstanceLaunchConfiguration launchConfiguration)", "testcase": false, "constructor": false}, {"identifier": "updateAttributes", "parameters": "(InstanceGroup newInstanceGroup, InstanceGroup oldInstanceGroup)", "modifiers": "private", "return": "InstanceGroup", "signature": "InstanceGroup updateAttributes(InstanceGroup newInstanceGroup, InstanceGroup oldInstanceGroup)", "full_signature": "private InstanceGroup updateAttributes(InstanceGroup newInstanceGroup, InstanceGroup oldInstanceGroup)", "class_method_signature": "InstanceCache.updateAttributes(InstanceGroup newInstanceGroup, InstanceGroup oldInstanceGroup)", "testcase": false, "constructor": false}, {"identifier": "removeInstanceGroup", "parameters": "(String instanceGroupId)", "modifiers": "private", "return": "void", "signature": "void removeInstanceGroup(String instanceGroupId)", "full_signature": "private void removeInstanceGroup(String instanceGroupId)", "class_method_signature": "InstanceCache.removeInstanceGroup(String instanceGroupId)", "testcase": false, "constructor": false}, {"identifier": "onEventLoop", "parameters": "(String actionName, Action0 action)", "modifiers": "private", "return": "void", "signature": "void onEventLoop(String actionName, Action0 action)", "full_signature": "private void onEventLoop(String actionName, Action0 action)", "class_method_signature": "InstanceCache.onEventLoop(String actionName, Action0 action)", "testcase": false, "constructor": false}, {"identifier": "newInstance", "parameters": "(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "modifiers": "static", "return": "InstanceCache", "signature": "InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "full_signature": "static InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "class_method_signature": "InstanceCache.newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "testcase": false, "constructor": false}, {"identifier": "newInstance", "parameters": "(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     Scheduler scheduler)", "modifiers": "static", "return": "InstanceCache", "signature": "InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     Scheduler scheduler)", "full_signature": "static InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     Scheduler scheduler)", "class_method_signature": "InstanceCache.newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     Scheduler scheduler)", "testcase": false, "constructor": false}], "file": "titus-server-master/src/main/java/com/netflix/titus/master/agent/service/cache/InstanceCache.java"}, "focal_method": {"identifier": "newInstance", "parameters": "(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "modifiers": "static", "return": "InstanceCache", "body": "static InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler) {\n        return new InstanceCache(configuration, connector, knownInstanceGroups, registry, bootRetryCount, bootRetryDelayMs, scheduler);\n    }", "signature": "InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "full_signature": "static InstanceCache newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "class_method_signature": "InstanceCache.newInstance(AgentManagementConfiguration configuration,\n                                     InstanceCloudConnector connector,\n                                     Set<String> knownInstanceGroups,\n                                     Registry registry,\n                                     int bootRetryCount,\n                                     long bootRetryDelayMs,\n                                     Scheduler scheduler)", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}