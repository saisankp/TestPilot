{"test_class": {"identifier": "SecretSeriesDAOTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Inject DSLContext jooqContext;", "modifier": "@Inject", "type": "DSLContext", "declarator": "jooqContext", "var_name": "jooqContext"}, {"original_string": "@Inject SecretSeriesDAOFactory secretSeriesDAOFactory;", "modifier": "@Inject", "type": "SecretSeriesDAOFactory", "declarator": "secretSeriesDAOFactory", "var_name": "secretSeriesDAOFactory"}, {"original_string": "@Inject SecretContentDAO.SecretContentDAOFactory secretContentDAOFactory;", "modifier": "@Inject", "type": "SecretContentDAO.SecretContentDAOFactory", "declarator": "secretContentDAOFactory", "var_name": "secretContentDAOFactory"}, {"original_string": "SecretSeriesDAO secretSeriesDAO;", "modifier": "", "type": "SecretSeriesDAO", "declarator": "secretSeriesDAO", "var_name": "secretSeriesDAO"}, {"original_string": "SecretContentDAO secretContentDAO;", "modifier": "", "type": "SecretContentDAO", "declarator": "secretContentDAO", "var_name": "secretContentDAO"}], "file": "server/src/test/java/keywhiz/service/daos/SecretSeriesDAOTest.java"}, "test_case": {"identifier": "getMultipleSecretSeriesByName", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void getMultipleSecretSeriesByName() {\n    int before = tableSize();\n    long now = OffsetDateTime.now().toEpochSecond();\n    ApiDate nowDate = new ApiDate(now);\n\n    long id = secretSeriesDAO.createSecretSeries(\"newSecretSeries\", \"creator\", \"desc\", null,\n            ImmutableMap.of(\"foo\", \"bar\"), now);\n    long contentId = secretContentDAO.createSecretContent(id, \"blah\",\n            \"checksum\", \"creator\", null, 0, now);\n    secretSeriesDAO.setCurrentVersion(id, contentId, \"creator\", now);\n\n    long id2 = secretSeriesDAO.createSecretSeries(\"newSecretSeries2\", \"creator\", \"desc\", null,\n            ImmutableMap.of(\"f00\", \"b4r\"), now);\n    long contentId2 = secretContentDAO.createSecretContent(id2, \"blah\",\n            \"checksum\", \"creator\", null, 0, now);\n    secretSeriesDAO.setCurrentVersion(id2, contentId2, \"creator\", now);\n\n    assertThat(tableSize()).isEqualTo(before + 2);\n\n    SecretSeries expected1 = SecretSeries.of(id, \"newSecretSeries\", \"desc\", nowDate, \"creator\", nowDate,\n            \"creator\", null, ImmutableMap.of(\"foo\", \"bar\"), contentId);\n    SecretSeries expected2 = SecretSeries.of(id2, \"newSecretSeries2\", \"desc\", nowDate, \"creator\", nowDate,\n            \"creator\", null, ImmutableMap.of(\"f00\", \"b4r\"), contentId2);\n\n    List<SecretSeries> actual = secretSeriesDAO.getMultipleSecretSeriesByName(List.of(\"newSecretSeries\", \"newSecretSeries2\"));\n\n    assertThat(actual).contains(expected1);\n    assertThat(actual).contains(expected2);\n\n  }", "signature": "void getMultipleSecretSeriesByName()", "full_signature": "@Test public void getMultipleSecretSeriesByName()", "class_method_signature": "SecretSeriesDAOTest.getMultipleSecretSeriesByName()", "testcase": true, "constructor": false, "invocations": ["tableSize", "toEpochSecond", "now", "createSecretSeries", "of", "createSecretContent", "setCurrentVersion", "createSecretSeries", "of", "createSecretContent", "setCurrentVersion", "isEqualTo", "assertThat", "tableSize", "of", "of", "of", "of", "getMultipleSecretSeriesByName", "of", "contains", "assertThat", "contains", "assertThat"]}, "focal_class": {"identifier": "SecretSeriesDAO", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final DSLContext dslContext;", "modifier": "private final", "type": "DSLContext", "declarator": "dslContext", "var_name": "dslContext"}, {"original_string": "private final ObjectMapper mapper;", "modifier": "private final", "type": "ObjectMapper", "declarator": "mapper", "var_name": "mapper"}, {"original_string": "private final SecretSeriesMapper secretSeriesMapper;", "modifier": "private final", "type": "SecretSeriesMapper", "declarator": "secretSeriesMapper", "var_name": "secretSeriesMapper"}, {"original_string": "private final RowHmacGenerator rowHmacGenerator;", "modifier": "private final", "type": "RowHmacGenerator", "declarator": "rowHmacGenerator", "var_name": "rowHmacGenerator"}], "methods": [{"identifier": "SecretSeriesDAO", "parameters": "(DSLContext dslContext, ObjectMapper mapper,\n      SecretSeriesMapper secretSeriesMapper, RowHmacGenerator rowHmacGenerator)", "modifiers": "private", "return": "", "signature": " SecretSeriesDAO(DSLContext dslContext, ObjectMapper mapper,\n      SecretSeriesMapper secretSeriesMapper, RowHmacGenerator rowHmacGenerator)", "full_signature": "private  SecretSeriesDAO(DSLContext dslContext, ObjectMapper mapper,\n      SecretSeriesMapper secretSeriesMapper, RowHmacGenerator rowHmacGenerator)", "class_method_signature": "SecretSeriesDAO.SecretSeriesDAO(DSLContext dslContext, ObjectMapper mapper,\n      SecretSeriesMapper secretSeriesMapper, RowHmacGenerator rowHmacGenerator)", "testcase": false, "constructor": true}, {"identifier": "createSecretSeries", "parameters": "(String name, String creator, String description, @Nullable String type,\n      @Nullable Map<String, String> generationOptions, long now)", "modifiers": "", "return": "long", "signature": "long createSecretSeries(String name, String creator, String description, @Nullable String type,\n      @Nullable Map<String, String> generationOptions, long now)", "full_signature": " long createSecretSeries(String name, String creator, String description, @Nullable String type,\n      @Nullable Map<String, String> generationOptions, long now)", "class_method_signature": "SecretSeriesDAO.createSecretSeries(String name, String creator, String description, @Nullable String type,\n      @Nullable Map<String, String> generationOptions, long now)", "testcase": false, "constructor": false}, {"identifier": "updateSecretSeries", "parameters": "(long secretId, String name, String creator, String description,\n      @Nullable String type, @Nullable Map<String, String> generationOptions, long now)", "modifiers": "", "return": "void", "signature": "void updateSecretSeries(long secretId, String name, String creator, String description,\n      @Nullable String type, @Nullable Map<String, String> generationOptions, long now)", "full_signature": " void updateSecretSeries(long secretId, String name, String creator, String description,\n      @Nullable String type, @Nullable Map<String, String> generationOptions, long now)", "class_method_signature": "SecretSeriesDAO.updateSecretSeries(long secretId, String name, String creator, String description,\n      @Nullable String type, @Nullable Map<String, String> generationOptions, long now)", "testcase": false, "constructor": false}, {"identifier": "setExpiration", "parameters": "(long secretContentId, Instant expiration)", "modifiers": "public", "return": "int", "signature": "int setExpiration(long secretContentId, Instant expiration)", "full_signature": "public int setExpiration(long secretContentId, Instant expiration)", "class_method_signature": "SecretSeriesDAO.setExpiration(long secretContentId, Instant expiration)", "testcase": false, "constructor": false}, {"identifier": "setHmac", "parameters": "(long secretContentId, String hmac)", "modifiers": "public", "return": "int", "signature": "int setHmac(long secretContentId, String hmac)", "full_signature": "public int setHmac(long secretContentId, String hmac)", "class_method_signature": "SecretSeriesDAO.setHmac(long secretContentId, String hmac)", "testcase": false, "constructor": false}, {"identifier": "setCurrentVersion", "parameters": "(long secretId, long secretContentId, String updater, long now)", "modifiers": "public", "return": "int", "signature": "int setCurrentVersion(long secretId, long secretContentId, String updater, long now)", "full_signature": "public int setCurrentVersion(long secretId, long secretContentId, String updater, long now)", "class_method_signature": "SecretSeriesDAO.setCurrentVersion(long secretId, long secretContentId, String updater, long now)", "testcase": false, "constructor": false}, {"identifier": "getSecretSeriesById", "parameters": "(long id)", "modifiers": "public", "return": "Optional<SecretSeries>", "signature": "Optional<SecretSeries> getSecretSeriesById(long id)", "full_signature": "public Optional<SecretSeries> getSecretSeriesById(long id)", "class_method_signature": "SecretSeriesDAO.getSecretSeriesById(long id)", "testcase": false, "constructor": false}, {"identifier": "getSecretSeriesByName", "parameters": "(String name)", "modifiers": "public", "return": "Optional<SecretSeries>", "signature": "Optional<SecretSeries> getSecretSeriesByName(String name)", "full_signature": "public Optional<SecretSeries> getSecretSeriesByName(String name)", "class_method_signature": "SecretSeriesDAO.getSecretSeriesByName(String name)", "testcase": false, "constructor": false}, {"identifier": "getMultipleSecretSeriesByName", "parameters": "(List<String> names)", "modifiers": "public", "return": "List<SecretSeries>", "signature": "List<SecretSeries> getMultipleSecretSeriesByName(List<String> names)", "full_signature": "public List<SecretSeries> getMultipleSecretSeriesByName(List<String> names)", "class_method_signature": "SecretSeriesDAO.getMultipleSecretSeriesByName(List<String> names)", "testcase": false, "constructor": false}, {"identifier": "getSecretSeries", "parameters": "(@Nullable Long expireMaxTime,\n      @Nullable Group group, @Nullable Long expireMinTime, @Nullable String minName,\n      @Nullable Integer limit)", "modifiers": "public", "return": "ImmutableList<SecretSeries>", "signature": "ImmutableList<SecretSeries> getSecretSeries(@Nullable Long expireMaxTime,\n      @Nullable Group group, @Nullable Long expireMinTime, @Nullable String minName,\n      @Nullable Integer limit)", "full_signature": "public ImmutableList<SecretSeries> getSecretSeries(@Nullable Long expireMaxTime,\n      @Nullable Group group, @Nullable Long expireMinTime, @Nullable String minName,\n      @Nullable Integer limit)", "class_method_signature": "SecretSeriesDAO.getSecretSeries(@Nullable Long expireMaxTime,\n      @Nullable Group group, @Nullable Long expireMinTime, @Nullable String minName,\n      @Nullable Integer limit)", "testcase": false, "constructor": false}, {"identifier": "getSecretSeriesBatched", "parameters": "(int idx, int num, boolean newestFirst)", "modifiers": "public", "return": "ImmutableList<SecretSeries>", "signature": "ImmutableList<SecretSeries> getSecretSeriesBatched(int idx, int num, boolean newestFirst)", "full_signature": "public ImmutableList<SecretSeries> getSecretSeriesBatched(int idx, int num, boolean newestFirst)", "class_method_signature": "SecretSeriesDAO.getSecretSeriesBatched(int idx, int num, boolean newestFirst)", "testcase": false, "constructor": false}, {"identifier": "deleteSecretSeriesByName", "parameters": "(String name)", "modifiers": "public", "return": "void", "signature": "void deleteSecretSeriesByName(String name)", "full_signature": "public void deleteSecretSeriesByName(String name)", "class_method_signature": "SecretSeriesDAO.deleteSecretSeriesByName(String name)", "testcase": false, "constructor": false}, {"identifier": "deleteSecretSeriesById", "parameters": "(long id)", "modifiers": "public", "return": "void", "signature": "void deleteSecretSeriesById(long id)", "full_signature": "public void deleteSecretSeriesById(long id)", "class_method_signature": "SecretSeriesDAO.deleteSecretSeriesById(long id)", "testcase": false, "constructor": false}, {"identifier": "countDeletedSecretSeries", "parameters": "()", "modifiers": "public", "return": "int", "signature": "int countDeletedSecretSeries()", "full_signature": "public int countDeletedSecretSeries()", "class_method_signature": "SecretSeriesDAO.countDeletedSecretSeries()", "testcase": false, "constructor": false}, {"identifier": "getIdsForSecretSeriesDeletedBeforeDate", "parameters": "(DateTime deleteBefore)", "modifiers": "public", "return": "List<Long>", "signature": "List<Long> getIdsForSecretSeriesDeletedBeforeDate(DateTime deleteBefore)", "full_signature": "public List<Long> getIdsForSecretSeriesDeletedBeforeDate(DateTime deleteBefore)", "class_method_signature": "SecretSeriesDAO.getIdsForSecretSeriesDeletedBeforeDate(DateTime deleteBefore)", "testcase": false, "constructor": false}, {"identifier": "dangerPermanentlyRemoveRecordsForGivenIDs", "parameters": "(List<Long> ids)", "modifiers": "public", "return": "long", "signature": "long dangerPermanentlyRemoveRecordsForGivenIDs(List<Long> ids)", "full_signature": "public long dangerPermanentlyRemoveRecordsForGivenIDs(List<Long> ids)", "class_method_signature": "SecretSeriesDAO.dangerPermanentlyRemoveRecordsForGivenIDs(List<Long> ids)", "testcase": false, "constructor": false}, {"identifier": "transformNameForDeletion", "parameters": "(String name)", "modifiers": "private", "return": "String", "signature": "String transformNameForDeletion(String name)", "full_signature": "private String transformNameForDeletion(String name)", "class_method_signature": "SecretSeriesDAO.transformNameForDeletion(String name)", "testcase": false, "constructor": false}], "file": "server/src/main/java/keywhiz/service/daos/SecretSeriesDAO.java"}, "focal_method": {"identifier": "getMultipleSecretSeriesByName", "parameters": "(List<String> names)", "modifiers": "public", "return": "List<SecretSeries>", "body": "public List<SecretSeries> getMultipleSecretSeriesByName(List<String> names) {\n    return dslContext.fetch(SECRETS, SECRETS.NAME.in(names).and(SECRETS.CURRENT.isNotNull())).map(secretSeriesMapper::map);\n  }", "signature": "List<SecretSeries> getMultipleSecretSeriesByName(List<String> names)", "full_signature": "public List<SecretSeries> getMultipleSecretSeriesByName(List<String> names)", "class_method_signature": "SecretSeriesDAO.getMultipleSecretSeriesByName(List<String> names)", "testcase": false, "constructor": false, "invocations": ["map", "fetch", "and", "in", "isNotNull"]}, "repository": {"repo_id": 32866430, "url": "https://github.com/square/keywhiz", "stars": 2186, "created": "3/25/2015 1:31:39 PM +00:00", "updates": "2020-01-24T18:57:02+00:00", "fork": "False", "license": "licensed"}}