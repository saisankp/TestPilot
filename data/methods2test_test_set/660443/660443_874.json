{"test_class": {"identifier": "AtomTetrahedralLigandPlacer3DTest", "superclass": "extends CDKTestCase", "interfaces": "", "fields": [], "file": "tool/builder3d/src/test/java/org/openscience/cdk/modeling/builder3d/AtomTetrahedralLigandPlacer3DTest.java"}, "test_case": {"identifier": "testAdd3DCoordinatesForSinglyBondedLigands_IAtomContainer", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testAdd3DCoordinatesForSinglyBondedLigands_IAtomContainer() throws Exception {\n        IAtom atom1 = new Atom(\"C\");\n        atom1.setPoint3d(new Point3d(1, 1, 1));\n        IAtom atom2 = new Atom(\"H\");\n        IAtom atom3 = new Atom(\"H\");\n        IAtom atom4 = new Atom(\"H\");\n        IAtom atom5 = new Atom(\"H\");\n        IBond bond1 = new Bond(atom1, atom2);\n        IBond bond2 = new Bond(atom1, atom3);\n        IBond bond3 = new Bond(atom1, atom4);\n        IBond bond4 = new Bond(atom1, atom5);\n        IAtomContainer ac = atom1.getBuilder().newInstance(IAtomContainer.class);\n        atom1.setFormalNeighbourCount(4);\n        atom2.setFormalNeighbourCount(1);\n        atom3.setFormalNeighbourCount(1);\n        atom4.setFormalNeighbourCount(1);\n        atom5.setFormalNeighbourCount(1);\n        ac.addAtom(atom1);\n        ac.addAtom(atom2);\n        ac.addAtom(atom3);\n        ac.addAtom(atom4);\n        ac.addAtom(atom5);\n        ac.addBond(bond1);\n        ac.addBond(bond2);\n        ac.addBond(bond3);\n        ac.addBond(bond4);\n        new AtomTetrahedralLigandPlacer3D().add3DCoordinatesForSinglyBondedLigands(ac);\n        ModelBuilder3DTest.checkAverageBondLength(ac);\n    }", "signature": "void testAdd3DCoordinatesForSinglyBondedLigands_IAtomContainer()", "full_signature": "@Test public void testAdd3DCoordinatesForSinglyBondedLigands_IAtomContainer()", "class_method_signature": "AtomTetrahedralLigandPlacer3DTest.testAdd3DCoordinatesForSinglyBondedLigands_IAtomContainer()", "testcase": true, "constructor": false, "invocations": ["setPoint3d", "newInstance", "getBuilder", "setFormalNeighbourCount", "setFormalNeighbourCount", "setFormalNeighbourCount", "setFormalNeighbourCount", "setFormalNeighbourCount", "addAtom", "addAtom", "addAtom", "addAtom", "addAtom", "addBond", "addBond", "addBond", "addBond", "add3DCoordinatesForSinglyBondedLigands", "checkAverageBondLength"]}, "focal_class": {"identifier": "AtomTetrahedralLigandPlacer3D", "superclass": "", "interfaces": "", "fields": [{"original_string": "private Map                 pSet                  = null;", "modifier": "private", "type": "Map", "declarator": "pSet                  = null", "var_name": "pSet"}, {"original_string": "public final static double  DEFAULT_BOND_LENGTH_H = 1.0;", "modifier": "public final static", "type": "double", "declarator": "DEFAULT_BOND_LENGTH_H = 1.0", "var_name": "DEFAULT_BOND_LENGTH_H"}, {"original_string": "public final static double  TETRAHEDRAL_ANGLE     = 2.0 * Math.acos(1.0 / Math.sqrt(3.0));", "modifier": "public final static", "type": "double", "declarator": "TETRAHEDRAL_ANGLE     = 2.0 * Math.acos(1.0 / Math.sqrt(3.0))", "var_name": "TETRAHEDRAL_ANGLE"}, {"original_string": "private final static double SP2_ANGLE             = 120 * Math.PI / 180;", "modifier": "private final static", "type": "double", "declarator": "SP2_ANGLE             = 120 * Math.PI / 180", "var_name": "SP2_ANGLE"}, {"original_string": "private final static double SP_ANGLE              = Math.PI;", "modifier": "private final static", "type": "double", "declarator": "SP_ANGLE              = Math.PI", "var_name": "SP_ANGLE"}, {"original_string": "final static Vector3d       XV                    = new Vector3d(1.0, 0.0, 0.0);", "modifier": "final static", "type": "Vector3d", "declarator": "XV                    = new Vector3d(1.0, 0.0, 0.0)", "var_name": "XV"}, {"original_string": "final static Vector3d       YV                    = new Vector3d(0.0, 1.0, 0.0);", "modifier": "final static", "type": "Vector3d", "declarator": "YV                    = new Vector3d(0.0, 1.0, 0.0)", "var_name": "YV"}], "methods": [{"identifier": "AtomTetrahedralLigandPlacer3D", "parameters": "()", "modifiers": "", "return": "", "signature": " AtomTetrahedralLigandPlacer3D()", "full_signature": "  AtomTetrahedralLigandPlacer3D()", "class_method_signature": "AtomTetrahedralLigandPlacer3D.AtomTetrahedralLigandPlacer3D()", "testcase": false, "constructor": true}, {"identifier": "setParameterSet", "parameters": "(Map moleculeParameter)", "modifiers": "public", "return": "void", "signature": "void setParameterSet(Map moleculeParameter)", "full_signature": "public void setParameterSet(Map moleculeParameter)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.setParameterSet(Map moleculeParameter)", "testcase": false, "constructor": false}, {"identifier": "add3DCoordinatesForSinglyBondedLigands", "parameters": "(IAtomContainer atomContainer)", "modifiers": "public", "return": "void", "signature": "void add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer)", "full_signature": "public void add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer)", "testcase": false, "constructor": false}, {"identifier": "rescaleBondLength", "parameters": "(IAtom atom1, IAtom atom2, Point3d point2)", "modifiers": "public", "return": "Point3d", "signature": "Point3d rescaleBondLength(IAtom atom1, IAtom atom2, Point3d point2)", "full_signature": "public Point3d rescaleBondLength(IAtom atom1, IAtom atom2, Point3d point2)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.rescaleBondLength(IAtom atom1, IAtom atom2, Point3d point2)", "testcase": false, "constructor": false}, {"identifier": "get3DCoordinatesForLigands", "parameters": "(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] get3DCoordinatesForLigands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "full_signature": "public Point3d[] get3DCoordinatesForLigands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.get3DCoordinatesForLigands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "testcase": false, "constructor": false}, {"identifier": "get3DCoordinatesForSPLigands", "parameters": "(IAtom refAtom, IAtomContainer withCoords, double length, double angle)", "modifiers": "public", "return": "Point3d", "signature": "Point3d get3DCoordinatesForSPLigands(IAtom refAtom, IAtomContainer withCoords, double length, double angle)", "full_signature": "public Point3d get3DCoordinatesForSPLigands(IAtom refAtom, IAtomContainer withCoords, double length, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.get3DCoordinatesForSPLigands(IAtom refAtom, IAtomContainer withCoords, double length, double angle)", "testcase": false, "constructor": false}, {"identifier": "get3DCoordinatesForSP2Ligands", "parameters": "(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, double length, double angle)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] get3DCoordinatesForSP2Ligands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, double length, double angle)", "full_signature": "public Point3d[] get3DCoordinatesForSP2Ligands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, double length, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.get3DCoordinatesForSP2Ligands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, double length, double angle)", "testcase": false, "constructor": false}, {"identifier": "get3DCoordinatesForSP3Ligands", "parameters": "(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] get3DCoordinatesForSP3Ligands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "full_signature": "public Point3d[] get3DCoordinatesForSP3Ligands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.get3DCoordinatesForSP3Ligands(IAtom refAtom, IAtomContainer noCoords, IAtomContainer withCoords,\n            IAtom atomC, int nwanted, double length, double angle)", "testcase": false, "constructor": false}, {"identifier": "calculate3DCoordinates0", "parameters": "(Point3d aPoint, int nwanted, double length)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] calculate3DCoordinates0(Point3d aPoint, int nwanted, double length)", "full_signature": "public Point3d[] calculate3DCoordinates0(Point3d aPoint, int nwanted, double length)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.calculate3DCoordinates0(Point3d aPoint, int nwanted, double length)", "testcase": false, "constructor": false}, {"identifier": "calculate3DCoordinates1", "parameters": "(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] calculate3DCoordinates1(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "full_signature": "public Point3d[] calculate3DCoordinates1(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.calculate3DCoordinates1(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "testcase": false, "constructor": false}, {"identifier": "calculate3DCoordinates2", "parameters": "(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] calculate3DCoordinates2(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "full_signature": "public Point3d[] calculate3DCoordinates2(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.calculate3DCoordinates2(Point3d aPoint, Point3d bPoint, Point3d cPoint, int nwanted,\n            double length, double angle)", "testcase": false, "constructor": false}, {"identifier": "calculate3DCoordinates3", "parameters": "(Point3d aPoint, Point3d bPoint, Point3d cPoint, Point3d dPoint, double length)", "modifiers": "public", "return": "Point3d", "signature": "Point3d calculate3DCoordinates3(Point3d aPoint, Point3d bPoint, Point3d cPoint, Point3d dPoint, double length)", "full_signature": "public Point3d calculate3DCoordinates3(Point3d aPoint, Point3d bPoint, Point3d cPoint, Point3d dPoint, double length)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.calculate3DCoordinates3(Point3d aPoint, Point3d bPoint, Point3d cPoint, Point3d dPoint, double length)", "testcase": false, "constructor": false}, {"identifier": "calculate3DCoordinatesSP2_1", "parameters": "(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "modifiers": "public", "return": "Point3d", "signature": "Point3d calculate3DCoordinatesSP2_1(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "full_signature": "public Point3d calculate3DCoordinatesSP2_1(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.calculate3DCoordinatesSP2_1(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "testcase": false, "constructor": false}, {"identifier": "calculate3DCoordinatesSP2_2", "parameters": "(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "modifiers": "public", "return": "Point3d[]", "signature": "Point3d[] calculate3DCoordinatesSP2_2(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "full_signature": "public Point3d[] calculate3DCoordinatesSP2_2(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.calculate3DCoordinatesSP2_2(Point3d aPoint, Point3d bPoint, Point3d cPoint, double length,\n            double angle)", "testcase": false, "constructor": false}, {"identifier": "getNonColinearVector", "parameters": "(Vector3d ab)", "modifiers": "private", "return": "Vector3d", "signature": "Vector3d getNonColinearVector(Vector3d ab)", "full_signature": "private Vector3d getNonColinearVector(Vector3d ab)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getNonColinearVector(Vector3d ab)", "testcase": false, "constructor": false}, {"identifier": "rotate", "parameters": "(Vector3d vector, Vector3d axis, double angle)", "modifiers": "public static", "return": "Vector3d", "signature": "Vector3d rotate(Vector3d vector, Vector3d axis, double angle)", "full_signature": "public static Vector3d rotate(Vector3d vector, Vector3d axis, double angle)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.rotate(Vector3d vector, Vector3d axis, double angle)", "testcase": false, "constructor": false}, {"identifier": "getDistanceValue", "parameters": "(String id1, String id2)", "modifiers": "private", "return": "double", "signature": "double getDistanceValue(String id1, String id2)", "full_signature": "private double getDistanceValue(String id1, String id2)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getDistanceValue(String id1, String id2)", "testcase": false, "constructor": false}, {"identifier": "getAngleValue", "parameters": "(String id1, String id2, String id3)", "modifiers": "public", "return": "double", "signature": "double getAngleValue(String id1, String id2, String id3)", "full_signature": "public double getAngleValue(String id1, String id2, String id3)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getAngleValue(String id1, String id2, String id3)", "testcase": false, "constructor": false}, {"identifier": "makeStereocenter", "parameters": "(Point3d atomA, IBond ax, Point3d atomB, Point3d atomC, Point3d[] branchPoints)", "modifiers": "public", "return": "int", "signature": "int makeStereocenter(Point3d atomA, IBond ax, Point3d atomB, Point3d atomC, Point3d[] branchPoints)", "full_signature": "public int makeStereocenter(Point3d atomA, IBond ax, Point3d atomB, Point3d atomC, Point3d[] branchPoints)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.makeStereocenter(Point3d atomA, IBond ax, Point3d atomB, Point3d atomC, Point3d[] branchPoints)", "testcase": false, "constructor": false}, {"identifier": "getSpatproduct", "parameters": "(Vector3d a, Vector3d b, Vector3d c)", "modifiers": "public", "return": "double", "signature": "double getSpatproduct(Vector3d a, Vector3d b, Vector3d c)", "full_signature": "public double getSpatproduct(Vector3d a, Vector3d b, Vector3d c)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getSpatproduct(Vector3d a, Vector3d b, Vector3d c)", "testcase": false, "constructor": false}, {"identifier": "getTorsionAngle", "parameters": "(Point3d a, Point3d b, Point3d c, Point3d d)", "modifiers": "public", "return": "double", "signature": "double getTorsionAngle(Point3d a, Point3d b, Point3d c, Point3d d)", "full_signature": "public double getTorsionAngle(Point3d a, Point3d b, Point3d c, Point3d d)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getTorsionAngle(Point3d a, Point3d b, Point3d c, Point3d d)", "testcase": false, "constructor": false}, {"identifier": "getPlacedAtomsInAtomContainer", "parameters": "(IAtom atom, IAtomContainer ac)", "modifiers": "public", "return": "IAtomContainer", "signature": "IAtomContainer getPlacedAtomsInAtomContainer(IAtom atom, IAtomContainer ac)", "full_signature": "public IAtomContainer getPlacedAtomsInAtomContainer(IAtom atom, IAtomContainer ac)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getPlacedAtomsInAtomContainer(IAtom atom, IAtomContainer ac)", "testcase": false, "constructor": false}, {"identifier": "getUnsetAtomsInAtomContainer", "parameters": "(IAtom atom, IAtomContainer ac)", "modifiers": "public", "return": "IAtomContainer", "signature": "IAtomContainer getUnsetAtomsInAtomContainer(IAtom atom, IAtomContainer ac)", "full_signature": "public IAtomContainer getUnsetAtomsInAtomContainer(IAtom atom, IAtomContainer ac)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getUnsetAtomsInAtomContainer(IAtom atom, IAtomContainer ac)", "testcase": false, "constructor": false}, {"identifier": "hasUnsetNeighbour", "parameters": "(IAtom atom, IAtomContainer ac)", "modifiers": "public", "return": "boolean", "signature": "boolean hasUnsetNeighbour(IAtom atom, IAtomContainer ac)", "full_signature": "public boolean hasUnsetNeighbour(IAtom atom, IAtomContainer ac)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.hasUnsetNeighbour(IAtom atom, IAtomContainer ac)", "testcase": false, "constructor": false}, {"identifier": "getPlacedHeavyAtomInAtomContainer", "parameters": "(IAtom atomA, IAtom atomB, IAtomContainer ac)", "modifiers": "public", "return": "IAtom", "signature": "IAtom getPlacedHeavyAtomInAtomContainer(IAtom atomA, IAtom atomB, IAtomContainer ac)", "full_signature": "public IAtom getPlacedHeavyAtomInAtomContainer(IAtom atomA, IAtom atomB, IAtomContainer ac)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.getPlacedHeavyAtomInAtomContainer(IAtom atomA, IAtom atomB, IAtomContainer ac)", "testcase": false, "constructor": false}], "file": "tool/builder3d/src/main/java/org/openscience/cdk/modeling/builder3d/AtomTetrahedralLigandPlacer3D.java"}, "focal_method": {"identifier": "add3DCoordinatesForSinglyBondedLigands", "parameters": "(IAtomContainer atomContainer)", "modifiers": "public", "return": "void", "body": "public void add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer) throws CDKException {\n        IAtom refAtom = null;\n        IAtom atomC = null;\n        int nwanted = 0;\n        for (int i = 0; i < atomContainer.getAtomCount(); i++) {\n            refAtom = atomContainer.getAtom(i);\n            if (!refAtom.getSymbol().equals(\"H\") && hasUnsetNeighbour(refAtom, atomContainer)) {\n                IAtomContainer noCoords = getUnsetAtomsInAtomContainer(refAtom, atomContainer);\n                IAtomContainer withCoords = getPlacedAtomsInAtomContainer(refAtom, atomContainer);\n                if (withCoords.getAtomCount() > 0) {\n                    atomC = getPlacedHeavyAtomInAtomContainer(withCoords.getAtom(0), refAtom, atomContainer);\n                }\n                if (refAtom.getFormalNeighbourCount() == 0 && refAtom.getSymbol().equals(\"C\")) {\n                    nwanted = noCoords.getAtomCount();\n                } else if (refAtom.getFormalNeighbourCount() == 0 && !refAtom.getSymbol().equals(\"C\")) {\n                    nwanted = 4;\n                } else {\n                    nwanted = refAtom.getFormalNeighbourCount() - withCoords.getAtomCount();\n                }\n                Point3d[] newPoints = get3DCoordinatesForLigands(refAtom, noCoords, withCoords, atomC, nwanted,\n                        DEFAULT_BOND_LENGTH_H, -1);\n                for (int j = 0; j < noCoords.getAtomCount(); j++) {\n                    IAtom ligand = noCoords.getAtom(j);\n                    Point3d newPoint = rescaleBondLength(refAtom, ligand, newPoints[j]);\n                    ligand.setPoint3d(newPoint);\n                    ligand.setFlag(CDKConstants.ISPLACED, true);\n                }\n\n                noCoords.removeAllElements();\n                withCoords.removeAllElements();\n            }\n        }\n    }", "signature": "void add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer)", "full_signature": "public void add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer)", "class_method_signature": "AtomTetrahedralLigandPlacer3D.add3DCoordinatesForSinglyBondedLigands(IAtomContainer atomContainer)", "testcase": false, "constructor": false, "invocations": ["getAtomCount", "getAtom", "equals", "getSymbol", "hasUnsetNeighbour", "getUnsetAtomsInAtomContainer", "getPlacedAtomsInAtomContainer", "getAtomCount", "getPlacedHeavyAtomInAtomContainer", "getAtom", "getFormalNeighbourCount", "equals", "getSymbol", "getAtomCount", "getFormalNeighbourCount", "equals", "getSymbol", "getFormalNeighbourCount", "getAtomCount", "get3DCoordinatesForLigands", "getAtomCount", "getAtom", "rescaleBondLength", "setPoint3d", "setFlag", "removeAllElements", "removeAllElements"]}, "repository": {"repo_id": 660443, "url": "https://github.com/cdk/cdk", "stars": 220, "created": "5/11/2010 8:30:07 AM +00:00", "updates": "2020-01-27T19:04:04+00:00", "fork": "False", "license": "licensed"}}