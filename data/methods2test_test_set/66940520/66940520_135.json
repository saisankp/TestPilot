{"test_class": {"identifier": "EventGeometryCheckTest", "superclass": "extends BaseValidationTest", "interfaces": "", "fields": [{"original_string": "private EventGeometryCheck rule;", "modifier": "private", "type": "EventGeometryCheck", "declarator": "rule", "var_name": "rule"}], "file": "dhis-2/dhis-services/dhis-service-dxf2/src/test/java/org/hisp/dhis/dxf2/events/importer/shared/validation/EventGeometryCheckTest.java"}, "test_case": {"identifier": "failOnEventWithGeometryAndProgramStageWithNoGeometry", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void failOnEventWithGeometryAndProgramStageWithNoGeometry()\n    {\n        event.setGeometry( createRandomPoint() );\n        ProgramStage programStage = createProgramStage();\n        programStage.setFeatureType( FeatureType.NONE );\n        when( workContext.getProgramStage( programStageIdScheme, event.getProgramStage() ) ).thenReturn( programStage );\n\n        ImportSummary importSummary = rule.check( new ImmutableEvent( event ), workContext );\n\n        assertHasError( importSummary, event,\n            \"Geometry (Point) does not conform to the feature type (None) specified for the program stage: \"\n                + programStage.getUid() );\n    }", "signature": "void failOnEventWithGeometryAndProgramStageWithNoGeometry()", "full_signature": "@Test public void failOnEventWithGeometryAndProgramStageWithNoGeometry()", "class_method_signature": "EventGeometryCheckTest.failOnEventWithGeometryAndProgramStageWithNoGeometry()", "testcase": true, "constructor": false, "invocations": ["setGeometry", "createRandomPoint", "createProgramStage", "setFeatureType", "thenReturn", "when", "getProgramStage", "getProgramStage", "check", "assertHasError", "getUid"]}, "focal_class": {"identifier": "EventGeometryCheck", "superclass": "", "interfaces": "implements Checker", "fields": [], "methods": [{"identifier": "check", "parameters": "( ImmutableEvent event, WorkContext ctx )", "modifiers": "@Override public", "return": "ImportSummary", "signature": "ImportSummary check( ImmutableEvent event, WorkContext ctx )", "full_signature": "@Override public ImportSummary check( ImmutableEvent event, WorkContext ctx )", "class_method_signature": "EventGeometryCheck.check( ImmutableEvent event, WorkContext ctx )", "testcase": false, "constructor": false}, {"identifier": "programStageFeatureCompatibleWithEventGeometry", "parameters": "(ImmutableEvent event, ProgramStage programStage )", "modifiers": "private", "return": "boolean", "signature": "boolean programStageFeatureCompatibleWithEventGeometry(ImmutableEvent event, ProgramStage programStage )", "full_signature": "private boolean programStageFeatureCompatibleWithEventGeometry(ImmutableEvent event, ProgramStage programStage )", "class_method_signature": "EventGeometryCheck.programStageFeatureCompatibleWithEventGeometry(ImmutableEvent event, ProgramStage programStage )", "testcase": false, "constructor": false}], "file": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/importer/shared/validation/EventGeometryCheck.java"}, "focal_method": {"identifier": "check", "parameters": "( ImmutableEvent event, WorkContext ctx )", "modifiers": "@Override public", "return": "ImportSummary", "body": "@Override\n    public ImportSummary check( ImmutableEvent event, WorkContext ctx )\n    {\n        IdScheme scheme = ctx.getImportOptions().getIdSchemes().getProgramStageIdScheme();\n        ProgramStage programStage = ctx.getProgramStage( scheme, event.getProgramStage() );\n\n        if ( Objects.nonNull( event.getGeometry() )\n            && programStageFeatureCompatibleWithEventGeometry( event, programStage ) )\n        {\n            return new ImportSummary( ImportStatus.ERROR,\n                \"Geometry (\" + event.getGeometry().getGeometryType() + \") does not conform to the feature type (\"\n                    + programStage.getFeatureType().value() + \") specified for the program stage: \"\n                    + programStage.getUid() ).setReference( event.getEvent() ).incrementIgnored();\n        }\n\n        return success();\n    }", "signature": "ImportSummary check( ImmutableEvent event, WorkContext ctx )", "full_signature": "@Override public ImportSummary check( ImmutableEvent event, WorkContext ctx )", "class_method_signature": "EventGeometryCheck.check( ImmutableEvent event, WorkContext ctx )", "testcase": false, "constructor": false, "invocations": ["getProgramStageIdScheme", "getIdSchemes", "getImportOptions", "getProgramStage", "getProgramStage", "nonNull", "getGeometry", "programStageFeatureCompatibleWithEventGeometry", "incrementIgnored", "setReference", "getGeometryType", "getGeometry", "value", "getFeatureType", "getUid", "getEvent", "success"]}, "repository": {"repo_id": 66940520, "url": "https://github.com/dhis2/dhis2-core", "stars": 151, "created": "8/30/2016 12:57:05 PM +00:00", "updates": "2020-01-24T18:06:36+00:00", "fork": "False", "license": "licensed"}}