{"test_class": {"identifier": "SingleClusterMemberResolverTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String IP_PREFIX = \"1.0.0.\";", "modifier": "private static final", "type": "String", "declarator": "IP_PREFIX = \"1.0.0.\"", "var_name": "IP_PREFIX"}, {"original_string": "private static final ClusterMemberAddress ADDRESS = ClusterMemberAddress.newBuilder()\n            .withIpAddress(IP_PREFIX + \"1\")\n            .withProtocol(\"grpc\")\n            .build();", "modifier": "private static final", "type": "ClusterMemberAddress", "declarator": "ADDRESS = ClusterMemberAddress.newBuilder()\n            .withIpAddress(IP_PREFIX + \"1\")\n            .withProtocol(\"grpc\")\n            .build()", "var_name": "ADDRESS"}, {"original_string": "private static final java.time.Duration TIMEOUT = Duration.ofSeconds(5);", "modifier": "private static final", "type": "java.time.Duration", "declarator": "TIMEOUT = Duration.ofSeconds(5)", "var_name": "TIMEOUT"}, {"original_string": "private static final ClusterMembershipRevision MEMBER_1 = newMember(1);", "modifier": "private static final", "type": "ClusterMembershipRevision", "declarator": "MEMBER_1 = newMember(1)", "var_name": "MEMBER_1"}, {"original_string": "private static final ClusterMembershipRevision MEMBER_2 = newMember(2);", "modifier": "private static final", "type": "ClusterMembershipRevision", "declarator": "MEMBER_2 = newMember(2)", "var_name": "MEMBER_2"}, {"original_string": "private static final ClusterMembershipRevision MEMBER_3 = newMember(3);", "modifier": "private static final", "type": "ClusterMembershipRevision", "declarator": "MEMBER_3 = newMember(3)", "var_name": "MEMBER_3"}, {"original_string": "private final TitusRuntime titusRuntime = TitusRuntimes.internal();", "modifier": "private final", "type": "TitusRuntime", "declarator": "titusRuntime = TitusRuntimes.internal()", "var_name": "titusRuntime"}, {"original_string": "private final ClusterMembershipResolverConfiguration configuration = Archaius2Ext.newConfiguration(ClusterMembershipResolverConfiguration.class);", "modifier": "private final", "type": "ClusterMembershipResolverConfiguration", "declarator": "configuration = Archaius2Ext.newConfiguration(ClusterMembershipResolverConfiguration.class)", "var_name": "configuration"}, {"original_string": "private final GrpcClusterMembershipServiceStub serviceStub = new GrpcClusterMembershipServiceStub();", "modifier": "private final", "type": "GrpcClusterMembershipServiceStub", "declarator": "serviceStub = new GrpcClusterMembershipServiceStub()", "var_name": "serviceStub"}, {"original_string": "private Server server;", "modifier": "private", "type": "Server", "declarator": "server", "var_name": "server"}, {"original_string": "private SingleClusterMemberResolver resolver;", "modifier": "private", "type": "SingleClusterMemberResolver", "declarator": "resolver", "var_name": "resolver"}], "file": "titus-common-client/src/test/java/com/netflix/titus/client/clustermembership/resolver/SingleClusterMemberResolverTest.java"}, "test_case": {"identifier": "testElectedLeaderSetInSnapshot", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testElectedLeaderSetInSnapshot() {\n        Iterator<ClusterMembershipSnapshot> eventIt = resolver.resolve().toIterable().iterator();\n        ClusterMembershipSnapshot leadElectedEvent = eventIt.next();\n\n        assertThat(leadElectedEvent.getLeaderRevision()).isNotEmpty();\n    }", "signature": "void testElectedLeaderSetInSnapshot()", "full_signature": "@Test public void testElectedLeaderSetInSnapshot()", "class_method_signature": "SingleClusterMemberResolverTest.testElectedLeaderSetInSnapshot()", "testcase": true, "constructor": false, "invocations": ["iterator", "toIterable", "resolve", "next", "isNotEmpty", "assertThat", "getLeaderRevision"]}, "focal_class": {"identifier": "SingleClusterMemberResolver", "superclass": "", "interfaces": "implements DirectClusterMemberResolver", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(SingleClusterMemberResolver.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(SingleClusterMemberResolver.class)", "var_name": "logger"}, {"original_string": "private static final Duration GRPC_REQUEST_TIMEOUT = Duration.ofSeconds(1);", "modifier": "private static final", "type": "Duration", "declarator": "GRPC_REQUEST_TIMEOUT = Duration.ofSeconds(1)", "var_name": "GRPC_REQUEST_TIMEOUT"}, {"original_string": "private final String name;", "modifier": "private final", "type": "String", "declarator": "name", "var_name": "name"}, {"original_string": "private final ClusterMembershipResolverConfiguration configuration;", "modifier": "private final", "type": "ClusterMembershipResolverConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final ClusterMemberAddress address;", "modifier": "private final", "type": "ClusterMemberAddress", "declarator": "address", "var_name": "address"}, {"original_string": "private final ClusterMemberVerifier clusterMemberVerifier;", "modifier": "private final", "type": "ClusterMemberVerifier", "declarator": "clusterMemberVerifier", "var_name": "clusterMemberVerifier"}, {"original_string": "private final Clock clock;", "modifier": "private final", "type": "Clock", "declarator": "clock", "var_name": "clock"}, {"original_string": "private final ManagedChannel channel;", "modifier": "private final", "type": "ManagedChannel", "declarator": "channel", "var_name": "channel"}, {"original_string": "private final ReactorClusterMembershipClient client;", "modifier": "private final", "type": "ReactorClusterMembershipClient", "declarator": "client", "var_name": "client"}, {"original_string": "private final Disposable eventStreamDisposable;", "modifier": "private final", "type": "Disposable", "declarator": "eventStreamDisposable", "var_name": "eventStreamDisposable"}, {"original_string": "private volatile String rejectedMemberError;", "modifier": "private volatile", "type": "String", "declarator": "rejectedMemberError", "var_name": "rejectedMemberError"}, {"original_string": "private volatile Optional<String> connectedToMemberId = Optional.empty();", "modifier": "private volatile", "type": "Optional<String>", "declarator": "connectedToMemberId = Optional.empty()", "var_name": "connectedToMemberId"}, {"original_string": "private volatile ClusterMembershipSnapshot lastSnapshot = ClusterMembershipSnapshot.empty();", "modifier": "private volatile", "type": "ClusterMembershipSnapshot", "declarator": "lastSnapshot = ClusterMembershipSnapshot.empty()", "var_name": "lastSnapshot"}, {"original_string": "private final ReplayProcessor<ClusterMembershipSnapshot> eventProcessor = ReplayProcessor.create(1);", "modifier": "private final", "type": "ReplayProcessor<ClusterMembershipSnapshot>", "declarator": "eventProcessor = ReplayProcessor.create(1)", "var_name": "eventProcessor"}, {"original_string": "private final FluxSink<ClusterMembershipSnapshot> eventSink = eventProcessor.sink();", "modifier": "private final", "type": "FluxSink<ClusterMembershipSnapshot>", "declarator": "eventSink = eventProcessor.sink()", "var_name": "eventSink"}, {"original_string": "private final AtomicReference<Long> disconnectTimeRef;", "modifier": "private final", "type": "AtomicReference<Long>", "declarator": "disconnectTimeRef", "var_name": "disconnectTimeRef"}], "methods": [{"identifier": "SingleClusterMemberResolver", "parameters": "(ClusterMembershipResolverConfiguration configuration,\n                                       Function<ClusterMemberAddress, ManagedChannel> channelProvider,\n                                       ClusterMemberAddress address,\n                                       ClusterMemberVerifier clusterMemberVerifier,\n                                       Scheduler scheduler,\n                                       TitusRuntime titusRuntime)", "modifiers": "public", "return": "", "signature": " SingleClusterMemberResolver(ClusterMembershipResolverConfiguration configuration,\n                                       Function<ClusterMemberAddress, ManagedChannel> channelProvider,\n                                       ClusterMemberAddress address,\n                                       ClusterMemberVerifier clusterMemberVerifier,\n                                       Scheduler scheduler,\n                                       TitusRuntime titusRuntime)", "full_signature": "public  SingleClusterMemberResolver(ClusterMembershipResolverConfiguration configuration,\n                                       Function<ClusterMemberAddress, ManagedChannel> channelProvider,\n                                       ClusterMemberAddress address,\n                                       ClusterMemberVerifier clusterMemberVerifier,\n                                       Scheduler scheduler,\n                                       TitusRuntime titusRuntime)", "class_method_signature": "SingleClusterMemberResolver.SingleClusterMemberResolver(ClusterMembershipResolverConfiguration configuration,\n                                       Function<ClusterMemberAddress, ManagedChannel> channelProvider,\n                                       ClusterMemberAddress address,\n                                       ClusterMemberVerifier clusterMemberVerifier,\n                                       Scheduler scheduler,\n                                       TitusRuntime titusRuntime)", "testcase": false, "constructor": true}, {"identifier": "checkSnapshot", "parameters": "(ClusterMembershipEvent.Snapshot snapshot)", "modifiers": "private", "return": "Optional<String>", "signature": "Optional<String> checkSnapshot(ClusterMembershipEvent.Snapshot snapshot)", "full_signature": "private Optional<String> checkSnapshot(ClusterMembershipEvent.Snapshot snapshot)", "class_method_signature": "SingleClusterMemberResolver.checkSnapshot(ClusterMembershipEvent.Snapshot snapshot)", "testcase": false, "constructor": false}, {"identifier": "shutdown", "parameters": "()", "modifiers": "@Override public", "return": "void", "signature": "void shutdown()", "full_signature": "@Override public void shutdown()", "class_method_signature": "SingleClusterMemberResolver.shutdown()", "testcase": false, "constructor": false}, {"identifier": "getAddress", "parameters": "()", "modifiers": "@Override public", "return": "ClusterMemberAddress", "signature": "ClusterMemberAddress getAddress()", "full_signature": "@Override public ClusterMemberAddress getAddress()", "class_method_signature": "SingleClusterMemberResolver.getAddress()", "testcase": false, "constructor": false}, {"identifier": "getPrintableName", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String getPrintableName()", "full_signature": "@Override public String getPrintableName()", "class_method_signature": "SingleClusterMemberResolver.getPrintableName()", "testcase": false, "constructor": false}, {"identifier": "isHealthy", "parameters": "()", "modifiers": "@Override public", "return": "boolean", "signature": "boolean isHealthy()", "full_signature": "@Override public boolean isHealthy()", "class_method_signature": "SingleClusterMemberResolver.isHealthy()", "testcase": false, "constructor": false}, {"identifier": "getSnapshot", "parameters": "()", "modifiers": "@Override public", "return": "ClusterMembershipSnapshot", "signature": "ClusterMembershipSnapshot getSnapshot()", "full_signature": "@Override public ClusterMembershipSnapshot getSnapshot()", "class_method_signature": "SingleClusterMemberResolver.getSnapshot()", "testcase": false, "constructor": false}, {"identifier": "resolve", "parameters": "()", "modifiers": "@Override public", "return": "Flux<ClusterMembershipSnapshot>", "signature": "Flux<ClusterMembershipSnapshot> resolve()", "full_signature": "@Override public Flux<ClusterMembershipSnapshot> resolve()", "class_method_signature": "SingleClusterMemberResolver.resolve()", "testcase": false, "constructor": false}, {"identifier": "getRejectedMemberError", "parameters": "()", "modifiers": "@VisibleForTesting", "return": "String", "signature": "String getRejectedMemberError()", "full_signature": "@VisibleForTesting String getRejectedMemberError()", "class_method_signature": "SingleClusterMemberResolver.getRejectedMemberError()", "testcase": false, "constructor": false}, {"identifier": "processEvent", "parameters": "(ClusterMembershipEvent next)", "modifiers": "private", "return": "void", "signature": "void processEvent(ClusterMembershipEvent next)", "full_signature": "private void processEvent(ClusterMembershipEvent next)", "class_method_signature": "SingleClusterMemberResolver.processEvent(ClusterMembershipEvent next)", "testcase": false, "constructor": false}, {"identifier": "processSnapshotEvent", "parameters": "(ClusterMembershipEvent.Snapshot snapshot)", "modifiers": "private", "return": "ClusterMembershipSnapshot", "signature": "ClusterMembershipSnapshot processSnapshotEvent(ClusterMembershipEvent.Snapshot snapshot)", "full_signature": "private ClusterMembershipSnapshot processSnapshotEvent(ClusterMembershipEvent.Snapshot snapshot)", "class_method_signature": "SingleClusterMemberResolver.processSnapshotEvent(ClusterMembershipEvent.Snapshot snapshot)", "testcase": false, "constructor": false}, {"identifier": "processMemberUpdateEvent", "parameters": "(ClusterMembershipEvent.MemberUpdated memberUpdated)", "modifiers": "private", "return": "ClusterMembershipSnapshot", "signature": "ClusterMembershipSnapshot processMemberUpdateEvent(ClusterMembershipEvent.MemberUpdated memberUpdated)", "full_signature": "private ClusterMembershipSnapshot processMemberUpdateEvent(ClusterMembershipEvent.MemberUpdated memberUpdated)", "class_method_signature": "SingleClusterMemberResolver.processMemberUpdateEvent(ClusterMembershipEvent.MemberUpdated memberUpdated)", "testcase": false, "constructor": false}, {"identifier": "buildLeaderRevision", "parameters": "(ClusterMembershipRevision<ClusterMember> memberRevision)", "modifiers": "private", "return": "ClusterMembershipRevision<ClusterMemberLeadership>", "signature": "ClusterMembershipRevision<ClusterMemberLeadership> buildLeaderRevision(ClusterMembershipRevision<ClusterMember> memberRevision)", "full_signature": "private ClusterMembershipRevision<ClusterMemberLeadership> buildLeaderRevision(ClusterMembershipRevision<ClusterMember> memberRevision)", "class_method_signature": "SingleClusterMemberResolver.buildLeaderRevision(ClusterMembershipRevision<ClusterMember> memberRevision)", "testcase": false, "constructor": false}, {"identifier": "processMemberRemovedEvent", "parameters": "(ClusterMembershipEvent.MemberRemoved memberRemoved)", "modifiers": "private", "return": "ClusterMembershipSnapshot", "signature": "ClusterMembershipSnapshot processMemberRemovedEvent(ClusterMembershipEvent.MemberRemoved memberRemoved)", "full_signature": "private ClusterMembershipSnapshot processMemberRemovedEvent(ClusterMembershipEvent.MemberRemoved memberRemoved)", "class_method_signature": "SingleClusterMemberResolver.processMemberRemovedEvent(ClusterMembershipEvent.MemberRemoved memberRemoved)", "testcase": false, "constructor": false}, {"identifier": "isConnectionDeadline", "parameters": "(Throwable error)", "modifiers": "private", "return": "boolean", "signature": "boolean isConnectionDeadline(Throwable error)", "full_signature": "private boolean isConnectionDeadline(Throwable error)", "class_method_signature": "SingleClusterMemberResolver.isConnectionDeadline(Throwable error)", "testcase": false, "constructor": false}], "file": "titus-common-client/src/main/java/com/netflix/titus/client/clustermembership/resolver/SingleClusterMemberResolver.java"}, "focal_method": {"identifier": "resolve", "parameters": "()", "modifiers": "@Override public", "return": "Flux<ClusterMembershipSnapshot>", "body": "@Override\n    public Flux<ClusterMembershipSnapshot> resolve() {\n        return eventProcessor;\n    }", "signature": "Flux<ClusterMembershipSnapshot> resolve()", "full_signature": "@Override public Flux<ClusterMembershipSnapshot> resolve()", "class_method_signature": "SingleClusterMemberResolver.resolve()", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}