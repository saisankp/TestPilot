{"test_class": {"identifier": "SimpleServiceIdentityProviderTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private String servicePublicKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "servicePublicKeyStringK0 = null", "var_name": "servicePublicKeyStringK0"}, {"original_string": "private String servicePublicKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "servicePublicKeyStringK1 = null", "var_name": "servicePublicKeyStringK1"}, {"original_string": "private String servicePrivateKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "servicePrivateKeyStringK1 = null", "var_name": "servicePrivateKeyStringK1"}, {"original_string": "private File k0File = null;", "modifier": "private", "type": "File", "declarator": "k0File = null", "var_name": "k0File"}], "file": "libs/java/auth_core/src/test/java/com/yahoo/athenz/auth/impl/SimpleServiceIdentityProviderTest.java"}, "test_case": {"identifier": "testSimpleIdentityDefaultV1", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testSimpleIdentityDefaultV1() {\n        \n        PrivateKey key = Crypto.loadPrivateKey(servicePrivateKeyStringK1);\n        SimpleServiceIdentityProvider provider = new SimpleServiceIdentityProvider(\"coretech\",\n                \"athenz\", key, \"1\");\n        Principal user = provider.getIdentity(\"coretech\", \"athenz\");\n        assertNotNull(user);\n        assertTrue(user.getIssueTime() != 0);\n        \n        String token = user.getCredentials();\n        PrincipalToken prToken = new PrincipalToken(token);\n        assertTrue(prToken.validate(servicePublicKeyStringK1, 0, false));\n        assertEquals(prToken.getKeyId(), \"1\");\n    }", "signature": "void testSimpleIdentityDefaultV1()", "full_signature": "@Test public void testSimpleIdentityDefaultV1()", "class_method_signature": "SimpleServiceIdentityProviderTest.testSimpleIdentityDefaultV1()", "testcase": true, "constructor": false, "invocations": ["loadPrivateKey", "getIdentity", "assertNotNull", "assertTrue", "getIssueTime", "getCredentials", "assertTrue", "validate", "assertEquals", "getKeyId"]}, "focal_class": {"identifier": "SimpleServiceIdentityProvider", "superclass": "", "interfaces": "implements ServiceIdentityProvider", "fields": [{"original_string": "private static final Authority PRINCIPAL_AUTHORITY = new PrincipalAuthority();", "modifier": "private static final", "type": "Authority", "declarator": "PRINCIPAL_AUTHORITY = new PrincipalAuthority()", "var_name": "PRINCIPAL_AUTHORITY"}, {"original_string": "private String domain;", "modifier": "private", "type": "String", "declarator": "domain", "var_name": "domain"}, {"original_string": "private String service;", "modifier": "private", "type": "String", "declarator": "service", "var_name": "service"}, {"original_string": "private PrivateKey key;", "modifier": "private", "type": "PrivateKey", "declarator": "key", "var_name": "key"}, {"original_string": "private long tokenTimeout;", "modifier": "private", "type": "long", "declarator": "tokenTimeout", "var_name": "tokenTimeout"}, {"original_string": "private String keyId;", "modifier": "private", "type": "String", "declarator": "keyId", "var_name": "keyId"}, {"original_string": "private String host = null;", "modifier": "private", "type": "String", "declarator": "host = null", "var_name": "host"}, {"original_string": "private Authority authority;", "modifier": "private", "type": "Authority", "declarator": "authority", "var_name": "authority"}], "methods": [{"identifier": "SimpleServiceIdentityProvider", "parameters": "(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId)", "modifiers": "public", "return": "", "signature": " SimpleServiceIdentityProvider(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId)", "full_signature": "public  SimpleServiceIdentityProvider(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId)", "class_method_signature": "SimpleServiceIdentityProvider.SimpleServiceIdentityProvider(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId)", "testcase": false, "constructor": true}, {"identifier": "SimpleServiceIdentityProvider", "parameters": "(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId, long tokenTimeout)", "modifiers": "public", "return": "", "signature": " SimpleServiceIdentityProvider(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId, long tokenTimeout)", "full_signature": "public  SimpleServiceIdentityProvider(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId, long tokenTimeout)", "class_method_signature": "SimpleServiceIdentityProvider.SimpleServiceIdentityProvider(String domainName, String serviceName,\n            PrivateKey privateKey, String keyId, long tokenTimeout)", "testcase": false, "constructor": true}, {"identifier": "SimpleServiceIdentityProvider", "parameters": "(Authority authority, String domainName,\n            String serviceName, PrivateKey privateKey, String keyId, long tokenTimeout)", "modifiers": "public", "return": "", "signature": " SimpleServiceIdentityProvider(Authority authority, String domainName,\n            String serviceName, PrivateKey privateKey, String keyId, long tokenTimeout)", "full_signature": "public  SimpleServiceIdentityProvider(Authority authority, String domainName,\n            String serviceName, PrivateKey privateKey, String keyId, long tokenTimeout)", "class_method_signature": "SimpleServiceIdentityProvider.SimpleServiceIdentityProvider(Authority authority, String domainName,\n            String serviceName, PrivateKey privateKey, String keyId, long tokenTimeout)", "testcase": false, "constructor": true}, {"identifier": "getIdentity", "parameters": "(String domainName, String serviceName)", "modifiers": "public", "return": "Principal", "signature": "Principal getIdentity(String domainName, String serviceName)", "full_signature": "public Principal getIdentity(String domainName, String serviceName)", "class_method_signature": "SimpleServiceIdentityProvider.getIdentity(String domainName, String serviceName)", "testcase": false, "constructor": false}, {"identifier": "getServerHostName", "parameters": "()", "modifiers": "", "return": "String", "signature": "String getServerHostName()", "full_signature": " String getServerHostName()", "class_method_signature": "SimpleServiceIdentityProvider.getServerHostName()", "testcase": false, "constructor": false}, {"identifier": "getLocalHost", "parameters": "()", "modifiers": "", "return": "InetAddress", "signature": "InetAddress getLocalHost()", "full_signature": " InetAddress getLocalHost()", "class_method_signature": "SimpleServiceIdentityProvider.getLocalHost()", "testcase": false, "constructor": false}, {"identifier": "getHost", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getHost()", "full_signature": "public String getHost()", "class_method_signature": "SimpleServiceIdentityProvider.getHost()", "testcase": false, "constructor": false}, {"identifier": "setHost", "parameters": "(String host)", "modifiers": "public", "return": "void", "signature": "void setHost(String host)", "full_signature": "public void setHost(String host)", "class_method_signature": "SimpleServiceIdentityProvider.setHost(String host)", "testcase": false, "constructor": false}, {"identifier": "setTokenTimeout", "parameters": "(long tokenTimeout)", "modifiers": "public", "return": "void", "signature": "void setTokenTimeout(long tokenTimeout)", "full_signature": "public void setTokenTimeout(long tokenTimeout)", "class_method_signature": "SimpleServiceIdentityProvider.setTokenTimeout(long tokenTimeout)", "testcase": false, "constructor": false}, {"identifier": "getAuthority", "parameters": "()", "modifiers": "public", "return": "Authority", "signature": "Authority getAuthority()", "full_signature": "public Authority getAuthority()", "class_method_signature": "SimpleServiceIdentityProvider.getAuthority()", "testcase": false, "constructor": false}, {"identifier": "setAuthority", "parameters": "(Authority authority)", "modifiers": "public", "return": "void", "signature": "void setAuthority(Authority authority)", "full_signature": "public void setAuthority(Authority authority)", "class_method_signature": "SimpleServiceIdentityProvider.setAuthority(Authority authority)", "testcase": false, "constructor": false}], "file": "libs/java/auth_core/src/main/java/com/yahoo/athenz/auth/impl/SimpleServiceIdentityProvider.java"}, "focal_method": {"identifier": "getIdentity", "parameters": "(String domainName, String serviceName)", "modifiers": "public", "return": "Principal", "body": "public Principal getIdentity(String domainName, String serviceName) {\n        \n        // all the role members in Athenz are normalized to lower case so we need to make\n        // sure our principal's name and domain are created with lower case as well\n        \n        domainName = domainName.toLowerCase();\n        serviceName = serviceName.toLowerCase();\n        \n        // make sure we're handling correct domain and service\n        \n        if (!domainName.equals(domain) || !serviceName.equals(service)) {\n            return null;\n        }\n        \n        PrincipalToken token = new PrincipalToken.Builder(\"S1\", domainName, serviceName)\n            .expirationWindow(tokenTimeout).host(host).keyId(keyId).build();\n        token.sign(key);\n        \n        SimplePrincipal principal = (SimplePrincipal) SimplePrincipal.create(domainName,\n                serviceName, token.getSignedToken(), System.currentTimeMillis() / 1000,\n                authority);\n        principal.setUnsignedCreds(token.getUnsignedToken());\n        return principal;\n    }", "signature": "Principal getIdentity(String domainName, String serviceName)", "full_signature": "public Principal getIdentity(String domainName, String serviceName)", "class_method_signature": "SimpleServiceIdentityProvider.getIdentity(String domainName, String serviceName)", "testcase": false, "constructor": false, "invocations": ["toLowerCase", "toLowerCase", "equals", "equals", "build", "keyId", "host", "expirationWindow", "sign", "create", "getSignedToken", "currentTimeMillis", "setUnsignedCreds", "getUnsignedToken"]}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}