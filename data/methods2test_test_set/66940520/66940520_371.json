{"test_class": {"identifier": "FileResourceBlocklistTest", "superclass": "", "interfaces": "", "fields": [], "file": "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/fileresource/FileResourceBlocklistTest.java"}, "test_case": {"identifier": "testInvalid", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testInvalid()\n    {\n        FileResource frA = new FileResource( \"Click_Me.exe\", \"application/x-ms-dos-executable\", 451, \"\", FileResourceDomain.DATA_VALUE );\n        FileResource frB = new FileResource( \"evil_script.sh\", \"application/pdf\", 125, \"\", FileResourceDomain.MESSAGE_ATTACHMENT ); // Fake content type\n        FileResource frC = new FileResource( \"cookie_stealer\", \"text/javascript\", 631, \"\", FileResourceDomain.USER_AVATAR ); // No file extension\n        FileResource frD = new FileResource( \"malicious_software.msi\", null, 235, \"\", FileResourceDomain.USER_AVATAR ); // No content type\n\n        assertFalse( FileResourceBlocklist.isValid( frA ) );\n        assertFalse( FileResourceBlocklist.isValid( frB ) );\n        assertFalse( FileResourceBlocklist.isValid( frC ) );\n        assertFalse( FileResourceBlocklist.isValid( frD ) );\n        assertFalse( FileResourceBlocklist.isValid( null ) );\n    }", "signature": "void testInvalid()", "full_signature": "@Test public void testInvalid()", "class_method_signature": "FileResourceBlocklistTest.testInvalid()", "testcase": true, "constructor": false, "invocations": ["assertFalse", "isValid", "assertFalse", "isValid", "assertFalse", "isValid", "assertFalse", "isValid", "assertFalse", "isValid"]}, "focal_class": {"identifier": "FileResourceBlocklist", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final ImmutableSet<String> CONTENT_TYPES = ImmutableSet.of(\n        // Web\n        \"text/html\",\n        \"text/css\",\n        \"text/javascript\",\n        \"font/otf\",\n        \"application/x-shockwave-flash\",\n        // Executable\n        \"application/vnd.debian.binary-package\",\n        \"application/x-rpm\",\n        \"application/java-archive\",\n        \"application/x-ms-dos-executable\",\n        \"application/vnd.microsoft.portable-executable\",\n        \"application/vnd.apple.installer+xml\",\n        \"application/vnd.mozilla.xul+xml\",\n        \"application/x-httpd-php\",\n        \"application/x-sh\",\n        \"application/x-csh\"\n    );", "modifier": "private static final", "type": "ImmutableSet<String>", "declarator": "CONTENT_TYPES = ImmutableSet.of(\n        // Web\n        \"text/html\",\n        \"text/css\",\n        \"text/javascript\",\n        \"font/otf\",\n        \"application/x-shockwave-flash\",\n        // Executable\n        \"application/vnd.debian.binary-package\",\n        \"application/x-rpm\",\n        \"application/java-archive\",\n        \"application/x-ms-dos-executable\",\n        \"application/vnd.microsoft.portable-executable\",\n        \"application/vnd.apple.installer+xml\",\n        \"application/vnd.mozilla.xul+xml\",\n        \"application/x-httpd-php\",\n        \"application/x-sh\",\n        \"application/x-csh\"\n    )", "var_name": "CONTENT_TYPES"}, {"original_string": "private static final ImmutableSet<String> FILE_EXTENSIONS = ImmutableSet.of(\n        // Web\n        \"html\",\n        \"htm\",\n        \"css\",\n        \"js\",\n        \"mjs\",\n        \"otf\",\n        \"swf\",\n        // Executable\n        \"deb\",\n        \"rpm\",\n        \"jar\",\n        \"jsp\",\n        \"exe\",\n        \"msi\",\n        \"mpkg\",\n        \"xul\",\n        \"php\",\n        \"bin\",\n        \"sh\",\n        \"csh\",\n        \"bat\"\n    );", "modifier": "private static final", "type": "ImmutableSet<String>", "declarator": "FILE_EXTENSIONS = ImmutableSet.of(\n        // Web\n        \"html\",\n        \"htm\",\n        \"css\",\n        \"js\",\n        \"mjs\",\n        \"otf\",\n        \"swf\",\n        // Executable\n        \"deb\",\n        \"rpm\",\n        \"jar\",\n        \"jsp\",\n        \"exe\",\n        \"msi\",\n        \"mpkg\",\n        \"xul\",\n        \"php\",\n        \"bin\",\n        \"sh\",\n        \"csh\",\n        \"bat\"\n    )", "var_name": "FILE_EXTENSIONS"}], "methods": [{"identifier": "isValid", "parameters": "( FileResource fileResource )", "modifiers": "public static", "return": "boolean", "signature": "boolean isValid( FileResource fileResource )", "full_signature": "public static boolean isValid( FileResource fileResource )", "class_method_signature": "FileResourceBlocklist.isValid( FileResource fileResource )", "testcase": false, "constructor": false}], "file": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlocklist.java"}, "focal_method": {"identifier": "isValid", "parameters": "( FileResource fileResource )", "modifiers": "public static", "return": "boolean", "body": "public static boolean isValid( FileResource fileResource )\n    {\n        if ( fileResource == null || fileResource.getContentType() == null || fileResource.getName() == null )\n        {\n            return false;\n        }\n\n        if ( CONTENT_TYPES.contains( fileResource.getContentType().toLowerCase() ) )\n        {\n            return false;\n        }\n\n        if ( FILE_EXTENSIONS.contains( FilenameUtils.getExtension( fileResource.getName().toLowerCase() ) ) )\n        {\n            return false;\n        }\n\n        return true;\n    }", "signature": "boolean isValid( FileResource fileResource )", "full_signature": "public static boolean isValid( FileResource fileResource )", "class_method_signature": "FileResourceBlocklist.isValid( FileResource fileResource )", "testcase": false, "constructor": false, "invocations": ["getContentType", "getName", "contains", "toLowerCase", "getContentType", "contains", "getExtension", "toLowerCase", "getName"]}, "repository": {"repo_id": 66940520, "url": "https://github.com/dhis2/dhis2-core", "stars": 151, "created": "8/30/2016 12:57:05 PM +00:00", "updates": "2020-01-24T18:06:36+00:00", "fork": "False", "license": "licensed"}}