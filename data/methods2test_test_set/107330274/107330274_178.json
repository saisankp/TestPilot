{"test_class": {"identifier": "DefaultLoadBalancerServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final int MIN_TIME_IN_QUEUE_MS = 1_000;", "modifier": "private static final", "type": "int", "declarator": "MIN_TIME_IN_QUEUE_MS = 1_000", "var_name": "MIN_TIME_IN_QUEUE_MS"}, {"original_string": "private static final int FLUSH_WAIT_TIME_MS = 2 * MIN_TIME_IN_QUEUE_MS;", "modifier": "private static final", "type": "int", "declarator": "FLUSH_WAIT_TIME_MS = 2 * MIN_TIME_IN_QUEUE_MS", "var_name": "FLUSH_WAIT_TIME_MS"}, {"original_string": "private TitusRuntime runtime;", "modifier": "private", "type": "TitusRuntime", "declarator": "runtime", "var_name": "runtime"}, {"original_string": "private LoadBalancerConnector client;", "modifier": "private", "type": "LoadBalancerConnector", "declarator": "client", "var_name": "client"}, {"original_string": "private V3JobOperations v3JobOperations;", "modifier": "private", "type": "V3JobOperations", "declarator": "v3JobOperations", "var_name": "v3JobOperations"}, {"original_string": "private LoadBalancerJobOperations loadBalancerJobOperations;", "modifier": "private", "type": "LoadBalancerJobOperations", "declarator": "loadBalancerJobOperations", "var_name": "loadBalancerJobOperations"}, {"original_string": "private LoadBalancerStore loadBalancerStore;", "modifier": "private", "type": "LoadBalancerStore", "declarator": "loadBalancerStore", "var_name": "loadBalancerStore"}, {"original_string": "private LoadBalancerReconciler reconciler;", "modifier": "private", "type": "LoadBalancerReconciler", "declarator": "reconciler", "var_name": "reconciler"}, {"original_string": "private PublishSubject<TargetStateBatchable> reconcilerEvents;", "modifier": "private", "type": "PublishSubject<TargetStateBatchable>", "declarator": "reconcilerEvents", "var_name": "reconcilerEvents"}, {"original_string": "private LoadBalancerJobValidator validator;", "modifier": "private", "type": "LoadBalancerJobValidator", "declarator": "validator", "var_name": "validator"}, {"original_string": "private TestScheduler testScheduler;", "modifier": "private", "type": "TestScheduler", "declarator": "testScheduler", "var_name": "testScheduler"}, {"original_string": "private CallMetadata callMetadata = CallMetadata.newBuilder().withCallerId(\"Load Balancer test\").build();", "modifier": "private", "type": "CallMetadata", "declarator": "callMetadata = CallMetadata.newBuilder().withCallerId(\"Load Balancer test\").build()", "var_name": "callMetadata"}], "file": "titus-server-master/src/test/java/com/netflix/titus/master/loadbalancer/service/DefaultLoadBalancerServiceTest.java"}, "test_case": {"identifier": "emptyBatchesAreFilteredOut", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void emptyBatchesAreFilteredOut() {\n        defaultStubs();\n\n        LoadBalancerConfiguration configuration = LoadBalancerTests.mockConfiguration(MIN_TIME_IN_QUEUE_MS);\n        DefaultLoadBalancerService service = new DefaultLoadBalancerService(\n                runtime, configuration, client, loadBalancerStore, loadBalancerJobOperations, reconciler, validator, testScheduler);\n\n        AssertableSubscriber<Batch<TargetStateBatchable, String>> testSubscriber = service.events().test();\n\n        testSubscriber.assertNoErrors().assertValueCount(0);\n        verify(client, never()).registerAll(any(), any());\n        verify(client, never()).deregisterAll(any(), any());\n        verifyNoReconcilerIgnore();\n\n        testScheduler.advanceTimeBy(FLUSH_WAIT_TIME_MS, TimeUnit.MILLISECONDS);\n\n        testSubscriber.assertNoErrors().assertValueCount(0);\n        verify(client, never()).registerAll(any(), any());\n        verify(client, never()).deregisterAll(any(), any());\n        verifyNoReconcilerIgnore();\n    }", "signature": "void emptyBatchesAreFilteredOut()", "full_signature": "@Test public void emptyBatchesAreFilteredOut()", "class_method_signature": "DefaultLoadBalancerServiceTest.emptyBatchesAreFilteredOut()", "testcase": true, "constructor": false, "invocations": ["defaultStubs", "mockConfiguration", "test", "events", "assertValueCount", "assertNoErrors", "registerAll", "verify", "never", "any", "any", "deregisterAll", "verify", "never", "any", "any", "verifyNoReconcilerIgnore", "advanceTimeBy", "assertValueCount", "assertNoErrors", "registerAll", "verify", "never", "any", "any", "deregisterAll", "verify", "never", "any", "any", "verifyNoReconcilerIgnore"]}, "focal_class": {"identifier": "DefaultLoadBalancerService", "superclass": "", "interfaces": "implements LoadBalancerService", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(DefaultLoadBalancerService.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(DefaultLoadBalancerService.class)", "var_name": "logger"}, {"original_string": "private final TitusRuntime runtime;", "modifier": "private final", "type": "TitusRuntime", "declarator": "runtime", "var_name": "runtime"}, {"original_string": "private final LoadBalancerConfiguration configuration;", "modifier": "private final", "type": "LoadBalancerConfiguration", "declarator": "configuration", "var_name": "configuration"}, {"original_string": "private final LoadBalancerConnector loadBalancerConnector;", "modifier": "private final", "type": "LoadBalancerConnector", "declarator": "loadBalancerConnector", "var_name": "loadBalancerConnector"}, {"original_string": "private final LoadBalancerStore loadBalancerStore;", "modifier": "private final", "type": "LoadBalancerStore", "declarator": "loadBalancerStore", "var_name": "loadBalancerStore"}, {"original_string": "private final LoadBalancerJobValidator validator;", "modifier": "private final", "type": "LoadBalancerJobValidator", "declarator": "validator", "var_name": "validator"}, {"original_string": "private final LoadBalancerReconciler reconciler;", "modifier": "private final", "type": "LoadBalancerReconciler", "declarator": "reconciler", "var_name": "reconciler"}, {"original_string": "private final LoadBalancerEngine engine;", "modifier": "private final", "type": "LoadBalancerEngine", "declarator": "engine", "var_name": "engine"}, {"original_string": "private final Scheduler scheduler;", "modifier": "private final", "type": "Scheduler", "declarator": "scheduler", "var_name": "scheduler"}, {"original_string": "private Subscription loadBalancerBatches;", "modifier": "private", "type": "Subscription", "declarator": "loadBalancerBatches", "var_name": "loadBalancerBatches"}], "methods": [{"identifier": "DefaultLoadBalancerService", "parameters": "(TitusRuntime runtime,\n                                      LoadBalancerConfiguration configuration,\n                                      LoadBalancerConnector loadBalancerConnector,\n                                      LoadBalancerStore loadBalancerStore,\n                                      V3JobOperations v3JobOperations,\n                                      LoadBalancerJobValidator validator)", "modifiers": "@Inject public", "return": "", "signature": " DefaultLoadBalancerService(TitusRuntime runtime,\n                                      LoadBalancerConfiguration configuration,\n                                      LoadBalancerConnector loadBalancerConnector,\n                                      LoadBalancerStore loadBalancerStore,\n                                      V3JobOperations v3JobOperations,\n                                      LoadBalancerJobValidator validator)", "full_signature": "@Inject public  DefaultLoadBalancerService(TitusRuntime runtime,\n                                      LoadBalancerConfiguration configuration,\n                                      LoadBalancerConnector loadBalancerConnector,\n                                      LoadBalancerStore loadBalancerStore,\n                                      V3JobOperations v3JobOperations,\n                                      LoadBalancerJobValidator validator)", "class_method_signature": "DefaultLoadBalancerService.DefaultLoadBalancerService(TitusRuntime runtime,\n                                      LoadBalancerConfiguration configuration,\n                                      LoadBalancerConnector loadBalancerConnector,\n                                      LoadBalancerStore loadBalancerStore,\n                                      V3JobOperations v3JobOperations,\n                                      LoadBalancerJobValidator validator)", "testcase": false, "constructor": true}, {"identifier": "DefaultLoadBalancerService", "parameters": "(TitusRuntime runtime,\n                               LoadBalancerConfiguration configuration,\n                               LoadBalancerConnector loadBalancerConnector,\n                               LoadBalancerStore loadBalancerStore,\n                               LoadBalancerJobOperations loadBalancerJobOperations,\n                               LoadBalancerReconciler reconciler,\n                               LoadBalancerJobValidator validator,\n                               Scheduler scheduler)", "modifiers": "@VisibleForTesting", "return": "", "signature": " DefaultLoadBalancerService(TitusRuntime runtime,\n                               LoadBalancerConfiguration configuration,\n                               LoadBalancerConnector loadBalancerConnector,\n                               LoadBalancerStore loadBalancerStore,\n                               LoadBalancerJobOperations loadBalancerJobOperations,\n                               LoadBalancerReconciler reconciler,\n                               LoadBalancerJobValidator validator,\n                               Scheduler scheduler)", "full_signature": "@VisibleForTesting  DefaultLoadBalancerService(TitusRuntime runtime,\n                               LoadBalancerConfiguration configuration,\n                               LoadBalancerConnector loadBalancerConnector,\n                               LoadBalancerStore loadBalancerStore,\n                               LoadBalancerJobOperations loadBalancerJobOperations,\n                               LoadBalancerReconciler reconciler,\n                               LoadBalancerJobValidator validator,\n                               Scheduler scheduler)", "class_method_signature": "DefaultLoadBalancerService.DefaultLoadBalancerService(TitusRuntime runtime,\n                               LoadBalancerConfiguration configuration,\n                               LoadBalancerConnector loadBalancerConnector,\n                               LoadBalancerStore loadBalancerStore,\n                               LoadBalancerJobOperations loadBalancerJobOperations,\n                               LoadBalancerReconciler reconciler,\n                               LoadBalancerJobValidator validator,\n                               Scheduler scheduler)", "testcase": false, "constructor": true}, {"identifier": "getJobLoadBalancers", "parameters": "(String jobId)", "modifiers": "@Override public", "return": "Observable<String>", "signature": "Observable<String> getJobLoadBalancers(String jobId)", "full_signature": "@Override public Observable<String> getJobLoadBalancers(String jobId)", "class_method_signature": "DefaultLoadBalancerService.getJobLoadBalancers(String jobId)", "testcase": false, "constructor": false}, {"identifier": "getAllLoadBalancers", "parameters": "(Page page)", "modifiers": "@Override public", "return": "Pair<List<JobLoadBalancer>, Pagination>", "signature": "Pair<List<JobLoadBalancer>, Pagination> getAllLoadBalancers(Page page)", "full_signature": "@Override public Pair<List<JobLoadBalancer>, Pagination> getAllLoadBalancers(Page page)", "class_method_signature": "DefaultLoadBalancerService.getAllLoadBalancers(Page page)", "testcase": false, "constructor": false}, {"identifier": "addLoadBalancer", "parameters": "(String jobId, String loadBalancerId)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable addLoadBalancer(String jobId, String loadBalancerId)", "full_signature": "@Override public Completable addLoadBalancer(String jobId, String loadBalancerId)", "class_method_signature": "DefaultLoadBalancerService.addLoadBalancer(String jobId, String loadBalancerId)", "testcase": false, "constructor": false}, {"identifier": "removeLoadBalancer", "parameters": "(String jobId, String loadBalancerId)", "modifiers": "@Override public", "return": "Completable", "signature": "Completable removeLoadBalancer(String jobId, String loadBalancerId)", "full_signature": "@Override public Completable removeLoadBalancer(String jobId, String loadBalancerId)", "class_method_signature": "DefaultLoadBalancerService.removeLoadBalancer(String jobId, String loadBalancerId)", "testcase": false, "constructor": false}, {"identifier": "activate", "parameters": "()", "modifiers": "@Activator public", "return": "void", "signature": "void activate()", "full_signature": "@Activator public void activate()", "class_method_signature": "DefaultLoadBalancerService.activate()", "testcase": false, "constructor": false}, {"identifier": "logBatchInfo", "parameters": "(Batch<TargetStateBatchable, String> batch)", "modifiers": "private", "return": "void", "signature": "void logBatchInfo(Batch<TargetStateBatchable, String> batch)", "full_signature": "private void logBatchInfo(Batch<TargetStateBatchable, String> batch)", "class_method_signature": "DefaultLoadBalancerService.logBatchInfo(Batch<TargetStateBatchable, String> batch)", "testcase": false, "constructor": false}, {"identifier": "deactivate", "parameters": "()", "modifiers": "@Deactivator public", "return": "void", "signature": "void deactivate()", "full_signature": "@Deactivator public void deactivate()", "class_method_signature": "DefaultLoadBalancerService.deactivate()", "testcase": false, "constructor": false}, {"identifier": "events", "parameters": "()", "modifiers": "@VisibleForTesting", "return": "Observable<Batch<TargetStateBatchable, String>>", "signature": "Observable<Batch<TargetStateBatchable, String>> events()", "full_signature": "@VisibleForTesting Observable<Batch<TargetStateBatchable, String>> events()", "class_method_signature": "DefaultLoadBalancerService.events()", "testcase": false, "constructor": false}, {"identifier": "backfillTargetsToStore", "parameters": "()", "modifiers": "@VisibleForTesting", "return": "void", "signature": "void backfillTargetsToStore()", "full_signature": "@VisibleForTesting void backfillTargetsToStore()", "class_method_signature": "DefaultLoadBalancerService.backfillTargetsToStore()", "testcase": false, "constructor": false}, {"identifier": "backfillTargetsToStore", "parameters": "(LoadBalancer loadBalancer)", "modifiers": "private", "return": "Mono<Void>", "signature": "Mono<Void> backfillTargetsToStore(LoadBalancer loadBalancer)", "full_signature": "private Mono<Void> backfillTargetsToStore(LoadBalancer loadBalancer)", "class_method_signature": "DefaultLoadBalancerService.backfillTargetsToStore(LoadBalancer loadBalancer)", "testcase": false, "constructor": false}], "file": "titus-server-master/src/main/java/com/netflix/titus/master/loadbalancer/service/DefaultLoadBalancerService.java"}, "focal_method": {"identifier": "events", "parameters": "()", "modifiers": "@VisibleForTesting", "return": "Observable<Batch<TargetStateBatchable, String>>", "body": "@VisibleForTesting\n    Observable<Batch<TargetStateBatchable, String>> events() {\n        return engine.events();\n    }", "signature": "Observable<Batch<TargetStateBatchable, String>> events()", "full_signature": "@VisibleForTesting Observable<Batch<TargetStateBatchable, String>> events()", "class_method_signature": "DefaultLoadBalancerService.events()", "testcase": false, "constructor": false, "invocations": ["events"]}, "repository": {"repo_id": 107330274, "url": "https://github.com/Netflix/titus-control-plane", "stars": 241, "created": "10/17/2017 10:20:55 PM +00:00", "updates": "2020-01-25T13:01:05+00:00", "fork": "False", "license": "licensed"}}