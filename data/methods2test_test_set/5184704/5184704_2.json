{"test_class": {"identifier": "HandshakeResponseTest", "superclass": "", "interfaces": "", "fields": [], "file": "src/com/github/mpjct/jmpjct/mysql/proto/HandshakeResponseTest.java"}, "test_case": {"identifier": "test_5_6_6", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void test_5_6_6() {\n        // https://dev.mysql.com/doc/internals/en/connection-phase-packets.html#packet-Protocol::HandshakeResponse\n        byte[] packet = new byte[] {\n            (byte)0xb2, (byte)0x00, (byte)0x00, (byte)0x01, (byte)0x85, (byte)0xa2, (byte)0x1e, (byte)0x00,\n            (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x40, (byte)0x08, (byte)0x00, (byte)0x00, (byte)0x00,\n            (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00,\n            (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00,\n            (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x72, (byte)0x6f, (byte)0x6f, (byte)0x74,\n            (byte)0x00, (byte)0x14, (byte)0x22, (byte)0x50, (byte)0x79, (byte)0xa2, (byte)0x12, (byte)0xd4,\n            (byte)0xe8, (byte)0x82, (byte)0xe5, (byte)0xb3, (byte)0xf4, (byte)0x1a, (byte)0x97, (byte)0x75,\n            (byte)0x6b, (byte)0xc8, (byte)0xbe, (byte)0xdb, (byte)0x9f, (byte)0x80, (byte)0x6d, (byte)0x79,\n            (byte)0x73, (byte)0x71, (byte)0x6c, (byte)0x5f, (byte)0x6e, (byte)0x61, (byte)0x74, (byte)0x69,\n            (byte)0x76, (byte)0x65, (byte)0x5f, (byte)0x70, (byte)0x61, (byte)0x73, (byte)0x73, (byte)0x77,\n            (byte)0x6f, (byte)0x72, (byte)0x64, (byte)0x00, (byte)0x61, (byte)0x03, (byte)0x5f, (byte)0x6f,\n            (byte)0x73, (byte)0x09, (byte)0x64, (byte)0x65, (byte)0x62, (byte)0x69, (byte)0x61, (byte)0x6e,\n            (byte)0x36, (byte)0x2e, (byte)0x30, (byte)0x0c, (byte)0x5f, (byte)0x63, (byte)0x6c, (byte)0x69,\n            (byte)0x65, (byte)0x6e, (byte)0x74, (byte)0x5f, (byte)0x6e, (byte)0x61, (byte)0x6d, (byte)0x65,\n            (byte)0x08, (byte)0x6c, (byte)0x69, (byte)0x62, (byte)0x6d, (byte)0x79, (byte)0x73, (byte)0x71,\n            (byte)0x6c, (byte)0x04, (byte)0x5f, (byte)0x70, (byte)0x69, (byte)0x64, (byte)0x05, (byte)0x32,\n            (byte)0x32, (byte)0x33, (byte)0x34, (byte)0x34, (byte)0x0f, (byte)0x5f, (byte)0x63, (byte)0x6c,\n            (byte)0x69, (byte)0x65, (byte)0x6e, (byte)0x74, (byte)0x5f, (byte)0x76, (byte)0x65, (byte)0x72,\n            (byte)0x73, (byte)0x69, (byte)0x6f, (byte)0x6e, (byte)0x08, (byte)0x35, (byte)0x2e, (byte)0x36,\n            (byte)0x2e, (byte)0x36, (byte)0x2d, (byte)0x6d, (byte)0x39, (byte)0x09, (byte)0x5f, (byte)0x70,\n            (byte)0x6c, (byte)0x61, (byte)0x74, (byte)0x66, (byte)0x6f, (byte)0x72, (byte)0x6d, (byte)0x06,\n            (byte)0x78, (byte)0x38, (byte)0x36, (byte)0x5f, (byte)0x36, (byte)0x34, (byte)0x03, (byte)0x66,\n            (byte)0x6f, (byte)0x6f, (byte)0x03, (byte)0x62, (byte)0x61, (byte)0x72\n        };\n        assertArrayEquals(packet, HandshakeResponse.loadFromPacket(packet).toPacket());\n    }", "signature": "void test_5_6_6()", "full_signature": "@Test public void test_5_6_6()", "class_method_signature": "HandshakeResponseTest.test_5_6_6()", "testcase": true, "constructor": false, "invocations": ["assertArrayEquals", "toPacket", "loadFromPacket"]}, "focal_class": {"identifier": "HandshakeResponse", "superclass": "extends Packet", "interfaces": "", "fields": [{"original_string": "public long capabilityFlags = Flags.CLIENT_PROTOCOL_41;", "modifier": "public", "type": "long", "declarator": "capabilityFlags = Flags.CLIENT_PROTOCOL_41", "var_name": "capabilityFlags"}, {"original_string": "public long maxPacketSize = 0;", "modifier": "public", "type": "long", "declarator": "maxPacketSize = 0", "var_name": "maxPacketSize"}, {"original_string": "public long characterSet = 0;", "modifier": "public", "type": "long", "declarator": "characterSet = 0", "var_name": "characterSet"}, {"original_string": "public String username = \"\";", "modifier": "public", "type": "String", "declarator": "username = \"\"", "var_name": "username"}, {"original_string": "public long authResponseLen = 0;", "modifier": "public", "type": "long", "declarator": "authResponseLen = 0", "var_name": "authResponseLen"}, {"original_string": "public String authResponse = \"\";", "modifier": "public", "type": "String", "declarator": "authResponse = \"\"", "var_name": "authResponse"}, {"original_string": "public String schema = \"\";", "modifier": "public", "type": "String", "declarator": "schema = \"\"", "var_name": "schema"}, {"original_string": "public String pluginName = \"\";", "modifier": "public", "type": "String", "declarator": "pluginName = \"\"", "var_name": "pluginName"}, {"original_string": "public long clientAttributesLen = 0;", "modifier": "public", "type": "long", "declarator": "clientAttributesLen = 0", "var_name": "clientAttributesLen"}, {"original_string": "public String clientAttributes = \"\";", "modifier": "public", "type": "String", "declarator": "clientAttributes = \"\"", "var_name": "clientAttributes"}], "methods": [{"identifier": "setCapabilityFlag", "parameters": "(long flag)", "modifiers": "public", "return": "void", "signature": "void setCapabilityFlag(long flag)", "full_signature": "public void setCapabilityFlag(long flag)", "class_method_signature": "HandshakeResponse.setCapabilityFlag(long flag)", "testcase": false, "constructor": false}, {"identifier": "removeCapabilityFlag", "parameters": "(long flag)", "modifiers": "public", "return": "void", "signature": "void removeCapabilityFlag(long flag)", "full_signature": "public void removeCapabilityFlag(long flag)", "class_method_signature": "HandshakeResponse.removeCapabilityFlag(long flag)", "testcase": false, "constructor": false}, {"identifier": "toggleCapabilityFlag", "parameters": "(long flag)", "modifiers": "public", "return": "void", "signature": "void toggleCapabilityFlag(long flag)", "full_signature": "public void toggleCapabilityFlag(long flag)", "class_method_signature": "HandshakeResponse.toggleCapabilityFlag(long flag)", "testcase": false, "constructor": false}, {"identifier": "hasCapabilityFlag", "parameters": "(long flag)", "modifiers": "public", "return": "boolean", "signature": "boolean hasCapabilityFlag(long flag)", "full_signature": "public boolean hasCapabilityFlag(long flag)", "class_method_signature": "HandshakeResponse.hasCapabilityFlag(long flag)", "testcase": false, "constructor": false}, {"identifier": "getPayload", "parameters": "()", "modifiers": "public", "return": "ArrayList<byte[]>", "signature": "ArrayList<byte[]> getPayload()", "full_signature": "public ArrayList<byte[]> getPayload()", "class_method_signature": "HandshakeResponse.getPayload()", "testcase": false, "constructor": false}, {"identifier": "loadFromPacket", "parameters": "(byte[] packet)", "modifiers": "public static", "return": "HandshakeResponse", "signature": "HandshakeResponse loadFromPacket(byte[] packet)", "full_signature": "public static HandshakeResponse loadFromPacket(byte[] packet)", "class_method_signature": "HandshakeResponse.loadFromPacket(byte[] packet)", "testcase": false, "constructor": false}], "file": "src/com/github/mpjct/jmpjct/mysql/proto/HandshakeResponse.java"}, "focal_method": {"identifier": "loadFromPacket", "parameters": "(byte[] packet)", "modifiers": "public static", "return": "HandshakeResponse", "body": "public static HandshakeResponse loadFromPacket(byte[] packet) {\n        HandshakeResponse obj = new HandshakeResponse();\n        Proto proto = new Proto(packet, 3);\n        \n        obj.sequenceId = proto.get_fixed_int(1);\n        obj.capabilityFlags = proto.get_fixed_int(2);\n        proto.offset -= 2;\n        \n        if (obj.hasCapabilityFlag(Flags.CLIENT_PROTOCOL_41)) {\n            obj.capabilityFlags = proto.get_fixed_int(4);\n            obj.maxPacketSize = proto.get_fixed_int(4);\n            obj.characterSet = proto.get_fixed_int(1);\n            proto.get_filler(23);\n            obj.username = proto.get_null_str();\n            \n            if (obj.hasCapabilityFlag(Flags.CLIENT_PLUGIN_AUTH_LENENC_CLIENT_DATA)) {\n                obj.authResponseLen = proto.get_lenenc_int();\n                obj.authResponse = proto.get_fixed_str(obj.authResponseLen, true);\n            }\n            else  {\n                if (obj.hasCapabilityFlag(Flags.CLIENT_SECURE_CONNECTION)) {\n                    obj.authResponseLen = proto.get_fixed_int(1);\n                    obj.authResponse = proto.get_fixed_str(obj.authResponseLen, true);\n                }\n                else {\n                    obj.authResponse = proto.get_null_str();\n                }\n            }\n            \n            if (obj.hasCapabilityFlag(Flags.CLIENT_CONNECT_WITH_DB))\n                obj.schema = proto.get_null_str();\n            \n            if (obj.hasCapabilityFlag(Flags.CLIENT_PLUGIN_AUTH))\n                obj.pluginName = proto.get_null_str();\n                \n            if (obj.hasCapabilityFlag(Flags.CLIENT_CONNECT_ATTRS)) {\n                obj.clientAttributesLen = proto.get_lenenc_int();\n                obj.clientAttributes = proto.get_eop_str();\n            }\n        }\n        else {\n            obj.capabilityFlags = proto.get_fixed_int(2);\n            obj.maxPacketSize = proto.get_fixed_int(3);\n            obj.username = proto.get_null_str();\n            \n            if (obj.hasCapabilityFlag(Flags.CLIENT_CONNECT_WITH_DB)) {\n                obj.authResponse = proto.get_null_str();\n                obj.schema = proto.get_null_str();\n            }\n            else\n                obj.authResponse = proto.get_eop_str();\n        }\n        \n        return obj;\n    }", "signature": "HandshakeResponse loadFromPacket(byte[] packet)", "full_signature": "public static HandshakeResponse loadFromPacket(byte[] packet)", "class_method_signature": "HandshakeResponse.loadFromPacket(byte[] packet)", "testcase": false, "constructor": false, "invocations": ["get_fixed_int", "get_fixed_int", "hasCapabilityFlag", "get_fixed_int", "get_fixed_int", "get_fixed_int", "get_filler", "get_null_str", "hasCapabilityFlag", "get_lenenc_int", "get_fixed_str", "hasCapabilityFlag", "get_fixed_int", "get_fixed_str", "get_null_str", "hasCapabilityFlag", "get_null_str", "hasCapabilityFlag", "get_null_str", "hasCapabilityFlag", "get_lenenc_int", "get_eop_str", "get_fixed_int", "get_fixed_int", "get_null_str", "hasCapabilityFlag", "get_null_str", "get_null_str", "get_eop_str"]}, "repository": {"repo_id": 5184704, "url": "https://github.com/MPjct/JMPjct", "language": "Java", "is_fork": false, "fork_count": 52, "stargazer_count": 81, "size": 16233, "license": "licensed"}}