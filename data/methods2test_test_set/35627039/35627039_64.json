{"test_class": {"identifier": "NotifierInfoCatalogResourceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "NotifierInfoCatalogResource resource;", "modifier": "", "type": "NotifierInfoCatalogResource", "declarator": "resource", "var_name": "resource"}, {"original_string": "@Injectable\n    StreamCatalogService mockCatalogService;", "modifier": "@Injectable", "type": "StreamCatalogService", "declarator": "mockCatalogService", "var_name": "mockCatalogService"}, {"original_string": "@Injectable\n    UriInfo mockUriInfo;", "modifier": "@Injectable", "type": "UriInfo", "declarator": "mockUriInfo", "var_name": "mockUriInfo"}, {"original_string": "@Injectable\n    FileStorage mockFileStorage;", "modifier": "@Injectable", "type": "FileStorage", "declarator": "mockFileStorage", "var_name": "mockFileStorage"}, {"original_string": "@Injectable\n    InputStream mockInputStream;", "modifier": "@Injectable", "type": "InputStream", "declarator": "mockInputStream", "var_name": "mockInputStream"}, {"original_string": "@Injectable\n    FormDataContentDisposition mockFormDataContentDisposition;", "modifier": "@Injectable", "type": "FormDataContentDisposition", "declarator": "mockFormDataContentDisposition", "var_name": "mockFormDataContentDisposition"}, {"original_string": "@Injectable\n    FormDataBodyPart mockFormDataBodyPart;", "modifier": "@Injectable", "type": "FormDataBodyPart", "declarator": "mockFormDataBodyPart", "var_name": "mockFormDataBodyPart"}, {"original_string": "MultivaluedMap<String, String> multiValuedMap;", "modifier": "", "type": "MultivaluedMap<String, String>", "declarator": "multiValuedMap", "var_name": "multiValuedMap"}, {"original_string": "@Injectable\n    StreamlineAuthorizer authorizer = new NoopAuthorizer();", "modifier": "@Injectable", "type": "StreamlineAuthorizer", "declarator": "authorizer = new NoopAuthorizer()", "var_name": "authorizer"}, {"original_string": "@Injectable\n    SecurityContext securityContext;", "modifier": "@Injectable", "type": "SecurityContext", "declarator": "securityContext", "var_name": "securityContext"}], "file": "streams/service/src/test/java/com/hortonworks/streamline/streams/service/NotifierInfoCatalogResourceTest.java"}, "test_case": {"identifier": "testAddNotifier", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testAddNotifier() throws Exception {\n        final Notifier notifier = new Notifier();\n        notifier.setName(\"test\");\n        new Expectations() {\n            {\n                mockCatalogService.addNotifierInfo(notifier);times=1;\n                result = notifier;\n                mockFormDataBodyPart.getMediaType();\n                result = APPLICATION_JSON_TYPE;\n                mockFormDataBodyPart.getValueAs(Notifier.class);\n                result = notifier;\n                mockFileStorage.upload(mockInputStream, anyString);\n                result = \"uploadedPath\";\n\n            }\n        };\n\n        Notifier result = (Notifier) resource.addNotifier(\n                mockInputStream,\n                mockFormDataContentDisposition,\n                mockFormDataBodyPart,\n                securityContext).getEntity();\n\n        assertEquals(notifier, result);\n    }", "signature": "void testAddNotifier()", "full_signature": "@Test public void testAddNotifier()", "class_method_signature": "NotifierInfoCatalogResourceTest.testAddNotifier()", "testcase": true, "constructor": false, "invocations": ["setName", "addNotifierInfo", "getMediaType", "getValueAs", "upload", "getEntity", "addNotifier", "assertEquals"]}, "focal_class": {"identifier": "NotifierInfoCatalogResource", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOG = LoggerFactory.getLogger(NotifierInfoCatalogResource.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(NotifierInfoCatalogResource.class)", "var_name": "LOG"}, {"original_string": "private final StreamlineAuthorizer authorizer;", "modifier": "private final", "type": "StreamlineAuthorizer", "declarator": "authorizer", "var_name": "authorizer"}, {"original_string": "private final StreamCatalogService catalogService;", "modifier": "private final", "type": "StreamCatalogService", "declarator": "catalogService", "var_name": "catalogService"}, {"original_string": "private final FileStorage fileStorage;", "modifier": "private final", "type": "FileStorage", "declarator": "fileStorage", "var_name": "fileStorage"}], "methods": [{"identifier": "NotifierInfoCatalogResource", "parameters": "(StreamlineAuthorizer authorizer, StreamCatalogService catalogService, FileStorage fileStorage)", "modifiers": "public", "return": "", "signature": " NotifierInfoCatalogResource(StreamlineAuthorizer authorizer, StreamCatalogService catalogService, FileStorage fileStorage)", "full_signature": "public  NotifierInfoCatalogResource(StreamlineAuthorizer authorizer, StreamCatalogService catalogService, FileStorage fileStorage)", "class_method_signature": "NotifierInfoCatalogResource.NotifierInfoCatalogResource(StreamlineAuthorizer authorizer, StreamCatalogService catalogService, FileStorage fileStorage)", "testcase": false, "constructor": true}, {"identifier": "listNotifiers", "parameters": "(@Context UriInfo uriInfo, @Context SecurityContext securityContext)", "modifiers": "@GET @Path(\"/notifiers\") @Timed public", "return": "Response", "signature": "Response listNotifiers(@Context UriInfo uriInfo, @Context SecurityContext securityContext)", "full_signature": "@GET @Path(\"/notifiers\") @Timed public Response listNotifiers(@Context UriInfo uriInfo, @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.listNotifiers(@Context UriInfo uriInfo, @Context SecurityContext securityContext)", "testcase": false, "constructor": false}, {"identifier": "getNotifierById", "parameters": "(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "modifiers": "@GET @Path(\"/notifiers/{id}\") @Timed public", "return": "Response", "signature": "Response getNotifierById(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "full_signature": "@GET @Path(\"/notifiers/{id}\") @Timed public Response getNotifierById(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.getNotifierById(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "testcase": false, "constructor": false}, {"identifier": "addNotifier", "parameters": "(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "modifiers": "@POST @Consumes(MediaType.MULTIPART_FORM_DATA) @Path(\"/notifiers\") @Timed public", "return": "Response", "signature": "Response addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "full_signature": "@POST @Consumes(MediaType.MULTIPART_FORM_DATA) @Path(\"/notifiers\") @Timed public Response addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "testcase": false, "constructor": false}, {"identifier": "removeNotifierInfo", "parameters": "(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "modifiers": "@DELETE @Path(\"/notifiers/{id}\") @Timed public", "return": "Response", "signature": "Response removeNotifierInfo(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "full_signature": "@DELETE @Path(\"/notifiers/{id}\") @Timed public Response removeNotifierInfo(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.removeNotifierInfo(@PathParam(\"id\") Long id, @Context SecurityContext securityContext)", "testcase": false, "constructor": false}, {"identifier": "addOrUpdateNotifierInfo", "parameters": "(@PathParam(\"id\") Long id,\n                                            @FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                            @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                            @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                            @Context SecurityContext securityContext)", "modifiers": "@PUT @Consumes(MediaType.MULTIPART_FORM_DATA) @Path(\"/notifiers/{id}\") @Timed public", "return": "Response", "signature": "Response addOrUpdateNotifierInfo(@PathParam(\"id\") Long id,\n                                            @FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                            @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                            @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                            @Context SecurityContext securityContext)", "full_signature": "@PUT @Consumes(MediaType.MULTIPART_FORM_DATA) @Path(\"/notifiers/{id}\") @Timed public Response addOrUpdateNotifierInfo(@PathParam(\"id\") Long id,\n                                            @FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                            @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                            @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                            @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.addOrUpdateNotifierInfo(@PathParam(\"id\") Long id,\n                                            @FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                            @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                            @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                            @Context SecurityContext securityContext)", "testcase": false, "constructor": false}, {"identifier": "downloadNotifier", "parameters": "(@PathParam(\"notifierId\") Long notifierId, @Context SecurityContext securityContext)", "modifiers": "@Timed @GET @Produces({\"application/java-archive\", \"application/json\"}) @Path(\"/notifiers/download/{notifierId}\") public", "return": "Response", "signature": "Response downloadNotifier(@PathParam(\"notifierId\") Long notifierId, @Context SecurityContext securityContext)", "full_signature": "@Timed @GET @Produces({\"application/java-archive\", \"application/json\"}) @Path(\"/notifiers/download/{notifierId}\") public Response downloadNotifier(@PathParam(\"notifierId\") Long notifierId, @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.downloadNotifier(@PathParam(\"notifierId\") Long notifierId, @Context SecurityContext securityContext)", "testcase": false, "constructor": false}, {"identifier": "uploadJar", "parameters": "(InputStream is, String notifierName)", "modifiers": "private", "return": "String", "signature": "String uploadJar(InputStream is, String notifierName)", "full_signature": "private String uploadJar(InputStream is, String notifierName)", "class_method_signature": "NotifierInfoCatalogResource.uploadJar(InputStream is, String notifierName)", "testcase": false, "constructor": false}], "file": "streams/service/src/main/java/com/hortonworks/streamline/streams/service/NotifierInfoCatalogResource.java"}, "focal_method": {"identifier": "addNotifier", "parameters": "(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "modifiers": "@POST @Consumes(MediaType.MULTIPART_FORM_DATA) @Path(\"/notifiers\") @Timed public", "return": "Response", "body": "@POST\n    @Consumes(MediaType.MULTIPART_FORM_DATA)\n    @Path(\"/notifiers\")\n    @Timed\n    public Response addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext) throws IOException {\n        SecurityUtil.checkRole(authorizer, securityContext, Roles.ROLE_NOTIFIER_ADMIN);\n        MediaType mediaType = notifierConfig.getMediaType();\n        LOG.debug(\"Media type {}\", mediaType);\n        if (!mediaType.equals(MediaType.APPLICATION_JSON_TYPE)) {\n            throw new UnsupportedMediaTypeException(mediaType.toString());\n        }\n        Notifier notifier = notifierConfig.getValueAs(Notifier.class);\n        Collection<Notifier> existing = null;\n        existing = catalogService.listNotifierInfos(Collections.singletonList(new QueryParam(Notifier.NOTIFIER_NAME, notifier.getName())));\n        if (existing != null && !existing.isEmpty()) {\n            LOG.warn(\"Received a post request for an already registered notifier. Not creating entity for \" + notifier);\n            return WSUtils.respondEntity(notifier, CONFLICT);\n        }\n        String jarFileName = uploadJar(inputStream, notifier.getName());\n        notifier.setJarFileName(jarFileName);\n        Notifier createdNotifier = catalogService.addNotifierInfo(notifier);\n        SecurityUtil.addAcl(authorizer, securityContext, Notifier.NAMESPACE, createdNotifier.getId(),\n                EnumSet.allOf(Permission.class));\n        return WSUtils.respondEntity(createdNotifier, CREATED);\n    }", "signature": "Response addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "full_signature": "@POST @Consumes(MediaType.MULTIPART_FORM_DATA) @Path(\"/notifiers\") @Timed public Response addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "class_method_signature": "NotifierInfoCatalogResource.addNotifier(@FormDataParam(\"notifierJarFile\") final InputStream inputStream,\n                                @FormDataParam(\"notifierJarFile\") final FormDataContentDisposition contentDispositionHeader,\n                                @FormDataParam(\"notifierConfig\") final FormDataBodyPart notifierConfig,\n                                @Context SecurityContext securityContext)", "testcase": false, "constructor": false, "invocations": ["checkRole", "getMediaType", "debug", "equals", "toString", "getValueAs", "listNotifierInfos", "singletonList", "getName", "isEmpty", "warn", "respondEntity", "uploadJar", "getName", "setJarFileName", "addNotifierInfo", "addAcl", "getId", "allOf", "respondEntity"]}, "repository": {"repo_id": 35627039, "url": "https://github.com/hortonworks/streamline", "language": "Java", "is_fork": false, "fork_count": 94, "stargazer_count": 147, "size": 69226, "license": "licensed"}}