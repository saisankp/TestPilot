{"test_class": {"identifier": "ScriptRunnerTest", "superclass": "extends TestCase", "interfaces": "", "fields": [], "file": "medium/src/test/java/net/sourceforge/cruisecontrol/builders/ScriptRunnerTest.java"}, "test_case": {"identifier": "testClearOutputLoggerFileAtEndOfScript", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testClearOutputLoggerFileAtEndOfScript() throws Exception {\n\n        final String logFilename = \"logFilename-\" + getName();\n        final File outputLog = new File(TestUtil.getTargetDir(), logFilename);\n        assertFalse(outputLog.exists());\n\n        final MockCommandline mockCommandline = new MockCommandline();\n        mockCommandline.setAssertCorrectCommandline(false);\n\n        mockCommandline.setProcessInputStream(\n                // need to provide some output to ensure StreamPumper threads have some work to do\n                new ByteArrayInputStream(\"some stuff\\nmore stuff\\n\".getBytes()));\n\n        mockCommandline.setProcessErrorStream(new ByteArrayInputStream(\"\".getBytes()));\n\n        final Script dummyScript = new Script() {\n\n            public Commandline buildCommandline() throws CruiseControlException {\n                return mockCommandline;\n            }\n\n            public void setExitCode(int result) {\n            }\n\n            public int getExitCode() {\n                return 0;\n            }\n        };\n\n        final ScriptRunner sr = new ScriptRunner();\n\n        final TestBuilder builder = new TestBuilder();\n\n        final String projectName = \"testProjectName\";\n\n        final BuildOutputLogger buildOutputLogger = builder.getBuildOutputConsumer(projectName,\n                outputLog.getParentFile(), outputLog.getName());\n        final String origId = buildOutputLogger.getID();\n\n        sr.runScript(TestUtil.getTargetDir(), dummyScript, ScriptRunner.NO_TIMEOUT, buildOutputLogger);\n\n        assertFalse(\"LiveOutput log should be cleared at end of script run: \" + outputLog.getAbsolutePath(),\n                outputLog.exists());\n\n        final String currentId = buildOutputLogger.getID();\n        assertTrue(\"buildOutputLogger id should change due to clear() at end of script run. origId: \" + origId\n                + \"; current Id: \" + currentId,\n                currentId.startsWith(origId) && (currentId.length() > origId.length()));\n    }", "signature": "void testClearOutputLoggerFileAtEndOfScript()", "full_signature": "@Test public void testClearOutputLoggerFileAtEndOfScript()", "class_method_signature": "ScriptRunnerTest.testClearOutputLoggerFileAtEndOfScript()", "testcase": true, "constructor": false, "invocations": ["getName", "getTargetDir", "assertFalse", "exists", "setAssertCorrectCommandline", "setProcessInputStream", "getBytes", "setProcessErrorStream", "getBytes", "getBuildOutputConsumer", "getParentFile", "getName", "getID", "runScript", "getTargetDir", "assertFalse", "getAbsolutePath", "exists", "getID", "assertTrue", "startsWith", "length", "length"]}, "focal_class": {"identifier": "ScriptRunner", "superclass": "", "interfaces": "", "fields": [{"original_string": "static final Logger LOG = Logger.getLogger(ScriptRunner.class);", "modifier": "static final", "type": "Logger", "declarator": "LOG = Logger.getLogger(ScriptRunner.class)", "var_name": "LOG"}, {"original_string": "public static final long NO_TIMEOUT = -1;", "modifier": "public static final", "type": "long", "declarator": "NO_TIMEOUT = -1", "var_name": "NO_TIMEOUT"}], "methods": [{"identifier": "runScript", "parameters": "(final File workingDir, final Script script, final long timeout)", "modifiers": "public", "return": "boolean", "signature": "boolean runScript(final File workingDir, final Script script, final long timeout)", "full_signature": "public boolean runScript(final File workingDir, final Script script, final long timeout)", "class_method_signature": "ScriptRunner.runScript(final File workingDir, final Script script, final long timeout)", "testcase": false, "constructor": false}, {"identifier": "runScript", "parameters": "(final File workingDir, final Script script, final long timeout,\n                             final BuildOutputLogger buildOutputConsumer)", "modifiers": "public", "return": "boolean", "signature": "boolean runScript(final File workingDir, final Script script, final long timeout,\n                             final BuildOutputLogger buildOutputConsumer)", "full_signature": "public boolean runScript(final File workingDir, final Script script, final long timeout,\n                             final BuildOutputLogger buildOutputConsumer)", "class_method_signature": "ScriptRunner.runScript(final File workingDir, final Script script, final long timeout,\n                             final BuildOutputLogger buildOutputConsumer)", "testcase": false, "constructor": false}, {"identifier": "runScript", "parameters": "(final File workingDir, final Script script, final long timeout,\n                             final InputStream scriptInputProvider, final BuildOutputLogger buildOutputConsumer)", "modifiers": "public", "return": "boolean", "signature": "boolean runScript(final File workingDir, final Script script, final long timeout,\n                             final InputStream scriptInputProvider, final BuildOutputLogger buildOutputConsumer)", "full_signature": "public boolean runScript(final File workingDir, final Script script, final long timeout,\n                             final InputStream scriptInputProvider, final BuildOutputLogger buildOutputConsumer)", "class_method_signature": "ScriptRunner.runScript(final File workingDir, final Script script, final long timeout,\n                             final InputStream scriptInputProvider, final BuildOutputLogger buildOutputConsumer)", "testcase": false, "constructor": false}, {"identifier": "runScript", "parameters": "(Script script, long timeout, BuildOutputLogger logger)", "modifiers": "public", "return": "boolean", "signature": "boolean runScript(Script script, long timeout, BuildOutputLogger logger)", "full_signature": "public boolean runScript(Script script, long timeout, BuildOutputLogger logger)", "class_method_signature": "ScriptRunner.runScript(Script script, long timeout, BuildOutputLogger logger)", "testcase": false, "constructor": false}, {"identifier": "getOutPumper", "parameters": "(final Process p, final StreamConsumer consumer)", "modifiers": "", "return": "StreamPumper", "signature": "StreamPumper getOutPumper(final Process p, final StreamConsumer consumer)", "full_signature": " StreamPumper getOutPumper(final Process p, final StreamConsumer consumer)", "class_method_signature": "ScriptRunner.getOutPumper(final Process p, final StreamConsumer consumer)", "testcase": false, "constructor": false}, {"identifier": "getErrPumper", "parameters": "(final Process p, final StreamConsumer consumer)", "modifiers": "", "return": "StreamPumper", "signature": "StreamPumper getErrPumper(final Process p, final StreamConsumer consumer)", "full_signature": " StreamPumper getErrPumper(final Process p, final StreamConsumer consumer)", "class_method_signature": "ScriptRunner.getErrPumper(final Process p, final StreamConsumer consumer)", "testcase": false, "constructor": false}, {"identifier": "getDirectOutLogger", "parameters": "()", "modifiers": "", "return": "StreamConsumer", "signature": "StreamConsumer getDirectOutLogger()", "full_signature": " StreamConsumer getDirectOutLogger()", "class_method_signature": "ScriptRunner.getDirectOutLogger()", "testcase": false, "constructor": false}, {"identifier": "getDirectErrLogger", "parameters": "()", "modifiers": "", "return": "StreamConsumer", "signature": "StreamConsumer getDirectErrLogger()", "full_signature": " StreamConsumer getDirectErrLogger()", "class_method_signature": "ScriptRunner.getDirectErrLogger()", "testcase": false, "constructor": false}, {"identifier": "letConsumeOut", "parameters": "()", "modifiers": "", "return": "boolean", "signature": "boolean letConsumeOut()", "full_signature": " boolean letConsumeOut()", "class_method_signature": "ScriptRunner.letConsumeOut()", "testcase": false, "constructor": false}, {"identifier": "letConsumeErr", "parameters": "()", "modifiers": "", "return": "boolean", "signature": "boolean letConsumeErr()", "full_signature": " boolean letConsumeErr()", "class_method_signature": "ScriptRunner.letConsumeErr()", "testcase": false, "constructor": false}], "file": "medium/src/main/java/net/sourceforge/cruisecontrol/builders/ScriptRunner.java"}, "focal_method": {"identifier": "runScript", "parameters": "(final File workingDir, final Script script, final long timeout)", "modifiers": "public", "return": "boolean", "body": "public boolean runScript(final File workingDir, final Script script, final long timeout)\n            throws CruiseControlException {\n        return runScript(workingDir, script, timeout, null, null);\n    }", "signature": "boolean runScript(final File workingDir, final Script script, final long timeout)", "full_signature": "public boolean runScript(final File workingDir, final Script script, final long timeout)", "class_method_signature": "ScriptRunner.runScript(final File workingDir, final Script script, final long timeout)", "testcase": false, "constructor": false, "invocations": ["runScript"]}, "repository": {"repo_id": 2310387, "url": "https://github.com/builddoctor/JavaBuildComparison", "language": "Java", "is_fork": false, "fork_count": 2, "stargazer_count": 6, "size": 14939, "license": "licensed"}}