{"test_class": {"identifier": "ValidatorsTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "@Rule public TemporaryFolder tmpFolder = new TemporaryFolder();", "modifier": "@Rule public", "type": "TemporaryFolder", "declarator": "tmpFolder = new TemporaryFolder()", "var_name": "tmpFolder"}], "file": "java_src/src/test/java/com/google/crypto/tink/subtle/ValidatorsTest.java"}, "test_case": {"identifier": "testValidateSignatureHash", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n  public void testValidateSignatureHash() throws Exception {\n    try {\n      Validators.validateSignatureHash(HashType.SHA256);\n      Validators.validateSignatureHash(HashType.SHA512);\n    } catch (GeneralSecurityException e) {\n      fail(\"Valid signature algorithm should work \" + e);\n    }\n    try {\n      Validators.validateSignatureHash(HashType.SHA1);\n      fail(\"Expected GeneralSecurityException\");\n    } catch (GeneralSecurityException e) {\n      TestUtil.assertExceptionContains(e, \"Unsupported hash: SHA1\");\n    }\n  }", "signature": "void testValidateSignatureHash()", "full_signature": "@Test public void testValidateSignatureHash()", "class_method_signature": "ValidatorsTest.testValidateSignatureHash()", "testcase": true, "constructor": false, "invocations": ["validateSignatureHash", "validateSignatureHash", "fail", "validateSignatureHash", "fail", "assertExceptionContains"]}, "focal_class": {"identifier": "Validators", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String TYPE_URL_PREFIX = \"type.googleapis.com/\";", "modifier": "private static final", "type": "String", "declarator": "TYPE_URL_PREFIX = \"type.googleapis.com/\"", "var_name": "TYPE_URL_PREFIX"}, {"original_string": "private static final int MIN_RSA_MODULUS_SIZE = 2048;", "modifier": "private static final", "type": "int", "declarator": "MIN_RSA_MODULUS_SIZE = 2048", "var_name": "MIN_RSA_MODULUS_SIZE"}, {"original_string": "private static final String URI_UNRESERVED_CHARS = \"([0-9a-zA-Z\\\\-\\\\.\\\\_~])+\";", "modifier": "private static final", "type": "String", "declarator": "URI_UNRESERVED_CHARS = \"([0-9a-zA-Z\\\\-\\\\.\\\\_~])+\"", "var_name": "URI_UNRESERVED_CHARS"}, {"original_string": "private static final Pattern GCP_KMS_CRYPTO_KEY_PATTERN =\n      Pattern.compile(\n          String.format(\n              \"^projects/%s/locations/%s/keyRings/%s/cryptoKeys/%s$\",\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS),\n          Pattern.CASE_INSENSITIVE);", "modifier": "private static final", "type": "Pattern", "declarator": "GCP_KMS_CRYPTO_KEY_PATTERN =\n      Pattern.compile(\n          String.format(\n              \"^projects/%s/locations/%s/keyRings/%s/cryptoKeys/%s$\",\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS),\n          Pattern.CASE_INSENSITIVE)", "var_name": "GCP_KMS_CRYPTO_KEY_PATTERN"}, {"original_string": "private static final Pattern GCP_KMS_CRYPTO_KEY_VERSION_PATTERN =\n      Pattern.compile(\n          String.format(\n              \"^projects/%s/locations/%s/keyRings/%s/cryptoKeys/%s/cryptoKeyVersions/%s$\",\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS),\n          Pattern.CASE_INSENSITIVE);", "modifier": "private static final", "type": "Pattern", "declarator": "GCP_KMS_CRYPTO_KEY_VERSION_PATTERN =\n      Pattern.compile(\n          String.format(\n              \"^projects/%s/locations/%s/keyRings/%s/cryptoKeys/%s/cryptoKeyVersions/%s$\",\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS,\n              URI_UNRESERVED_CHARS),\n          Pattern.CASE_INSENSITIVE)", "var_name": "GCP_KMS_CRYPTO_KEY_VERSION_PATTERN"}], "methods": [{"identifier": "Validators", "parameters": "()", "modifiers": "private", "return": "", "signature": " Validators()", "full_signature": "private  Validators()", "class_method_signature": "Validators.Validators()", "testcase": false, "constructor": true}, {"identifier": "validateTypeUrl", "parameters": "(String typeUrl)", "modifiers": "public static", "return": "void", "signature": "void validateTypeUrl(String typeUrl)", "full_signature": "public static void validateTypeUrl(String typeUrl)", "class_method_signature": "Validators.validateTypeUrl(String typeUrl)", "testcase": false, "constructor": false}, {"identifier": "validateAesKeySize", "parameters": "(int sizeInBytes)", "modifiers": "public static", "return": "void", "signature": "void validateAesKeySize(int sizeInBytes)", "full_signature": "public static void validateAesKeySize(int sizeInBytes)", "class_method_signature": "Validators.validateAesKeySize(int sizeInBytes)", "testcase": false, "constructor": false}, {"identifier": "validateVersion", "parameters": "(int candidate, int maxExpected)", "modifiers": "public static", "return": "void", "signature": "void validateVersion(int candidate, int maxExpected)", "full_signature": "public static void validateVersion(int candidate, int maxExpected)", "class_method_signature": "Validators.validateVersion(int candidate, int maxExpected)", "testcase": false, "constructor": false}, {"identifier": "validateSignatureHash", "parameters": "(HashType hash)", "modifiers": "public static", "return": "void", "signature": "void validateSignatureHash(HashType hash)", "full_signature": "public static void validateSignatureHash(HashType hash)", "class_method_signature": "Validators.validateSignatureHash(HashType hash)", "testcase": false, "constructor": false}, {"identifier": "validateRsaModulusSize", "parameters": "(int modulusSize)", "modifiers": "public static", "return": "void", "signature": "void validateRsaModulusSize(int modulusSize)", "full_signature": "public static void validateRsaModulusSize(int modulusSize)", "class_method_signature": "Validators.validateRsaModulusSize(int modulusSize)", "testcase": false, "constructor": false}, {"identifier": "validateRsaPublicExponent", "parameters": "(\n      BigInteger publicExponent)", "modifiers": "public static", "return": "void", "signature": "void validateRsaPublicExponent(\n      BigInteger publicExponent)", "full_signature": "public static void validateRsaPublicExponent(\n      BigInteger publicExponent)", "class_method_signature": "Validators.validateRsaPublicExponent(\n      BigInteger publicExponent)", "testcase": false, "constructor": false}, {"identifier": "validateNotExists", "parameters": "(File f)", "modifiers": "public static", "return": "void", "signature": "void validateNotExists(File f)", "full_signature": "public static void validateNotExists(File f)", "class_method_signature": "Validators.validateNotExists(File f)", "testcase": false, "constructor": false}, {"identifier": "validateExists", "parameters": "(File f)", "modifiers": "public static", "return": "void", "signature": "void validateExists(File f)", "full_signature": "public static void validateExists(File f)", "class_method_signature": "Validators.validateExists(File f)", "testcase": false, "constructor": false}, {"identifier": "validateKmsKeyUriAndRemovePrefix", "parameters": "(String expectedPrefix, String kmsKeyUri)", "modifiers": "public static", "return": "String", "signature": "String validateKmsKeyUriAndRemovePrefix(String expectedPrefix, String kmsKeyUri)", "full_signature": "public static String validateKmsKeyUriAndRemovePrefix(String expectedPrefix, String kmsKeyUri)", "class_method_signature": "Validators.validateKmsKeyUriAndRemovePrefix(String expectedPrefix, String kmsKeyUri)", "testcase": false, "constructor": false}, {"identifier": "validateCryptoKeyUri", "parameters": "(String kmsKeyUri)", "modifiers": "public static", "return": "void", "signature": "void validateCryptoKeyUri(String kmsKeyUri)", "full_signature": "public static void validateCryptoKeyUri(String kmsKeyUri)", "class_method_signature": "Validators.validateCryptoKeyUri(String kmsKeyUri)", "testcase": false, "constructor": false}], "file": "java_src/src/main/java/com/google/crypto/tink/subtle/Validators.java"}, "focal_method": {"identifier": "validateSignatureHash", "parameters": "(HashType hash)", "modifiers": "public static", "return": "void", "body": "public static void validateSignatureHash(HashType hash) throws GeneralSecurityException {\n    switch (hash) {\n      case SHA256: // fall through\n      case SHA384: // fall through\n      case SHA512:\n        return;\n      default:\n        break;\n    }\n    throw new GeneralSecurityException(\"Unsupported hash: \" + hash.name());\n  }", "signature": "void validateSignatureHash(HashType hash)", "full_signature": "public static void validateSignatureHash(HashType hash)", "class_method_signature": "Validators.validateSignatureHash(HashType hash)", "testcase": false, "constructor": false, "invocations": ["name"]}, "repository": {"repo_id": 20570214, "url": "https://github.com/google/tink", "stars": 8884, "created": "6/6/2014 4:21:09 PM +00:00", "updates": "2020-01-27T11:52:16+00:00", "fork": "False", "license": "licensed"}}