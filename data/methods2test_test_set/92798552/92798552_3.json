{"test_class": {"identifier": "Kv78ParserTest", "superclass": "", "interfaces": "", "fields": [], "file": "distribution/src/test/java/nl/crowndov/displaydirect/distribution/kv78/Kv78ParserTest.java"}, "test_case": {"identifier": "parseMessage", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void parseMessage() throws Exception {\n        String data = \"\\\\GKV8turbo_passtimes|KV8turbo_passtimes|openOV RETBUS|||UTF-8|0.1|2017-04-11T20:58:42+02:00|\\uFEFF\\r\\n\" +\n                \"\\\\TDATEDPASSTIME|DATEDPASSTIME|start object\\r\\n\" +\n                \"\\\\LDataOwnerCode|OperationDate|LinePlanningNumber|JourneyNumber|FortifyOrderNumber|UserStopOrderNumber|UserStopCode|LocalServiceLevelCode|JourneyPatternCode|LineDirection|LastUpdateTimeStamp|DestinationCode|IsTimingStop|ExpectedArrivalTime|ExpectedDepartureTime|TripStopStatus|MessageContent|MessageType|SideCode|NumberOfCoaches|WheelChairAccessible|OperatorCode|ReasonType|SubReasonType|ReasonContent|AdviceType|SubAdviceType|AdviceContent|TimingPointDataOwnerCode|TimingPointCode|JourneyStopType|TargetArrivalTime|TargetDepartureTime|RecordedArrivalTime|RecordedDepartureTime|DetectedUserStopCode|DistanceSinceDetectedUserStop|Detected_RD_X|Detected_RD_Y|VehicleNumber|BlockCode|LineVeTagNumber|VejoJourneyNumber|VehicleJourneyType|VejoBlockNumCode|JourneyModificationType|VejoDepartureTime|VejoArrivalTime|VejoTripStatusType\\r\\n\" +\n                \"RET|2017-04-11|820|613894|0|28|HA1017|2950991|190863|2|2017-04-11T20:58:41+02:00|TESC---|0|20:58:27|20:58:39|ARRIVED|\\\\0|\\\\0|-|1|UNKNOWN|\\\\0|\\\\0|\\\\0|\\\\0|\\\\0|\\\\0|\\\\0|ALGEMEEN|31001017|INTERMEDIATE|20:55:13|20:55:13|20:58:24|\\\\0|HA1017|515|92368|437750|2135|2024087|0|613894|DR|\\\\0|NONE|20:15:00|21:32:00|DRIVING\\r\\n\" +\n                \"RET|2017-04-11|820|613894|0|29|HA1018|2950991|190863|2|2017-04-11T20:58:41+02:00|TESC---|0|20:59:36|20:59:36|DRIVING|\\\\0|\\\\0|-|1|UNKNOWN|\\\\0|\\\\0|\\\\0|\\\\0|\\\\0|\\\\0|\\\\0|ALGEMEEN|31001018|INTERMEDIATE|20:56:11|20:56:11|\\\\0|\\\\0|HA1018|221|\\\\0|\\\\0|2135|2024087|0|613894|DR|\\\\0|NONE|20:15:00|21:32:00|DRIVING\\r\\n\";\n\n        Kv78Packet p = Kv78Parser.parseMessage(data);\n        Assert.assertEquals(\"KV8turbo_passtimes\", p.getType());\n        Assert.assertEquals(\"openOV RETBUS\", p.getComment());\n        Assert.assertEquals(\"UTF-8\", p.getEncoding());\n        Assert.assertEquals(\"0.1\", p.getVersion());\n        Assert.assertEquals(ZonedDateTime.parse(\"2017-04-11T20:58:42+02:00\"), p.getGenerated());\n\n        Assert.assertEquals(\"DATEDPASSTIME\", p.getTables().get(0).getTableName());\n        Assert.assertEquals(\"start object\", p.getTables().get(0).getTableComment());\n\n        Assert.assertEquals(2, p.getTables().get(0).getRecords().size());\n\n        Map<String, String> record = p.getTables().get(0).getRecords().get(0);\n        Assert.assertEquals(38, record.size());\n        Assert.assertEquals(\"RET\", record.get(\"DataOwnerCode\"));\n        Assert.assertEquals(\"2017-04-11\", record.get(\"OperationDate\"));\n        Assert.assertEquals(\"820\", record.get(\"LinePlanningNumber\"));\n        Assert.assertEquals(\"613894\", record.get(\"JourneyNumber\"));\n        Assert.assertEquals(\"0\", record.get(\"FortifyOrderNumber\"));\n        Assert.assertEquals(\"28\", record.get(\"UserStopOrderNumber\"));\n        Assert.assertEquals(\"HA1017\", record.get(\"UserStopCode\"));\n        Assert.assertEquals(\"2950991\", record.get(\"LocalServiceLevelCode\"));\n        Assert.assertEquals(\"190863\", record.get(\"JourneyPatternCode\"));\n        Assert.assertEquals(\"2\", record.get(\"LineDirection\"));\n        Assert.assertEquals(\"2017-04-11T20:58:41+02:00\", record.get(\"LastUpdateTimeStamp\"));\n        Assert.assertEquals(\"TESC---\", record.get(\"DestinationCode\"));\n        Assert.assertEquals(\"0\", record.get(\"IsTimingStop\"));\n        Assert.assertEquals(\"20:58:27\", record.get(\"ExpectedArrivalTime\"));\n        Assert.assertEquals(\"20:58:39\", record.get(\"ExpectedDepartureTime\"));\n        Assert.assertEquals(\"ARRIVED\", record.get(\"TripStopStatus\"));\n        Assert.assertEquals(\"-\", record.get(\"SideCode\"));\n        Assert.assertEquals(\"1\", record.get(\"NumberOfCoaches\"));\n        Assert.assertEquals(\"UNKNOWN\", record.get(\"WheelChairAccessible\"));\n        Assert.assertEquals(\"ALGEMEEN\", record.get(\"TimingPointDataOwnerCode\"));\n        Assert.assertEquals(\"31001017\", record.get(\"TimingPointCode\"));\n        Assert.assertEquals(\"INTERMEDIATE\", record.get(\"JourneyStopType\"));\n        Assert.assertEquals( \"20:55:13\", record.get(\"TargetArrivalTime\"));\n        Assert.assertEquals( \"20:55:13\", record.get(\"TargetDepartureTime\"));\n        Assert.assertEquals( \"20:58:24\", record.get(\"RecordedArrivalTime\"));\n        Assert.assertEquals( \"HA1017\", record.get(\"DetectedUserStopCode\"));\n        Assert.assertEquals( \"515\", record.get(\"DistanceSinceDetectedUserStop\"));\n        Assert.assertEquals( \"92368\", record.get(\"Detected_RD_X\"));\n        Assert.assertEquals( \"437750\", record.get(\"Detected_RD_Y\"));\n        Assert.assertEquals( \"2135\", record.get(\"VehicleNumber\"));\n        Assert.assertEquals( \"0\", record.get(\"LineVeTagNumber\"));\n        Assert.assertEquals( \"613894\", record.get(\"VejoJourneyNumber\"));\n        Assert.assertEquals( \"DR\", record.get(\"VehicleJourneyType\"));\n        Assert.assertEquals( \"NONE\", record.get(\"JourneyModificationType\"));\n        Assert.assertEquals( \"20:15:00\", record.get(\"VejoDepartureTime\"));\n        Assert.assertEquals( \"21:32:00\", record.get(\"VejoArrivalTime\"));\n        Assert.assertEquals( \"DRIVING\", record.get(\"VejoTripStatusType\"));\n    }", "signature": "void parseMessage()", "full_signature": "@Test public void parseMessage()", "class_method_signature": "Kv78ParserTest.parseMessage()", "testcase": true, "constructor": false, "invocations": ["parseMessage", "assertEquals", "getType", "assertEquals", "getComment", "assertEquals", "getEncoding", "assertEquals", "getVersion", "assertEquals", "parse", "getGenerated", "assertEquals", "getTableName", "get", "getTables", "assertEquals", "getTableComment", "get", "getTables", "assertEquals", "size", "getRecords", "get", "getTables", "get", "getRecords", "get", "getTables", "assertEquals", "size", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get"]}, "focal_class": {"identifier": "Kv78Parser", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger LOGGER = LoggerFactory.getLogger(Configuration.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOGGER = LoggerFactory.getLogger(Configuration.class)", "var_name": "LOGGER"}, {"original_string": "private static final String CHAR_SPLIT = \"\\\\|\";", "modifier": "private static final", "type": "String", "declarator": "CHAR_SPLIT = \"\\\\|\"", "var_name": "CHAR_SPLIT"}, {"original_string": "private static final String CHAR_CONTROL = \"\\\\\";", "modifier": "private static final", "type": "String", "declarator": "CHAR_CONTROL = \"\\\\\"", "var_name": "CHAR_CONTROL"}, {"original_string": "private static final String CHAR_EMPTY = \"\\\\0\";", "modifier": "private static final", "type": "String", "declarator": "CHAR_EMPTY = \"\\\\0\"", "var_name": "CHAR_EMPTY"}, {"original_string": "private static final String CHAR_NEWLINE = \"\\r\\n\";", "modifier": "private static final", "type": "String", "declarator": "CHAR_NEWLINE = \"\\r\\n\"", "var_name": "CHAR_NEWLINE"}], "methods": [{"identifier": "parseMessage", "parameters": "(String input)", "modifiers": "public static", "return": "Kv78Packet", "signature": "Kv78Packet parseMessage(String input)", "full_signature": "public static Kv78Packet parseMessage(String input)", "class_method_signature": "Kv78Parser.parseMessage(String input)", "testcase": false, "constructor": false}], "file": "distribution/src/main/java/nl/crowndov/displaydirect/distribution/kv78/Kv78Parser.java"}, "focal_method": {"identifier": "parseMessage", "parameters": "(String input)", "modifiers": "public static", "return": "Kv78Packet", "body": "public static Kv78Packet parseMessage(String input) {\n        Kv78Packet p = new Kv78Packet();\n        Kv78Table t = null;\n        String[] lines = input.split(CHAR_NEWLINE);\n        String[] headers = null;\n        for (String line : lines) {\n            if (line.startsWith(CHAR_CONTROL)) {\n                String[] columns = line.substring(2).split(\"\\\\|\");\n                switch (line.substring(1,2)) {\n                    case \"G\":\n                        p.setType(columns[0]);\n                        p.setComment(columns[2]);\n                        p.setEncoding(columns[5]);\n                        p.setVersion(columns[6]);\n                        p.setGenerated(ZonedDateTime.parse(columns[7]));\n                        break;\n                    case \"T\":\n                        if (t != null) {\n                            p.addTable(t);\n                        }\n                        t = new Kv78Table();\n                        t.setTableName(columns[0]);\n                        t.setTableComment(columns[2]);\n                        break;\n                    case \"L\":\n                        headers = columns;\n                        break;\n                    default:\n                        break;\n                }\n            } else {\n                if (headers != null) {\n                    Map<String, String> record = new HashMap<>();\n                    String[] cells = line.split(CHAR_SPLIT);\n                    for (int i = 0; i < cells.length; i++) {\n                        if (!CHAR_EMPTY.contentEquals(cells[i])) {\n                            record.put(headers[i], cells[i]);\n                        }\n                    }\n                    if (t == null) {\n                        t = new Kv78Table();\n                    }\n                    t.getRecords().add(record);\n                } else {\n                    // Invalid message!\n                    LOGGER.error(\"Failed to parse message\");\n                }\n            }\n        }\n        p.addTable(t);\n        return p;\n    }", "signature": "Kv78Packet parseMessage(String input)", "full_signature": "public static Kv78Packet parseMessage(String input)", "class_method_signature": "Kv78Parser.parseMessage(String input)", "testcase": false, "constructor": false, "invocations": ["split", "startsWith", "split", "substring", "substring", "setType", "setComment", "setEncoding", "setVersion", "setGenerated", "parse", "addTable", "setTableName", "setTableComment", "split", "contentEquals", "put", "add", "getRecords", "error", "addTable"]}, "repository": {"repo_id": 92798552, "url": "https://github.com/CROW-NDOV/displaydirect", "language": "Java", "is_fork": false, "fork_count": 0, "stargazer_count": 6, "size": 247, "license": "licensed"}}