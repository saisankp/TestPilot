{"test_class": {"identifier": "NotificationBusTest", "superclass": "", "interfaces": "", "fields": [], "file": "OcavaCore/src/test/java/com/ocadotechnology/notification/NotificationBusTest.java"}, "test_case": {"identifier": "testIsNotificationRegistered", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testIsNotificationRegistered() {\n        NotificationBus<Notification> bus = new TestBus();\n        NotificationHandler handler = new NotificationHandler();\n\n        bus.addHandler(handler);\n        Assertions.assertTrue(bus.isNotificationRegistered(Notification.class));\n        Assertions.assertTrue(bus.isNotificationRegistered(TestOneNotification.class));\n        Assertions.assertTrue(bus.hasCorrectType(Notification.class));\n        Assertions.assertTrue(bus.hasCorrectType(TestOneNotification.class));\n\n        bus.broadcast(new TestOneNotification());\n        Assertions.assertTrue(handler.handled);\n    }", "signature": "void testIsNotificationRegistered()", "full_signature": "@Test public void testIsNotificationRegistered()", "class_method_signature": "NotificationBusTest.testIsNotificationRegistered()", "testcase": true, "constructor": false, "invocations": ["addHandler", "assertTrue", "isNotificationRegistered", "assertTrue", "isNotificationRegistered", "assertTrue", "hasCorrectType", "assertTrue", "hasCorrectType", "broadcast", "assertTrue"]}, "focal_class": {"identifier": "NotificationBus", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final String NOTIFICATION_BUS_ID = \"NOTIFICATION_BUS\";", "modifier": "public static final", "type": "String", "declarator": "NOTIFICATION_BUS_ID = \"NOTIFICATION_BUS\"", "var_name": "NOTIFICATION_BUS_ID"}, {"original_string": "private final Logger logger = LoggerFactory.getLogger(NOTIFICATION_BUS_ID);", "modifier": "private final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(NOTIFICATION_BUS_ID)", "var_name": "logger"}, {"original_string": "private final Class<N> notificationClass;", "modifier": "private final", "type": "Class<N>", "declarator": "notificationClass", "var_name": "notificationClass"}, {"original_string": "private final AtomicReference<Thread> thread = new AtomicReference<>(null);", "modifier": "private final", "type": "AtomicReference<Thread>", "declarator": "thread = new AtomicReference<>(null)", "var_name": "thread"}, {"original_string": "private final ReadWriteLock rwLock = new ReentrantReadWriteLock();", "modifier": "private final", "type": "ReadWriteLock", "declarator": "rwLock = new ReentrantReadWriteLock()", "var_name": "rwLock"}, {"original_string": "@GuardedBy(\"rwLock\")\n    private BlockingEventBus eventBus;", "modifier": "@GuardedBy(\"rwLock\")\n    private", "type": "BlockingEventBus", "declarator": "eventBus", "var_name": "eventBus"}, {"original_string": "@GuardedBy(\"rwLock\")\n    private final Map<Class<?>, Class<?>> registeredNotifications = new HashMap<>();", "modifier": "@GuardedBy(\"rwLock\")\n    private final", "type": "Map<Class<?>, Class<?>>", "declarator": "registeredNotifications = new HashMap<>()", "var_name": "registeredNotifications"}, {"original_string": "@GuardedBy(\"rwLock\")\n    private final Map<Class<?>, Boolean> cacheOfImpliedNotifications = new HashMap<>();", "modifier": "@GuardedBy(\"rwLock\")\n    private final", "type": "Map<Class<?>, Boolean>", "declarator": "cacheOfImpliedNotifications = new HashMap<>()", "var_name": "cacheOfImpliedNotifications"}, {"original_string": "private final PointToPointValidator pointToPointValidator = new PointToPointValidator();", "modifier": "private final", "type": "PointToPointValidator", "declarator": "pointToPointValidator = new PointToPointValidator()", "var_name": "pointToPointValidator"}], "methods": [{"identifier": "NotificationBus", "parameters": "(Class<N> notificationClass)", "modifiers": "protected", "return": "", "signature": " NotificationBus(Class<N> notificationClass)", "full_signature": "protected  NotificationBus(Class<N> notificationClass)", "class_method_signature": "NotificationBus.NotificationBus(Class<N> notificationClass)", "testcase": false, "constructor": true}, {"identifier": "addHandler", "parameters": "(Object handler)", "modifiers": "protected", "return": "void", "signature": "void addHandler(Object handler)", "full_signature": "protected void addHandler(Object handler)", "class_method_signature": "NotificationBus.addHandler(Object handler)", "testcase": false, "constructor": false}, {"identifier": "collectSubscribingTypes", "parameters": "(Object handler)", "modifiers": "private", "return": "List<Class<?>>", "signature": "List<Class<?>> collectSubscribingTypes(Object handler)", "full_signature": "private List<Class<?>> collectSubscribingTypes(Object handler)", "class_method_signature": "NotificationBus.collectSubscribingTypes(Object handler)", "testcase": false, "constructor": false}, {"identifier": "clearAllHandlers", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void clearAllHandlers()", "full_signature": "public void clearAllHandlers()", "class_method_signature": "NotificationBus.clearAllHandlers()", "testcase": false, "constructor": false}, {"identifier": "broadcast", "parameters": "(N notification)", "modifiers": "public", "return": "void", "signature": "void broadcast(N notification)", "full_signature": "public void broadcast(N notification)", "class_method_signature": "NotificationBus.broadcast(N notification)", "testcase": false, "constructor": false}, {"identifier": "clearThread", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void clearThread()", "full_signature": "public void clearThread()", "class_method_signature": "NotificationBus.clearThread()", "testcase": false, "constructor": false}, {"identifier": "replaceAllNotifications", "parameters": "(Collection<Class<?>> newNotifications)", "modifiers": "protected", "return": "void", "signature": "void replaceAllNotifications(Collection<Class<?>> newNotifications)", "full_signature": "protected void replaceAllNotifications(Collection<Class<?>> newNotifications)", "class_method_signature": "NotificationBus.replaceAllNotifications(Collection<Class<?>> newNotifications)", "testcase": false, "constructor": false}, {"identifier": "checkThatThisBusHasOnlyBeenUsedByOneThread", "parameters": "(N notification)", "modifiers": "protected", "return": "void", "signature": "void checkThatThisBusHasOnlyBeenUsedByOneThread(N notification)", "full_signature": "protected void checkThatThisBusHasOnlyBeenUsedByOneThread(N notification)", "class_method_signature": "NotificationBus.checkThatThisBusHasOnlyBeenUsedByOneThread(N notification)", "testcase": false, "constructor": false}, {"identifier": "isNotificationRegistered", "parameters": "(Class<?> notification)", "modifiers": "protected", "return": "boolean", "signature": "boolean isNotificationRegistered(Class<?> notification)", "full_signature": "protected boolean isNotificationRegistered(Class<?> notification)", "class_method_signature": "NotificationBus.isNotificationRegistered(Class<?> notification)", "testcase": false, "constructor": false}, {"identifier": "isParentOfNotificationRegistered", "parameters": "(Class<T> notification)", "modifiers": "private", "return": "boolean", "signature": "boolean isParentOfNotificationRegistered(Class<T> notification)", "full_signature": "private boolean isParentOfNotificationRegistered(Class<T> notification)", "class_method_signature": "NotificationBus.isParentOfNotificationRegistered(Class<T> notification)", "testcase": false, "constructor": false}, {"identifier": "clearCache", "parameters": "()", "modifiers": "private", "return": "void", "signature": "void clearCache()", "full_signature": "private void clearCache()", "class_method_signature": "NotificationBus.clearCache()", "testcase": false, "constructor": false}, {"identifier": "canHandleNotification", "parameters": "(Class<?> notification)", "modifiers": "protected", "return": "boolean", "signature": "boolean canHandleNotification(Class<?> notification)", "full_signature": "protected boolean canHandleNotification(Class<?> notification)", "class_method_signature": "NotificationBus.canHandleNotification(Class<?> notification)", "testcase": false, "constructor": false}, {"identifier": "hasCorrectType", "parameters": "(Class<?> notification)", "modifiers": "protected abstract", "return": "boolean", "signature": "boolean hasCorrectType(Class<?> notification)", "full_signature": "protected abstract boolean hasCorrectType(Class<?> notification)", "class_method_signature": "NotificationBus.hasCorrectType(Class<?> notification)", "testcase": false, "constructor": false}, {"identifier": "toString", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String toString()", "full_signature": "@Override public String toString()", "class_method_signature": "NotificationBus.toString()", "testcase": false, "constructor": false}], "file": "OcavaCore/src/main/java/com/ocadotechnology/notification/NotificationBus.java"}, "focal_method": {"identifier": "isNotificationRegistered", "parameters": "(Class<?> notification)", "modifiers": "protected", "return": "boolean", "body": "protected boolean isNotificationRegistered(Class<?> notification) {\n        Lock lock = rwLock.readLock();\n        try {\n            lock.lock();\n\n            if (registeredNotifications.containsKey(notification)) {\n                return true;\n            }\n\n            Boolean result = cacheOfImpliedNotifications.get(notification);\n            if (result != null) {\n                return result;\n            }\n        } finally {\n            lock.unlock();\n        }\n\n        // Has to be done outside readLock as can't upgrade read to write\n        return isParentOfNotificationRegistered(notification);\n    }", "signature": "boolean isNotificationRegistered(Class<?> notification)", "full_signature": "protected boolean isNotificationRegistered(Class<?> notification)", "class_method_signature": "NotificationBus.isNotificationRegistered(Class<?> notification)", "testcase": false, "constructor": false, "invocations": ["readLock", "lock", "containsKey", "get", "unlock", "isParentOfNotificationRegistered"]}, "repository": {"repo_id": 99997703, "url": "https://github.com/ocadotechnology/Ocava", "language": "Java", "is_fork": false, "fork_count": 4, "stargazer_count": 16, "size": 1137, "license": "licensed"}}