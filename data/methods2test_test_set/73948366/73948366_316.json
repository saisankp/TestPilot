{"test_class": {"identifier": "RoleTokenTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private final String rolVersion = \"Z1\";", "modifier": "private final", "type": "String", "declarator": "rolVersion = \"Z1\"", "var_name": "rolVersion"}, {"original_string": "private final String svcDomain = \"sports\";", "modifier": "private final", "type": "String", "declarator": "svcDomain = \"sports\"", "var_name": "svcDomain"}, {"original_string": "private final String salt = \"aAkjbbDMhnLX\";", "modifier": "private final", "type": "String", "declarator": "salt = \"aAkjbbDMhnLX\"", "var_name": "salt"}, {"original_string": "private final long expirationTime = 10;", "modifier": "private final", "type": "long", "declarator": "expirationTime = 10", "var_name": "expirationTime"}, {"original_string": "private String ztsPublicKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "ztsPublicKeyStringK0 = null", "var_name": "ztsPublicKeyStringK0"}, {"original_string": "private String ztsPrivateKeyStringK0 = null;", "modifier": "private", "type": "String", "declarator": "ztsPrivateKeyStringK0 = null", "var_name": "ztsPrivateKeyStringK0"}, {"original_string": "private String ztsPublicKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "ztsPublicKeyStringK1 = null", "var_name": "ztsPublicKeyStringK1"}, {"original_string": "private String ztsPrivateKeyStringK1 = null;", "modifier": "private", "type": "String", "declarator": "ztsPrivateKeyStringK1 = null", "var_name": "ztsPrivateKeyStringK1"}], "file": "libs/java/auth_core/src/test/java/com/yahoo/athenz/auth/token/RoleTokenTest.java"}, "test_case": {"identifier": "testRoleTokenInvalidParamsAtEnd", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testRoleTokenInvalidParamsAtEnd() throws CryptoException {\n        // Add some roles\n        List<String> roles = new ArrayList<>();\n        roles.add(\"reader\");\n        roles.add(\"writer\");\n\n        // Create a token for validation using the signed data\n        String testKeyVersionK1 = \"1\";\n\n        // Create token and sign\n        RoleToken rollTokenToSign = new RoleToken.Builder(rolVersion, svcDomain, roles)\n                .salt(salt).expirationWindow(expirationTime).keyId(testKeyVersionK1).build();\n\n        rollTokenToSign.sign(ztsPrivateKeyStringK1);\n        String signedToken = rollTokenToSign.getSignedToken() + \";d=newdomain;r=newroles\";\n\n        RoleToken rollTokenToValidate = new RoleToken(signedToken);\n\n        assertNotNull(rollTokenToValidate.getSignedToken());\n\n        // Validate all input data, we'll be ignoring the data\n        // after the signature\n\n        assertEquals(rollTokenToValidate.getDomain(), svcDomain);\n        List<String> rolesToValidate = rollTokenToValidate.getRoles();\n        assertEquals(rolesToValidate.size(), roles.size());\n        assertEquals(rolesToValidate, roles);\n        assertEquals(rollTokenToValidate.getKeyId(), testKeyVersionK1);\n\n        // Validate the signature and that expiration time had not elapsed\n        // we should get invalid validation due to extra arguments at\n        // end of the string\n\n        assertFalse(rollTokenToValidate.validate(ztsPublicKeyStringK1, 300, false));\n    }", "signature": "void testRoleTokenInvalidParamsAtEnd()", "full_signature": "@Test public void testRoleTokenInvalidParamsAtEnd()", "class_method_signature": "RoleTokenTest.testRoleTokenInvalidParamsAtEnd()", "testcase": true, "constructor": false, "invocations": ["add", "add", "build", "keyId", "expirationWindow", "salt", "sign", "getSignedToken", "assertNotNull", "getSignedToken", "assertEquals", "getDomain", "getRoles", "assertEquals", "size", "size", "assertEquals", "assertEquals", "getKeyId", "assertFalse", "validate"]}, "focal_class": {"identifier": "RoleToken", "superclass": "extends Token", "interfaces": "", "fields": [{"original_string": "protected List<String> roles;", "modifier": "protected", "type": "List<String>", "declarator": "roles", "var_name": "roles"}, {"original_string": "private String principal = null;", "modifier": "private", "type": "String", "declarator": "principal = null", "var_name": "principal"}, {"original_string": "private String proxyUser = null;", "modifier": "private", "type": "String", "declarator": "proxyUser = null", "var_name": "proxyUser"}, {"original_string": "private boolean domainCompleteRoleSet = false;", "modifier": "private", "type": "boolean", "declarator": "domainCompleteRoleSet = false", "var_name": "domainCompleteRoleSet"}, {"original_string": "private static final Logger LOG = LoggerFactory.getLogger(RoleToken.class);", "modifier": "private static final", "type": "Logger", "declarator": "LOG = LoggerFactory.getLogger(RoleToken.class)", "var_name": "LOG"}], "methods": [{"identifier": "RoleToken", "parameters": "(Builder builder)", "modifiers": "private", "return": "", "signature": " RoleToken(Builder builder)", "full_signature": "private  RoleToken(Builder builder)", "class_method_signature": "RoleToken.RoleToken(Builder builder)", "testcase": false, "constructor": true}, {"identifier": "RoleToken", "parameters": "(String signedToken)", "modifiers": "public", "return": "", "signature": " RoleToken(String signedToken)", "full_signature": "public  RoleToken(String signedToken)", "class_method_signature": "RoleToken.RoleToken(String signedToken)", "testcase": false, "constructor": true}, {"identifier": "getPrincipal", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getPrincipal()", "full_signature": "public String getPrincipal()", "class_method_signature": "RoleToken.getPrincipal()", "testcase": false, "constructor": false}, {"identifier": "getRoles", "parameters": "()", "modifiers": "public", "return": "List<String>", "signature": "List<String> getRoles()", "full_signature": "public List<String> getRoles()", "class_method_signature": "RoleToken.getRoles()", "testcase": false, "constructor": false}, {"identifier": "getProxyUser", "parameters": "()", "modifiers": "public", "return": "String", "signature": "String getProxyUser()", "full_signature": "public String getProxyUser()", "class_method_signature": "RoleToken.getProxyUser()", "testcase": false, "constructor": false}, {"identifier": "getDomainCompleteRoleSet", "parameters": "()", "modifiers": "public", "return": "boolean", "signature": "boolean getDomainCompleteRoleSet()", "full_signature": "public boolean getDomainCompleteRoleSet()", "class_method_signature": "RoleToken.getDomainCompleteRoleSet()", "testcase": false, "constructor": false}], "file": "libs/java/auth_core/src/main/java/com/yahoo/athenz/auth/token/RoleToken.java"}, "focal_method": {"identifier": "getRoles", "parameters": "()", "modifiers": "public", "return": "List<String>", "body": "public List<String> getRoles() {\n        return roles;\n    }", "signature": "List<String> getRoles()", "full_signature": "public List<String> getRoles()", "class_method_signature": "RoleToken.getRoles()", "testcase": false, "constructor": false, "invocations": []}, "repository": {"repo_id": 73948366, "url": "https://github.com/yahoo/athenz", "stars": 394, "created": "11/16/2016 6:23:08 PM +00:00", "updates": "2020-01-27T15:36:13+00:00", "fork": "False", "license": "licensed"}}