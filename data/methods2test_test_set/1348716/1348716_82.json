{"test_class": {"identifier": "DatabaseUpgradeSupportTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final String EXPANSION = \"expansion\";", "modifier": "public static final", "type": "String", "declarator": "EXPANSION = \"expansion\"", "var_name": "EXPANSION"}, {"original_string": "public static final String CONTRACTION = \"contraction\";", "modifier": "public static final", "type": "String", "declarator": "CONTRACTION = \"contraction\"", "var_name": "CONTRACTION"}, {"original_string": "private DatabaseUpgradeSupport databaseUpgradeSupport;", "modifier": "private", "type": "DatabaseUpgradeSupport", "declarator": "databaseUpgradeSupport", "var_name": "databaseUpgradeSupport"}, {"original_string": "@Mock\n    private Liquibase liquibase;", "modifier": "@Mock\n    private", "type": "Liquibase", "declarator": "liquibase", "var_name": "liquibase"}, {"original_string": "@Mock\n    private ChangeSet changeSet1;", "modifier": "@Mock\n    private", "type": "ChangeSet", "declarator": "changeSet1", "var_name": "changeSet1"}, {"original_string": "@Mock\n    private ChangeSet changeSet2;", "modifier": "@Mock\n    private", "type": "ChangeSet", "declarator": "changeSet2", "var_name": "changeSet2"}, {"original_string": "@Mock\n    private Database database;", "modifier": "@Mock\n    private", "type": "Database", "declarator": "database", "var_name": "database"}], "file": "db/src/test/java/org/mifos/db/upgrade/DatabaseUpgradeSupportTest.java"}, "test_case": {"identifier": "listUnrunChangeSets", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void listUnrunChangeSets() throws LiquibaseException {\n        when(changeSet1.getId()).thenReturn(\"id1\");\n        when(changeSet1.getAuthor()).thenReturn(\"author1\");\n        Set<String> contextSet = new HashSet<String>();\n        contextSet.add(EXPANSION);\n        when(changeSet1.getContexts()).thenReturn(contextSet);\n        when(liquibase.listUnrunChangeSets(StringUtils.EMPTY)).thenReturn(Arrays.<ChangeSet>asList(changeSet1));\n        List<UnRunChangeSetInfo> unRunChangeSetInfo = databaseUpgradeSupport.listUnRunChangeSets();\n        verify(liquibase).listUnrunChangeSets(StringUtils.EMPTY);\n        UnRunChangeSetInfo unRunChangeSetInfo1 = unRunChangeSetInfo.get(0);\n        assertThat(unRunChangeSetInfo1.getId(), is(\"id1\"));\n        assertThat(unRunChangeSetInfo1.getAuthor(), is(\"author1\"));\n        assertThat(unRunChangeSetInfo1.getContexts(), is(\"[\"+EXPANSION+\"]\"));\n    }", "signature": "void listUnrunChangeSets()", "full_signature": "@Test public void listUnrunChangeSets()", "class_method_signature": "DatabaseUpgradeSupportTest.listUnrunChangeSets()", "testcase": true, "constructor": false, "invocations": ["thenReturn", "when", "getId", "thenReturn", "when", "getAuthor", "add", "thenReturn", "when", "getContexts", "thenReturn", "when", "listUnrunChangeSets", "asList", "listUnRunChangeSets", "listUnrunChangeSets", "verify", "get", "assertThat", "getId", "is", "assertThat", "getAuthor", "is", "assertThat", "getContexts", "is"]}, "focal_class": {"identifier": "DatabaseUpgradeSupport", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final String EXPANSION = \"expansion\";", "modifier": "public static final", "type": "String", "declarator": "EXPANSION = \"expansion\"", "var_name": "EXPANSION"}, {"original_string": "public static final String CONTRACTION = \"contraction\";", "modifier": "public static final", "type": "String", "declarator": "CONTRACTION = \"contraction\"", "var_name": "CONTRACTION"}, {"original_string": "public static final String BEAN_NAME = \"databaseUpgradeSupport\";", "modifier": "public static final", "type": "String", "declarator": "BEAN_NAME = \"databaseUpgradeSupport\"", "var_name": "BEAN_NAME"}, {"original_string": "private Liquibase liquibase;", "modifier": "private", "type": "Liquibase", "declarator": "liquibase", "var_name": "liquibase"}, {"original_string": "private Database database;", "modifier": "private", "type": "Database", "declarator": "database", "var_name": "database"}], "methods": [{"identifier": "DatabaseUpgradeSupport", "parameters": "(DataSource dataSource, ResourceOpener resourceOpener)", "modifiers": "public", "return": "", "signature": " DatabaseUpgradeSupport(DataSource dataSource, ResourceOpener resourceOpener)", "full_signature": "public  DatabaseUpgradeSupport(DataSource dataSource, ResourceOpener resourceOpener)", "class_method_signature": "DatabaseUpgradeSupport.DatabaseUpgradeSupport(DataSource dataSource, ResourceOpener resourceOpener)", "testcase": false, "constructor": true}, {"identifier": "DatabaseUpgradeSupport", "parameters": "(Database database, Liquibase liquibase)", "modifiers": "public", "return": "", "signature": " DatabaseUpgradeSupport(Database database, Liquibase liquibase)", "full_signature": "public  DatabaseUpgradeSupport(Database database, Liquibase liquibase)", "class_method_signature": "DatabaseUpgradeSupport.DatabaseUpgradeSupport(Database database, Liquibase liquibase)", "testcase": false, "constructor": true}, {"identifier": "initDatabase", "parameters": "(DataSource dataSource)", "modifiers": "private", "return": "Database", "signature": "Database initDatabase(DataSource dataSource)", "full_signature": "private Database initDatabase(DataSource dataSource)", "class_method_signature": "DatabaseUpgradeSupport.initDatabase(DataSource dataSource)", "testcase": false, "constructor": false}, {"identifier": "initLiquibase", "parameters": "(ResourceOpener resourceOpener)", "modifiers": "private", "return": "Liquibase", "signature": "Liquibase initLiquibase(ResourceOpener resourceOpener)", "full_signature": "private Liquibase initLiquibase(ResourceOpener resourceOpener)", "class_method_signature": "DatabaseUpgradeSupport.initLiquibase(ResourceOpener resourceOpener)", "testcase": false, "constructor": false}, {"identifier": "validate", "parameters": "()", "modifiers": "public", "return": "DbUpgradeValidationResult", "signature": "DbUpgradeValidationResult validate()", "full_signature": "public DbUpgradeValidationResult validate()", "class_method_signature": "DatabaseUpgradeSupport.validate()", "testcase": false, "constructor": false}, {"identifier": "expansion", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void expansion()", "full_signature": "public void expansion()", "class_method_signature": "DatabaseUpgradeSupport.expansion()", "testcase": false, "constructor": false}, {"identifier": "contraction", "parameters": "()", "modifiers": "public", "return": "void", "signature": "void contraction()", "full_signature": "public void contraction()", "class_method_signature": "DatabaseUpgradeSupport.contraction()", "testcase": false, "constructor": false}, {"identifier": "listRanUpgrades", "parameters": "()", "modifiers": "public", "return": "List<ChangeSetInfo>", "signature": "List<ChangeSetInfo> listRanUpgrades()", "full_signature": "public List<ChangeSetInfo> listRanUpgrades()", "class_method_signature": "DatabaseUpgradeSupport.listRanUpgrades()", "testcase": false, "constructor": false}, {"identifier": "listUnRunChangeSets", "parameters": "()", "modifiers": "public", "return": "List<UnRunChangeSetInfo>", "signature": "List<UnRunChangeSetInfo> listUnRunChangeSets()", "full_signature": "public List<UnRunChangeSetInfo> listUnRunChangeSets()", "class_method_signature": "DatabaseUpgradeSupport.listUnRunChangeSets()", "testcase": false, "constructor": false}], "file": "db/src/main/java/org/mifos/db/upgrade/DatabaseUpgradeSupport.java"}, "focal_method": {"identifier": "listUnRunChangeSets", "parameters": "()", "modifiers": "public", "return": "List<UnRunChangeSetInfo>", "body": "public List<UnRunChangeSetInfo> listUnRunChangeSets() {\n        try {\n            return CollectionUtils.collect(liquibase.listUnrunChangeSets(EMPTY), new Transformer<ChangeSet, UnRunChangeSetInfo>() {\n                @Override\n                public UnRunChangeSetInfo transform(ChangeSet changeSet) {\n                    return new UnRunChangeSetInfo(changeSet);\n                }\n            });\n        } catch (LiquibaseException e) {\n            throw new MifosRuntimeException(e);\n        }\n    }", "signature": "List<UnRunChangeSetInfo> listUnRunChangeSets()", "full_signature": "public List<UnRunChangeSetInfo> listUnRunChangeSets()", "class_method_signature": "DatabaseUpgradeSupport.listUnRunChangeSets()", "testcase": false, "constructor": false, "invocations": ["collect", "listUnrunChangeSets"]}, "repository": {"repo_id": 1348716, "url": "https://github.com/mifos/head", "language": "Java", "is_fork": false, "fork_count": 91, "stargazer_count": 55, "size": 532732, "license": "licensed"}}