{"test_class": {"identifier": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilderTest", "superclass": "extends AbstractNotificationMessageBuilderTestHelper", "interfaces": "", "fields": [{"original_string": "@Rule\n    public ExpectedException expectedException = ExpectedException.none();", "modifier": "@Rule\n    public", "type": "ExpectedException", "declarator": "expectedException = ExpectedException.none()", "var_name": "expectedException"}, {"original_string": "@Autowired\n    private BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder businessObjectDefinitionDescriptionSuggestionChangeMessageBuilder;", "modifier": "@Autowired\n    private", "type": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder", "declarator": "businessObjectDefinitionDescriptionSuggestionChangeMessageBuilder", "var_name": "businessObjectDefinitionDescriptionSuggestionChangeMessageBuilder"}], "file": "herd-code/herd-service/src/test/java/org/finra/herd/service/helper/notification/BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilderTest.java"}, "test_case": {"identifier": "testGetBusinessObjectDefinitionDescriptionSuggestionChangeMessageVelocityContextMap", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testGetBusinessObjectDefinitionDescriptionSuggestionChangeMessageVelocityContextMap()\n    {\n        // Create a business object definition description suggestion key with values that require JSON and XML escaping.\n        BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey =\n            new BusinessObjectDefinitionDescriptionSuggestionKey(BDEF_NAMESPACE + SUFFIX_UNESCAPED, BDEF_NAME + SUFFIX_UNESCAPED, USER_ID + SUFFIX_UNESCAPED);\n\n        // Create a business object definition description suggestion with values that require JSON and XML escaping.\n        BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion =\n            new BusinessObjectDefinitionDescriptionSuggestion(ID, businessObjectDefinitionDescriptionSuggestionKey, DESCRIPTION_SUGGESTION + SUFFIX_UNESCAPED,\n                BDEF_DESCRIPTION_SUGGESTION_STATUS + SUFFIX_UNESCAPED, USER_ID + SUFFIX_UNESCAPED, CREATED_ON);\n\n        // Create and persist a namespace entity.\n        NamespaceEntity namespaceEntity = namespaceDaoTestHelper.createNamespaceEntity(businessObjectDefinitionDescriptionSuggestionKey.getNamespace());\n\n        // Call the method under test.\n        Map<String, Object> result = businessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.getNotificationMessageVelocityContextMap(\n            new BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent(businessObjectDefinitionDescriptionSuggestion,\n                USER_ID_2 + SUFFIX_UNESCAPED, UPDATED_ON, namespaceEntity.getCode()));\n\n        // Create an expected JSON escaped business object definition description suggestion key.\n        BusinessObjectDefinitionDescriptionSuggestionKey expectedBusinessObjectDefinitionDescriptionSuggestionKeyWithJson =\n            new BusinessObjectDefinitionDescriptionSuggestionKey(BDEF_NAMESPACE + SUFFIX_ESCAPED_JSON, BDEF_NAME + SUFFIX_ESCAPED_JSON,\n                USER_ID + SUFFIX_ESCAPED_JSON);\n\n        // Create an expected JSON escaped business object definition description suggestion key.\n        BusinessObjectDefinitionDescriptionSuggestion expectedBusinessObjectDefinitionDescriptionSuggestionWithJson =\n            new BusinessObjectDefinitionDescriptionSuggestion(ID, expectedBusinessObjectDefinitionDescriptionSuggestionKeyWithJson,\n                DESCRIPTION_SUGGESTION + SUFFIX_ESCAPED_JSON, BDEF_DESCRIPTION_SUGGESTION_STATUS + SUFFIX_ESCAPED_JSON, USER_ID + SUFFIX_ESCAPED_JSON,\n                CREATED_ON);\n\n        // Create an expected XML escaped business object definition description suggestion key.\n        BusinessObjectDefinitionDescriptionSuggestionKey expectedBusinessObjectDefinitionDescriptionSuggestionKeyWithXml =\n            new BusinessObjectDefinitionDescriptionSuggestionKey(BDEF_NAMESPACE + SUFFIX_ESCAPED_XML, BDEF_NAME + SUFFIX_ESCAPED_XML,\n                USER_ID + SUFFIX_ESCAPED_XML);\n\n        // Create an expected XML escaped business object definition description suggestion key.\n        BusinessObjectDefinitionDescriptionSuggestion expectedBusinessObjectDefinitionDescriptionSuggestionWithXml =\n            new BusinessObjectDefinitionDescriptionSuggestion(ID, expectedBusinessObjectDefinitionDescriptionSuggestionKeyWithXml,\n                DESCRIPTION_SUGGESTION + SUFFIX_ESCAPED_XML, BDEF_DESCRIPTION_SUGGESTION_STATUS + SUFFIX_ESCAPED_XML, USER_ID + SUFFIX_ESCAPED_XML, CREATED_ON);\n\n        // Create expected notification lists.\n        List<String> expectedNotificationList = Lists.newArrayList(USER_ID + SUFFIX_UNESCAPED);\n        List<String> expectedNotificationListWithJson = Lists.newArrayList(USER_ID + SUFFIX_ESCAPED_JSON);\n        List<String> expectedNotificationListWithXml = Lists.newArrayList(USER_ID + SUFFIX_ESCAPED_XML);\n\n        // Validate the results.\n        assertEquals(16, CollectionUtils.size(result));\n\n        assertEquals(businessObjectDefinitionDescriptionSuggestion, result.get(\"businessObjectDefinitionDescriptionSuggestion\"));\n        assertEquals(expectedBusinessObjectDefinitionDescriptionSuggestionWithJson, result.get(\"businessObjectDefinitionDescriptionSuggestionWithJson\"));\n        assertEquals(expectedBusinessObjectDefinitionDescriptionSuggestionWithXml, result.get(\"businessObjectDefinitionDescriptionSuggestionWithXml\"));\n\n        assertEquals(businessObjectDefinitionDescriptionSuggestionKey, result.get(\"businessObjectDefinitionDescriptionSuggestionKey\"));\n        assertEquals(expectedBusinessObjectDefinitionDescriptionSuggestionKeyWithJson, result.get(\"businessObjectDefinitionDescriptionSuggestionKeyWithJson\"));\n        assertEquals(expectedBusinessObjectDefinitionDescriptionSuggestionKeyWithXml, result.get(\"businessObjectDefinitionDescriptionSuggestionKeyWithXml\"));\n\n        assertEquals(USER_ID_2 + SUFFIX_UNESCAPED, result.get(\"lastUpdatedByUserId\"));\n        assertEquals(USER_ID_2 + SUFFIX_ESCAPED_JSON, result.get(\"lastUpdatedByUserIdWithJson\"));\n        assertEquals(USER_ID_2 + SUFFIX_ESCAPED_XML, result.get(\"lastUpdatedByUserIdWithXml\"));\n\n        assertEquals(UPDATED_ON, result.get(\"lastUpdatedOn\"));\n\n        assertEquals(expectedNotificationList, result.get(\"notificationList\"));\n        assertEquals(expectedNotificationListWithJson, result.get(\"notificationListWithJson\"));\n        assertEquals(expectedNotificationListWithXml, result.get(\"notificationListWithXml\"));\n\n        assertEquals(BDEF_NAMESPACE + SUFFIX_UNESCAPED, result.get(\"namespace\"));\n        assertEquals(BDEF_NAMESPACE + SUFFIX_ESCAPED_JSON, result.get(\"namespaceWithJson\"));\n        assertEquals(BDEF_NAMESPACE + SUFFIX_ESCAPED_XML, result.get(\"namespaceWithXml\"));\n    }", "signature": "void testGetBusinessObjectDefinitionDescriptionSuggestionChangeMessageVelocityContextMap()", "full_signature": "@Test public void testGetBusinessObjectDefinitionDescriptionSuggestionChangeMessageVelocityContextMap()", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilderTest.testGetBusinessObjectDefinitionDescriptionSuggestionChangeMessageVelocityContextMap()", "testcase": true, "constructor": false, "invocations": ["createNamespaceEntity", "getNamespace", "getNotificationMessageVelocityContextMap", "getCode", "newArrayList", "newArrayList", "newArrayList", "assertEquals", "size", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get", "assertEquals", "get"]}, "focal_class": {"identifier": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder", "superclass": "extends AbstractNotificationMessageBuilder", "interfaces": "implements NotificationMessageBuilder", "fields": [{"original_string": "@Autowired\n    private UserNamespaceAuthorizationDao userNamespaceAuthorizationDao;", "modifier": "@Autowired\n    private", "type": "UserNamespaceAuthorizationDao", "declarator": "userNamespaceAuthorizationDao", "var_name": "userNamespaceAuthorizationDao"}, {"original_string": "@Autowired\n    private NamespaceDao namespaceDao;", "modifier": "@Autowired\n    private", "type": "NamespaceDao", "declarator": "namespaceDao", "var_name": "namespaceDao"}], "methods": [{"identifier": "getNotificationMessageVelocityContextMap", "parameters": "(NotificationEvent notificationEvent)", "modifiers": "@Override @SuppressFBWarnings(value = \"BC_UNCONFIRMED_CAST\", justification = \"The NotificationEvent is cast to a BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent which is always the case since\" + \" we manage the event type to a builder in a map defined in NotificationMessageManager\") public", "return": "Map<String, Object>", "signature": "Map<String, Object> getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)", "full_signature": "@Override @SuppressFBWarnings(value = \"BC_UNCONFIRMED_CAST\", justification = \"The NotificationEvent is cast to a BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent which is always the case since\" + \" we manage the event type to a builder in a map defined in NotificationMessageManager\") public Map<String, Object> getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)", "testcase": false, "constructor": false}, {"identifier": "escapeJsonBusinessObjectDefinitionDescriptionSuggestion", "parameters": "(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "modifiers": "private", "return": "BusinessObjectDefinitionDescriptionSuggestion", "signature": "BusinessObjectDefinitionDescriptionSuggestion escapeJsonBusinessObjectDefinitionDescriptionSuggestion(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "full_signature": "private BusinessObjectDefinitionDescriptionSuggestion escapeJsonBusinessObjectDefinitionDescriptionSuggestion(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.escapeJsonBusinessObjectDefinitionDescriptionSuggestion(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "testcase": false, "constructor": false}, {"identifier": "escapeXmlBusinessObjectDefinitionDescriptionSuggestion", "parameters": "(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "modifiers": "private", "return": "BusinessObjectDefinitionDescriptionSuggestion", "signature": "BusinessObjectDefinitionDescriptionSuggestion escapeXmlBusinessObjectDefinitionDescriptionSuggestion(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "full_signature": "private BusinessObjectDefinitionDescriptionSuggestion escapeXmlBusinessObjectDefinitionDescriptionSuggestion(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.escapeXmlBusinessObjectDefinitionDescriptionSuggestion(\n        final BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestion)", "testcase": false, "constructor": false}, {"identifier": "escapeXmlBusinessObjectDefinitionDescriptionSuggestionKey", "parameters": "(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "modifiers": "private", "return": "BusinessObjectDefinitionDescriptionSuggestionKey", "signature": "BusinessObjectDefinitionDescriptionSuggestionKey escapeXmlBusinessObjectDefinitionDescriptionSuggestionKey(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "full_signature": "private BusinessObjectDefinitionDescriptionSuggestionKey escapeXmlBusinessObjectDefinitionDescriptionSuggestionKey(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.escapeXmlBusinessObjectDefinitionDescriptionSuggestionKey(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "testcase": false, "constructor": false}, {"identifier": "escapeJsonBusinessObjectDefinitionDescriptionSuggestionKey", "parameters": "(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "modifiers": "private", "return": "BusinessObjectDefinitionDescriptionSuggestionKey", "signature": "BusinessObjectDefinitionDescriptionSuggestionKey escapeJsonBusinessObjectDefinitionDescriptionSuggestionKey(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "full_signature": "private BusinessObjectDefinitionDescriptionSuggestionKey escapeJsonBusinessObjectDefinitionDescriptionSuggestionKey(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.escapeJsonBusinessObjectDefinitionDescriptionSuggestionKey(\n        final BusinessObjectDefinitionDescriptionSuggestionKey businessObjectDefinitionDescriptionSuggestionKey)", "testcase": false, "constructor": false}], "file": "herd-code/herd-service/src/main/java/org/finra/herd/service/helper/notification/BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.java"}, "focal_method": {"identifier": "getNotificationMessageVelocityContextMap", "parameters": "(NotificationEvent notificationEvent)", "modifiers": "@Override @SuppressFBWarnings(value = \"BC_UNCONFIRMED_CAST\", justification = \"The NotificationEvent is cast to a BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent which is always the case since\" + \" we manage the event type to a builder in a map defined in NotificationMessageManager\") public", "return": "Map<String, Object>", "body": "@Override\n    @SuppressFBWarnings(value = \"BC_UNCONFIRMED_CAST\", justification =\n        \"The NotificationEvent is cast to a BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent which is always the case since\" +\n            \" we manage the event type to a builder in a map defined in NotificationMessageManager\")\n    public Map<String, Object> getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)\n    {\n        BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent event =\n            (BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent) notificationEvent;\n\n        // Create a list of users (User IDs) that need to be notified about this event.\n        // Initialize the list with the user who created this business object definition description suggestion.\n        List<String> notificationList = new ArrayList<>();\n        notificationList.add(event.getBusinessObjectDefinitionDescriptionSuggestion().getCreatedByUserId());\n\n        NamespaceEntity namespaceEntity = namespaceDao.getNamespaceByCd(event.getNamespace());\n        Assert.notNull(namespaceEntity, String.format(\"namespaceEntity must not be null for namespace code \\\"%s\\\"\", event.getNamespace()));\n\n        // Add to the notification list all users that have WRITE or WRITE_DESCRIPTIVE_CONTENT permission on the namespace.\n        notificationList.addAll(userNamespaceAuthorizationDao.getUserIdsWithWriteOrWriteDescriptiveContentPermissionsByNamespace(namespaceEntity));\n\n        // Create JSON and XML escaped copies of the business object definition description suggestion.\n        BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestionWithJson =\n            escapeJsonBusinessObjectDefinitionDescriptionSuggestion(event.getBusinessObjectDefinitionDescriptionSuggestion());\n        BusinessObjectDefinitionDescriptionSuggestion businessObjectDefinitionDescriptionSuggestionWithXml =\n            escapeXmlBusinessObjectDefinitionDescriptionSuggestion(event.getBusinessObjectDefinitionDescriptionSuggestion());\n\n        // Create JSON and XML escaped notification lists.\n        List<String> notificationListWithJson = new ArrayList<>();\n        List<String> notificationListWithXml = new ArrayList<>();\n        for (String userId : notificationList)\n        {\n            notificationListWithJson.add(escapeJson(userId));\n            notificationListWithXml.add(escapeXml(userId));\n        }\n\n        // Create a context map of values that can be used when building the message.\n        Map<String, Object> velocityContextMap = new HashMap<>();\n        addObjectPropertyToContext(velocityContextMap, \"businessObjectDefinitionDescriptionSuggestion\",\n            event.getBusinessObjectDefinitionDescriptionSuggestion(), businessObjectDefinitionDescriptionSuggestionWithJson,\n            businessObjectDefinitionDescriptionSuggestionWithXml);\n        addObjectPropertyToContext(velocityContextMap, \"businessObjectDefinitionDescriptionSuggestionKey\",\n            event.getBusinessObjectDefinitionDescriptionSuggestion().getBusinessObjectDefinitionDescriptionSuggestionKey(),\n            businessObjectDefinitionDescriptionSuggestionWithJson.getBusinessObjectDefinitionDescriptionSuggestionKey(),\n            businessObjectDefinitionDescriptionSuggestionWithXml.getBusinessObjectDefinitionDescriptionSuggestionKey());\n        addStringPropertyToContext(velocityContextMap, \"lastUpdatedByUserId\", event.getLastUpdatedByUserId());\n        velocityContextMap.put(\"lastUpdatedOn\", event.getLastUpdatedOn());\n        addObjectPropertyToContext(velocityContextMap, \"notificationList\", notificationList, notificationListWithJson, notificationListWithXml);\n        addStringPropertyToContext(velocityContextMap, \"namespace\", event.getNamespace());\n\n        // Return the Velocity context map.\n        return velocityContextMap;\n    }", "signature": "Map<String, Object> getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)", "full_signature": "@Override @SuppressFBWarnings(value = \"BC_UNCONFIRMED_CAST\", justification = \"The NotificationEvent is cast to a BusinessObjectDefinitionDescriptionSuggestionChangeNotificationEvent which is always the case since\" + \" we manage the event type to a builder in a map defined in NotificationMessageManager\") public Map<String, Object> getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)", "class_method_signature": "BusinessObjectDefinitionDescriptionSuggestionChangeMessageBuilder.getNotificationMessageVelocityContextMap(NotificationEvent notificationEvent)", "testcase": false, "constructor": false, "invocations": ["add", "getCreatedByUserId", "getBusinessObjectDefinitionDescriptionSuggestion", "getNamespaceByCd", "getNamespace", "notNull", "format", "getNamespace", "addAll", "getUserIdsWithWriteOrWriteDescriptiveContentPermissionsByNamespace", "escapeJsonBusinessObjectDefinitionDescriptionSuggestion", "getBusinessObjectDefinitionDescriptionSuggestion", "escapeXmlBusinessObjectDefinitionDescriptionSuggestion", "getBusinessObjectDefinitionDescriptionSuggestion", "add", "escapeJson", "add", "escapeXml", "addObjectPropertyToContext", "getBusinessObjectDefinitionDescriptionSuggestion", "addObjectPropertyToContext", "getBusinessObjectDefinitionDescriptionSuggestionKey", "getBusinessObjectDefinitionDescriptionSuggestion", "getBusinessObjectDefinitionDescriptionSuggestionKey", "getBusinessObjectDefinitionDescriptionSuggestionKey", "addStringPropertyToContext", "getLastUpdatedByUserId", "put", "getLastUpdatedOn", "addObjectPropertyToContext", "addStringPropertyToContext", "getNamespace"]}, "repository": {"repo_id": 42949039, "url": "https://github.com/FINRAOS/herd", "language": "Java", "is_fork": false, "fork_count": 36, "stargazer_count": 120, "size": 205797, "license": "licensed"}}