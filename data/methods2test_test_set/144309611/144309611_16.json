{"test_class": {"identifier": "ZeroKnowledgeProverTest", "superclass": "", "interfaces": "", "fields": [], "file": "pross-common/src/test/java/com/ibm/pross/common/util/crypto/zkp/splitting/ZeroKnowledgeProverTest.java"}, "test_case": {"identifier": "testProofPerformance", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testProofPerformance() {\n\t\t\n\t\tfinal EcCurve curve = CommonConfiguration.CURVE;\n\n\t\tfinal BigInteger a0 = RandomNumberGenerator.generateRandomInteger(curve.getR());\n\t\tfinal BigInteger b0 = RandomNumberGenerator.generateRandomInteger(curve.getR());\n\t\t\n\t\t\n\t\t// Warm up\n\t\tZeroKnowledgeProof zkp = null;\n\t\tfor (int i = 0; i < 20; i++)\n\t\t{\n\t\t\tzkp = ZeroKnowledgeProver.createProof(a0, b0);\n\t\t}\n\t\t\n\t\tint length = (zkp.getA0().getX().toByteArray().length + 1) + (zkp.getB0().getX().toByteArray().length + 1) + zkp.getC().toByteArray().length + zkp.getSa().toByteArray().length + zkp.getSb().toByteArray().length;\n\t\tSystem.out.println(\"size: \" + length);\n\t\t\n\t\t// Do test\n\t\tlong timeNs = 0;\n\t\tfinal int iterations = 1000;\n\t\tfor (int i = 0; i < iterations; i++)\n\t\t{\n\t\t\tfinal BigInteger a = RandomNumberGenerator.generateRandomInteger(curve.getR());\n\t\t\tfinal BigInteger b = RandomNumberGenerator.generateRandomInteger(curve.getR());\n\t\t\tfinal long start = System.nanoTime();\n\t\t\tZeroKnowledgeProver.createProof(a, b);\n\t\t\tfinal long end = System.nanoTime();\n\t\t\ttimeNs += (end - start);\n\t\t}\n\t\t\n\t\tSystem.out.println(\"Total time (ms): \" + timeNs / (((long)iterations) * 1_000_000.0));\n\t}", "signature": "void testProofPerformance()", "full_signature": "@Test public void testProofPerformance()", "class_method_signature": "ZeroKnowledgeProverTest.testProofPerformance()", "testcase": true, "constructor": false, "invocations": ["generateRandomInteger", "getR", "generateRandomInteger", "getR", "createProof", "toByteArray", "getX", "getA0", "toByteArray", "getX", "getB0", "toByteArray", "getC", "toByteArray", "getSa", "toByteArray", "getSb", "println", "generateRandomInteger", "getR", "generateRandomInteger", "getR", "nanoTime", "createProof", "nanoTime", "println"]}, "focal_class": {"identifier": "ZeroKnowledgeProver", "superclass": "", "interfaces": "", "fields": [{"original_string": "public static final EcCurve curve = CommonConfiguration.CURVE;", "modifier": "public static final", "type": "EcCurve", "declarator": "curve = CommonConfiguration.CURVE", "var_name": "curve"}, {"original_string": "public static final EcPoint g = CommonConfiguration.g;", "modifier": "public static final", "type": "EcPoint", "declarator": "g = CommonConfiguration.g", "var_name": "g"}, {"original_string": "public static final EcPoint h = CommonConfiguration.h;", "modifier": "public static final", "type": "EcPoint", "declarator": "h = CommonConfiguration.h", "var_name": "h"}, {"original_string": "public static final String HASH_ALGORITHM = CommonConfiguration.HASH_ALGORITHM;", "modifier": "public static final", "type": "String", "declarator": "HASH_ALGORITHM = CommonConfiguration.HASH_ALGORITHM", "var_name": "HASH_ALGORITHM"}], "methods": [{"identifier": "createProof", "parameters": "(final BigInteger a0, final BigInteger b0)", "modifiers": "public static", "return": "ZeroKnowledgeProof", "signature": "ZeroKnowledgeProof createProof(final BigInteger a0, final BigInteger b0)", "full_signature": "public static ZeroKnowledgeProof createProof(final BigInteger a0, final BigInteger b0)", "class_method_signature": "ZeroKnowledgeProver.createProof(final BigInteger a0, final BigInteger b0)", "testcase": false, "constructor": false}, {"identifier": "verifyProof", "parameters": "(final EcPoint C0, final ZeroKnowledgeProof proof)", "modifiers": "public static", "return": "boolean", "signature": "boolean verifyProof(final EcPoint C0, final ZeroKnowledgeProof proof)", "full_signature": "public static boolean verifyProof(final EcPoint C0, final ZeroKnowledgeProof proof)", "class_method_signature": "ZeroKnowledgeProver.verifyProof(final EcPoint C0, final ZeroKnowledgeProof proof)", "testcase": false, "constructor": false}], "file": "pross-common/src/main/java/com/ibm/pross/common/util/crypto/zkp/splitting/ZeroKnowledgeProver.java"}, "focal_method": {"identifier": "createProof", "parameters": "(final BigInteger a0, final BigInteger b0)", "modifiers": "public static", "return": "ZeroKnowledgeProof", "body": "public static ZeroKnowledgeProof createProof(final BigInteger a0, final BigInteger b0)\n\t{\n\t\t// Calculate A0 and B0\n\t\tfinal EcPoint A0 = curve.multiply(g, a0);\n\t\tfinal EcPoint B0 = curve.multiply(h, b0);\n\t\t\n\t\t// Chose random points\n\t\tfinal BigInteger r1 = RandomNumberGenerator.generateRandomInteger(curve.getR());\n\t\tfinal BigInteger r2 = RandomNumberGenerator.generateRandomInteger(curve.getR());\n\t\t\n\t\t// Compute powers\n\t\tfinal EcPoint p1 = curve.multiply(g, r1);\n\t\tfinal EcPoint p2 = curve.multiply(h, r2);\n\t\tfinal EcPoint sum = curve.addPoints(p1, p2);\n\t\t\n\t\t// Compute c\n\t\tfinal byte[] input = Parse.concatenate(g, h, sum);\n\t\tfinal MessageDigest digest;\n\t\ttry {\n\t\t\tdigest = MessageDigest.getInstance(HASH_ALGORITHM);\n\t\t} catch (NoSuchAlgorithmException e) {\n\t\t\tthrow new RuntimeException(\"Should not happen\");\n\t\t}\n\t\tfinal BigInteger c = new BigInteger(1, digest.digest(input)).mod(curve.getR());\n\t\t\n\t\t// Compute sa and sb\n\t\tfinal BigInteger sa = (r1.subtract(c.multiply(a0))).mod(curve.getR());\n\t\tfinal BigInteger sb = (r2.subtract(c.multiply(b0))).mod(curve.getR());\n\t\t\n\t\treturn new ZeroKnowledgeProof(A0, B0, c, sa, sb);\n\t}", "signature": "ZeroKnowledgeProof createProof(final BigInteger a0, final BigInteger b0)", "full_signature": "public static ZeroKnowledgeProof createProof(final BigInteger a0, final BigInteger b0)", "class_method_signature": "ZeroKnowledgeProver.createProof(final BigInteger a0, final BigInteger b0)", "testcase": false, "constructor": false, "invocations": ["multiply", "multiply", "generateRandomInteger", "getR", "generateRandomInteger", "getR", "multiply", "multiply", "addPoints", "concatenate", "getInstance", "mod", "digest", "getR", "mod", "subtract", "multiply", "getR", "mod", "subtract", "multiply", "getR"]}, "repository": {"repo_id": 144309611, "url": "https://github.com/jasonkresch/protect", "language": "Java", "is_fork": false, "fork_count": 6, "stargazer_count": 38, "size": 1932, "license": "licensed"}}