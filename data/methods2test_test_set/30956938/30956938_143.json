{"test_class": {"identifier": "CSVSpreadsheetReaderTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private SpreadsheetReader spreadsheetReader;", "modifier": "private", "type": "SpreadsheetReader", "declarator": "spreadsheetReader", "var_name": "spreadsheetReader"}], "file": "taverna-spreadsheet-import-activity/src/test/java/org/apache/taverna/activities/spreadsheet/CSVSpreadsheetReaderTest.java"}, "test_case": {"identifier": "testReadAllRows", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n\tpublic void testReadAllRows() throws Exception {\n\t\tString[] testFiles2 = new String[] { \"/test-spreadsheet.csv\" };\n\t\tfor (int i = 0; i < testFiles2.length; i++) {\n\t\t\tfinal List<Integer> rows = new ArrayList<Integer>(Arrays.asList(0, 1, 2, 3, 4, 5, 6, 7,\n\t\t\t\t\t8, 9, 10, 11, 12, 13, 14));\n\t\t\tspreadsheetReader.read(getClass().getResourceAsStream(testFiles2[i]), new Range(0, -1), new Range(0, 4), false,\n\t\t\t\t\tnew SpreadsheetRowProcessor() {\n\n\t\t\t\t\t\tpublic void processRow(int rowIndex, SortedMap<Integer, String> row) {\n\t\t\t\t\t\t\tassertTrue(rows.remove((Integer) rowIndex));\n\t\t\t\t\t\t\tList<Integer> columns = new ArrayList<Integer>(Arrays.asList(0, 1, 2,\n\t\t\t\t\t\t\t\t\t3, 4));\n\t\t\t\t\t\t\tfor (Entry<Integer, String> cell : row.entrySet()) {\n\t\t\t\t\t\t\t\tassertTrue(columns.remove(cell.getKey()));\n\t\t\t\t\t\t\t\tif (rowIndex == 0) {\n\t\t\t\t\t\t\t\t\tif (cell.getKey().equals(0)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"A\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(1)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"5\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(2)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"C\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(3)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"1\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (rowIndex == 1) {\n\t\t\t\t\t\t\t\t\tif (cell.getKey().equals(0)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"A\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(1)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"5\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(2)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"C\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(3)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"1\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (rowIndex == 2) {\n\t\t\t\t\t\t\t\t\tif (cell.getKey().equals(0)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"TRUE\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(1)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"15/06/09\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(2)) {\n\t\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t\t} else if (cell.getKey().equals(3)) {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"2\", cell.getValue());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (rowIndex == 3 || rowIndex == 4) {\n\t\t\t\t\t\t\t\t\tif (cell.getKey().equals(4)) {\n\t\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"X\", cell.getValue());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (rowIndex == 5 || rowIndex == 6 || rowIndex == 7\n\t\t\t\t\t\t\t\t\t\t|| rowIndex == 8) {\n\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t} else if (rowIndex == 9 || rowIndex == 10 || rowIndex == 11\n\t\t\t\t\t\t\t\t\t\t|| rowIndex == 12 || rowIndex == 13 || rowIndex == 14) {\n\t\t\t\t\t\t\t\t\tif (cell.getKey().equals(4)) {\n\t\t\t\t\t\t\t\t\t\tassertNull(cell.getValue());\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tassertEquals(\"y\", cell.getValue());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tassertTrue(columns.isEmpty());\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\tassertTrue(rows.isEmpty());\n\t\t}\n\t}", "signature": "void testReadAllRows()", "full_signature": "@Test public void testReadAllRows()", "class_method_signature": "CSVSpreadsheetReaderTest.testReadAllRows()", "testcase": true, "constructor": false, "invocations": ["asList", "read", "getResourceAsStream", "getClass", "assertTrue", "remove", "asList", "entrySet", "assertTrue", "remove", "getKey", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "assertNull", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "assertNull", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertEquals", "getValue", "equals", "getKey", "assertNull", "getValue", "equals", "getKey", "assertEquals", "getValue", "assertNull", "getValue", "equals", "getKey", "assertNull", "getValue", "assertEquals", "getValue", "assertNull", "getValue", "equals", "getKey", "assertNull", "getValue", "assertEquals", "getValue", "assertTrue", "isEmpty", "assertTrue", "isEmpty"]}, "focal_class": {"identifier": "CSVSpreadsheetReader", "superclass": "", "interfaces": "implements SpreadsheetReader", "fields": [], "methods": [{"identifier": "read", "parameters": "(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "modifiers": "public", "return": "void", "signature": "void read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "full_signature": "public void read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "class_method_signature": "CSVSpreadsheetReader.read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "testcase": false, "constructor": false}], "file": "taverna-spreadsheet-import-activity/src/main/java/org/apache/taverna/activities/spreadsheet/CSVSpreadsheetReader.java"}, "focal_method": {"identifier": "read", "parameters": "(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "modifiers": "public", "return": "void", "body": "public void read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)\n\t\t\tthrows SpreadsheetReadException {\n\t\tCsvReader csvReader = new CsvReader(new InputStreamReader(inputStream));\n\t\tcsvReader.setSkipEmptyRecords(false);\n\n\t\tSortedMap<Integer, String> currentDataRow = new TreeMap<Integer, String>();\n\n\t\ttry {\n\t\t\twhile(csvReader.readRecord()) {\n\t\t\t\tint rowIndex = (int) csvReader.getCurrentRecord();\n\t\t\t\tboolean blankRow = true;\n\t\t\t\tif (rowRange.contains(rowIndex)) {\n\t\t\t\t\tfor (int columnIndex = columnRange.getStart(); columnIndex <= columnRange.getEnd(); columnIndex++) {\n\t\t\t\t\t\tif (columnRange.contains(columnIndex)) {\n\t\t\t\t\t\t\tString value = csvReader.get(columnIndex);\n\t\t\t\t\t\t\tvalue = \"\".equals(value) ? null : value;\n\t\t\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\t\t\tblankRow = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcurrentDataRow.put(columnIndex, value);\n\t\t\t\t\t\t\tif (columnIndex == columnRange.getEnd()) {\n\t\t\t\t\t\t\t\tif (!ignoreBlankRows || !blankRow) {\n\t\t\t\t\t\t\t\t\trowProcessor.processRow(rowIndex, currentDataRow);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcurrentDataRow = new TreeMap<Integer, String>();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\tif (rowIndex == rowRange.getEnd()) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\tthrow new SpreadsheetReadException(\"Unable to read CSV file\", e);\n\t\t}\n\t}", "signature": "void read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "full_signature": "public void read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "class_method_signature": "CSVSpreadsheetReader.read(InputStream inputStream, Range rowRange,\n\t\t\tRange columnRange, boolean ignoreBlankRows,\n\t\t\tSpreadsheetRowProcessor rowProcessor)", "testcase": false, "constructor": false, "invocations": ["setSkipEmptyRecords", "readRecord", "getCurrentRecord", "contains", "getStart", "getEnd", "contains", "get", "equals", "put", "getEnd", "processRow", "getEnd"]}, "repository": {"repo_id": 30956938, "url": "https://github.com/apache/incubator-taverna-common-activities", "language": "Java", "is_fork": false, "fork_count": 13, "stargazer_count": 8, "size": 5696, "license": "licensed"}}