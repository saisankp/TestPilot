{"test_class": {"identifier": "CSVReaderTest", "superclass": "", "interfaces": "", "fields": [], "file": "OcavaCore/src/test/java/com/ocadotechnology/tableio/csv/CSVReaderTest.java"}, "test_case": {"identifier": "testReadCSVFile", "parameters": "()", "modifiers": "@Test", "return": "void", "body": "@Test\n    void testReadCSVFile() {\n        SimpleTableReader consumer = new SimpleTableReader();\n        CSVReader reader = new CSVReader();\n\n        File testFile = new File(\"src/test/test.csv\");\n        reader.read(testFile, consumer);\n\n        ImmutableMap<String, String> line0 = ImmutableMap.<String, String>builder()\n                .put(\"THIS\", \"1\")\n                .put(\"IS\", \"2\")\n                .put(\"A\", \"3\")\n                .put(\"TEST\", \"4\")\n                .build();\n        ImmutableMap<String, String> line1 = ImmutableMap.<String, String>builder()\n                .put(\"THIS\", \"5\")\n                .put(\"IS\", \"6\")\n                .put(\"A\", \"7\")\n                .put(\"TEST\", \"8\")\n                .build();\n\n        Assertions.assertEquals(line0, consumer.getRow(0));\n        Assertions.assertEquals(line1, consumer.getRow(1));\n    }", "signature": "void testReadCSVFile()", "full_signature": "@Test void testReadCSVFile()", "class_method_signature": "CSVReaderTest.testReadCSVFile()", "testcase": true, "constructor": false, "invocations": ["read", "build", "put", "put", "put", "put", "builder", "build", "put", "put", "put", "put", "builder", "assertEquals", "getRow", "assertEquals", "getRow"]}, "focal_class": {"identifier": "CSVReader", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final Logger logger = LoggerFactory.getLogger(CSVReader.class);", "modifier": "private static final", "type": "Logger", "declarator": "logger = LoggerFactory.getLogger(CSVReader.class)", "var_name": "logger"}, {"original_string": "public static final String COLUMN_DELIMITER = \",\";", "modifier": "public static final", "type": "String", "declarator": "COLUMN_DELIMITER = \",\"", "var_name": "COLUMN_DELIMITER"}], "methods": [{"identifier": "read", "parameters": "(BufferedReader reader, TableReader lineConsumer)", "modifiers": "public", "return": "void", "signature": "void read(BufferedReader reader, TableReader lineConsumer)", "full_signature": "public void read(BufferedReader reader, TableReader lineConsumer)", "class_method_signature": "CSVReader.read(BufferedReader reader, TableReader lineConsumer)", "testcase": false, "constructor": false}, {"identifier": "read", "parameters": "(File file, TableReader lineConsumer)", "modifiers": "public", "return": "void", "signature": "void read(File file, TableReader lineConsumer)", "full_signature": "public void read(File file, TableReader lineConsumer)", "class_method_signature": "CSVReader.read(File file, TableReader lineConsumer)", "testcase": false, "constructor": false}], "file": "OcavaCore/src/main/java/com/ocadotechnology/tableio/csv/CSVReader.java"}, "focal_method": {"identifier": "read", "parameters": "(BufferedReader reader, TableReader lineConsumer)", "modifiers": "public", "return": "void", "body": "public void read(BufferedReader reader, TableReader lineConsumer) {\n        try {\n            String line = reader.readLine();\n            if (line == null) {\n                return;\n            }\n            ImmutableList<String> header = Arrays.stream(line.split(COLUMN_DELIMITER, -1))\n                    .collect(ImmutableList.toImmutableList());\n            int headerLength = header.size();\n            lineConsumer.consumeHeader(header);\n            line = reader.readLine();\n            while (line != null) {\n                if (!line.isEmpty()) {\n                    String[] splitLine = line.split(COLUMN_DELIMITER, -1);\n                    Preconditions.checkState(splitLine.length == headerLength,\n                            String.format(\"Line incompatible with header.%n Line: %s%n Header: %s\", Arrays.toString(splitLine), header));\n                    ImmutableMap.Builder<String, String> builder = ImmutableMap.builder();\n                    for (int i = 0; i < headerLength; i++) {\n                        builder.put(header.get(i), splitLine[i]);\n                    }\n                    lineConsumer.consumeLine(builder.build());\n                }\n                line = reader.readLine();\n            }\n            lineConsumer.fileFinished();\n            reader.close();\n        } catch (IOException e) {\n            logger.error(\"Failed to read file\", e);\n        }\n    }", "signature": "void read(BufferedReader reader, TableReader lineConsumer)", "full_signature": "public void read(BufferedReader reader, TableReader lineConsumer)", "class_method_signature": "CSVReader.read(BufferedReader reader, TableReader lineConsumer)", "testcase": false, "constructor": false, "invocations": ["readLine", "collect", "stream", "split", "toImmutableList", "size", "consumeHeader", "readLine", "isEmpty", "split", "checkState", "format", "toString", "builder", "put", "get", "consumeLine", "build", "readLine", "fileFinished", "close", "error"]}, "repository": {"repo_id": 99997703, "url": "https://github.com/ocadotechnology/Ocava", "language": "Java", "is_fork": false, "fork_count": 4, "stargazer_count": 16, "size": 1137, "license": "licensed"}}