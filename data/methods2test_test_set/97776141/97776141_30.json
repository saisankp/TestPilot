{"test_class": {"identifier": "DefaultAuthenticationServiceTest", "superclass": "", "interfaces": "", "fields": [{"original_string": "private static final String VALID_USERNAME = \"user\";", "modifier": "private static final", "type": "String", "declarator": "VALID_USERNAME = \"user\"", "var_name": "VALID_USERNAME"}, {"original_string": "private static final String VALID_PASSWORD = \"password\";", "modifier": "private static final", "type": "String", "declarator": "VALID_PASSWORD = \"password\"", "var_name": "VALID_PASSWORD"}, {"original_string": "private static final String INVALID_PASSWORD = \"invalid_password\";", "modifier": "private static final", "type": "String", "declarator": "INVALID_PASSWORD = \"invalid_password\"", "var_name": "INVALID_PASSWORD"}, {"original_string": "@Mock\n    private UserService mockUserService;", "modifier": "@Mock\n    private", "type": "UserService", "declarator": "mockUserService", "var_name": "mockUserService"}, {"original_string": "@Mock\n    private DateTimeService mockDateTimeService;", "modifier": "@Mock\n    private", "type": "DateTimeService", "declarator": "mockDateTimeService", "var_name": "mockDateTimeService"}, {"original_string": "private DefaultAuthenticationService defaultAuthenticationService;", "modifier": "private", "type": "DefaultAuthenticationService", "declarator": "defaultAuthenticationService", "var_name": "defaultAuthenticationService"}], "file": "application/confagrid-webapp/src/test/java/com/aleggeup/confagrid/auth/DefaultAuthenticationServiceTest.java"}, "test_case": {"identifier": "testUserPasswordCheck", "parameters": "()", "modifiers": "@Test public", "return": "void", "body": "@Test\n    public void testUserPasswordCheck() {\n        final UserEntity userEntity = new UserEntity();\n        userEntity.setPassword(VALID_PASSWORD);\n\n        Mockito.when(mockUserService.findByName(VALID_USERNAME)).thenReturn(userEntity);\n        Mockito.when(mockUserService.matches(VALID_PASSWORD, VALID_PASSWORD)).thenReturn(true);\n\n        Assert.assertTrue(defaultAuthenticationService.userPasswordCheck(VALID_USERNAME, VALID_PASSWORD));\n\n        Mockito.verify(mockUserService).findByName(VALID_USERNAME);\n        Mockito.verify(mockUserService).matches(VALID_PASSWORD, VALID_PASSWORD);\n    }", "signature": "void testUserPasswordCheck()", "full_signature": "@Test public void testUserPasswordCheck()", "class_method_signature": "DefaultAuthenticationServiceTest.testUserPasswordCheck()", "testcase": true, "constructor": false, "invocations": ["setPassword", "thenReturn", "when", "findByName", "thenReturn", "when", "matches", "assertTrue", "userPasswordCheck", "findByName", "verify", "matches", "verify"]}, "focal_class": {"identifier": "DefaultAuthenticationService", "superclass": "", "interfaces": "implements AuthenticationService", "fields": [{"original_string": "private static final int TOKEN_INTERVAL_DAYS = 1;", "modifier": "private static final", "type": "int", "declarator": "TOKEN_INTERVAL_DAYS = 1", "var_name": "TOKEN_INTERVAL_DAYS"}, {"original_string": "private final UserService userService;", "modifier": "private final", "type": "UserService", "declarator": "userService", "var_name": "userService"}, {"original_string": "private final DateTimeService dateTimeService;", "modifier": "private final", "type": "DateTimeService", "declarator": "dateTimeService", "var_name": "dateTimeService"}], "methods": [{"identifier": "DefaultAuthenticationService", "parameters": "(final UserService userService, final DateTimeService dateTimeService)", "modifiers": "@Autowired public", "return": "", "signature": " DefaultAuthenticationService(final UserService userService, final DateTimeService dateTimeService)", "full_signature": "@Autowired public  DefaultAuthenticationService(final UserService userService, final DateTimeService dateTimeService)", "class_method_signature": "DefaultAuthenticationService.DefaultAuthenticationService(final UserService userService, final DateTimeService dateTimeService)", "testcase": false, "constructor": true}, {"identifier": "userPasswordCheck", "parameters": "(final String username, final String password)", "modifiers": "@Override public", "return": "boolean", "signature": "boolean userPasswordCheck(final String username, final String password)", "full_signature": "@Override public boolean userPasswordCheck(final String username, final String password)", "class_method_signature": "DefaultAuthenticationService.userPasswordCheck(final String username, final String password)", "testcase": false, "constructor": false}, {"identifier": "authenticationToken", "parameters": "(final String username, final String password)", "modifiers": "@Override public", "return": "String", "signature": "String authenticationToken(final String username, final String password)", "full_signature": "@Override public String authenticationToken(final String username, final String password)", "class_method_signature": "DefaultAuthenticationService.authenticationToken(final String username, final String password)", "testcase": false, "constructor": false}, {"identifier": "anonymousToken", "parameters": "()", "modifiers": "@Override public", "return": "String", "signature": "String anonymousToken()", "full_signature": "@Override public String anonymousToken()", "class_method_signature": "DefaultAuthenticationService.anonymousToken()", "testcase": false, "constructor": false}], "file": "application/confagrid-webapp/src/main/java/com/aleggeup/confagrid/auth/DefaultAuthenticationService.java"}, "focal_method": {"identifier": "userPasswordCheck", "parameters": "(final String username, final String password)", "modifiers": "@Override public", "return": "boolean", "body": "@Override\n    public boolean userPasswordCheck(final String username, final String password) {\n        final UserEntity userEntity = userService.findByName(username);\n\n        return userEntity != null && userService.matches(password, userEntity.getPassword());\n    }", "signature": "boolean userPasswordCheck(final String username, final String password)", "full_signature": "@Override public boolean userPasswordCheck(final String username, final String password)", "class_method_signature": "DefaultAuthenticationService.userPasswordCheck(final String username, final String password)", "testcase": false, "constructor": false, "invocations": ["findByName", "matches", "getPassword"]}, "repository": {"repo_id": 97776141, "url": "https://github.com/ALeggeUp/confagrid", "language": "Java", "is_fork": false, "fork_count": 0, "stargazer_count": 5, "size": 22043, "license": "licensed"}}